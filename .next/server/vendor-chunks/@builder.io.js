"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@builder.io";
exports.ids = ["vendor-chunks/@builder.io"];
exports.modules = {

/***/ "(ssr)/./node_modules/@builder.io/react/dist/builder-react.es5.js":
/*!******************************************************************!*\
  !*** ./node_modules/@builder.io/react/dist/builder-react.es5.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Builder: () => (/* reexport safe */ _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder),\n/* harmony export */   BuilderAsyncRequestsContext: () => (/* binding */ BuilderAsyncRequestsContext),\n/* harmony export */   BuilderBlock: () => (/* binding */ BuilderBlock),\n/* harmony export */   BuilderBlockComponent: () => (/* binding */ BuilderBlock$1),\n/* harmony export */   BuilderBlocks: () => (/* binding */ BuilderBlocks),\n/* harmony export */   BuilderComponent: () => (/* binding */ BuilderComponent),\n/* harmony export */   BuilderContent: () => (/* binding */ BuilderContent),\n/* harmony export */   BuilderMetaContext: () => (/* binding */ BuilderMetaContext),\n/* harmony export */   BuilderPage: () => (/* binding */ BuilderComponent),\n/* harmony export */   BuilderStoreContext: () => (/* binding */ BuilderStoreContext),\n/* harmony export */   Button: () => (/* binding */ Button),\n/* harmony export */   Columns: () => (/* binding */ Columns),\n/* harmony export */   Content: () => (/* binding */ BuilderComponent),\n/* harmony export */   CustomCode: () => (/* binding */ CustomCode),\n/* harmony export */   Dropzone: () => (/* binding */ Slot),\n/* harmony export */   Embed: () => (/* binding */ Embed),\n/* harmony export */   Form: () => (/* binding */ Form),\n/* harmony export */   FormInput: () => (/* binding */ FormInput),\n/* harmony export */   FormSelect: () => (/* binding */ FormSelect),\n/* harmony export */   FormSubmitButton: () => (/* binding */ FormSubmitButton),\n/* harmony export */   Fragment: () => (/* binding */ Fragment),\n/* harmony export */   Image: () => (/* binding */ Image),\n/* harmony export */   Img: () => (/* binding */ Img),\n/* harmony export */   Label: () => (/* binding */ Label),\n/* harmony export */   Mutation: () => (/* binding */ Mutation),\n/* harmony export */   RawText: () => (/* binding */ RawText),\n/* harmony export */   Router: () => (/* binding */ Router),\n/* harmony export */   Section: () => (/* binding */ Section),\n/* harmony export */   StateProvider: () => (/* binding */ StateProvider),\n/* harmony export */   Symbol: () => (/* binding */ Symbol$1),\n/* harmony export */   Text: () => (/* binding */ Text),\n/* harmony export */   TextArea: () => (/* binding */ TextArea),\n/* harmony export */   Video: () => (/* binding */ Video),\n/* harmony export */   builder: () => (/* reexport safe */ _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder),\n/* harmony export */   \"default\": () => (/* reexport safe */ _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder),\n/* harmony export */   getSrcSet: () => (/* binding */ getSrcSet),\n/* harmony export */   noWrap: () => (/* binding */ noWrap),\n/* harmony export */   onChange: () => (/* binding */ onChange),\n/* harmony export */   stringToFunction: () => (/* binding */ stringToFunction),\n/* harmony export */   updateMetadata: () => (/* binding */ updateMetadata),\n/* harmony export */   useIsPreviewing: () => (/* binding */ useIsPreviewing),\n/* harmony export */   withBuilder: () => (/* binding */ withBuilder),\n/* harmony export */   withChildren: () => (/* binding */ withChildren)\n/* harmony export */ });\n/* harmony import */ var _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @builder.io/sdk */ \"(ssr)/./node_modules/@builder.io/sdk/dist/index.esm.js\");\n/* harmony import */ var _emotion_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @emotion/core */ \"(ssr)/./node_modules/@emotion/core/dist/core.esm.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-dom.js\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var hash_sum__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! hash-sum */ \"(ssr)/./node_modules/hash-sum/hash-sum.js\");\n/* harmony import */ var hash_sum__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(hash_sum__WEBPACK_IMPORTED_MODULE_4__);\nvar version=\"3.2.6\",_a;\"undefined\"!=typeof window&&(null===(_a=window.parent)||void 0===_a||_a.postMessage({type:\"builder.isReactSdk\",data:{value:!0,supportsPatchUpdates:\"v4\",supportsCustomBreakpoints:!0,supportsGlobalSymbols:!0,priorVersion:version}},\"*\"));var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function __extends(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Class extends value \"+String(t)+\" is not a constructor or null\");function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function __rest(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function __decorate(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function __metadata(e,t){if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))}function __generator(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(n)throw new TypeError(\"Generator is already executing.\");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function __spreadArray(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}\"function\"==typeof SuppressedError&&SuppressedError;var fastClone=function(e){return JSON.parse(JSON.stringify(e))},omit$2=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=Object.assign({},e),r=0,o=t;r<o.length;r++){var a=o[r];delete i[a]}return i},sizeNames=[\"xsmall\",\"small\",\"medium\",\"large\"],sizes={xsmall:{min:0,default:0,max:0},small:{min:320,default:321,max:640},medium:{min:641,default:642,max:991},large:{min:990,default:991,max:1200},getWidthForSize:function(e){return this[e].default},getSizeForWidth:function(e){for(var t=0,n=sizeNames;t<n.length;t++){var i=n[t];if(e<=this[i].max)return i}return\"large\"}},getSizesForBreakpoints=function(e){var t=e.small,n=e.medium,i=__assign(__assign({},sizes),fastClone(sizes));if(!t||!n)return i;var r=Math.floor(t/2);i.small={max:t,min:r,default:r+1};var o=i.small.max+1;i.medium={max:n,min:o,default:o+1};var a=i.medium.max+1;return i.large={max:2e3,min:a,default:a+1},i},set=function(e,t,n){if(Object(e)!==e)return e;var i=Array.isArray(t)?t:t.toString().match(/[^.[\\]]+/g);return i.slice(0,-1).reduce((function(e,t,n){return Object(e[t])===e[t]?e[t]:e[t]=Math.abs(Number(i[n+1]))>>0==+i[n+1]?[]:{}}),e)[i[i.length-1]]=n,e},noop=function(){return null},safeDynamicRequire;if(\"function\"==typeof(null===globalThis||void 0===globalThis?void 0:globalThis.require)||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer&&\"function\"==\"function\")try{safeDynamicRequire=eval(\"require\")}catch(e){safeDynamicRequire=(null===globalThis||void 0===globalThis?void 0:globalThis.require)?globalThis.require:noop}function isDebug(){return Boolean(\"undefined\"!=typeof process&&void 0!==process.env&&process.env.DEBUG)}function isNodeRuntime(){var e;return\"undefined\"!=typeof process&&Boolean(null===(e=null===process||void 0===process?void 0:process.versions)||void 0===e?void 0:e.node)}null!=safeDynamicRequire||(safeDynamicRequire=noop);var shouldForceBrowserRuntimeInNode=function(){var e;if(!isNodeRuntime())return!1;var t=\"arm64\"===process.arch,n=process.version.startsWith(\"v20\"),i=null===(e=process.env.NODE_OPTIONS)||void 0===e?void 0:e.includes(\"--no-node-snapshot\");return!(!t||!n||i)&&(console.log(\"Skipping usage of `isolated-vm` to avoid crashes in Node v20 on an arm64 machine.\\n    If you would like to use the `isolated-vm` package on this machine, please provide the `NODE_OPTIONS=--no-node-snapshot` config to your Node process.\\n    See https://github.com/BuilderIO/builder/blob/main/packages/react/README.md#node-v20--m1-macs-apple-silicon-support for more information.\\n    \"),!0)},fnCache={},api=function(e){return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder};function stringToFunction(e,t,n,i){if(void 0===t&&(t=!0),!e||!e.trim())return function(){};var r=e+\":\"+t;if(fnCache[r])return fnCache[r];var o=t&&!(e.includes(\";\")||e.includes(\" return \")||e.trim().startsWith(\"return \"))||e.trim().startsWith(\"builder.run\"),a=function(){};try{_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&(a=new Function(\"state\",\"event\",\"block\",\"builder\",\"Device\",\"update\",\"Builder\",\"context\",\"\\n          var names = [\\n            'state',\\n            'event',\\n            'block',\\n            'builder',\\n            'Device',\\n            'update',\\n            'Builder',\\n            'context'\\n          ];\\n          var rootState = state;\\n          if (typeof Proxy !== 'undefined') {\\n            rootState = new Proxy(rootState, {\\n              set: function () {\\n                return false;\\n              },\\n              get: function (target, key) {\\n                if (names.includes(key)) {\\n                  return undefined;\\n                }\\n                return target[key];\\n              }\\n            });\\n          }\\n          /* Alias */\\n          var ctx = context;\\n          var log = console.log.bind(console);\\n          with (rootState) {\\n            \".concat(o?\"return (\".concat(e,\");\"):e,\";\\n          }\\n        \")))}catch(t){n&&n.push(t);var s=t&&t.message;s&&\"string\"==typeof s&&i&&-1===i.indexOf(s)&&i.push(s),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&console.warn(\"Function compile error in \".concat(e),t)}var l=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];try{if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser||shouldForceBrowserRuntimeInNode())return a.apply(void 0,t);var r=getIsolateContext(),s=safeDynamicRequire(\"isolated-vm\"),l=r.evalClosureSync(makeFn(e,o),t.map((function(e,t){return\"object\"==typeof e?new s.Reference(t===indexOfBuilderInstance?__assign(__assign({},e),{getUserAttributes:function(){return e.getUserAttributes(\"\")}}):e):null})));try{var u=JSON.parse(l);return u}catch(e){return l}}catch(t){return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser?console.warn(\"Builder custom code error:\",t.message||t,\"in\",e,t.stack||t):isDebug()&&console.debug(\"Builder custom code error:\",t.message||t,\"in\",e,t.stack||t),n&&n.push(t),null}};return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&(fnCache[r]=l),l}var indexOfBuilderInstance=3,makeFn=function(e,t,n){var i=n||[\"state\",\"event\",\"block\",\"builder\",\"Device\",\"update\",\"Builder\",\"context\"];return\"\\n\".concat(\"\\n  var refToProxy = (obj) => {\\n    if (typeof obj !== 'object' || obj === null) {\\n      return obj;\\n    }\\n    return new Proxy({}, {\\n        get(target, key) {\\n            if (key === 'copySync') {\\n              return () => obj.copySync();\\n            }\\n            const val = obj.getSync(key);\\n            if (typeof val?.getSync === 'function') {\\n                return refToProxy(val);\\n            }\\n            return val;\\n        },\\n        set(target, key, value) {\\n            obj.setSync(key, value);\\n        },\\n        deleteProperty(target, key) {\\n            obj.deleteSync(key);\\n        }\\n      })\\n  }\\n\",\"\\n\").concat(\"\\n    var stringify = (val) => {\\n      if (typeof val === 'object' && val !== null) {\\n        return JSON.stringify(val.copySync ? val.copySync() : val);\\n      }\\n      return val;\\n    }\\n  \",\"\\n\").concat(i.map((function(e,t){return\"var \".concat(e,\" = refToProxy($\").concat(t,\");\")})).join(\"\\n\")).concat(\"\\n\".concat(i.includes(\"context\")?\"var ctx = context;\":\"\",\"\\n\").concat(t?\"return stringify(\".concat(e,\");\"):e,\";\\n\"))},getIsolateContext=function(){var e=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.serverContext;e||(e=new(safeDynamicRequire(\"isolated-vm\").Isolate)({memoryLimit:128}).createContextSync(),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.setServerContext(e));var t=e.global;return t.setSync(\"global\",t.derefInto()),t.setSync(\"log\",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];isDebug()&&console.log.apply(console,e)})),e},isPromise=function(e){return\"function\"==typeof e.then},isRequestInfo=function(e){return!isPromise(e)},BuilderAsyncRequestsContext=react__WEBPACK_IMPORTED_MODULE_2___default().createContext({requests:[],errors:[],logs:[]}),BuilderStoreContext=react__WEBPACK_IMPORTED_MODULE_2___default().createContext({state:{},rootState:{},content:{},context:{},update:function(e){return null}}),applyPatchWithMinimalMutationChain=function(e,t,n){if(void 0===n&&(n=!1),Object(e)!==e)return e;var i=t.path,r=t.op,o=t.value,a=i.split(/\\//);\"\"===a[0]&&a.shift();for(var s=n?e:__assign({},e),l=s,u=0;u<a.length;u++){var d=u===a.length-1,c=a[u];if(d){if(\"replace\"===r)l[c]=o;else if(\"add\"===r){var p=Number(c);Array.isArray(l)?\"-\"===c?l.push(o):l.splice(p,0,o):l[c]=o}else if(\"remove\"===r){p=Number(c);Array.isArray(l)?l.splice(p,1):delete l[c]}}else{var f=a[u+1],m=Object(l[c])===l[c]?l[c]:String(Number(f))===f?[]:{};l=l[c]=Array.isArray(m)?__spreadArray([],m,!0):__assign({},m)}}return s},htmlEscape=function(e){return e.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\")},blockToHtmlString=function(e){var t;return\"<\".concat(htmlEscape(e.tagName||\"div\"),' \\n    class=\"builder-block ').concat(e.id,\" \").concat(e.class||\"\",'\"\\n    builder-id=\"').concat(e.id,'\"\\n  ').concat(Object.keys(e.properties||{}).map((function(t){return\"\".concat(htmlEscape(t),'=\"').concat(htmlEscape(e.properties[t]),'\"')})).join(\" \"),\"\\n  >\").concat(\"Text\"===(null===(t=null==e?void 0:e.component)||void 0===t?void 0:t.name)?e.component.options.text:e.children?e.children.map((function(e){return blockToHtmlString(e)})).join(\"\"):\"\",\"</\").concat(e.tagName||\"div\",\">\").replace(/\\s+/g,\" \")},Link=function(e){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderStoreContext.Consumer,null,(function(t){return t.renderLink?t.renderLink(e):react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"a\",__assign({},e))}))},camelCaseToKebabCase=function(e){return e?e.replace(/([A-Z])/g,(function(e){return\"-\".concat(e[0].toLowerCase())})):\"\"},kebabCaseToCamelCase=function(e){return void 0===e&&(e=\"\"),e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))},Device={desktop:0,tablet:1,mobile:2},voidElements=new Set([\"area\",\"base\",\"br\",\"col\",\"embed\",\"hr\",\"img\",\"input\",\"link\",\"meta\",\"param\",\"source\",\"track\",\"wbr\",\"textarea\"]),last=function(e){return e[e.length-1]};function omit$1(e,t){for(var n=Object.assign({},e),i=0,r=t;i<r.length;i++){delete n[r[i]]}return n}var cssCase=function(e){if(!e)return e;var t=camelCaseToKebabCase(e);return e[0]===e[0].toUpperCase()&&(t=\"-\"+t),t};function capitalize(e){if(e)return e[0].toUpperCase()+e.slice(1)}var BuilderBlock$1=function(_super){function BuilderBlock(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.state={hasError:!1,updates:0},_this.privateState={state:{},rootState:{},context:{},update:function(){}},_this.onWindowMessage=function(event){var message=event.data;if(message)switch(message.type){case\"builder.selectionChange\":var data=message.data;if(!data)break;var selection=data.selection,id=_this.block&&_this.block.id;id&&Array.isArray(selection)&&selection.indexOf(id)>-1&&setTimeout((function(){window.$block=_this,window.$blocks||(window.$blocks=[]),window.$blocks.push(_this)}));break;case\"builder.patchUpdates\":var data=message.data;if(!data||!data.data)break;var patches=data.data[_this.block.id];if(!patches)return;location.href.includes(\"builder.debug=true\")&&eval(\"debugger\");for(var _i=0,patches_1=patches;_i<patches_1.length;_i++){var patch=patches_1[_i];applyPatchWithMinimalMutationChain(_this.props.block,patch,!0)}_this.setState({updates:_this.state.updates+1})}},_this}return __extends(BuilderBlock,_super),Object.defineProperty(BuilderBlock.prototype,\"store\",{get:function(){return this.privateState},enumerable:!1,configurable:!0}),BuilderBlock.getDerivedStateFromError=function(e){return{hasError:!0}},BuilderBlock.prototype.componentDidCatch=function(e,t){console.error(\"Builder block error:\",e,t)},BuilderBlock.prototype.stringToFunction=function(e,t){return void 0===t&&(t=!0),stringToFunction(e,t,this._errors,this._logs)},Object.defineProperty(BuilderBlock.prototype,\"block\",{get:function(){return this.props.block},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderBlock.prototype,\"emotionCss\",{get:function(){var e,t,n,i,r,o=this.block;if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer){var a=o.animations&&o.animations[0];if(a&&\"hover\"!==a.trigger){var s=a&&a.steps&&a.steps[0],l=s&&s.styles;l&&(r=l)}}var u=sizeNames.slice().reverse(),d=this.block,c={};if(d.responsiveStyles)for(var p=0,f=u;p<f.length;p++){var m=f[p];if(\"large\"===m)this.props.emailMode||(c[\"&.builder-block\"]=Object.assign({},d.responsiveStyles[m],r));else{var h=getSizesForBreakpoints((null===(t=null===(e=this.privateState.context.builderContent)||void 0===e?void 0:e.meta)||void 0===t?void 0:t.breakpoints)||{});c[\"@media only screen and (max-width: \".concat(h[m].max,\"px)\")]={\"&.builder-block\":d.responsiveStyles[m]}}}var g=o.animations&&o.animations.find((function(e){return\"hover\"===e.trigger}));return g&&(c[\":hover\"]=(null===(i=null===(n=g.steps)||void 0===n?void 0:n[1])||void 0===i?void 0:i.styles)||{},c.transition=\"all \".concat(g.duration,\"s \").concat(camelCaseToKebabCase(g.easing)),g.delay&&(c.transitionDelay=g.delay+\"s\")),c},enumerable:!1,configurable:!0}),BuilderBlock.prototype.eval=function(e){return this.stringToFunction(e)(this.privateState.state,void 0,this.block,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder,Device,this.privateState.update,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder,this.privateState.context)},BuilderBlock.prototype.componentWillUnmount=function(){_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&removeEventListener(\"message\",this.onWindowMessage)},BuilderBlock.prototype.componentDidMount=function(){var e,t=this,n=this.block,i=n&&n.animations;if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&addEventListener(\"message\",this.onWindowMessage),i){var r={animations:fastClone(i)};if(n.bindings)for(var o in n.bindings)if((null===(e=o.trim)||void 0===e?void 0:e.call(o))&&o.startsWith(\"animations.\")){var a=this.stringToFunction(n.bindings[o]);void 0!==a&&set(r,o,a(this.privateState.state,null,n,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder,null,null,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder,this.privateState.context))}_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.animator.bindAnimations(r.animations.filter((function(e){return\"hover\"!==e.trigger})).map((function(e){return __assign(__assign({},e),{elementId:t.block.id})})))}},BuilderBlock.prototype.getElement=function(e,t){var n,i,r,o,a,s=this;void 0===e&&(e=0),void 0===t&&(t=this.privateState.state);var l=this.props;l.child,l.fieldName;var u,d=this.block,c=(d.tagName||\"div\").toLowerCase();if(\"template\"===c){var p=d.children?d.children.map((function(e){return blockToHtmlString(e)})).join(\" \"):\"\";return console.debug(\"template html\",p),(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"template\",__assign({},d.properties,{dangerouslySetInnerHTML:{__html:p}}))}var f=d.component&&(d.component.name||d.component.component),m=null;d.component&&!d.component.class&&(d.component&&d.component.tag?u=d.component.tag:(m=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.components.find((function(e){return e.name===f}))||null)&&m.class?u=m.class:m&&m.tag?u=m.tag:(null==f?void 0:f.startsWith(\"Builder:\"))?console.warn(\"Missing @builder.io/widgets installation, please install and import @builder.io/widgets to use \".concat(f.split(\":\")[1],\" in your content, more info here: https://github.com/BuilderIO/builder/tree/main/packages/widgets\")):f&&console.warn(\"Missing registration for \".concat(f,\", have you included the registration in your bundle?\")));var h=__assign(__assign({},d.properties),{style:{}});if(h=__assign(__assign({},h.properties),h),d.component&&(h.component=fastClone(d.component)),d.bindings)for(var g in d.bindings)if(null===(i=g.trim)||void 0===i?void 0:i.call(g)){var v=this.stringToFunction(d.bindings[g]);set(h,g,v(t,null,d,api(),Device,null,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder,this.privateState.context))}if(h.hide)return null;if(delete h.hide,(\"show\"in h||d.bindings&&d.bindings.show)&&!h.show)return null;if(delete h.show,d.actions){var b=function(e){if(!(null===(r=e.trim)||void 0===r?void 0:r.call(e)))return\"continue\";var n=d.actions[e];h[\"on\"+capitalize(e)]=function(e){var i=t;return\"undefined\"!=typeof Proxy&&(i=new Proxy(t,{set:function(e,t,n){return e[t]=n,s.privateState.rootState[t]=n,!0}})),s.stringToFunction(n,!1)(i,e,s.block,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder,Device,s.privateState.update,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder,s.privateState.context)}};for(var g in d.actions)b(g)}var y=(h.component||h.options)&&__assign(__assign({},h.options),h.component.options||h.component.data),_=voidElements.has(c),x=m&&(m.fragment||m.noWrap),S=(null===(o=h.attr)||void 0===o?void 0:o.style)||(\"string\"==typeof h.style?h.style:\"\")||\"\";if(\"string\"==typeof S){\"object\"!=typeof h.style&&(h.style={});for(var B=0,k=S.split(\";\");B<k.length;B++){var C=k[B].split(\":\");if(!C.length)return;g=C[0],v=C[1];g&&(C.length>2&&(v=C.slice(1).join(\":\")),h.style[kebabCaseToCamelCase(g)]=v)}}var w=__assign(__assign(__assign({},omit$1(h,[\"class\",\"component\",\"attr\"])),((n={})[\"string\"!=typeof c||c.includes(\"-\")?\"class\":\"className\"]=\"builder-block \".concat(this.id).concat(d.class?\" \".concat(d.class):\"\").concat(!d.component||[\"Image\",\"Video\",\"Banner\"].indexOf(f)>-1?\"\":\" builder-has-component\")+(h.class?\" \"+h.class:\"\")+(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&(null===(a=this.privateState.state._spacer)||void 0===a?void 0:a.parent)===d.id?\" builder-spacer-parent\":\"\"),n.key=this.id+e,n[\"builder-id\"]=this.id,n)),0!==e&&{\"builder-index\":e});_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&(w[\"builder-inline-styles\"]=h.attr&&h.attr.style?Object.keys(h.style).reduce((function(e,t){return(e?\"\".concat(e,\";\"):\"\")+\"\".concat(cssCase(t),\":\").concat(h.style[t],\";\")}),\"\"):\"\"),(w.properties&&w.properties.href||w.href)&&\"div\"===c&&(c=\"a\"),\"a\"===c&&(c=Link);var R=d.children||w.children||[];return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),null,(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(_emotion_core__WEBPACK_IMPORTED_MODULE_1__.ClassNames,null,(function(e){var t=e.css;if(e.cx,!s.props.emailMode){var n=\" \"+t(s.emotionCss);w.class&&(w.class+=n),w.className&&(w.className+=n)}return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderAsyncRequestsContext.Consumer,null,(function(e){return s._asyncRequests=e&&e.requests,s._errors=e&&e.errors,s._logs=e&&e.logs,_?(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(c,__assign({},w)):u&&(x||s.props.emailMode)?(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(u,__assign({},y,{attributes:w,builderBlock:d,builderState:s.privateState})):(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(c,__assign({},w),u&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(u,__assign({builderState:s.privateState,builderBlock:d},y)),d.text||h.text?h.text:!u&&R&&Array.isArray(R)&&R.length?R.map((function(e,t){return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlock,{key:(s.id||\"\")+t,block:e,index:t,size:s.props.size,fieldName:s.props.fieldName,child:s.props.child,emailMode:s.props.emailMode})})):null)}))})))},Object.defineProperty(BuilderBlock.prototype,\"id\",{get:function(){var e=this.block;return e.id.startsWith(\"builder\")?e.id:\"builder-\"+e.id},enumerable:!1,configurable:!0}),BuilderBlock.prototype.contents=function(e){var t=this,n=this.block;if(this.privateState=e,n.repeat&&n.repeat.collection){var i=n.repeat.collection,r=last((i||\"\").trim().split(\"(\")[0].trim().split(\".\")),o=n.repeat.itemName||(r?r+\"Item\":\"item\"),a=this.stringToFunction(i)(e.state,null,n,api(),Device,null,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder,this.privateState.context);return Array.isArray(a)?a.map((function(n,i){var r,a=__assign(__assign({},e.state),((r={$index:i,$item:n})[o]=n,r[\"$\".concat(o,\"Index\")]=i,r));return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Provider,{key:i,value:__assign(__assign({},e),{state:a})},t.getElement(i,a))})):null}return this.getElement()},BuilderBlock.prototype.render=function(){var e=this;return this.state.hasError?(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"span\",{css:{display:\"inline-block\",padding:5,color:\"#999\",fontSize:11,fontStyle:\"italic\"}},\"Builder block error :( Check console for details\"):(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Consumer,null,(function(t){return e.contents(t)}))},BuilderBlock}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),BuilderBlocks=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickEmptyBlocks=function(){var e;_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isIframe&&t.noBlocks&&(null===(e=window.parent)||void 0===e||e.postMessage({type:\"builder.clickEmptyBlocks\",data:{parentElementId:t.parentId,dataPath:t.path}},\"*\"))},t.onHoverEmptyBlocks=function(){var e;_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&t.noBlocks&&(null===(e=window.parent)||void 0===e||e.postMessage({type:\"builder.hoverEmptyBlocks\",data:{parentElementId:t.parentId,dataPath:t.path}},\"*\"))},t}return __extends(t,e),Object.defineProperty(t.prototype,\"isRoot\",{get:function(){return!this.props.child},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"noBlocks\",{get:function(){var e=this.props.blocks;return!(e&&e.length)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"path\",{get:function(){var e=this.props.dataPath||\"\";return e.trim()&&(e.startsWith(\"this.\")?e=e.replace(\"this.\",\"\"):e.startsWith(\"component.options.\")||(e=\"component.options.\"+e)),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"parentId\",{get:function(){return this.props.parentElementId?this.props.parentElementId:this.props.parent&&this.props.parent.id},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props.blocks,n=this.props.emailMode?\"span\":\"div\";return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(n,__assign({className:\"builder-blocks\"+(this.noBlocks?\" no-blocks\":\"\")+(this.props.child?\" builder-blocks-child\":\"\")+(this.props.className?\" \"+this.props.className:\"\"),\"builder-type\":\"blocks\",\"builder-path\":_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isIframe?this.path:void 0,\"builder-parent-id\":this.parentId,css:__assign(__assign({},!this.props.emailMode&&{display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\"}),this.props.style),onClick:function(){e.noBlocks&&e.onClickEmptyBlocks()}},_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&{onMouseEnter:function(){return e.onHoverEmptyBlocks()}}),t&&Array.isArray(t)&&t.map((function(t,n){return t&&\"@builder.io/sdk:Element\"===t[\"@type\"]?(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlock$1,{key:t.id,block:t,index:n,fieldName:e.props.fieldName,child:e.props.child,emailMode:e.props.emailMode}):t}))||t)},t.renderInto=function(e,n,i){if(void 0===n&&(n={}),e){var r=null;return\"string\"==typeof e?r=document.querySelector(e):e instanceof Element&&(r=e),react_dom__WEBPACK_IMPORTED_MODULE_3___default().render((0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Provider,{value:i},(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(t,__assign({},n))),r)}},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),NoWrap=function(e){return e.children};function getData(e){if(void 0!==(null==e?void 0:e.data)){var t=e.data,n=t.blocks,i=t.blocksString,r=Array.isArray(n)||\"string\"==typeof i,o=__assign(__assign({},e.data),r&&{blocks:n||JSON.parse(i)});return delete o.blocksString,o}}var variantsScript=function(e,t){return\"\\n(function() {\\n  if (window.builderNoTrack || !navigator.cookieEnabled) {\\n    return;\\n  }\\n\\n  var variants = \".concat(e,\";\\n  function removeVariants() {\\n    variants.forEach(function (template) {\\n      document.querySelector('template[data-template-variant-id=\\\"' + template.id + '\\\"]').remove();\\n    });\\n    document.getElementById('variants-script-\").concat(t,'\\').remove();\\n  }\\n\\n  if (typeof document.createElement(\"template\").content === \\'undefined\\') {\\n    removeVariants();\\n    return ;\\n  }\\n\\n  function setCookie(name,value,days) {\\n    var expires = \"\";\\n    if (days) {\\n        var date = new Date();\\n        date.setTime(date.getTime() + (days*24*60*60*1000));\\n        expires = \"; expires=\" + date.toUTCString();\\n    }\\n    document.cookie = name + \"=\" + (value || \"\")  + expires + \"; path=/\" + \"; Secure; SameSite=None\";\\n  }\\n\\n  function getCookie(name) {\\n    var nameEQ = name + \"=\";\\n    var ca = document.cookie.split(\\';\\');\\n    for(var i=0;i < ca.length;i++) {\\n        var c = ca[i];\\n        while (c.charAt(0)==\\' \\') c = c.substring(1,c.length);\\n        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\\n    }\\n    return null;\\n  }\\n  var cookieName = \\'builder.tests.').concat(t,\"';\\n  var variantInCookie = getCookie(cookieName);\\n  var availableIDs = variants.map(function(vr) { return vr.id }).concat('\").concat(t,\"');\\n  var variantId;\\n  if (availableIDs.indexOf(variantInCookie) > -1) {\\n    variantId = variantInCookie;\\n  }\\n  if (!variantId) {\\n    var n = 0;\\n    var random = Math.random();\\n    for (var i = 0; i < variants.length; i++) {\\n      var variant = variants[i];\\n      var testRatio = variant.testRatio;\\n      n += testRatio;\\n      if (random < n) {\\n        setCookie(cookieName, variant.id);\\n        variantId = variant.id;\\n        break;\\n      }\\n    }\\n    if (!variantId) {\\n      variantId = \\\"\").concat(t,'\";\\n      setCookie(cookieName, \"').concat(t,'\");\\n    }\\n  }\\n  if (variantId && variantId !== \"').concat(t,\"\\\") {\\n    var winningTemplate = document.querySelector('template[data-template-variant-id=\\\"' + variantId + '\\\"]');\\n    if (winningTemplate) {\\n      var parentNode = winningTemplate.parentNode;\\n      var newParent = parentNode.cloneNode(false);\\n      newParent.appendChild(winningTemplate.content.firstChild);\\n      parentNode.parentNode.replaceChild(newParent, parentNode);\\n    }\\n  } else if (variants.length > 0) {\\n    removeVariants();\\n  }\\n})()\").replace(/\\s+/g,\" \")},VariantsProvider=function(e){var t=e.initialContent,n=e.children;if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.canTrack)return n([t]);if(!Boolean(Object.keys((null==t?void 0:t.variations)||{}).length))return n([t]);var i=Object.keys(t.variations).map((function(e){return __assign(__assign({id:e},t.variations[e]),{data:getData(t.variations[e])})})),r=__spreadArray(__spreadArray([],i,!0),[t],!1);if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer){var o=JSON.stringify(Object.keys(t.variations||{}).map((function(e){return{id:e,testRatio:t.variations[e].testRatio}})));return react__WEBPACK_IMPORTED_MODULE_2__.createElement(react__WEBPACK_IMPORTED_MODULE_2__.Fragment,null,n(r,(function(){return react__WEBPACK_IMPORTED_MODULE_2__.createElement(\"script\",{id:\"variants-script-\".concat(t.id),dangerouslySetInnerHTML:{__html:variantsScript(o,t.id)}})})))}var a=\"builder.tests.\".concat(t.id),s=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.getCookie(a);if(!s&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser)for(var l=0,u=Math.random(),d=0;d<i.length;d++){var c=i[d];if(u<(l+=c.testRatio)){_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.setCookie(a,c.id),s=c.id;break}}return s||(s=t.id,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.setCookie(a,s)),n([r.find((function(e){return e.id===s}))])},BuilderContent=function(_super){function BuilderContent(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.ref=null,_this.state={loading:!_this.props.content,data:getContentWithInfo(_this.props.content),updates:1},_this.onWindowMessage=function(event){var _a,_b,message=event.data;if(message)switch(message.type){case\"builder.patchUpdates\":if(null===(_a=_this.props.options)||void 0===_a?void 0:_a.noEditorUpdates)return;var data=message.data;if(!data||!data.data)break;var patches=data.data[null===(_b=_this.state.data)||void 0===_b?void 0:_b.id];if(!patches||!patches.length)return;location.href.includes(\"builder.debug=true\")&&eval(\"debugger\");for(var newData=_this.state.data,_i=0,patches_1=patches;_i<patches_1.length;_i++){var patch=patches_1[_i];newData=applyPatchWithMinimalMutationChain(newData,patch,!1)}_this.setState({updates:_this.state.updates+1,data:newData}),_this.props.contentLoaded&&_this.props.contentLoaded(newData.data,newData)}},_this.subscriptions=new _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Subscription,_this.firstLoad=!0,_this.clicked=!1,_this.trackedImpression=!1,_this.intersectionObserver=null,_this.onClick=function(e){var t=e.nativeEvent,n=_this.data;n&&(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.autoTrack&&_this.builder.trackInteraction(n.id,_this.renderedVariantId,_this.clicked,t,{content:n}),_this.clicked||(_this.clicked=!0))},_this}return __extends(BuilderContent,_super),Object.defineProperty(BuilderContent.prototype,\"builder\",{get:function(){return this.props.builder||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,\"name\",{get:function(){var e=this.props;return\"model\"in e?e.model:e.modelName},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,\"renderedVariantId\",{get:function(){var e,t,n=this.props.isStatic?this.builder.getCookie(\"builder.tests.\".concat(null===(e=this.data)||void 0===e?void 0:e.id)):null===(t=this.data)||void 0===t?void 0:t.variationId;if(null!==n)return n},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,\"options\",{get:function(){var e,t,n=__assign({},this.props.options||{});return n.key||!(null===(e=this.props.content)||void 0===e?void 0:e.id)||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isPreviewing||(n.key=this.props.content.id),!this.props.content||(null===(t=n.initialContent)||void 0===t?void 0:t.length)||!this.props.inline&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isPreviewing||(n.initialContent=[this.props.content]),n},enumerable:!1,configurable:!0}),Object.defineProperty(BuilderContent.prototype,\"data\",{get:function(){var e=(this.props.inline||!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser||this.firstLoad)&&this.options.initialContent&&this.options.initialContent[0]||this.state.data;return getContentWithInfo(e)},enumerable:!1,configurable:!0}),BuilderContent.prototype.componentDidMount=function(){var e,t;if(!this.props.inline||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isPreviewing)this.subscribeToContent();else if(this.props.inline&&(null===(t=null===(e=this.options)||void 0===e?void 0:e.initialContent)||void 0===t?void 0:t.length)){var n=this.options.initialContent[0];(null==n?void 0:n.id)&&this.builder.trackImpression(n.id,this.renderedVariantId,void 0,{content:n})}_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&addEventListener(\"message\",this.onWindowMessage)},BuilderContent.prototype.subscribeToContent=function(){var e=this;\"_inline\"!==this.name&&this.subscriptions.add(this.builder.queueGetContent(this.name,this.options).subscribe((function(t){var n=t&&t[0];e.setState({data:n,loading:!1});var i=(e.builder.editingModel||e.builder.previewingModel)===e.name;if(!e.props.inline&&e.props.content&&e.firstLoad&&i&&(e.firstLoad=!1,e.subscriptions.unsubscribe(),e.subscribeToContent()),n&&e.firstLoad&&(e.firstLoad=!1,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.autoTrack&&!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing)){var r=!1;if(\"function\"==typeof IntersectionObserver&&e.ref)try{(e.intersectionObserver=new IntersectionObserver((function(t,i){t.forEach((function(t){t.intersectionRatio>0&&!e.trackedImpression&&(e.builder.trackImpression(n.id,e.renderedVariantId,void 0,{content:e.data}),e.data,e.trackedImpression=!0,e.ref&&i.unobserve(e.ref))}))}))).observe(e.ref),r=!0}catch(e){console.warn(\"Could not bind intersection observer\")}r||(e.trackedImpression=!0,e.builder.trackImpression(n.id,e.renderedVariantId,void 0,{content:n}))}e.props.contentLoaded&&e.props.contentLoaded(n&&n.data,n)}),(function(t){e.props.contentError&&(e.props.contentError(t),e.setState({loading:!1}))})))},BuilderContent.prototype.componentWillUnmount=function(){_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&removeEventListener(\"message\",this.onWindowMessage),this.subscriptions.unsubscribe(),this.intersectionObserver&&this.ref&&this.intersectionObserver.unobserve(this.ref)},BuilderContent.prototype.render=function(){var e=this;if(this.props.dataOnly)return null;var t=this.state.loading,n=this.data,i=this.props.dataOnly?NoWrap:\"div\";return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(VariantsProvider,{initialContent:n},(function(r,o){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),null,r.map((function(a,s){var l=s===r.length-1?(react__WEBPACK_IMPORTED_MODULE_2___default().Fragment):\"template\";return react__WEBPACK_IMPORTED_MODULE_2___default().createElement((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),{key:String((null==a?void 0:a.id)+s)},\"template\"!==l&&(null==o?void 0:o()),react__WEBPACK_IMPORTED_MODULE_2___default().createElement(l,__assign({key:String((null==a?void 0:a.id)+s)},\"template\"===l&&{\"data-template-variant-id\":null==a?void 0:a.id}),react__WEBPACK_IMPORTED_MODULE_2___default().createElement(i,__assign({},0===s&&!e.props.dataOnly&&{ref:function(t){return e.ref=t}},{className:\"builder-content\",onClick:e.onClick,\"builder-content-id\":null==a?void 0:a.id,\"builder-model\":e.name}),e.props.children(null==a?void 0:a.data,!e.props.inline&&t,n))))})))}))},BuilderContent}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),getContentWithInfo=function(e){var t;if(e){var n=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.getCookie(\"builder.tests.\".concat(e.id)),i=n===e.id?e:null===(t=e.variations)||void 0===t?void 0:t[n],r=(null==i?void 0:i.name)||((null==i?void 0:i.id)===e.id?\"Default variation\":\"\");return __assign(__assign({},e),{variationId:n,testVariationId:n,testVariationName:r})}return null};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,\"default\")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var onChange_1=createCommonjsModule((function(e,t){Object.defineProperty(t,\"__esModule\",{value:!0});var n=Symbol(\"target\"),i=Symbol(\"unsubscribe\"),r=function(e,t){return t&&t.toString&&(e&&(e+=\".\"),e+=t.toString()),e},o=function(e){return Array.isArray(e)?e.slice():Object.assign({},e)},a=function(e,t,a){if(\"undefined\"==typeof Proxy)return e;void 0===a&&(a={});var s,l,u=Symbol(\"ProxyTarget\"),d=!1,c=!1,p=!1,f=a.equals||Object.is,m=new WeakMap,h=new WeakMap,g=new WeakMap,v=function(e,n,i,a){if(!p)if(d){if(d&&l&&void 0!==i&&void 0!==a&&\"length\"!==n){var u=l;e!==s&&function(e,t){for(var n;e;)-1===(n=e.indexOf(\".\"))&&(n=e.length),t(e.slice(0,n)),e=e.slice(n+1)}(e=e.replace(s,\"\").slice(1),(function(e){u[e]=o(u[e]),u=u[e]})),u[n]=i}c=!0}else t(r(e,n),a,i)},b=function(e,t){var n=m?m.get(e):void 0;n&&n.delete(t)},y=function(e,t){if(p)return e;h.set(e,t);var n=g.get(e);return void 0===n&&(n=new Proxy(e,x),g.set(e,n)),n},_=function(e){return p||!0===a.ignoreSymbols&&\"symbol\"==typeof e},x={get:function(e,t,o){if(t===u||t===n)return e;if(t===i&&\"\"===h.get(e))return function(e){return p=!0,m=null,h=null,g=null,e}(e);var s=Reflect.get(e,t,o);if(function(e){return null===e||\"object\"!=typeof e&&\"function\"!=typeof e}(s)||function(e){return e instanceof RegExp||e instanceof Number}(s)||\"constructor\"===t||!0===a.isShallow)return s;var l=function(e,t){var n=m?m.get(e):void 0;if(n)return n;n=new Map,m.set(e,n);var i=n.get(t);return i||(i=Reflect.getOwnPropertyDescriptor(e,t),n.set(t,i)),i}(e,t);if(l&&!l.configurable){if(l.set&&!l.get)return;if(!1===l.writable)return s}return y(s,r(h.get(e),t))},set:function(e,t,n,i){n&&void 0!==n[u]&&(n=n[u]);var r=_(t),o=r?null:Reflect.get(e,t,i),a=Reflect.set(e[u]||e,t,n);return r||f(o,n)||v(h.get(e),t,o,n),a},defineProperty:function(e,t,n){var i=Reflect.defineProperty(e,t,n);return _(t)||(b(e,t),v(h.get(e),t,void 0,n.value)),i},deleteProperty:function(e,t){if(!Reflect.has(e,t))return!0;var n=_(t),i=n?null:Reflect.get(e,t),r=Reflect.deleteProperty(e,t);return n||(b(e,t),v(h.get(e),t,i)),r},apply:function(e,t,n){var i=t instanceof Date;if(i&&(t=t[u]),!d){d=!0,i&&(l=t.valueOf()),(Array.isArray(t)||\"[object Object]\"===toString.call(t))&&(l=o(t[u])),s=(s=h.get(e)).slice(0,Math.max(s.lastIndexOf(\".\"),0));var r=Reflect.apply(e,t,n);return d=!1,(c||i&&!f(l,t.valueOf()))&&(v(s,\"\",l,t[u]||t),l=null,c=!1),r}return Reflect.apply(e,t,n)}},S=y(e,\"\");return t=t.bind(S),S};a.target=function(e){return e[n]||e},a.unsubscribe=function(e){return e[i]||e},e.exports=a,t.default=a})),onChange=unwrapExports(onChange_1),nextTick=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.nextTick;function debounceNextTick(e,t,n){return void 0===t&&\"function\"==typeof e?debounceNextTickImpl(e):{configurable:!0,enumerable:n.enumerable,get:function(){return Object.defineProperty(this,t,{configurable:!0,enumerable:n.enumerable,value:debounceNextTickImpl(n.value)}),this[t]}}}function debounceNextTickImpl(e){var t=null,n=null;return function(){var e=t;if(t=[].slice.call(arguments),n=this,null!==e)return;nextTick(i)};function i(){e.apply(n,t),t=null,n=null}}function throttle(e,t,n){var i,r,o;void 0===n&&(n={});var a=null,s=0,l=function(){s=!1===n.leading?0:Date.now(),a=null,o=e.apply(i,r),a||(i=r=null)};return function(){var u=Date.now();s||!1!==n.leading||(s=u);var d=t-(u-s);return i=this,r=arguments,d<=0||d>t?(a&&(clearTimeout(a),a=null),s=u,o=e.apply(i,r),a||(i=r=null)):a||!1===n.trailing||(a=setTimeout(l,d)),o}}var BuilderMetaContext=react__WEBPACK_IMPORTED_MODULE_2___default().createContext({emailMode:!1,ampMode:!1,isServer:!1}),tryEval=function(e,t,n){void 0===t&&(t={});var i=e;if(\"string\"==typeof i&&i.trim()){var r=!(i.includes(\";\")||i.includes(\" return \")),o=function(){};try{_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&(o=new Function(\"state\",\"var rootState = state;\\n        if (typeof Proxy !== 'undefined') {\\n          rootState = new Proxy(rootState, {\\n            set: function () {\\n              return false;\\n            },\\n            get: function (target, key) {\\n              if (key === 'state') {\\n                return state;\\n              }\\n              return target[key]\\n            }\\n          });\\n        }\\n        with (rootState) {\\n          \".concat(r?\"return (\".concat(e,\");\"):e,\";\\n        }\")))}catch(e){_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&console.warn(\"Could not compile javascript\",e)}try{if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser||shouldForceBrowserRuntimeInNode())return o(t||{});var a=safeDynamicRequire(\"isolated-vm\"),s=getIsolateContext(),l=makeFn(e,r,[\"state\"]),u=s.evalClosureSync(l,[new a.Reference(t||{})]);try{return JSON.parse(u)}catch(e){return u}}catch(t){n&&n.push(t),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser?console.warn(\"Builder custom code error:\",t.message,\"in\",e,t.stack):isDebug()&&console.debug(\"Builder custom code error:\",t.message,\"in\",e,t.stack)}}};function toError(e){return e instanceof Error?e:new Error(String(e))}function getBuilderPixel(e){return{id:\"builder-pixel-\"+Math.random().toString(36).split(\".\")[1],\"@type\":\"@builder.io/sdk:Element\",tagName:\"img\",properties:{role:\"presentation\",\"aria-hidden\":\"true\",src:\"https://cdn.builder.io/api/v1/pixel?apiKey=\".concat(e)},responsiveStyles:{large:{height:\"0\",width:\"0\",display:\"inline-block\",opacity:\"0\",overflow:\"hidden\",pointerEvents:\"none\"}}}}function pick(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i={};return t.forEach((function(t){i[t]=e[t]})),i}function omit(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=__assign({},e);return t.forEach((function(e){delete i[e]})),i}var instancesMap=new Map,wrapComponent=function(e){return function(t){var n,i=t.builderTag||\"div\",r=[\"children\"].concat((null===(n=e.inputs)||void 0===n?void 0:n.map((function(e){return e.name})))||[]),o=omit.apply(void 0,__spreadArray(__spreadArray([t],r,!1),[\"attributes\"],!1)),a=t;return e.noWrap?react__WEBPACK_IMPORTED_MODULE_2___default().createElement(e.class,__assign({attributes:o},a)):react__WEBPACK_IMPORTED_MODULE_2___default().createElement(i,__assign({},o),react__WEBPACK_IMPORTED_MODULE_2___default().createElement(e.class,__assign({},a)))}},size$1=function(e){return Object.keys(e).length};function debounce(e,t,n){var i;return void 0===n&&(n=!1),function(){var r=this,o=arguments;clearTimeout(i),i=setTimeout((function(){i=null,n||e.apply(r,o)}),t),n&&!i&&e.apply(r,o)}}var fontsLoaded=new Set,fetch$1;globalThis.fetch&&(fetch$1=globalThis.fetch),null!=fetch$1||(fetch$1=__webpack_require__(/*! node-fetch */ \"(ssr)/./node_modules/node-fetch/lib/index.mjs\"));var sizeMap={desktop:\"large\",tablet:\"medium\",mobile:\"small\"},fetchCache={};function searchToObject$1(e){var t=(e.search||\"\").substring(1).split(\"&\"),n={};for(var i in t)if(t[i]&&\"string\"==typeof t[i]){var r=t[i].split(\"=\");n[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return n}var BuilderComponent=function(e){function t(t){var n,i,r=this;(r=e.call(this,t)||this).subscriptions=new _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Subscription,r.onStateChange=new _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.BehaviorSubject(null),r.asServer=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer,r.contentRef=null,r.styleRef=null,r.rootState=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer?{}:onChange({},(function(){return r.updateState()})),r.lastJsCode=\"\",r.lastHttpRequests={},r.httpSubscriptionPerKey={},r.firstLoad=!0,r.ref=null,r.messageListener=function(e){var t,n=e.data;switch(n.type){case\"builder.configureSdk\":var i=n.data;if(!i.contentId||i.contentId!==(null===(t=r.useContent)||void 0===t?void 0:t.id))return;r.sizes=getSizesForBreakpoints(i.breakpoints||{}),r.setState({state:Object.assign(r.rootState,{deviceSize:r.deviceSizeState,device:r.device}),updates:(r.state&&r.state.updates||0)+1,breakpoints:i.breakpoints});break;case\"builder.updateSpacer\":var o=n.data;r.rootState._spacer,r.updateState((function(e){e._spacer=o}));break;case\"builder.resetState\":var a=n.data,s=a.state;if(a.model===r.name){for(var l in r.rootState)\"function\"!=typeof r.rootState[l]&&delete r.rootState[l];Object.assign(r.rootState,s),r.setState(__assign(__assign({},r.state),{state:r.rootState,updates:(r.state&&r.state.updates||0)+1}))}break;case\"builder.resetSymbolState\":var u=n.data.state,d=(s=u.state,u.model,u.id);if(r.props.builderBlock&&r.props.builderBlock===d){for(var l in r.rootState)delete r.rootState[l];Object.assign(r.rootState,s),r.setState(__assign(__assign({},r.state),{state:r.rootState,updates:(r.state&&r.state.updates||0)+1}))}}},r.resizeFn=function(){var e=r.deviceSizeState;e!==r.state.state.deviceSize&&r.setState(__assign(__assign({},r.state),{updates:(r.state&&r.state.updates||0)+1,state:Object.assign(r.rootState,__assign(__assign({},r.state.state),{deviceSize:e}))}))},r.resizeListener=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing?throttle(r.resizeFn,200):debounce(r.resizeFn,400),r.mounted=!1,r.updateState=function(e){var t=r.rootState;e&&e(t),r.mounted?r.setState({update:r.updateState,state:t,updates:(r.state&&r.state.updates||0)+1}):r.state=__assign(__assign({},r.state),{update:r.updateState,state:t,updates:(r.state&&r.state.updates||0)+1}),r.notifyStateChange()},r.onContentLoaded=function(e,t){if(\"page\"===r.name&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&e){var n=e.title,i=e.pageTitle,o=e.description,a=e.pageDescription;if((n||i)&&(document.title=n||i),o||a){var s=document.querySelector('meta[name=\"description\"]');s||((s=document.createElement(\"meta\")).setAttribute(\"name\",\"description\"),document.head.appendChild(s)),s.setAttribute(\"content\",o||a)}}if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&r.notifyStateChange(),r.props.contentLoaded&&r.props.contentLoaded(e,t),e&&e.inputs&&Array.isArray(e.inputs)&&e.inputs.length&&(e.state||(e.state={}),e.inputs.forEach((function(t){t&&t.name&&void 0!==t.defaultValue&&void 0===e.state[t.name]&&(e.state[t.name]=t.defaultValue)}))),e&&e.state){var l=__assign(__assign({},r.state),{updates:(r.state&&r.state.updates||0)+1,state:Object.assign(r.rootState,__assign(__assign(__assign(__assign(__assign({},r.state.state),{location:r.locationState,device:r.device}),e.state),r.externalState),{deviceSize:r.deviceSizeState}))});r.mounted?r.setState(l):r.state=l}if(e&&e.jsCode&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&!r.options.codegen){var u=!1;if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&(r.lastJsCode===e.jsCode?u=!0:r.lastJsCode=e.jsCode),!u){var d=r.state.state;try{new Function(\"data\",\"ref\",\"state\",\"update\",\"element\",\"Builder\",\"builder\",\"context\",e.jsCode)(e,r,d,r.state.update,r.ref,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder,r.state.context)}catch(t){var c=toError(t);_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser?console.warn(\"Builder custom code error:\",c.message,\"in\",e.jsCode,c.stack):isDebug()&&console.debug(\"Builder custom code error:\",c.message,\"in\",e.jsCode,c.stack)}}}if(e&&e.httpRequests&&!r.props.noAsync&&!(u=!1)){var p=function(t){var n=e.httpRequests[t];if(n&&(!r.data[t]||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing))if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser){var i=r.evalExpression(n);if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&r.lastHttpRequests[t]===i)return\"continue\";r.lastHttpRequests[t]=i;var o=n.match(/builder\\.io\\/api\\/v2\\/([^\\/\\?]+)/i);o&&o[1],r.handleRequest(t,i);var a=r.httpSubscriptionPerKey[t];a&&a.unsubscribe();var s=r.httpSubscriptionPerKey[t]=r.onStateChange.subscribe((function(){var e=r.evalExpression(n);e!==i&&(r.handleRequest(t,e),r.lastHttpRequests[t]=e)}));r.subscriptions.add(s)}else r.handleRequest(t,r.evalExpression(n))};for(var f in e.httpRequests)p(f)}};var o=r.inlinedContent;o&&o.content&&(o=o.content),r.sizes=getSizesForBreakpoints((null===(n=null==o?void 0:o.meta)||void 0===n?void 0:n.breakpoints)||{});var a=null===(i=r.inlinedContent)||void 0===i?void 0:i.data;if(a&&Array.isArray(a.inputs)&&a.inputs.length>0&&(a.state||(a.state={}),a.inputs.forEach((function(e){e&&e.name&&void 0!==e.defaultValue&&void 0===a.state[e.name]&&(a.state[e.name]=e.defaultValue)}))),r.state={context:__assign(__assign({},t.context),{apiKey:r.props.apiKey||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.apiKey}),state:Object.assign(r.rootState,__assign(__assign(__assign(__assign({},r.inlinedContent&&r.inlinedContent.data&&r.inlinedContent.data.state),{isBrowser:_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser,isServer:!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser,_hydrate:t.hydrate,location:r.locationState,deviceSize:r.deviceSizeState,device:r.device}),r.getHtmlData()),t.data)),updates:0,key:0,update:r.updateState},_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser){var s=r.props.apiKey;if(s&&s!==r.builder.apiKey&&!instancesMap.has(s)){var l=new _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder(s,void 0,void 0,!0);instancesMap.set(s,l)}if(r.inlinedContent){var u=r.inlinedContent.content||r.inlinedContent;r.onContentLoaded(null==u?void 0:u.data,getContentWithInfo(u))}}return r.registerCustomComponents(),r}return __extends(t,e),Object.defineProperty(t.prototype,\"options\",{get:function(){return __assign(__assign({},t.defaults),this.props)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"name\",{get:function(){return this.props.model||this.props.modelName||this.props.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"element\",{get:function(){return this.ref},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"inlinedContent\",{get:function(){if(!this.isPreviewing||this.props.inlineContent)return this.props.content},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"builder\",{get:function(){return this.props.apiKey&&instancesMap.get(this.props.apiKey)||this.props.builder||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder},enumerable:!1,configurable:!0}),t.prototype.getHtmlData=function(){var e=this.inlinedContent&&this.inlinedContent.id||this.props.entry,t=e&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&document.querySelector('script[data-builder-json=\"'.concat(e,'\"],script[data-builder-state=\"').concat(e,'\"]'));if(t)try{return JSON.parse(t.innerText)}catch(e){console.warn(\"Could not parse Builder.io HTML data transfer\",e,t.innerText)}return{}},Object.defineProperty(t.prototype,\"device\",{get:function(){return this.builder.getUserAttributes().device||\"desktop\"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"locationState\",{get:function(){return __assign(__assign({},pick(this.location,\"pathname\",\"hostname\",\"search\",\"host\")),{path:this.location.pathname&&this.location.pathname.split(\"/\").slice(1)||\"\",query:searchToObject$1(this.location)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"deviceSizeState\",{get:function(){return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser?this.sizes.getSizeForWidth(window.innerWidth):sizeMap[this.device]||\"large\"},enumerable:!1,configurable:!0}),t.renderInto=function(e,n,i,r){if(void 0===n&&(n={}),void 0===i&&(i=!0),void 0===r&&(r=!1),console.debug(\"BuilderPage.renderInto\",e,n,i,this),e){var o=null;if(\"string\"==typeof e?o=document.querySelector(e):e instanceof Element&&(o=e),o){var a=o.classList.contains(\"builder-hydrated\");if(!a||r){o.classList.add(\"builder-hydrated\");var s=i&&o.innerHTML.includes(\"builder-block\");if(!o.classList.contains(\"builder-component\")){var l=o.querySelector(\".builder-api-styles\")||(o.previousElementSibling&&o.previousElementSibling.matches(\".builder-api-styles\")?o.previousElementSibling:null),u=\"\";if(l)l.innerHTML.replace(/\\/\\*start:([^\\*]+?)\\*\\/([\\s\\S]*?)\\/\\*end:([^\\*]+?)\\*\\//g,(function(e,t,n){var i=null;try{i=document.querySelector('[data-emotion-css=\"'.concat(t,'\"]'))}catch(e){console.warn(e)}return i?i.innerHTML=n:_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||(u+=e),e})),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.nextTick((function(){l.innerHTML=u}));var d=o.querySelector(\".builder-component\");d?o=d:s=!1}location.search.includes(\"builder.debug=true\")&&console.debug(\"hydrate\",s,o);var c=o;if(!a){var p=document.createElement(\"div\");o.insertAdjacentElement(\"beforebegin\",p),p.appendChild(o),c=p}if((_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&location.search.includes(\"builder.preview=\"))&&(s=!1),s&&o){var f=react_dom__WEBPACK_IMPORTED_MODULE_3___default().render(react__WEBPACK_IMPORTED_MODULE_2___default().createElement(t,__assign({},n)),c,c.builderRootRef);return c.builderRootRef=f,f}var m=react_dom__WEBPACK_IMPORTED_MODULE_3___default().render(react__WEBPACK_IMPORTED_MODULE_2___default().createElement(t,__assign({},n)),c,c.builderRootRef);return c.builderRootRef=m,m}console.debug(\"Tried to hydrate multiple times\")}}},t.prototype.registerCustomComponents=function(){if(this.props.customComponents)for(var e=0,t=this.props.customComponents;e<t.length;e++){var n=t[e];if(n){var i=n.component,r=__rest(n,[\"component\"]);_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.registerComponent(i,r)}}},t.prototype.componentDidMount=function(){var e,t=this;this.mounted=!0,this.asServer&&(this.asServer=!1,this.updateState((function(e){e.isBrowser=!0,e.isServer=!1}))),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isIframe&&(null===(e=window.parent)||void 0===e||e.postMessage({type:\"builder.sdkInjected\",data:{modelName:this.name}},\"*\")),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&(window.addEventListener(\"resize\",this.resizeListener),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&window.addEventListener(\"message\",this.messageListener),(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isPreviewing)&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.nextTick((function(){t.firstLoad=!1,t.reload()})),setTimeout((function(){window.dispatchEvent(new CustomEvent(\"builder:component:load\",{detail:{ref:t}}))})))},Object.defineProperty(t.prototype,\"isPreviewing\",{get:function(){return(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isPreviewing&&!this.firstLoad)&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.previewingModel===this.name},enumerable:!1,configurable:!0}),t.prototype.notifyStateChange=function(){if(!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer&&this&&this.state){var e=this.state.state;this.props.onStateChange&&this.props.onStateChange(e),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&window.dispatchEvent(new CustomEvent(\"builder:component:stateChange\",{detail:{state:e,ref:this}})),this.onStateChange.next(e)}},t.prototype.processStateFromApi=function(e){return e},Object.defineProperty(t.prototype,\"location\",{get:function(){return this.props.location||(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser?location:{})},enumerable:!1,configurable:!0}),t.prototype.getCssFromFont=function(e,t){var n=e.family+(e.kind&&!e.kind.includes(\"#\")?\", \"+e.kind:\"\"),i=n.split(\",\")[0],r=e.fileUrl?e.fileUrl:e.files&&e.files.regular,o=\"\";if(r&&n&&i&&(o+='\\n@font-face {\\n  font-family: \"'.concat(n,'\";\\n  src: local(\"').concat(i,\"\\\"), url('\").concat(r,\"') format('woff2');\\n  font-display: fallback;\\n  font-weight: 400;\\n}\\n        \").trim()),e.files)for(var a in e.files){if(String(Number(a))===a){var s=e.files[a];s&&s!==r&&(o+='\\n@font-face {\\n  font-family: \"'.concat(n,\"\\\";\\n  src: url('\").concat(s,\"') format('woff2');\\n  font-display: fallback;\\n  font-weight: \").concat(a,\";\\n}\\n          \").trim())}}return o},t.prototype.componentWillUnmount=function(){this.unsubscribe(),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&(window.removeEventListener(\"resize\",this.resizeListener),window.removeEventListener(\"message\",this.messageListener))},t.prototype.getFontCss=function(e){var t=this;return this.builder.allowCustomFonts&&(null==e?void 0:e.customFonts)&&e.customFonts.length&&e.customFonts.map((function(n){return t.getCssFromFont(n,e)})).join(\" \")||\"\"},t.prototype.ensureFontsLoaded=function(e){if(this.builder.allowCustomFonts&&(null==e?void 0:e.customFonts)&&Array.isArray(e.customFonts))for(var t=0,n=e.customFonts;t<n.length;t++){var i=n[t],r=i.fileUrl?i.fileUrl:i.files&&i.files.regular;if(!fontsLoaded.has(r)){var o=this.getCssFromFont(i,e);if(fontsLoaded.add(r),!o)continue;var a=document.createElement(\"style\");a.className=\"builder-custom-font\",a.setAttribute(\"data-builder-custom-font\",r),a.innerHTML=o,document.head.appendChild(a)}}},t.prototype.getCss=function(e){var t,n=null===(t=this.useContent)||void 0===t?void 0:t.id,i=(null==e?void 0:e.cssCode)||\"\";return n&&(i=i.replace(/&/g,\".builder-component-\".concat(n))),i+this.getFontCss(e)},Object.defineProperty(t.prototype,\"data\",{get:function(){var e,t=__assign(__assign(__assign({},this.inlinedContent&&(null===(e=this.inlinedContent.data)||void 0===e?void 0:e.state)),this.externalState),this.state.state);return Object.assign(this.rootState,t),t},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e){var t=this;this.props.data&&e.data!==this.props.data&&this.state.update((function(e){Object.assign(e,t.externalState)})),this.props.customComponents&&this.props.customComponents!==e.customComponents&&this.registerCustomComponents(),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&this.inlinedContent&&e.content!==this.inlinedContent&&this.onContentLoaded(this.inlinedContent.data,this.inlinedContent)},t.prototype.checkStyles=function(e){if(this.styleRef){var t=this.getCss(e);this.styleRef.innerHTML!==t&&(this.styleRef.innerHTML=t)}},t.prototype.reload=function(){this.setState({key:this.state.key+1})},Object.defineProperty(t.prototype,\"content\",{get:function(){var e=this.inlinedContent;return e&&e.content&&(e=__assign(__assign({},e),{data:e.content})),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"externalState\",{get:function(){return __assign(__assign({},this.props.data),this.props.locale?{locale:this.props.locale}:{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"useContent\",{get:function(){return this.content||this.state.context.builderContent},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t=this,n=this.content,i=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&this.externalState&&size$1(this.externalState)&&hash_sum__WEBPACK_IMPORTED_MODULE_4___default()(this.externalState),r=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing?this.name:this.props.entry;r&&!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&i&&i.length<300&&(r+=\":\"+i);var o=this.props.dataOnly?(react__WEBPACK_IMPORTED_MODULE_2___default().Fragment):\"div\",a=null===(e=this.useContent)||void 0===e?void 0:e.id;return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(o,{onClick:function(e){!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||t.props.isChild||t.props.stopClickPropagationWhenEditing||e.stopPropagation()},className:\"builder-component \".concat(a?\"builder-component-\".concat(a):\"\"),\"data-name\":this.name,\"data-source\":\"Rendered by Builder.io\",key:this.state.key,ref:function(e){return t.ref=e}},react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderMetaContext.Consumer,null,(function(e){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderMetaContext.Provider,{value:\"boolean\"==typeof t.props.ampMode?__assign(__assign({},e),{ampMode:t.props.ampMode}):e},react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderAsyncRequestsContext.Consumer,null,(function(e){var i;return t._asyncRequests=e&&e.requests,t._errors=e&&e.errors,t._logs=e&&e.logs,react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderContent,{isStatic:t.props.isStatic||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isStatic,key:(null===(i=t.inlinedContent)||void 0===i?void 0:i.id)||(\"content\"in t.props&&!t.isPreviewing?\"null-content-prop\":\"no-content-prop\"),builder:t.builder,ref:function(e){return t.contentRef=e},contentLoaded:function(e,n){return t.onContentLoaded(e,n)},options:__assign(__assign(__assign(__assign(__assign(__assign({key:r,entry:t.props.entry},n&&{initialContent:[n]}),!n&&\"content\"in t.props&&!t.isPreviewing&&{initialContent:[]}),t.props.url&&{url:t.props.url}),t.props.options),t.props.locale?{locale:t.props.locale}:{}),t.options.codegen&&{format:\"react\"}),inline:t.props.inlineContent||!t.isPreviewing&&\"content\"in t.props,contentError:t.props.contentError,modelName:t.name||\"page\"},(function(e,n,i){var r;if(t.props.dataOnly)return null;i&&i.id&&(t.state.breakpoints&&(i.meta=i.meta||{},i.meta.breakpoints=t.state.breakpoints),t.state.context.builderContent=i),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.nextTick((function(){t.checkStyles(e)}));var o=t.options.codegen;if(o&&!t.Component&&(null==e?void 0:e.blocksJs)){var a=Array.from(new Set(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.components.map((function(e){return e.name})))),s=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.components.slice().reverse(),l=a.map((function(e){return s.find((function(t){return t.class&&t.name===e}))})),u=a.map((function(e){return(e||\"\").replace(/[^\\w]+/gi,\"\")})),d=l.map((function(e){return wrapComponent(e)}));t.Component=(new(Function.bind.apply(Function,__spreadArray(__spreadArray([void 0,\"jsx\",\"_css\",\"Builder\",\"builder\",\"React\",\"useBuilderState\"],u,!1),[e.blocksJs],!1)))).apply(void 0,__spreadArray([_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.css,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder,_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder,(react__WEBPACK_IMPORTED_MODULE_2___default()),function(e){var t=react__WEBPACK_IMPORTED_MODULE_2___default().useState(0)[1];return react__WEBPACK_IMPORTED_MODULE_2___default().useState((function(){return onChange(e,(function(){t((function(e){return e+1}))}))}))[0]}],d,!1))}var c=(null==e?void 0:e.blocks)||[],p=c.find((function(e){var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith(\"builder-pixel\")}));return e&&!p&&c.length>0&&c.push(getBuilderPixel(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.apiKey)),e?react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"div\",__assign({\"data-builder-component\":t.name,\"data-builder-content-id\":i.id},t.isPreviewing?{\"data-builder-variation-id\":i.testVariationId||i.variationId||i.id}:{}),!o&&t.getCss(e)&&react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"style\",{ref:function(e){return t.styleRef=e},className:\"builder-custom-styles\",dangerouslySetInnerHTML:{__html:t.getCss(e)}}),react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderStoreContext.Provider,{value:__assign(__assign({},t.state),{rootState:t.rootState,state:t.data,content:i,renderLink:t.props.renderLink})},o&&t.Component?react__WEBPACK_IMPORTED_MODULE_2___default().createElement(t.Component,{data:t.data,context:t.state.context}):react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderBlocks,{key:String(!!(null===(r=null==e?void 0:e.blocks)||void 0===r?void 0:r.length)),emailMode:t.props.emailMode,fieldName:\"blocks\",blocks:c}))):n?react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"div\",{\"data-builder-component\":t.name,className:\"builder-loading\"},t.props.children):react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"div\",{\"data-builder-component\":t.name,className:\"builder-no-content\"})}))})))})))},t.prototype.evalExpression=function(e){var t=this,n=this.data;return String(e).replace(/{{([^}]+)}}/g,(function(e,i){return tryEval(i,n,t._errors)}))},t.prototype.handleRequest=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,i,r,o,a=this;return __generator(this,(function(s){return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isIframe&&fetchCache[t]?(this.updateState((function(n){n[e]=fetchCache[t]})),[2,fetchCache[t]]):(n=function(){return __awaiter(a,void 0,void 0,(function(){var n,i,r,o;return __generator(this,(function(a){switch(a.label){case 0:n=Date.now(),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser||console.time(\"Fetch \"+t),a.label=1;case 1:return a.trys.push([1,4,5,6]),[4,fetch$1(t)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[3,6];case 4:return r=a.sent(),o=toError(r),this._errors&&this._errors.push(o),this._logs&&this._logs.push(\"Fetch to \".concat(t,\" errored in \").concat(Date.now()-n,\"ms\")),[2];case 5:return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser||(console.timeEnd(\"Fetch \"+t),this._logs&&this._logs.push(\"Fetched \".concat(t,\" in \").concat(Date.now()-n,\"ms\"))),[7];case 6:return i&&(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isIframe&&(fetchCache[t]=i),this.updateState((function(t){t[e]=i}))),[2,i]}}))}))},(i=this._asyncRequests&&this._asyncRequests.find((function(e){return isRequestInfo(e)&&e.url===t})))?((r=i.promise).then((function(t){t&&a.updateState((function(n){n[e]=t}))})),[2,r]):(o=n(),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.nextTick((function(){a._asyncRequests&&a._asyncRequests.push(o)})),[2,o]))}))}))},t.prototype.unsubscribe=function(){this.subscriptions&&(this.subscriptions.unsubscribe(),this.subscriptions=new _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Subscription)},t.prototype.handleBuilderRequest=function(e,t){var n=this,i=tryEval(t,this.data,this._errors);this.subscriptions&&this.unsubscribe(),i&&this.subscriptions.add(this.builder.queueGetContent(i.model,i).subscribe((function(t){t&&n.updateState((function(n){n[e]=t}))})))},t.defaults={codegen:Boolean(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&location.href.includes(\"builder.codegen=true\"))},__decorate([debounceNextTick,__metadata(\"design:type\",Function),__metadata(\"design:paramtypes\",[]),__metadata(\"design:returntype\",void 0)],t.prototype,\"notifyStateChange\",null),t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component));function BuilderBlock(e){return e.type=\"react\",_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.Component(e)}function updateMetadata(e,t){var n=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.components.find((function(t){return\"string\"==typeof e?t.name===e:t.class===t}))||null,i=t(n);n&&i?_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.registerComponent(i.class||n.class,i):n&&!i||!n&&i&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.registerComponent(i.class,i)}function withBuilder(e,t){return BuilderBlock(t)(e),e}var isBuilderElement=function(e){return Boolean(\"object\"==typeof e&&e&&\"@builder.io/sdk:Element\"===(null==e?void 0:e[\"@type\"]))},withChildren=function(e){var t=react__WEBPACK_IMPORTED_MODULE_2___default().forwardRef((function(t,n){var i,r,o=__assign({},t),a=t.children||t.builderBlock&&t.builderBlock.children&&t.builderBlock.children.map((function(e){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderBlock$1,{key:e.id,block:e})})),s=null===(r=null===(i=t.builderBlock)||void 0===i?void 0:i.component)||void 0===r?void 0:r.options;return s&&Object.keys(s).forEach((function(e){var t=s[e];Array.isArray(t)&&t.every(isBuilderElement)?o[e]=t.map((function(e){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderBlock$1,{key:e.id,block:e})})):isBuilderElement(t)&&(o[e]=react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderBlock$1,{block:t}))})),react__WEBPACK_IMPORTED_MODULE_2___default().createElement(e,__assign({},o,{ref:n}),a)}));return t.builderOptions={canHaveChildren:!0},t},noWrap=function(e){var t=react__WEBPACK_IMPORTED_MODULE_2___default().forwardRef((function(t,n){var i=__assign(__assign({},t),t.attributes);return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(e,__assign({},i,{ref:n}))}));return t.builderOptions={noWrap:!0},t},iconUrl=\"https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-text_fields-24px%20(1).svg?alt=media&token=12177b73-0ee3-42ca-98c6-0dd003de1929\",TextComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textRef=null,t}return __extends(t,e),t.prototype.componentDidMount=function(){this.textRef&&!/{{([^}]+)}}/.test(this.props.text)&&(this.textRef.innerHTML=this.props.text)},t.prototype.evalExpression=function(e,t){return this.allowTextEdit?String(e):String(e).replace(/{{([^}]+)}}/g,(function(e,n){return tryEval(n,t)}))},Object.defineProperty(t.prototype,\"allowTextEdit\",{get:function(){return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&location.search.includes(\"builder.allowTextEdit=true\")&&!(this.props.builderBlock&&this.props.builderBlock.bindings&&(this.props.builderBlock.bindings[\"component.options.text\"]||this.props.builderBlock.bindings[\"options.text\"]||this.props.builderBlock.bindings.text))},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t={outline:\"none\",\"& p:first-of-type, & .builder-paragraph:first-of-type\":{margin:0},\"& > p, & .builder-paragraph\":{color:\"inherit\",lineHeight:\"inherit\",letterSpacing:\"inherit\",fontWeight:\"inherit\",fontSize:\"inherit\",textAlign:\"inherit\",fontFamily:\"inherit\"}};return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Consumer,null,(function(n){var i;return(null===(i=n.content.meta)||void 0===i?void 0:i.rtlMode)&&(t.direction=\"rtl\"),(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),null,(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"span\",__assign({ref:function(t){e.textRef=t},css:t,className:\"builder-text\"},{dangerouslySetInnerHTML:{__html:e.evalExpression(e.props.text||e.props.content||\"\",n.state)}})))}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Text=withBuilder(TextComponent,{name:\"Text\",static:!0,image:iconUrl,inputs:[{name:\"text\",type:\"html\",required:!0,autoFocus:!0,bubble:!0,defaultValue:\"Enter some text...\"}],defaultStyles:{lineHeight:\"normal\",height:\"auto\",textAlign:\"center\"}});function Slot(e){var t=e.name,n=(0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(BuilderStoreContext),i=!n.context.symbolId;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",__assign({css:{pointerEvents:\"auto\"}},i&&{\"builder-slot\":t}),(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlocks,{child:!0,parentElementId:n.context.symbolId,dataPath:\"symbol.data.\".concat(t),blocks:n.state[t]||[]}))}_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.registerComponent(Slot,{name:\"Slot\",description:\"Allow child blocks to be inserted into this content when used as a Symbol\",docsLink:\"https://www.builder.io/c/docs/symbols-with-blocks\",image:\"https://cdn.builder.io/api/v1/image/assets%2FYJIGb4i01jvw0SRdL5Bt%2F3aad6de36eae43b59b52c85190fdef56\",inputs:[{name:\"name\",type:\"string\",required:!0,defaultValue:\"children\"}]});var FragmentComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return this.props.builderBlock&&this.props.builderBlock.children&&this.props.builderBlock.children.map((function(e,t){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderBlock$1,{block:e,key:e.id,index:t})}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Fragment=withBuilder(FragmentComponent,{name:\"Core:Fragment\",canHaveChildren:!0,noWrap:!0,static:!0,hideFromInsertMenu:!0}),DEFAULT_ASPECT_RATIO$2=.7004048582995948,defaultBlocks=[{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\",flexShrink:\"0\",position:\"relative\",marginTop:\"30px\",textAlign:\"center\",lineHeight:\"normal\",height:\"auto\",minHeight:\"20px\",minWidth:\"20px\",overflow:\"hidden\"}},component:{name:\"Image\",options:{image:\"https://builder.io/api/v1/image/assets%2Fpwgjf0RoYWbdnJSbpBAjXNRMe9F2%2Ffb27a7c790324294af8be1c35fe30f4d\",backgroundPosition:\"center\",backgroundSize:\"cover\",aspectRatio:DEFAULT_ASPECT_RATIO$2}}},{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\",flexShrink:\"0\",position:\"relative\",marginTop:\"30px\",textAlign:\"center\",lineHeight:\"normal\",height:\"auto\"}},component:{name:\"Text\",options:{text:\"<p>Enter some text...</p>\"}}}],ColumnsComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,\"columns\",{get:function(){return this.props.columns||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"gutterSize\",{get:function(){return\"number\"==typeof this.props.space?this.props.space||0:20},enumerable:!1,configurable:!0}),t.prototype.getWidth=function(e){return this.columns[e]&&this.columns[e].width||100/this.columns.length},t.prototype.getColumnWidth=function(e){var t=this.columns,n=this.gutterSize*(t.length-1)/t.length;return\"calc(\".concat(this.getWidth(e),\"% - \").concat(n,\"px)\")},t.prototype.render=function(){var e,t,n,i,r=this,o=this.columns,a=this.gutterSize,s=(null===(i=null===(n=null===(t=this.props.builderState)||void 0===t?void 0:t.context.builderContent)||void 0===n?void 0:n.meta)||void 0===i?void 0:i.breakpoints)||{},l=getSizesForBreakpoints(s);return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),null,(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{className:\"builder-columns\",css:__assign({display:\"flex\"},\"never\"!==this.props.stackColumnsAt&&(e={},e[\"@media (max-width: \".concat(\"tablet\"!==this.props.stackColumnsAt?l.small.max:l.medium.max,\"px)\")]={flexDirection:this.props.reverseColumnsWhenStacked?\"column-reverse\":\"column\",alignItems:\"stretch\"},e))},o.map((function(e,t){var n,i,o=e.link?Link:\"div\";return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),{key:t},(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(o,__assign({className:\"builder-column\"},e.link?{href:e.link}:null,{css:__assign((n={display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\",lineHeight:\"normal\"},n[\"& > .builder-blocks\"]={flexGrow:1},n.width=r.getColumnWidth(t),n.marginLeft=0===t?0:a,n),\"never\"!==r.props.stackColumnsAt&&(i={},i[\"@media (max-width: \".concat(\"tablet\"!==r.props.stackColumnsAt?l.small.max:l.medium.max,\"px)\")]={width:\"100%\",marginLeft:0},i))}),(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlocks,{key:t,child:!0,parentElementId:r.props.builderBlock&&r.props.builderBlock.id,blocks:e.blocks,dataPath:\"component.options.columns.\".concat(t,\".blocks\")})))}))))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Columns=withBuilder(ColumnsComponent,{name:\"Columns\",static:!0,inputs:[{name:\"columns\",type:\"array\",broadcast:!0,subFields:[{name:\"blocks\",type:\"array\",hideFromUI:!0,defaultValue:defaultBlocks},{name:\"width\",type:\"number\",hideFromUI:!0,helperText:\"Width %, e.g. set to 50 to fill half of the space\"},{name:\"link\",type:\"url\",helperText:\"Optionally set a url that clicking this column will link to\"}],defaultValue:[{blocks:defaultBlocks},{blocks:defaultBlocks}],onChange:function(e){function t(){n.forEach((function(e){e.delete(\"width\")}))}var n=e.get(\"columns\");Array.isArray(n)&&(!n.find((function(e){return e.get(\"width\")}))||(n.find((function(e){return!e.get(\"width\")}))||100!==n.reduce((function(e,t){return e+t.get(\"width\")}),0))&&t())}},{name:\"space\",type:\"number\",defaultValue:20,helperText:\"Size of gap between columns\",advanced:!0},{name:\"stackColumnsAt\",type:\"string\",defaultValue:\"tablet\",helperText:\"Convert horizontal columns to vertical at what device size\",enum:[\"tablet\",\"mobile\",\"never\"],advanced:!0},{name:\"reverseColumnsWhenStacked\",type:\"boolean\",defaultValue:!1,helperText:\"When stacking columns for mobile devices, reverse the ordering\",advanced:!0}]}),EmbedComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.elementRef=null,t.scriptsInserted=new Set,t.scriptsRun=new Set,t}return __extends(t,e),t.prototype.componentDidUpdate=function(e){this.props.content!==e.content&&this.findAndRunScripts()},t.prototype.componentDidMount=function(){this.findAndRunScripts()},t.prototype.findAndRunScripts=function(){if(this.elementRef&&\"undefined\"!=typeof window)for(var e=this.elementRef.getElementsByTagName(\"script\"),t=0;t<e.length;t++){var n=e[t];if(n.src){if(this.scriptsInserted.has(n.src))continue;this.scriptsInserted.add(n.src);var i=document.createElement(\"script\");i.async=!0,i.src=n.src,document.head.appendChild(i)}else{if(this.scriptsRun.has(n.innerText))continue;this.scriptsRun.add(n.innerText);try{new Function(n.innerText)()}catch(e){console.warn(\"Builder custom code component error:\",e)}}}},Object.defineProperty(t.prototype,\"content\",{get:function(){return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer?(this.props.content||\"\").replace(/<script[\\s\\S]*?<\\/script>/g,\"\"):this.props.content},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this;return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"div\",{ref:function(t){return e.elementRef=t},className:\"builder-embed\",dangerouslySetInnerHTML:{__html:this.content}})},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Embed=withBuilder(EmbedComponent,{name:\"Embed\",static:!0,inputs:[{name:\"url\",type:\"url\",required:!0,defaultValue:\"\",helperText:\"e.g. enter a youtube url, google map, etc\",onChange:function(e){var t=e.get(\"url\");if(t){e.set(\"content\",\"Loading...\");return fetch(\"https://iframe.ly/api/iframely?url=\".concat(t,\"&api_key=\").concat(\"ae0e60e78201a3f2b0de4b\")).then((function(e){return e.json()})).then((function(n){e.get(\"url\")===t&&(n.html?e.set(\"content\",n.html):e.set(\"content\",\"Invalid url, please try another\"))})).catch((function(t){e.set(\"content\",\"There was an error embedding this URL, please try again or another URL\")}))}e.delete(\"content\")}},{name:\"content\",type:\"html\",defaultValue:'<div style=\"padding: 20px; text-align: center\">(Choose an embed URL)<div>',hideFromUI:!0}]}),globalReplaceNodes={}||null,isShopify$1=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&\"Shopify\"in window;if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&globalReplaceNodes){var customCodeQuerySelector_1=\".builder-custom-code\";try{var allCustomCodeElements_1=Array.from(document.querySelectorAll(customCodeQuerySelector_1)),builderTemplates=document.querySelectorAll(\"template[data-template-variant-id]\");builderTemplates.length&&Array.from(builderTemplates).forEach((function(e){var t=e.content.querySelectorAll(customCodeQuerySelector_1);t.length&&(allCustomCodeElements_1=allCustomCodeElements_1.concat(Array.from(t)))})),allCustomCodeElements_1.forEach((function(e){var t=e.parentElement,n=t&&t.getAttribute(\"builder-id\");n&&(globalReplaceNodes[n]=globalReplaceNodes[n]||[],globalReplaceNodes[n].push(isShopify$1?e:e.cloneNode(!0)))}))}catch(e){console.error(\"Builder replace nodes error:\",e)}}var CustomCodeComponent=function(e){function t(t){var n,i=this;if((i=e.call(this,t)||this).elementRef=null,i.originalRef=null,i.scriptsInserted=new Set,i.scriptsRun=new Set,i.firstLoad=!0,i.replaceNodes=!1,i.state={hydrated:!1},_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser){var r=null===(n=i.props.builderBlock)||void 0===n?void 0:n.id;if(i.replaceNodes=Boolean(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&(t.replaceNodes||isShopify$1)&&r&&(null==globalReplaceNodes?void 0:globalReplaceNodes[r])),i.firstLoad&&i.props.builderBlock)if(r&&(null==globalReplaceNodes?void 0:globalReplaceNodes[r])){var o=globalReplaceNodes[r].shift()||null;i.originalRef=o,0===globalReplaceNodes[r].length&&delete globalReplaceNodes[r]}else if(i.replaceNodes){var a=document.querySelectorAll(\".\".concat(i.props.builderBlock.id,\" .builder-custom-code\"));if(1===a.length){var s=a[0];i.originalRef=s,i.originalRef.remove()}}}return i}return __extends(t,e),Object.defineProperty(t.prototype,\"noReactRender\",{get:function(){var e;return Boolean(isShopify$1&&(null===(e=this.props.code)||void 0===e?void 0:e.match(/{[{%]/g)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"isHydrating\",{get:function(){return!isShopify$1&&this.originalRef},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e){this.props.code!==e.code&&this.findAndRunScripts()},t.prototype.componentDidMount=function(){var e=this;this.firstLoad=!1,this.replaceNodes||(this.isHydrating?(this.setState({hydrated:!0}),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.nextTick((function(){return e.findAndRunScripts()}))):this.findAndRunScripts()),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&this.replaceNodes&&this.originalRef&&this.elementRef&&this.elementRef.appendChild(this.originalRef)},t.prototype.findAndRunScripts=function(){if(this.elementRef&&\"undefined\"!=typeof window)for(var e=this.elementRef.getElementsByTagName(\"script\"),t=0;t<e.length;t++){var n=e[t];if(n.src){if(this.scriptsInserted.has(n.src))continue;this.scriptsInserted.add(n.src);var i=document.createElement(\"script\");i.async=!0,i.src=n.src,document.head.appendChild(i)}else if(!n.type||[\"text/javascript\",\"application/javascript\",\"application/ecmascript\"].includes(n.type)){if(this.scriptsRun.has(n.innerText))continue;try{this.scriptsRun.add(n.innerText),new Function(n.innerText)()}catch(e){console.warn(\"Builder custom code component error:\",e)}}}},Object.defineProperty(t.prototype,\"code\",{get:function(){return(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isServer||this.isHydrating&&this.firstLoad)&&this.props.scriptsClientOnly?(this.props.code||\"\").replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,\"\"):this.props.code},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this;return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"div\",__assign({ref:function(t){return e.elementRef=t},className:\"builder-custom-code\"},!this.replaceNodes&&!this.noReactRender&&{dangerouslySetInnerHTML:{__html:this.code}}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),CustomCode=withBuilder(CustomCodeComponent,{name:\"Custom Code\",static:!0,requiredPermissions:[\"editCode\"],inputs:[{name:\"code\",type:\"html\",required:!0,defaultValue:\"<p>Hello there, I am custom HTML code!</p>\",code:!0},__assign({name:\"replaceNodes\",type:\"boolean\",helperText:\"Preserve server rendered dom nodes\",advanced:!0},isShopify$1&&{defaultValue:!0}),__assign({name:\"scriptsClientOnly\",type:\"boolean\",helperText:\"Only print and run scripts on the client. Important when scripts influence DOM that could be replaced when client loads\",advanced:!0},!isShopify$1&&{defaultValue:!0})]});function removeProtocol(e){return e.replace(/http(s)?:/,\"\")}function isElementInViewport(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function getShopifyImageUrl(e,t){if(!e||!(null==e?void 0:e.match(/cdn\\.shopify\\.com/))||!t)return e;if(\"master\"===t)return removeProtocol(e);var n=e.match(/(_\\d+x(\\d+)?)?(\\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\\?v=\\d+)?)/i);if(n){var i=e.split(n[0]),r=n[3],o=t.match(\"x\")?t:\"\".concat(t,\"x\");return removeProtocol(\"\".concat(i[0],\"_\").concat(o).concat(r))}return null}var DEFAULT_ASPECT_RATIO$1=.7041;function updateQueryParam(e,t,n){void 0===e&&(e=\"\");var i=new RegExp(\"([?&])\"+t+\"=.*?(&|$)\",\"i\"),r=-1!==e.indexOf(\"?\")?\"&\":\"?\";return e.match(i)?e.replace(i,\"$1\"+t+\"=\"+encodeURIComponent(n)+\"$2\"):e+r+t+\"=\"+encodeURIComponent(n)}function getSrcSet(e){if(!e)return e;var t=[100,200,400,800,1200,1600,2e3];if(e.match(/builder\\.io/)){var n=e,i=Number(e.split(\"?width=\")[1]);return isNaN(i)||(n=\"\".concat(n,\" \").concat(i,\"w\")),t.filter((function(e){return e!==i})).map((function(t){return\"\".concat(updateQueryParam(e,\"width\",t),\" \").concat(t,\"w\")})).concat([n]).join(\", \")}return e.match(/cdn\\.shopify\\.com/)?t.map((function(t){return[getShopifyImageUrl(e,\"\".concat(t,\"x\").concat(t)),t]})).filter((function(e){return!!e[0]})).map((function(e){var t=e[0],n=e[1];return\"\".concat(t,\" \").concat(n,\"w\")})).concat([e]).join(\", \"):e}var getSizes=function(e,t,n){var i,r,o,a,s,l,u,d;void 0===n&&(n={});var c=\"\";if(e){var p=e.split(\",\"),f=p.length;c=p.map((function(e,t){return f===t+1?e.replace(/\\([\\s\\S]*?\\)/g,\"\").trim():e})).join(\", \")}else if(t&&t.responsiveStyles){var m=[],h=!1,g=/^\\d+/,v=getSizesForBreakpoints(n);if(null===(o=null===(r=null===(i=t.responsiveStyles)||void 0===i?void 0:i.small)||void 0===r?void 0:r.width)||void 0===o?void 0:o.match(g)){h=!0;var b=\"(max-width: \".concat(v.small.max,\"px)\"),y=\"\".concat(b,\" \").concat(t.responsiveStyles.small.width.replace(\"%\",\"vw\"));m.push(y)}if(null===(l=null===(s=null===(a=t.responsiveStyles)||void 0===a?void 0:a.medium)||void 0===s?void 0:s.width)||void 0===l?void 0:l.match(g)){h=!0;b=\"(max-width: \".concat(v.medium.max,\"px)\"),y=\"\".concat(b,\" \").concat(t.responsiveStyles.medium.width.replace(\"%\",\"vw\"));m.push(y)}if(null===(d=null===(u=t.responsiveStyles)||void 0===u?void 0:u.large)||void 0===d?void 0:d.width){var _=t.responsiveStyles.large.width.replace(\"%\",\"vw\");m.push(_)}else h&&m.push(\"100vw\");m.length&&(c=m.join(\", \"))}return c},ImageComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={imageLoaded:!t.useLazyLoading,load:!t.useLazyLoading},t.pictureRef=null,t.scrollListener=null,t.intersectionObserver=null,t}return __extends(t,e),Object.defineProperty(t.prototype,\"useLazyLoading\",{get:function(){return(!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser||!location.search.includes(\"builder.lazyLoadImages=false\"))&&(!(!_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser||!location.href.includes(\"builder.lazyLoadImages=true\"))||this.props.lazy)},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&(this.scrollListener&&(window.removeEventListener(\"scroll\",this.scrollListener),this.scrollListener=null),this.intersectionObserver&&this.pictureRef&&this.intersectionObserver.unobserve(this.pictureRef))},t.prototype.componentDidMount=function(){var e=this;if(this.props.lazy&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser)if(this.pictureRef&&isElementInViewport(this.pictureRef))this.setState({load:!0});else if(\"function\"==typeof IntersectionObserver&&this.pictureRef){(this.intersectionObserver=new IntersectionObserver((function(t,n){t.forEach((function(t){t.intersectionRatio>0&&(e.setState({load:!0}),e.pictureRef&&n.unobserve(e.pictureRef))}))}))).observe(this.pictureRef)}else{var t=throttle((function(n){if(e.pictureRef){var i=e.pictureRef.getBoundingClientRect(),r=window.innerHeight/2;i.top<window.innerHeight+r&&(e.setState(__assign(__assign({},e.state),{load:!0})),window.removeEventListener(\"scroll\",t),e.scrollListener=null)}}),400,{leading:!1,trailing:!0});this.scrollListener=t,window.addEventListener(\"scroll\",t,{capture:!0,passive:!0}),t()}},Object.defineProperty(t.prototype,\"image\",{get:function(){return this.props.image||this.props.src},enumerable:!1,configurable:!0}),t.prototype.getSrcSet=function(){var e=this.image;if(e&&(e.match(/builder\\.io/)||e.match(/cdn\\.shopify\\.com/)))return getSrcSet(e)},t.prototype.render=function(){var e,t,n=this,i=this.props,r=i.aspectRatio,o=i.lazy,a=i.builderBlock,s=i.builderState,l=this.props.builderBlock&&this.props.builderBlock.children,u=this.props.srcset,d=getSizes(this.props.sizes,a,(null===(t=null===(e=null==s?void 0:s.context.builderContent)||void 0===e?void 0:e.meta)||void 0===t?void 0:t.breakpoints)||{}),c=this.image;u&&c&&c.includes(\"builder.io/api/v1/image\")?u.includes(c.split(\"?\")[0])||(console.debug(\"Removed given srcset\"),u=this.getSrcSet()):c&&!u&&(u=this.getSrcSet());var p=null==a?void 0:a.id.startsWith(\"builder-pixel-\"),f=this.props.fitContent;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderMetaContext.Consumer,null,(function(e){var t,i=e.ampMode,a=i?\"amp-img\":\"img\",s=(!o||n.state.load||i)&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(a,__assign({},i?{layout:\"responsive\",height:n.props.height||(r?Math.round(1e3*r):void 0),width:n.props.width||(r?Math.round(1e3/r):void 0)}:null,{alt:n.props.altText,key:_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&\"string\"==typeof n.image&&n.image.split(\"?\")[0]||void 0,role:n.props.altText?void 0:\"presentation\",css:__assign(__assign({opacity:i?1:n.useLazyLoading&&!n.state.imageLoaded?0:1,transition:\"opacity 0.2s ease-in-out\",objectFit:n.props.backgroundSize||\"cover\",objectPosition:n.props.backgroundPosition||\"center\"},r&&!i&&{position:\"absolute\",height:\"100%\",width:\"100%\",left:0,top:0}),i&&(t={},t[\"& img\"]={objectFit:n.props.backgroundSize,objectPosition:n.props.backgroundPosition},t)),loading:p?\"eager\":\"lazy\",className:\"builder-image\"+(n.props.className?\" \"+n.props.className:\"\"),src:n.image},!i&&{onLoad:function(){return n.setState({imageLoaded:!0})}},{srcSet:u,sizes:!i&&d?d:void 0}));return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),null,i?s:(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"picture\",{ref:function(e){return n.pictureRef=e}},u&&u.match(/builder\\.io/)&&!n.props.noWebp&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"source\",{srcSet:u.replace(/\\?/g,\"?format=webp&\"),type:\"image/webp\"}),s),!r||i||f&&l&&l.length?null:(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{className:\"builder-image-sizer\",css:{width:\"100%\",paddingTop:100*r+\"%\",pointerEvents:\"none\",fontSize:0}},\" \"),l&&l.length?f?l.map((function(e,t){return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlock$1,{key:e.id,block:e})})):(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{css:{display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\",position:\"absolute\",top:0,left:0,width:\"100%\",height:\"100%\"}},l.map((function(e,t){return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlock$1,{key:e.id,block:e})}))):null)}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Image=withBuilder(ImageComponent,{name:\"Image\",static:!0,image:\"https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-insert_photo-24px.svg?alt=media&token=4e5d0ef4-f5e8-4e57-b3a9-38d63a9b9dc4\",defaultStyles:{position:\"relative\",minHeight:\"20px\",minWidth:\"20px\",overflow:\"hidden\"},canHaveChildren:!0,inputs:[{name:\"image\",type:\"file\",bubble:!0,allowedFileTypes:[\"jpeg\",\"jpg\",\"png\",\"svg\"],required:!0,defaultValue:\"https://cdn.builder.io/api/v1/image/assets%2FYJIGb4i01jvw0SRdL5Bt%2F72c80f114dc149019051b6852a9e3b7a\",onChange:function(e){e.delete(\"srcset\"),e.delete(\"noWebp\");var t,n,i=e.get(\"image\"),r=e.get(\"aspectRatio\");if(fetch(i).then((function(e){return e.blob()})).then((function(t){t.type.includes(\"svg\")&&e.set(\"noWebp\",!0)})),i&&(!r||.7041===r))return(t=i,void 0===n&&(n=6e4),new Promise((function(e,i){var r=document.createElement(\"img\"),o=!1;r.onload=function(){o=!0,e(r)},r.addEventListener(\"error\",(function(e){console.warn(\"Image load failed\",e.error),i(e.error)})),r.src=t,setTimeout((function(){o||i(new Error(\"Image load timed out\"))}),n)}))).then((function(t){var n,r=e.get(\"aspectRatio\");e.get(\"image\")!==i||r&&.7041!==r||t.width&&t.height&&(e.set(\"aspectRatio\",(n=t.height/t.width,Math.round(1e3*n)/1e3)),e.set(\"height\",t.height),e.set(\"width\",t.width))}))}},{name:\"backgroundSize\",type:\"text\",defaultValue:\"cover\",enum:[{label:\"contain\",value:\"contain\",helperText:\"The image should never get cropped\"},{label:\"cover\",value:\"cover\",helperText:\"The image should fill its box, cropping when needed\"}]},{name:\"backgroundPosition\",type:\"text\",defaultValue:\"center\",enum:[\"center\",\"top\",\"left\",\"right\",\"bottom\",\"top left\",\"top right\",\"bottom left\",\"bottom right\"]},{name:\"altText\",type:\"string\",helperText:\"Text to display when the user has images off\"},{name:\"height\",type:\"number\",hideFromUI:!0},{name:\"width\",type:\"number\",hideFromUI:!0},{name:\"sizes\",type:\"string\",hideFromUI:!0},{name:\"srcset\",type:\"string\",hideFromUI:!0},{name:\"lazy\",type:\"boolean\",defaultValue:!0,hideFromUI:!0},{name:\"fitContent\",type:\"boolean\",helperText:\"When child blocks are provided, fit to them instead of using the image's aspect ratio\",defaultValue:!0},{name:\"aspectRatio\",type:\"number\",helperText:\"This is the ratio of height/width, e.g. set to 1.5 for a 300px wide and 200px tall photo. Set to 0 to not force the image to maintain it's aspect ratio\",advanced:!0,defaultValue:DEFAULT_ASPECT_RATIO$1}]}),DEFAULT_ASPECT_RATIO=.7004048582995948,VideoComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.video=null,t.containerRef=null,t.scrollListener=null,t.state={load:!t.lazyLoad},t}return __extends(t,e),Object.defineProperty(t.prototype,\"lazyLoad\",{get:function(){return!1!==this.props.lazyLoad},enumerable:!1,configurable:!0}),t.prototype.updateVideo=function(){var e=this,t=this.video;if(t){[\"muted\",\"playsInline\",\"autoPlay\"].forEach((function(n){var i=n.toLowerCase();e.props[n]?t.setAttribute(i,i):t.removeAttribute(i)}))}},t.prototype.componentDidUpdate=function(){this.updateVideo()},t.prototype.componentDidMount=function(){var e=this;if(this.updateVideo(),this.lazyLoad&&_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser){var t=throttle((function(n){if(e.containerRef){var i=e.containerRef.getBoundingClientRect(),r=window.innerHeight/2;i.top<window.innerHeight+r&&(e.setState((function(e){return __assign(__assign({},e),{load:!0})})),window.removeEventListener(\"scroll\",t),e.scrollListener=null)}}),400,{leading:!1,trailing:!0});this.scrollListener=t,window.addEventListener(\"scroll\",t,{capture:!0,passive:!0}),t()}},t.prototype.componentWillUnmount=function(){_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&this.scrollListener&&(window.removeEventListener(\"scroll\",this.scrollListener),this.scrollListener=null)},t.prototype.render=function(){var e=this,t=this.props,n=t.aspectRatio,i=t.children;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{ref:function(t){return e.containerRef=t},css:{position:\"relative\"}},(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"video\",{key:this.props.video||\"no-src\",poster:this.props.posterImage,ref:function(t){return e.video=t},autoPlay:this.props.autoPlay,muted:this.props.muted,controls:this.props.controls,loop:this.props.loop,preload:this.props.preload||\"metadata\",className:\"builder-video\",css:__assign({width:\"100%\",height:\"100%\",objectFit:this.props.fit,objectPosition:this.props.position,zIndex:2,borderRadius:1},n?{position:\"absolute\"}:null)},(!this.lazyLoad||this.state.load)&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"source\",{type:\"video/mp4\",src:this.props.video})),!n||this.props.fitContent&&i?null:(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{css:{width:\"100%\",paddingTop:100*n+\"%\",pointerEvents:\"none\",fontSize:0}}),i&&this.props.fitContent?(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{css:{display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\"}},i):i?(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{css:{pointerEvents:\"none\",display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\",position:\"absolute\",top:0,left:0,width:\"100%\",height:\"100%\"}},i):null)},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Video=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.registerComponent(withChildren(VideoComponent),{name:\"Video\",canHaveChildren:!0,defaultStyles:{minHeight:\"20px\",minWidth:\"20px\"},image:\"https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-videocam-24px%20(1).svg?alt=media&token=49a84e4a-b20e-4977-a650-047f986874bb\",inputs:[{name:\"video\",type:\"file\",allowedFileTypes:[\"mp4\"],bubble:!0,defaultValue:\"https://cdn.builder.io/o/assets%2FYJIGb4i01jvw0SRdL5Bt%2Fd27731a526464deba0016216f5f9e570%2Fcompressed?apiKey=YJIGb4i01jvw0SRdL5Bt&token=d27731a526464deba0016216f5f9e570&alt=media&optimized=true\",required:!0},{name:\"posterImage\",type:\"file\",allowedFileTypes:[\"jpeg\",\"png\"],helperText:\"Image to show before the video plays\"},{name:\"autoPlay\",type:\"boolean\",defaultValue:!0},{name:\"controls\",type:\"boolean\",defaultValue:!1},{name:\"muted\",type:\"boolean\",defaultValue:!0},{name:\"loop\",type:\"boolean\",defaultValue:!0},{name:\"playsInline\",type:\"boolean\",defaultValue:!0},{name:\"fit\",type:\"text\",defaultValue:\"cover\",enum:[\"contain\",\"cover\",\"fill\",\"auto\"]},{name:\"preload\",type:\"text\",defaultValue:\"metadata\",enum:[\"auto\",\"metadata\",\"none\"]},{name:\"fitContent\",type:\"boolean\",helperText:\"When child blocks are provided, fit to them instead of using the aspect ratio\",defaultValue:!0,advanced:!0},{name:\"position\",type:\"text\",defaultValue:\"center\",enum:[\"center\",\"top\",\"left\",\"right\",\"bottom\",\"top left\",\"top right\",\"bottom left\",\"bottom right\"]},{name:\"height\",type:\"number\",advanced:!0},{name:\"width\",type:\"number\",advanced:!0},{name:\"aspectRatio\",type:\"number\",advanced:!0,defaultValue:DEFAULT_ASPECT_RATIO},{name:\"lazyLoad\",type:\"boolean\",helperText:'Load this video \"lazily\" - as in only when a user scrolls near the video. Recommended for optmized performance and bandwidth consumption',defaultValue:!0,advanced:!0}]}),size=function(e){return Object.keys(e).length},isShopify=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&\"Shopify\"in window,refs={};if(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser)try{Array.from(document.querySelectorAll(\"[builder-static-symbol]\")).forEach((function(e){var t=e.getAttribute(\"builder-static-symbol\");t&&(refs[t]=e)}))}catch(e){console.error(\"Builder replace nodes error:\",e)}var SymbolComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=null,t.staticRef=null,t}return __extends(t,e),Object.defineProperty(t.prototype,\"placeholder\",{get:function(){return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{css:{padding:10}},\"Symbols let you reuse dynamic elements across your content. Please choose a model and entry for this symbol.\")},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){var e,t,n;this.useStatic&&this.staticRef&&refs[null===(e=this.props.builderBlock)||void 0===e?void 0:e.id]&&(null===(t=this.staticRef.parentNode)||void 0===t||t.replaceChild(refs[null===(n=this.props.builderBlock)||void 0===n?void 0:n.id],this.staticRef))},Object.defineProperty(t.prototype,\"useStatic\",{get:function(){var e;return Boolean(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isBrowser&&refs[null===(e=this.props.builderBlock)||void 0===e?void 0:e.id]&&!(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isPreviewing))},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t=this;if(this.useStatic)return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{ref:function(e){return t.staticRef=e}});var n=this.props.symbol,i=!1;n||(i=!0);var r=this.props.dataOnly?NoWrap:this.props.builderBlock&&this.props.builderBlock.tagName||\"div\",o=n||{},a=o.model,s=o.entry,l=o.data,u=o.content,d=o.inline,c=o.ownerId,p=(null==n?void 0:n.dynamic)||this.props.dynamic;a&&(s||p)||(null===(e=null==u?void 0:u.data)||void 0===e?void 0:e.blocksJs)||d||(i=!0);var f=p?void 0:[a,s].join(\":\"),m=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing?null:l&&size(l)&&hash_sum__WEBPACK_IMPORTED_MODULE_4___default()(l);f&&m&&m.length<300&&(f+=\":\"+m);var h=this.props.attributes||{};return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Consumer,{key:(a||\"no model\")+\":\"+(s||\"no entry\")},(function(e){var o,d,p,m,g,v,b,y,_,x,S,B=\"\".concat(f,\"_\").concat((null===(o=null==e?void 0:e.state)||void 0===o?void 0:o.locale)||\"Default\");return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(r,__assign({\"data-model\":a},h,{className:(h.class||h.className||\"\")+\" builder-symbol\"+((null==n?void 0:n.inline)?\" builder-inline-symbol\":\"\")+((null==n?void 0:n.dynamic)||t.props.dynamic?\" builder-dynamic-symbol\":\"\")}),i?t.placeholder:(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderComponent,__assign({},c&&{apiKey:c},(null===(d=e.state)||void 0===d?void 0:d.locale)&&{locale:e.state.locale},{isChild:!0,ref:function(e){return t.ref=e},context:__assign(__assign({},e.context),{symbolId:null===(p=t.props.builderBlock)||void 0===p?void 0:p.id}),model:a,entry:s,data:__assign(__assign(__assign({},l),!!t.props.inheritState&&omit$2(e.state,\"children\")),null===(_=null===(y=null===(b=null===(v=null===(g=null===(m=t.props.builderBlock)||void 0===m?void 0:m.component)||void 0===g?void 0:g.options)||void 0===v?void 0:v.symbol)||void 0===b?void 0:b.content)||void 0===y?void 0:y.data)||void 0===_?void 0:_.state),renderLink:e.renderLink,inlineContent:null==n?void 0:n.inline},u&&{content:u},{key:B,options:{key:B,noEditorUpdates:!0},codegen:!!(null===(x=null==u?void 0:u.data)||void 0===x?void 0:x.blocksJs),hydrate:null===(S=e.state)||void 0===S?void 0:S._hydrate,builderBlock:t.props.builderBlock,dataOnly:t.props.dataOnly}),t.props.children))}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Symbol$1=withBuilder(SymbolComponent,{name:\"Symbol\",noWrap:!0,static:!0,inputs:[{name:\"symbol\",type:\"uiSymbol\"},{name:\"dataOnly\",helperText:\"Make this a data symbol that doesn't display any UI\",type:\"boolean\",defaultValue:!1,advanced:!0,hideFromUI:!0},{name:\"inheritState\",helperText:\"Inherit the parent component state and data\",type:\"boolean\",defaultValue:isShopify,advanced:!0},{name:\"renderToLiquid\",helperText:\"Render this symbols contents to liquid. Turn off to fetch with javascript and use custom targeting\",type:\"boolean\",defaultValue:isShopify,advanced:!0,hideFromUI:!0},{name:\"useChildren\",hideFromUI:!0,type:\"boolean\"}]}),ButtonComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props.link?Link:\"span\";return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(e,__assign({role:\"button\",href:this.props.link,target:this.props.openLinkInNewTab?\"_blank\":void 0},this.props.attributes),this.props.text)},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Button=withBuilder(ButtonComponent,{name:\"Core:Button\",image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F81a15681c3e74df09677dfc57a615b13\",defaultStyles:{appearance:\"none\",paddingTop:\"15px\",paddingBottom:\"15px\",paddingLeft:\"25px\",paddingRight:\"25px\",backgroundColor:\"#000000\",color:\"white\",borderRadius:\"4px\",textAlign:\"center\",cursor:\"pointer\"},inputs:[{name:\"text\",type:\"text\",defaultValue:\"Click me!\",bubble:!0},{name:\"link\",type:\"url\",bubble:!0},{name:\"openLinkInNewTab\",type:\"boolean\",defaultValue:!1,friendlyName:\"Open link in new tab\"}],static:!0,noWrap:!0}),SectionComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=null,t.unmountCallbacks=[],t.state={inView:!1},t}return __extends(t,e),Object.defineProperty(t.prototype,\"renderContents\",{get:function(){return!0!==this.props.lazyLoad||this.state.inView},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){this.unmountCallbacks.forEach((function(e){return e()}))},t.prototype.componentDidMount=function(){var e=this;if(this.props.lazyLoad)if(\"undefined\"!=typeof IntersectionObserver&&this.ref){var t=new IntersectionObserver((function(t,n){t.forEach((function(t){t.intersectionRatio>0&&(e.setState({inView:!0}),e.ref&&n.unobserve(e.ref))}))}),{rootMargin:\"10px\"});t.observe(this.ref),this.unmountCallbacks.push((function(){e.ref&&t.unobserve(e.ref)}))}else this.setState({inView:!0})},t.prototype.render=function(){var e=this;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"section\",{ref:function(t){return e.ref=t},css:__assign({width:\"100%\",alignSelf:\"stretch\",flexGrow:1,boxSizing:\"border-box\",maxWidth:this.props.maxWidth,display:\"flex\",flexDirection:\"column\",alignItems:\"stretch\",marginLeft:\"auto\",marginRight:\"auto\"},this.renderContents?null:this.props.lazyStyles)},this.renderContents?(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)((react__WEBPACK_IMPORTED_MODULE_2___default().Fragment),null,this.props.children,this.props.builderBlock&&this.props.builderBlock.children&&this.props.builderBlock.children.map((function(e,t){return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlock$1,{key:e.id,block:e})}))):null)},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Section=withBuilder(SectionComponent,{name:\"Core:Section\",static:!0,image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F682efef23ace49afac61748dd305c70a\",inputs:[{name:\"maxWidth\",type:\"number\",defaultValue:1200},{name:\"lazyLoad\",type:\"boolean\",defaultValue:!1,advanced:!0,description:\"Only render this section when in view\"}],defaultStyles:{paddingLeft:\"20px\",paddingRight:\"20px\",paddingTop:\"50px\",paddingBottom:\"50px\",marginTop:\"0px\",width:\"100vw\",marginLeft:\"calc(50% - 50vw)\"},canHaveChildren:!0,defaultChildren:[{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{textAlign:\"center\"}},component:{name:\"Text\",options:{text:\"<p><b>I am a section! My content keeps from getting too wide, so that it's easy to read even on big screens.</b></p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur</p>\"}}}]}),StateProviderComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this;return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderStoreContext.Consumer,null,(function(t){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderStoreContext.Provider,{value:__assign(__assign({},t),{state:__assign(__assign({},t.state),e.props.state),context:__assign(__assign({},t.context),e.props.context)})},e.props.builderBlock&&e.props.builderBlock.children&&e.props.builderBlock.children.map((function(e,t){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderBlock$1,{block:e,key:e.id,index:t,child:!0})})),e.props.children)}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),StateProvider=withBuilder(StateProviderComponent,{name:\"Builder:StateProvider\",canHaveChildren:!0,static:!0,noWrap:!0,hideFromInsertMenu:!0}),prefetched=new Set;function searchToObject(e){var t=(e.search||\"\").substring(1).split(\"&\"),n={};for(var i in t)if(t[i]&&\"string\"==typeof t[i]){var r=t[i].split(\"=\");n[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return n}var RouterComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.builder=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder,t.routed=!1,t.preloadQueue=0,t.onPopState=function(e){t.updateLocationState()},t.onMouseOverOrTouchStart=function(e){if(!(t.preloadQueue>4)&&!1!==t.props.preloadOnHover){var n=t.findHrefTarget(e);if(n){var i=n.getAttribute(\"href\");if(i){if(!t.isRelative(i)){var r=t.convertToRelative(i);if(!r)return;i=r}if(!i.startsWith(\"#\")&&!prefetched.has(i)){prefetched.add(i);var o=t.parseUrl(i);t.preloadQueue++;var a=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.getUserAttributes();a.urlPath=o.pathname,a.queryString=o.search;var s=_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.get(t.model,{userAttributes:a,key:t.model+\":\"+o.pathname+o.search}).subscribe((function(){t.preloadQueue--,s.unsubscribe()}))}}}}},t.onClick=function(e){return __awaiter(t,void 0,void 0,(function(){var t,n,i,r;return __generator(this,(function(o){if(!1===this.props.handleRouting)return[2];if(0!==e.button||e.ctrlKey||e.defaultPrevented||e.metaKey)return[2];if(!(t=this.findHrefTarget(e)))return[2];if(t.target&&\"_client\"!==t.target)return[2];if(!(n=t.getAttribute(\"href\")))return[2];if(this.props.onRoute&&(i={url:n,anchorNode:t,preventDefault:function(){this.defaultPrevented=!0},defaultPrevented:!1},this.props.onRoute(i),i.defaultPrevented))return[2];if(!this.isRelative(n)){if(!(r=this.convertToRelative(n)))return[2];n=r}return n.startsWith(\"#\")||(e.preventDefault(),this.route(n)),[2]}))}))},t.privateState=null,t}return __extends(t,e),t.prototype.route=function(e){var t;return this.routed=!0,\"function\"==typeof(null===(t=window.history)||void 0===t?void 0:t.pushState)?(history.pushState(null,\"\",e),this.updateLocationState(),!0):(location.href=e,!1)},t.prototype.updateLocationState=function(){this.privateState&&this.privateState.update((function(e){e.location=__assign(__assign({},e.location),{pathname:location.pathname,search:location.search,path:location.pathname.split(\"/\").slice(1),query:searchToObject(location)})}))},Object.defineProperty(t.prototype,\"model\",{get:function(){return this.props.model||\"page\"},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){\"undefined\"!=typeof document&&(document.addEventListener(\"click\",this.onClick),window.addEventListener(\"popstate\",this.onPopState),document.addEventListener(\"mouseover\",this.onMouseOverOrTouchStart),document.addEventListener(\"touchstart\",this.onMouseOverOrTouchStart))},t.prototype.componentWillUnmount=function(){\"undefined\"!=typeof document&&(document.removeEventListener(\"click\",this.onClick),document.removeEventListener(\"mouseover\",this.onMouseOverOrTouchStart),window.removeEventListener(\"popstate\",this.onPopState),document.removeEventListener(\"touchstart\",this.onMouseOverOrTouchStart))},t.prototype.render=function(){var e=this,t=this.model;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Consumer,null,(function(n){e.privateState=n;var i=n.state&&n.state.location&&n.state.location.pathname+n.state.location.search;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{className:\"builder-router\",\"data-model\":t},(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"style\",null,\"\\n                @keyframes builderLoadingSpinner {\\n                  0% {\\n                    transform: rotate(0deg);\\n                  }\\n                  100% {\\n                    transform: rotate(360deg);\\n                  }\\n                }\\n                /* TODO: overridable tag */\\n                .builder-page-loading {\\n                  -webkit-animation: builderLoadingSpinner 1s infinite linear;\\n                  animation: builderLoadingSpinner 1s infinite linear;\\n                  -webkit-transform: translateZ(0);\\n                  transform: translateZ(0);\\n                  border-radius: 50%;\\n                  width: 36px;\\n                  height: 36px;\\n                  margin: 6px auto;\\n                  position: relative;\\n                  border: 1px solid transparent;\\n                  border-left: 1px solid #808284;\\n                }\\n              \"),(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderComponent,{key:i,data:e.props.data,content:e.routed?void 0:e.props.content,modelName:t,options:{key:_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing?void 0:e.model+\":\"+i}},e.props.children||(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{css:{display:\"flex\"}},(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\",{css:{margin:\"40vh auto\"},className:\"builder-page-loading\"}))))}))},t.prototype.findHrefTarget=function(e){for(var t=e.target;t;){if(t instanceof HTMLAnchorElement&&t.getAttribute(\"href\"))return t;if(t===e.currentTarget)break;t=t.parentElement}return null},t.prototype.isRelative=function(e){return!e.match(/^(\\/\\/|https?:\\/\\/)/i)},t.prototype.parseUrl=function(e){var t=document.createElement(\"a\");return t.href=e,t},t.prototype.convertToRelative=function(e){var t=this.parseUrl(location.href),n=this.parseUrl(e);if(t.host===n.host){var i=n.pathname+(n.search?n.search:\"\");return i.startsWith(\"#\")?null:i||\"/\"}return null},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Router=withBuilder(RouterComponent,{name:\"Core:Router\",hideFromInsertMenu:!0,inputs:[{name:\"model\",type:\"string\",defaultValue:\"page\",advanced:!0},{name:\"handleRouting\",type:\"boolean\",defaultValue:!0,advanced:!0},{name:\"preloadOnHover\",type:\"boolean\",defaultValue:!0,advanced:!0},{name:\"onRoute\",type:\"function\",advanced:!0}]});function Mutation(e){var t,n,i=react__WEBPACK_IMPORTED_MODULE_2___default().useRef(null);useWaitForSelector(e.selector,(function(t){\"afterEnd\"!==e.type&&(t.innerHTML=\"\"),t.appendChild(i.current.firstElementChild)}));var r=null===(t=e.builderBlock)||void 0===t?void 0:t.children;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"span\",{style:{display:\"none\"},ref:i},(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlocks,{style:{display:\"inline\"},child:!0,parentElementId:null===(n=e.builderBlock)||void 0===n?void 0:n.id,dataPath:\"this.children\",blocks:r}))}function useWaitForSelector(e,t){react__WEBPACK_IMPORTED_MODULE_2___default().useLayoutEffect((function(){try{var n=document.querySelector(e);if(n)return void t(n)}catch(e){console.warn(e)}var i=new MutationObserver((function(){try{var n=document.querySelector(e);n&&(i.disconnect(),t(n))}catch(e){console.warn(e)}}));return i.observe(document.body,{attributes:!0,subtree:!0,characterData:!0}),function(){i.disconnect()}}),[e])}_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.registerComponent(Mutation,{name:\"Builder:Mutation\",canHaveChildren:!0,noWrap:!0,hideFromInsertMenu:!0,inputs:[{name:\"type\",type:\"string\",defaultValue:\"replace\",enum:[{label:\"Replace\",value:\"replace\",helperText:\"Replace the contents of this site region with content from Builder\"},{label:\"Append\",value:\"afterEnd\",helperText:\"Append Builder content after the chosen site region\"}]},{name:\"selector\",type:\"builder:domSelector\"}]});var get=function(e,t,n){var i=String.prototype.split.call(t,/[,[\\].]+?/).filter(Boolean).reduce((function(e,t){return null!=e?e[t]:e}),e);return void 0===i||i===e?n:i},MULTIPART_CONTENT_TYPE=\"multipart/form-data\",JSON_CONTENT_TYPE=\"application/json\",ENCODED_CONTENT_TYPE=\"application/x-www-form-urlencoded\",FormComponent=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=null,t.state={state:\"unsubmitted\",responseData:null,formErrorMessage:\"\"},t}return __extends(t,e),Object.defineProperty(t.prototype,\"submissionState\",{get:function(){return _builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&this.props.previewState||this.state.state},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this;return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Consumer,null,(function(t){return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderStoreContext.Provider,{value:__assign(__assign({},t),{state:__assign(__assign({},t.state),{formErrorMessage:e.state.formErrorMessage})})},(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"form\",__assign({validate:e.props.validate,ref:function(t){return e.ref=t},action:!e.props.sendWithJs&&e.props.action,method:e.props.method,name:e.props.name,onSubmit:function(t){var n,i=e.props.sendWithJs||\"email\"===e.props.sendSubmissionsTo;if(\"zapier\"===e.props.sendSubmissionsTo)t.preventDefault();else if(i){if(!e.props.action&&\"email\"!==e.props.sendSubmissionsTo)return void t.preventDefault();t.preventDefault();var r=t.currentTarget,o=e.props.customHeaders||{},a=void 0,s=new FormData(r),l=Array.from(t.currentTarget.querySelectorAll(\"input,select,textarea\")).filter((function(e){return!!e.name})).map((function(e){var t,n=e.name;if(e instanceof HTMLInputElement)if(\"radio\"===e.type){if(e.checked)return{key:n,value:t=e.name}}else if(\"checkbox\"===e.type)t=e.checked;else if(\"number\"===e.type||\"range\"===e.type){var i=e.valueAsNumber;isNaN(i)||(t=i)}else t=\"file\"===e.type?e.files:e.value;else t=e.value;return{key:n,value:t}})),u=e.props.contentType;if(\"email\"===e.props.sendSubmissionsTo&&(u=MULTIPART_CONTENT_TYPE),Array.from(l).forEach((function(e){var t=e.value;(t instanceof File||Array.isArray(t)&&t[0]instanceof File||t instanceof FileList)&&(u=MULTIPART_CONTENT_TYPE)})),u===MULTIPART_CONTENT_TYPE)a=s;else if(u===JSON_CONTENT_TYPE){var d={};Array.from(l).forEach((function(e){var t=e.value,n=e.key;set(d,n,t)})),a=JSON.stringify(d)}else{if(u!==ENCODED_CONTENT_TYPE)return void console.error(\"Unsupported content type: \",u);a=Array.from(l).map((function(e){var t=e.value,n=e.key;return encodeURIComponent(n)+\"=\"+encodeURIComponent(t)})).join(\"&\")}u&&u!==MULTIPART_CONTENT_TYPE&&(i&&(null===(n=e.props.action)||void 0===n?void 0:n.includes(\"zapier.com\"))||(o[\"content-type\"]=u));var c=new CustomEvent(\"presubmit\",{detail:{body:a}});if(e.ref&&(e.ref.dispatchEvent(c),c.defaultPrevented))return;e.setState(__assign(__assign({},e.state),{state:\"sending\"}));var p=\"\".concat(\"dev\"===_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.env?\"http://localhost:5000\":\"https://builder.io\",\"/api/v1/form-submit?apiKey=\").concat(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.builder.apiKey,\"&to=\").concat(btoa(e.props.sendSubmissionsToEmail||\"\"),\"&name=\").concat(encodeURIComponent(e.props.name||\"\"));fetch(\"email\"===e.props.sendSubmissionsTo?p:e.props.action,{body:a,headers:o,method:e.props.method||\"post\"}).then((function(t){return __awaiter(e,void 0,void 0,(function(){var e,n,i,r,o;return __generator(this,(function(a){switch(a.label){case 0:return(n=t.headers.get(\"content-type\"))&&-1!==n.indexOf(JSON_CONTENT_TYPE)?[4,t.json()]:[3,2];case 1:return e=a.sent(),[3,4];case 2:return[4,t.text()];case 3:e=a.sent(),a.label=4;case 4:if(!t.ok&&this.props.errorMessagePath&&(i=get(e,this.props.errorMessagePath))&&(\"string\"!=typeof i&&(i=JSON.stringify(i)),this.setState(__assign(__assign({},this.state),{formErrorMessage:i}))),this.setState(__assign(__assign({},this.state),{responseData:e,state:t.ok?\"success\":\"error\"})),t.ok){if(r=new CustomEvent(\"submit:success\",{detail:{res:t,body:e}}),this.ref){if(this.ref.dispatchEvent(r),r.defaultPrevented)return[2];!1!==this.props.resetFormOnSubmit&&this.ref.reset()}this.props.successUrl&&(this.ref?(o=new CustomEvent(\"route\",{detail:{url:this.props.successUrl}}),this.ref.dispatchEvent(o),o.defaultPrevented||(location.href=this.props.successUrl)):location.href=this.props.successUrl)}return[2]}}))}))}),(function(t){var n=new CustomEvent(\"submit:error\",{detail:{error:t}});e.ref&&(e.ref.dispatchEvent(n),n.defaultPrevented)||e.setState(__assign(__assign({},e.state),{responseData:t,state:\"error\"}))}))}}},e.props.attributes),e.props.builderBlock&&e.props.builderBlock.children&&e.props.builderBlock.children.map((function(e,t){return (0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlock$1,{key:e.id,block:e})})),\"error\"===e.submissionState&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlocks,{dataPath:\"errorMessage\",blocks:e.props.errorMessage}),\"sending\"===e.submissionState&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlocks,{dataPath:\"sendingMessage\",blocks:e.props.sendingMessage}),\"error\"===e.submissionState&&e.state.responseData&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"pre\",{className:\"builder-form-error-text\",css:{padding:10,color:\"red\",textAlign:\"center\"}},JSON.stringify(e.state.responseData,null,2)),\"success\"===e.submissionState&&(0,_emotion_core__WEBPACK_IMPORTED_MODULE_1__.jsx)(BuilderBlocks,{dataPath:\"successMessage\",blocks:e.props.successMessage})))}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Form=withBuilder(FormComponent,{name:\"Form:Form\",defaults:{responsiveStyles:{large:{marginTop:\"15px\",paddingBottom:\"15px\"}}},image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fef36d2a846134910b64b88e6d18c5ca5\",inputs:[{name:\"sendSubmissionsTo\",type:\"string\",enum:[{label:\"Send to email\",value:\"email\",helperText:\"Send form submissions to the email address of your choosing\"},{label:\"Custom\",value:\"custom\",helperText:\"Handle where the form requests go manually with a little code, e.g. to your own custom backend\"}],defaultValue:\"email\"},{name:\"sendSubmissionsToEmail\",type:\"string\",required:!0,defaultValue:\"your@email.com\",showIf:'options.get(\"sendSubmissionsTo\") === \"email\"'},{name:\"sendWithJs\",type:\"boolean\",helperText:\"Set to false to use basic html form action\",defaultValue:!0,showIf:'options.get(\"sendSubmissionsTo\") === \"custom\"'},{name:\"name\",type:\"string\",defaultValue:\"My form\"},{name:\"action\",type:\"string\",helperText:\"URL to send the form data to\",showIf:'options.get(\"sendSubmissionsTo\") === \"custom\"'},{name:\"contentType\",type:\"string\",defaultValue:JSON_CONTENT_TYPE,advanced:!0,enum:[JSON_CONTENT_TYPE,MULTIPART_CONTENT_TYPE,ENCODED_CONTENT_TYPE],showIf:'options.get(\"sendSubmissionsTo\") === \"custom\" && options.get(\"sendWithJs\") === true'},{name:\"method\",type:\"string\",showIf:'options.get(\"sendSubmissionsTo\") === \"custom\"',defaultValue:\"POST\",advanced:!0},{name:\"previewState\",type:\"string\",enum:[\"unsubmitted\",\"sending\",\"success\",\"error\"],defaultValue:\"unsubmitted\",helperText:'Choose a state to edit, e.g. choose \"success\" to show what users see on success and edit the message',showIf:'options.get(\"sendSubmissionsTo\") !== \"zapier\" && options.get(\"sendWithJs\") === true'},{name:\"successUrl\",type:\"url\",helperText:\"Optional URL to redirect the user to on form submission success\",showIf:'options.get(\"sendSubmissionsTo\") !== \"zapier\" && options.get(\"sendWithJs\") === true'},{name:\"resetFormOnSubmit\",type:\"boolean\",showIf:function(e){return\"custom\"===e.get(\"sendSubmissionsTo\")&&!0===e.get(\"sendWithJs\")},advanced:!0},{name:\"successMessage\",type:\"uiBlocks\",hideFromUI:!0,defaultValue:[{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},component:{name:\"Text\",options:{text:\"<span>Thanks!</span>\"}}}]},{name:\"validate\",type:\"boolean\",defaultValue:!0,advanced:!0},{name:\"errorMessagePath\",type:\"text\",advanced:!0,helperText:'Path to where to get the error message from in a JSON response to display to the user, e.g. \"error.message\" for a response like { \"error\": { \"message\": \"this username is taken\" }}'},{name:\"errorMessage\",type:\"uiBlocks\",hideFromUI:!0,defaultValue:[{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},bindings:{\"component.options.text\":\"state.formErrorMessage || block.component.options.text\"},component:{name:\"Text\",options:{text:\"<span>Form submission error :( Please check your answers and try again</span>\"}}}]},{name:\"sendingMessage\",type:\"uiBlocks\",hideFromUI:!0,defaultValue:[{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},component:{name:\"Text\",options:{text:\"<span>Sending...</span>\"}}}]},__assign(__assign({name:\"customHeaders\",type:\"map\"},{valueType:{type:\"string\"}}),{advanced:!0,showIf:'options.get(\"sendSubmissionsTo\") === \"custom\" && options.get(\"sendWithJs\") === true'})],noWrap:!0,canHaveChildren:!0,defaultChildren:[{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},component:{name:\"Text\",options:{text:\"<span>Enter your name</span>\"}}},{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},component:{name:\"Form:Input\",options:{name:\"name\",placeholder:\"Jane Doe\"}}},{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},component:{name:\"Text\",options:{text:\"<span>Enter your email</span>\"}}},{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},component:{name:\"Form:Input\",options:{name:\"email\",placeholder:\"jane@doe.com\"}}},{\"@type\":\"@builder.io/sdk:Element\",responsiveStyles:{large:{marginTop:\"10px\"}},component:{name:\"Form:SubmitButton\",options:{text:\"Submit\"}}}]}),FormInputComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"input\",__assign({key:_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&this.props.defaultValue?this.props.defaultValue:\"default-key\",placeholder:this.props.placeholder,type:this.props.type,name:this.props.name,value:this.props.value,defaultValue:this.props.defaultValue,required:this.props.required},this.props.attributes))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),FormInput=withBuilder(FormInputComponent,{name:\"Form:Input\",image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fad6f37889d9e40bbbbc72cdb5875d6ca\",inputs:[{name:\"type\",type:\"text\",enum:[\"text\",\"number\",\"email\",\"url\",\"checkbox\",\"radio\",\"range\",\"date\",\"datetime-local\",\"search\",\"tel\",\"time\",\"file\",\"month\",\"week\",\"password\",\"color\",\"hidden\"],defaultValue:\"text\"},{name:\"name\",type:\"string\",required:!0,helperText:'Every input in a form needs a unique name describing what it takes, e.g. \"email\"'},{name:\"placeholder\",type:\"string\",defaultValue:\"Hello there\",helperText:\"Text to display when there is no value\"},{name:\"defaultValue\",type:\"string\"},{name:\"value\",type:\"string\",advanced:!0},{name:\"required\",type:\"boolean\",helperText:\"Is this input required to be filled out to submit a form\",defaultValue:!1}],noWrap:!0,static:!0,defaultStyles:{paddingTop:\"10px\",paddingBottom:\"10px\",paddingLeft:\"10px\",paddingRight:\"10px\",borderRadius:\"3px\",borderWidth:\"1px\",borderStyle:\"solid\",borderColor:\"#ccc\"}}),FormSubmitButtonComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"button\",__assign({type:\"submit\"},this.props.attributes),this.props.text)},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),FormSubmitButton=withBuilder(FormSubmitButtonComponent,{name:\"Form:SubmitButton\",image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fdf2820ffed1f4349a94c40b3221f5b98\",defaultStyles:{appearance:\"none\",paddingTop:\"15px\",paddingBottom:\"15px\",paddingLeft:\"25px\",paddingRight:\"25px\",backgroundColor:\"#3898EC\",color:\"white\",borderRadius:\"4px\",cursor:\"pointer\"},inputs:[{name:\"text\",type:\"text\",defaultValue:\"Click me\"}],static:!0,noWrap:!0}),LabelComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"label\",__assign({htmlFor:this.props.for},this.props.attributes),this.props.text&&react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"span\",{className:\"builder-label-text\",dangerouslySetInnerHTML:{__html:this.props.text}}),this.props.builderBlock&&this.props.builderBlock.children&&this.props.builderBlock.children.map((function(e){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(BuilderBlock$1,{key:e.id,block:e})})))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Label=withBuilder(LabelComponent,{name:\"Form:Label\",image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F9322342f04b545fb9a8091cd801dfb5b\",inputs:[{name:\"text\",type:\"html\",richText:!0,defaultValue:\"Label\"},{name:\"for\",type:\"text\",helperText:\"The name of the input this label is for\",advanced:!0}],noWrap:!0,static:!0,canHaveChildren:!0}),FormSelectComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props.options;return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"select\",__assign({value:this.props.value,key:_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing&&this.props.defaultValue?this.props.defaultValue:\"default-key\",defaultValue:this.props.defaultValue,name:this.props.name},this.props.attributes),e&&e.map((function(e){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"option\",{value:e.value},e.name||e.value)})))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),FormSelect=withBuilder(FormSelectComponent,{name:\"Form:Select\",image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F83acca093fb24aaf94dee136e9a4b045\",defaultStyles:{alignSelf:\"flex-start\"},inputs:[{name:\"options\",type:\"list\",required:!0,subFields:[{name:\"value\",type:\"text\",required:!0},{name:\"name\",type:\"text\"}],defaultValue:[{value:\"option 1\"},{value:\"option 2\"}]},{name:\"name\",type:\"string\",required:!0,helperText:'Every select in a form needs a unique name describing what it gets, e.g. \"email\"'},{name:\"defaultValue\",type:\"string\"},{name:\"value\",type:\"string\",advanced:!0},{name:\"required\",type:\"boolean\",defaultValue:!1}],static:!0,noWrap:!0}),TextAreaComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"textarea\",__assign({placeholder:this.props.placeholder,name:this.props.name,value:this.props.value,defaultValue:this.props.defaultValue},this.props.attributes))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),TextArea=withBuilder(TextAreaComponent,{name:\"Form:TextArea\",image:\"https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Ff74a2f3de58c4c3e939204e5b6b8f6c3\",inputs:[{advanced:!0,name:\"value\",type:\"string\"},{name:\"name\",type:\"string\",required:!0,helperText:'Every input in a form needs a unique name describing what it gets, e.g. \"email\"'},{name:\"defaultValue\",type:\"string\"},{name:\"placeholder\",type:\"string\",defaultValue:\"Hello there\"},{name:\"required\",type:\"boolean\",defaultValue:!1}],defaultStyles:{paddingTop:\"10px\",paddingBottom:\"10px\",paddingLeft:\"10px\",paddingRight:\"10px\",borderRadius:\"3px\",borderWidth:\"1px\",borderStyle:\"solid\",borderColor:\"#ccc\"},static:!0,noWrap:!0}),ImgComponent=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props.attributes||{};return react__WEBPACK_IMPORTED_MODULE_2___default().createElement(\"img\",__assign({},this.props.attributes,{src:this.props.image||e.src}))},t}((react__WEBPACK_IMPORTED_MODULE_2___default().Component)),Img=withBuilder(ImgComponent,{name:\"Raw:Img\",hideFromInsertMenu:!0,image:\"https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-insert_photo-24px.svg?alt=media&token=4e5d0ef4-f5e8-4e57-b3a9-38d63a9b9dc4\",inputs:[{name:\"image\",bubble:!0,type:\"file\",allowedFileTypes:[\"jpeg\",\"jpg\",\"png\",\"svg\"],required:!0}],noWrap:!0,static:!0}),RawText=function(e){var t=e.attributes||{};return react__WEBPACK_IMPORTED_MODULE_2__.createElement(\"span\",{className:(null==t?void 0:t.class)||(null==t?void 0:t.className),dangerouslySetInnerHTML:{__html:e.text||\"\"}})};function useIsPreviewing(){var e=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1),t=e[0],n=e[1];return (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)((function(){(_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isEditing||_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isPreviewing)&&n(!0)}),[]),t}_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.registerComponent(RawText,{name:\"Builder:RawText\",hideFromInsertMenu:!0,inputs:[{name:\"text\",bubble:!0,type:\"longText\",required:!0}]}),_builder_io_sdk__WEBPACK_IMPORTED_MODULE_0__.Builder.isReact=!0;\n//# sourceMappingURL=builder-react.es5.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGJ1aWxkZXIuaW8vcmVhY3QvZGlzdC9idWlsZGVyLXJlYWN0LmVzNS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBZ1YsdUJBQXVCLHFGQUFxRixnQ0FBZ0MsK0dBQStHLE9BQU8sZ0NBQWdDLDZDQUE2QyxhQUFhLGdDQUFnQyxjQUFjLGdCQUFnQixzRUFBc0UsUUFBUSx3QkFBd0Isd0hBQXdILGFBQWEsbUJBQW1CLHlGQUF5Rix3QkFBd0IsMkNBQTJDLGlDQUFpQyxJQUFJLHVGQUF1RixTQUFTLHlCQUF5QixxQkFBcUIsU0FBUyxzRkFBc0YsNkRBQTZELFFBQVEsc0NBQXNDLFdBQVcsNkZBQTZGLFNBQVMsNkJBQTZCLG1GQUFtRiw2RkFBNkYsMEJBQTBCLEtBQUssb0RBQW9ELDhDQUE4Qyx5QkFBeUIsOEZBQThGLDRCQUE0QiwwQ0FBMEMsY0FBYyxJQUFJLGFBQWEsU0FBUyxNQUFNLGNBQWMsSUFBSSxjQUFjLFNBQVMsTUFBTSxjQUFjLE1BQU0saUVBQWlFLEtBQUssY0FBYywrQkFBK0IsR0FBRywwQkFBMEIsZUFBZSx3QkFBd0IscUJBQXFCLFlBQVksaUJBQWlCLFVBQVUsaUNBQWlDLDJEQUEyRCxZQUFZLElBQUksY0FBYyxtQkFBbUIsbUJBQW1CLDREQUE0RCxLQUFLLHVCQUF1QixLQUFLLGtIQUFrSCx5Q0FBeUMsa0JBQWtCLE1BQU0seUJBQXlCLG9CQUFvQiw4QkFBOEIsU0FBUyxrQ0FBa0MsU0FBUywwRUFBMEUsSUFBSSxTQUFTLHlDQUF5QyxhQUFhLE1BQU0sMkJBQTJCLGlCQUFpQixNQUFNLG9CQUFvQiwyQkFBMkIsTUFBTSwrQkFBK0IsU0FBUyxjQUFjLFNBQVMsWUFBWSxRQUFRLE1BQU0scUJBQXFCLE9BQU8sZ0NBQWdDLFVBQVUsOEJBQThCLG9EQUFvRCxJQUFJLHFFQUFxRSxrREFBa0Qsb0RBQW9ELDBCQUEwQixxQ0FBcUMs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QixvREFBTyxvSUFBb0ksOENBQThDLE9BQU8sMERBQTRCLFdBQVcsY0FBYyxrQkFBa0IsSUFBSSxHQUFHLENBQUMsd0RBQXdCLDhDQUE4Qyx1SkFBdUosdUJBQXVCLFVBQVUsbURBQW1ELHFDQUFxQyxFQUFFLHdCQUF3QixpQkFBaUIsaUJBQWlCLEVBQUUsaUJBQWlCLEVBQUUsRUFBRSxvSUFBb0ksRUFBRSxrQ0FBa0MsRUFBRSx1Q0FBdUMsRUFBRSwrQ0FBK0Msc0JBQXNCLGdDQUFnQyxhQUFhLCtDQUErQyxvREFBb0QsT0FBTywwREFBNEIsc0JBQXNCLG9IQUFvSCx5QkFBeUIsR0FBRyxDQUFDLHdEQUF3QiwwQ0FBMEMsbUpBQW1KLHVDQUF1QyxFQUFFLG1JQUFtSSxFQUFFLGtDQUFrQyxFQUFFLDREQUE0RCxFQUFFLCtDQUErQyxpQkFBaUIsMEpBQTBKLHFCQUFxQiwyQkFBMkIsYUFBYSwrQ0FBK0Msb0RBQW9ELGdDQUFnQyxPQUFPLDBEQUE0QixrQkFBa0Isd0JBQXdCLDRCQUE0QixHQUFHLEdBQUcsQ0FBQyx3REFBd0IsZ0NBQWdDLDJOQUEyTiwyRkFBMkYsc0JBQXNCLHNCQUFzQix1QkFBdUIsT0FBTyxnREFBbUIsU0FBUywwRkFBMEYsbUJBQW1CLEdBQUcsMkJBQTJCLE1BQU0sK0NBQVEsbUJBQW1CLE9BQU8sZ0RBQVMsYUFBYSxDQUFDLG9EQUFPLFlBQVksb0RBQU8sc0JBQXNCLFFBQVEsb0RBQU8sNEJBQTRCLHNEQUFzRCxrREFBa0QsRUFBRSxFQUFFLG9EQUFPLFlBQW1pQjtBQUM3L3FIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYnVpbGRlci1hcHAvLi9ub2RlX21vZHVsZXMvQGJ1aWxkZXIuaW8vcmVhY3QvZGlzdC9idWlsZGVyLXJlYWN0LmVzNS5qcz83NTAyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydHtCdWlsZGVyLGJ1aWxkZXIsU3Vic2NyaXB0aW9uLEJlaGF2aW9yU3ViamVjdH1mcm9tXCJAYnVpbGRlci5pby9zZGtcIjtleHBvcnR7QnVpbGRlcixidWlsZGVyLGJ1aWxkZXIgYXMgZGVmYXVsdH1mcm9tXCJAYnVpbGRlci5pby9zZGtcIjtpbXBvcnR7anN4LENsYXNzTmFtZXMsY3NzfWZyb21cIkBlbW90aW9uL2NvcmVcIjtpbXBvcnQqYXMgUmVhY3QgZnJvbVwicmVhY3RcIjtpbXBvcnQgUmVhY3RfX2RlZmF1bHQse3VzZUNvbnRleHQsdXNlU3RhdGUsdXNlRWZmZWN0fWZyb21cInJlYWN0XCI7aW1wb3J0IFJlYWN0RE9NIGZyb21cInJlYWN0LWRvbVwiO2ltcG9ydCBoYXNoIGZyb21cImhhc2gtc3VtXCI7dmFyIHZlcnNpb249XCIzLjIuNlwiLF9hO1widW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJihudWxsPT09KF9hPXdpbmRvdy5wYXJlbnQpfHx2b2lkIDA9PT1fYXx8X2EucG9zdE1lc3NhZ2Uoe3R5cGU6XCJidWlsZGVyLmlzUmVhY3RTZGtcIixkYXRhOnt2YWx1ZTohMCxzdXBwb3J0c1BhdGNoVXBkYXRlczpcInY0XCIsc3VwcG9ydHNDdXN0b21CcmVha3BvaW50czohMCxzdXBwb3J0c0dsb2JhbFN5bWJvbHM6ITAscHJpb3JWZXJzaW9uOnZlcnNpb259fSxcIipcIikpO3ZhciBleHRlbmRTdGF0aWNzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuKGV4dGVuZFN0YXRpY3M9T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGUsdCl7ZS5fX3Byb3RvX189dH18fGZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuIGluIHQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsbikmJihlW25dPXRbbl0pfSkoZSx0KX07ZnVuY3Rpb24gX19leHRlbmRzKGUsdCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIrU3RyaW5nKHQpK1wiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9ZX1leHRlbmRTdGF0aWNzKGUsdCksZS5wcm90b3R5cGU9bnVsbD09PXQ/T2JqZWN0LmNyZWF0ZSh0KToobi5wcm90b3R5cGU9dC5wcm90b3R5cGUsbmV3IG4pfXZhciBfX2Fzc2lnbj1mdW5jdGlvbigpe3JldHVybihfX2Fzc2lnbj1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHQsbj0xLGk9YXJndW1lbnRzLmxlbmd0aDtuPGk7bisrKWZvcih2YXIgciBpbiB0PWFyZ3VtZW50c1tuXSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxyKSYmKGVbcl09dFtyXSk7cmV0dXJuIGV9KS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2Z1bmN0aW9uIF9fcmVzdChlLHQpe3ZhciBuPXt9O2Zvcih2YXIgaSBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLGkpJiZ0LmluZGV4T2YoaSk8MCYmKG5baV09ZVtpXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3IoaT1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8aS5sZW5ndGg7cisrKXQuaW5kZXhPZihpW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxpW3JdKSYmKG5baVtyXV09ZVtpW3JdXSl9cmV0dXJuIG59ZnVuY3Rpb24gX19kZWNvcmF0ZShlLHQsbixpKXt2YXIgcixvPWFyZ3VtZW50cy5sZW5ndGgsYT1vPDM/dDpudWxsPT09aT9pPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCxuKTppO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBSZWZsZWN0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBSZWZsZWN0LmRlY29yYXRlKWE9UmVmbGVjdC5kZWNvcmF0ZShlLHQsbixpKTtlbHNlIGZvcih2YXIgcz1lLmxlbmd0aC0xO3M+PTA7cy0tKShyPWVbc10pJiYoYT0obzwzP3IoYSk6bz4zP3IodCxuLGEpOnIodCxuKSl8fGEpO3JldHVybiBvPjMmJmEmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LG4sYSksYX1mdW5jdGlvbiBfX21ldGFkYXRhKGUsdCl7aWYoXCJvYmplY3RcIj09dHlwZW9mIFJlZmxlY3QmJlwiZnVuY3Rpb25cIj09dHlwZW9mIFJlZmxlY3QubWV0YWRhdGEpcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoZSx0KX1mdW5jdGlvbiBfX2F3YWl0ZXIoZSx0LG4saSl7cmV0dXJuIG5ldyhufHwobj1Qcm9taXNlKSkoKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7bChpLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2woaS50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gbChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBuP3Q6bmV3IG4oKGZ1bmN0aW9uKGUpe2UodCl9KSkpLnRoZW4oYSxzKX1sKChpPWkuYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KSl9ZnVuY3Rpb24gX19nZW5lcmF0b3IoZSx0KXt2YXIgbixpLHIsbyxhPXtsYWJlbDowLHNlbnQ6ZnVuY3Rpb24oKXtpZigxJnJbMF0pdGhyb3cgclsxXTtyZXR1cm4gclsxXX0sdHJ5czpbXSxvcHM6W119O3JldHVybiBvPXtuZXh0OnMoMCksdGhyb3c6cygxKSxyZXR1cm46cygyKX0sXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiYob1tTeW1ib2wuaXRlcmF0b3JdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KSxvO2Z1bmN0aW9uIHMocyl7cmV0dXJuIGZ1bmN0aW9uKGwpe3JldHVybiBmdW5jdGlvbihzKXtpZihuKXRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO2Zvcig7byYmKG89MCxzWzBdJiYoYT0wKSksYTspdHJ5e2lmKG49MSxpJiYocj0yJnNbMF0/aS5yZXR1cm46c1swXT9pLnRocm93fHwoKHI9aS5yZXR1cm4pJiZyLmNhbGwoaSksMCk6aS5uZXh0KSYmIShyPXIuY2FsbChpLHNbMV0pKS5kb25lKXJldHVybiByO3N3aXRjaChpPTAsciYmKHM9WzImc1swXSxyLnZhbHVlXSksc1swXSl7Y2FzZSAwOmNhc2UgMTpyPXM7YnJlYWs7Y2FzZSA0OnJldHVybiBhLmxhYmVsKysse3ZhbHVlOnNbMV0sZG9uZTohMX07Y2FzZSA1OmEubGFiZWwrKyxpPXNbMV0scz1bMF07Y29udGludWU7Y2FzZSA3OnM9YS5vcHMucG9wKCksYS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShyPWEudHJ5cywocj1yLmxlbmd0aD4wJiZyW3IubGVuZ3RoLTFdKXx8NiE9PXNbMF0mJjIhPT1zWzBdKSl7YT0wO2NvbnRpbnVlfWlmKDM9PT1zWzBdJiYoIXJ8fHNbMV0+clswXSYmc1sxXTxyWzNdKSl7YS5sYWJlbD1zWzFdO2JyZWFrfWlmKDY9PT1zWzBdJiZhLmxhYmVsPHJbMV0pe2EubGFiZWw9clsxXSxyPXM7YnJlYWt9aWYociYmYS5sYWJlbDxyWzJdKXthLmxhYmVsPXJbMl0sYS5vcHMucHVzaChzKTticmVha31yWzJdJiZhLm9wcy5wb3AoKSxhLnRyeXMucG9wKCk7Y29udGludWV9cz10LmNhbGwoZSxhKX1jYXRjaChlKXtzPVs2LGVdLGk9MH1maW5hbGx5e249cj0wfWlmKDUmc1swXSl0aHJvdyBzWzFdO3JldHVybnt2YWx1ZTpzWzBdP3NbMV06dm9pZCAwLGRvbmU6ITB9fShbcyxsXSl9fX1mdW5jdGlvbiBfX3NwcmVhZEFycmF5KGUsdCxuKXtpZihufHwyPT09YXJndW1lbnRzLmxlbmd0aClmb3IodmFyIGkscj0wLG89dC5sZW5ndGg7cjxvO3IrKykhaSYmciBpbiB0fHwoaXx8KGk9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodCwwLHIpKSxpW3JdPXRbcl0pO3JldHVybiBlLmNvbmNhdChpfHxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KSl9XCJmdW5jdGlvblwiPT10eXBlb2YgU3VwcHJlc3NlZEVycm9yJiZTdXBwcmVzc2VkRXJyb3I7dmFyIGZhc3RDbG9uZT1mdW5jdGlvbihlKXtyZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlKSl9LG9taXQkMj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9W10sbj0xO248YXJndW1lbnRzLmxlbmd0aDtuKyspdFtuLTFdPWFyZ3VtZW50c1tuXTtmb3IodmFyIGk9T2JqZWN0LmFzc2lnbih7fSxlKSxyPTAsbz10O3I8by5sZW5ndGg7cisrKXt2YXIgYT1vW3JdO2RlbGV0ZSBpW2FdfXJldHVybiBpfSxzaXplTmFtZXM9W1wieHNtYWxsXCIsXCJzbWFsbFwiLFwibWVkaXVtXCIsXCJsYXJnZVwiXSxzaXplcz17eHNtYWxsOnttaW46MCxkZWZhdWx0OjAsbWF4OjB9LHNtYWxsOnttaW46MzIwLGRlZmF1bHQ6MzIxLG1heDo2NDB9LG1lZGl1bTp7bWluOjY0MSxkZWZhdWx0OjY0MixtYXg6OTkxfSxsYXJnZTp7bWluOjk5MCxkZWZhdWx0Ojk5MSxtYXg6MTIwMH0sZ2V0V2lkdGhGb3JTaXplOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzW2VdLmRlZmF1bHR9LGdldFNpemVGb3JXaWR0aDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9MCxuPXNpemVOYW1lczt0PG4ubGVuZ3RoO3QrKyl7dmFyIGk9blt0XTtpZihlPD10aGlzW2ldLm1heClyZXR1cm4gaX1yZXR1cm5cImxhcmdlXCJ9fSxnZXRTaXplc0ZvckJyZWFrcG9pbnRzPWZ1bmN0aW9uKGUpe3ZhciB0PWUuc21hbGwsbj1lLm1lZGl1bSxpPV9fYXNzaWduKF9fYXNzaWduKHt9LHNpemVzKSxmYXN0Q2xvbmUoc2l6ZXMpKTtpZighdHx8IW4pcmV0dXJuIGk7dmFyIHI9TWF0aC5mbG9vcih0LzIpO2kuc21hbGw9e21heDp0LG1pbjpyLGRlZmF1bHQ6cisxfTt2YXIgbz1pLnNtYWxsLm1heCsxO2kubWVkaXVtPXttYXg6bixtaW46byxkZWZhdWx0Om8rMX07dmFyIGE9aS5tZWRpdW0ubWF4KzE7cmV0dXJuIGkubGFyZ2U9e21heDoyZTMsbWluOmEsZGVmYXVsdDphKzF9LGl9LHNldD1mdW5jdGlvbihlLHQsbil7aWYoT2JqZWN0KGUpIT09ZSlyZXR1cm4gZTt2YXIgaT1BcnJheS5pc0FycmF5KHQpP3Q6dC50b1N0cmluZygpLm1hdGNoKC9bXi5bXFxdXSsvZyk7cmV0dXJuIGkuc2xpY2UoMCwtMSkucmVkdWNlKChmdW5jdGlvbihlLHQsbil7cmV0dXJuIE9iamVjdChlW3RdKT09PWVbdF0/ZVt0XTplW3RdPU1hdGguYWJzKE51bWJlcihpW24rMV0pKT4+MD09K2lbbisxXT9bXTp7fX0pLGUpW2lbaS5sZW5ndGgtMV1dPW4sZX0sbm9vcD1mdW5jdGlvbigpe3JldHVybiBudWxsfSxzYWZlRHluYW1pY1JlcXVpcmU7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09PWdsb2JhbFRoaXN8fHZvaWQgMD09PWdsb2JhbFRoaXM/dm9pZCAwOmdsb2JhbFRoaXMucmVxdWlyZSl8fEJ1aWxkZXIuaXNTZXJ2ZXImJlwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUpdHJ5e3NhZmVEeW5hbWljUmVxdWlyZT1ldmFsKFwicmVxdWlyZVwiKX1jYXRjaChlKXtzYWZlRHluYW1pY1JlcXVpcmU9KG51bGw9PT1nbG9iYWxUaGlzfHx2b2lkIDA9PT1nbG9iYWxUaGlzP3ZvaWQgMDpnbG9iYWxUaGlzLnJlcXVpcmUpP2dsb2JhbFRoaXMucmVxdWlyZTpub29wfWZ1bmN0aW9uIGlzRGVidWcoKXtyZXR1cm4gQm9vbGVhbihcInVuZGVmaW5lZFwiIT10eXBlb2YgcHJvY2VzcyYmdm9pZCAwIT09cHJvY2Vzcy5lbnYmJnByb2Nlc3MuZW52LkRFQlVHKX1mdW5jdGlvbiBpc05vZGVSdW50aW1lKCl7dmFyIGU7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHByb2Nlc3MmJkJvb2xlYW4obnVsbD09PShlPW51bGw9PT1wcm9jZXNzfHx2b2lkIDA9PT1wcm9jZXNzP3ZvaWQgMDpwcm9jZXNzLnZlcnNpb25zKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5ub2RlKX1udWxsIT1zYWZlRHluYW1pY1JlcXVpcmV8fChzYWZlRHluYW1pY1JlcXVpcmU9bm9vcCk7dmFyIHNob3VsZEZvcmNlQnJvd3NlclJ1bnRpbWVJbk5vZGU9ZnVuY3Rpb24oKXt2YXIgZTtpZighaXNOb2RlUnVudGltZSgpKXJldHVybiExO3ZhciB0PVwiYXJtNjRcIj09PXByb2Nlc3MuYXJjaCxuPXByb2Nlc3MudmVyc2lvbi5zdGFydHNXaXRoKFwidjIwXCIpLGk9bnVsbD09PShlPXByb2Nlc3MuZW52Lk5PREVfT1BUSU9OUyl8fHZvaWQgMD09PWU/dm9pZCAwOmUuaW5jbHVkZXMoXCItLW5vLW5vZGUtc25hcHNob3RcIik7cmV0dXJuISghdHx8IW58fGkpJiYoY29uc29sZS5sb2coXCJTa2lwcGluZyB1c2FnZSBvZiBgaXNvbGF0ZWQtdm1gIHRvIGF2b2lkIGNyYXNoZXMgaW4gTm9kZSB2MjAgb24gYW4gYXJtNjQgbWFjaGluZS5cXG4gICAgSWYgeW91IHdvdWxkIGxpa2UgdG8gdXNlIHRoZSBgaXNvbGF0ZWQtdm1gIHBhY2thZ2Ugb24gdGhpcyBtYWNoaW5lLCBwbGVhc2UgcHJvdmlkZSB0aGUgYE5PREVfT1BUSU9OUz0tLW5vLW5vZGUtc25hcHNob3RgIGNvbmZpZyB0byB5b3VyIE5vZGUgcHJvY2Vzcy5cXG4gICAgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9CdWlsZGVySU8vYnVpbGRlci9ibG9iL21haW4vcGFja2FnZXMvcmVhY3QvUkVBRE1FLm1kI25vZGUtdjIwLS1tMS1tYWNzLWFwcGxlLXNpbGljb24tc3VwcG9ydCBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cXG4gICAgXCIpLCEwKX0sZm5DYWNoZT17fSxhcGk9ZnVuY3Rpb24oZSl7cmV0dXJuIGJ1aWxkZXJ9O2Z1bmN0aW9uIHN0cmluZ1RvRnVuY3Rpb24oZSx0LG4saSl7aWYodm9pZCAwPT09dCYmKHQ9ITApLCFlfHwhZS50cmltKCkpcmV0dXJuIGZ1bmN0aW9uKCl7fTt2YXIgcj1lK1wiOlwiK3Q7aWYoZm5DYWNoZVtyXSlyZXR1cm4gZm5DYWNoZVtyXTt2YXIgbz10JiYhKGUuaW5jbHVkZXMoXCI7XCIpfHxlLmluY2x1ZGVzKFwiIHJldHVybiBcIil8fGUudHJpbSgpLnN0YXJ0c1dpdGgoXCJyZXR1cm4gXCIpKXx8ZS50cmltKCkuc3RhcnRzV2l0aChcImJ1aWxkZXIucnVuXCIpLGE9ZnVuY3Rpb24oKXt9O3RyeXtCdWlsZGVyLmlzQnJvd3NlciYmKGE9bmV3IEZ1bmN0aW9uKFwic3RhdGVcIixcImV2ZW50XCIsXCJibG9ja1wiLFwiYnVpbGRlclwiLFwiRGV2aWNlXCIsXCJ1cGRhdGVcIixcIkJ1aWxkZXJcIixcImNvbnRleHRcIixcIlxcbiAgICAgICAgICB2YXIgbmFtZXMgPSBbXFxuICAgICAgICAgICAgJ3N0YXRlJyxcXG4gICAgICAgICAgICAnZXZlbnQnLFxcbiAgICAgICAgICAgICdibG9jaycsXFxuICAgICAgICAgICAgJ2J1aWxkZXInLFxcbiAgICAgICAgICAgICdEZXZpY2UnLFxcbiAgICAgICAgICAgICd1cGRhdGUnLFxcbiAgICAgICAgICAgICdCdWlsZGVyJyxcXG4gICAgICAgICAgICAnY29udGV4dCdcXG4gICAgICAgICAgXTtcXG4gICAgICAgICAgdmFyIHJvb3RTdGF0ZSA9IHN0YXRlO1xcbiAgICAgICAgICBpZiAodHlwZW9mIFByb3h5ICE9PSAndW5kZWZpbmVkJykge1xcbiAgICAgICAgICAgIHJvb3RTdGF0ZSA9IG5ldyBQcm94eShyb290U3RhdGUsIHtcXG4gICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKCkge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XFxuICAgICAgICAgICAgICB9LFxcbiAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHtcXG4gICAgICAgICAgICAgICAgaWYgKG5hbWVzLmluY2x1ZGVzKGtleSkpIHtcXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRba2V5XTtcXG4gICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICB9KTtcXG4gICAgICAgICAgfVxcbiAgICAgICAgICAvKiBBbGlhcyAqL1xcbiAgICAgICAgICB2YXIgY3R4ID0gY29udGV4dDtcXG4gICAgICAgICAgdmFyIGxvZyA9IGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7XFxuICAgICAgICAgIHdpdGggKHJvb3RTdGF0ZSkge1xcbiAgICAgICAgICAgIFwiLmNvbmNhdChvP1wicmV0dXJuIChcIi5jb25jYXQoZSxcIik7XCIpOmUsXCI7XFxuICAgICAgICAgIH1cXG4gICAgICAgIFwiKSkpfWNhdGNoKHQpe24mJm4ucHVzaCh0KTt2YXIgcz10JiZ0Lm1lc3NhZ2U7cyYmXCJzdHJpbmdcIj09dHlwZW9mIHMmJmkmJi0xPT09aS5pbmRleE9mKHMpJiZpLnB1c2gocyksQnVpbGRlci5pc0Jyb3dzZXImJmNvbnNvbGUud2FybihcIkZ1bmN0aW9uIGNvbXBpbGUgZXJyb3IgaW4gXCIuY29uY2F0KGUpLHQpfXZhciBsPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PVtdLGk9MDtpPGFyZ3VtZW50cy5sZW5ndGg7aSsrKXRbaV09YXJndW1lbnRzW2ldO3RyeXtpZihCdWlsZGVyLmlzQnJvd3Nlcnx8c2hvdWxkRm9yY2VCcm93c2VyUnVudGltZUluTm9kZSgpKXJldHVybiBhLmFwcGx5KHZvaWQgMCx0KTt2YXIgcj1nZXRJc29sYXRlQ29udGV4dCgpLHM9c2FmZUR5bmFtaWNSZXF1aXJlKFwiaXNvbGF0ZWQtdm1cIiksbD1yLmV2YWxDbG9zdXJlU3luYyhtYWtlRm4oZSxvKSx0Lm1hcCgoZnVuY3Rpb24oZSx0KXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgZT9uZXcgcy5SZWZlcmVuY2UodD09PWluZGV4T2ZCdWlsZGVySW5zdGFuY2U/X19hc3NpZ24oX19hc3NpZ24oe30sZSkse2dldFVzZXJBdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0VXNlckF0dHJpYnV0ZXMoXCJcIil9fSk6ZSk6bnVsbH0pKSk7dHJ5e3ZhciB1PUpTT04ucGFyc2UobCk7cmV0dXJuIHV9Y2F0Y2goZSl7cmV0dXJuIGx9fWNhdGNoKHQpe3JldHVybiBCdWlsZGVyLmlzQnJvd3Nlcj9jb25zb2xlLndhcm4oXCJCdWlsZGVyIGN1c3RvbSBjb2RlIGVycm9yOlwiLHQubWVzc2FnZXx8dCxcImluXCIsZSx0LnN0YWNrfHx0KTppc0RlYnVnKCkmJmNvbnNvbGUuZGVidWcoXCJCdWlsZGVyIGN1c3RvbSBjb2RlIGVycm9yOlwiLHQubWVzc2FnZXx8dCxcImluXCIsZSx0LnN0YWNrfHx0KSxuJiZuLnB1c2godCksbnVsbH19O3JldHVybiBCdWlsZGVyLmlzQnJvd3NlciYmKGZuQ2FjaGVbcl09bCksbH12YXIgaW5kZXhPZkJ1aWxkZXJJbnN0YW5jZT0zLG1ha2VGbj1mdW5jdGlvbihlLHQsbil7dmFyIGk9bnx8W1wic3RhdGVcIixcImV2ZW50XCIsXCJibG9ja1wiLFwiYnVpbGRlclwiLFwiRGV2aWNlXCIsXCJ1cGRhdGVcIixcIkJ1aWxkZXJcIixcImNvbnRleHRcIl07cmV0dXJuXCJcXG5cIi5jb25jYXQoXCJcXG4gIHZhciByZWZUb1Byb3h5ID0gKG9iaikgPT4ge1xcbiAgICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgfHwgb2JqID09PSBudWxsKSB7XFxuICAgICAgcmV0dXJuIG9iajtcXG4gICAgfVxcbiAgICByZXR1cm4gbmV3IFByb3h5KHt9LCB7XFxuICAgICAgICBnZXQodGFyZ2V0LCBrZXkpIHtcXG4gICAgICAgICAgICBpZiAoa2V5ID09PSAnY29weVN5bmMnKSB7XFxuICAgICAgICAgICAgICByZXR1cm4gKCkgPT4gb2JqLmNvcHlTeW5jKCk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IG9iai5nZXRTeW5jKGtleSk7XFxuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWw/LmdldFN5bmMgPT09ICdmdW5jdGlvbicpIHtcXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlZlRvUHJveHkodmFsKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcXG4gICAgICAgIH0sXFxuICAgICAgICBzZXQodGFyZ2V0LCBrZXksIHZhbHVlKSB7XFxuICAgICAgICAgICAgb2JqLnNldFN5bmMoa2V5LCB2YWx1ZSk7XFxuICAgICAgICB9LFxcbiAgICAgICAgZGVsZXRlUHJvcGVydHkodGFyZ2V0LCBrZXkpIHtcXG4gICAgICAgICAgICBvYmouZGVsZXRlU3luYyhrZXkpO1xcbiAgICAgICAgfVxcbiAgICAgIH0pXFxuICB9XFxuXCIsXCJcXG5cIikuY29uY2F0KFwiXFxuICAgIHZhciBzdHJpbmdpZnkgPSAodmFsKSA9PiB7XFxuICAgICAgaWYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnICYmIHZhbCAhPT0gbnVsbCkge1xcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbC5jb3B5U3luYyA/IHZhbC5jb3B5U3luYygpIDogdmFsKTtcXG4gICAgICB9XFxuICAgICAgcmV0dXJuIHZhbDtcXG4gICAgfVxcbiAgXCIsXCJcXG5cIikuY29uY2F0KGkubWFwKChmdW5jdGlvbihlLHQpe3JldHVyblwidmFyIFwiLmNvbmNhdChlLFwiID0gcmVmVG9Qcm94eSgkXCIpLmNvbmNhdCh0LFwiKTtcIil9KSkuam9pbihcIlxcblwiKSkuY29uY2F0KFwiXFxuXCIuY29uY2F0KGkuaW5jbHVkZXMoXCJjb250ZXh0XCIpP1widmFyIGN0eCA9IGNvbnRleHQ7XCI6XCJcIixcIlxcblwiKS5jb25jYXQodD9cInJldHVybiBzdHJpbmdpZnkoXCIuY29uY2F0KGUsXCIpO1wiKTplLFwiO1xcblwiKSl9LGdldElzb2xhdGVDb250ZXh0PWZ1bmN0aW9uKCl7dmFyIGU9QnVpbGRlci5zZXJ2ZXJDb250ZXh0O2V8fChlPW5ldyhzYWZlRHluYW1pY1JlcXVpcmUoXCJpc29sYXRlZC12bVwiKS5Jc29sYXRlKSh7bWVtb3J5TGltaXQ6MTI4fSkuY3JlYXRlQ29udGV4dFN5bmMoKSxCdWlsZGVyLnNldFNlcnZlckNvbnRleHQoZSkpO3ZhciB0PWUuZ2xvYmFsO3JldHVybiB0LnNldFN5bmMoXCJnbG9iYWxcIix0LmRlcmVmSW50bygpKSx0LnNldFN5bmMoXCJsb2dcIiwoZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sdD0wO3Q8YXJndW1lbnRzLmxlbmd0aDt0KyspZVt0XT1hcmd1bWVudHNbdF07aXNEZWJ1ZygpJiZjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLGUpfSkpLGV9LGlzUHJvbWlzZT1mdW5jdGlvbihlKXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBlLnRoZW59LGlzUmVxdWVzdEluZm89ZnVuY3Rpb24oZSl7cmV0dXJuIWlzUHJvbWlzZShlKX0sQnVpbGRlckFzeW5jUmVxdWVzdHNDb250ZXh0PVJlYWN0X19kZWZhdWx0LmNyZWF0ZUNvbnRleHQoe3JlcXVlc3RzOltdLGVycm9yczpbXSxsb2dzOltdfSksQnVpbGRlclN0b3JlQ29udGV4dD1SZWFjdF9fZGVmYXVsdC5jcmVhdGVDb250ZXh0KHtzdGF0ZTp7fSxyb290U3RhdGU6e30sY29udGVudDp7fSxjb250ZXh0Ont9LHVwZGF0ZTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbH19KSxhcHBseVBhdGNoV2l0aE1pbmltYWxNdXRhdGlvbkNoYWluPWZ1bmN0aW9uKGUsdCxuKXtpZih2b2lkIDA9PT1uJiYobj0hMSksT2JqZWN0KGUpIT09ZSlyZXR1cm4gZTt2YXIgaT10LnBhdGgscj10Lm9wLG89dC52YWx1ZSxhPWkuc3BsaXQoL1xcLy8pO1wiXCI9PT1hWzBdJiZhLnNoaWZ0KCk7Zm9yKHZhciBzPW4/ZTpfX2Fzc2lnbih7fSxlKSxsPXMsdT0wO3U8YS5sZW5ndGg7dSsrKXt2YXIgZD11PT09YS5sZW5ndGgtMSxjPWFbdV07aWYoZCl7aWYoXCJyZXBsYWNlXCI9PT1yKWxbY109bztlbHNlIGlmKFwiYWRkXCI9PT1yKXt2YXIgcD1OdW1iZXIoYyk7QXJyYXkuaXNBcnJheShsKT9cIi1cIj09PWM/bC5wdXNoKG8pOmwuc3BsaWNlKHAsMCxvKTpsW2NdPW99ZWxzZSBpZihcInJlbW92ZVwiPT09cil7cD1OdW1iZXIoYyk7QXJyYXkuaXNBcnJheShsKT9sLnNwbGljZShwLDEpOmRlbGV0ZSBsW2NdfX1lbHNle3ZhciBmPWFbdSsxXSxtPU9iamVjdChsW2NdKT09PWxbY10/bFtjXTpTdHJpbmcoTnVtYmVyKGYpKT09PWY/W106e307bD1sW2NdPUFycmF5LmlzQXJyYXkobSk/X19zcHJlYWRBcnJheShbXSxtLCEwKTpfX2Fzc2lnbih7fSxtKX19cmV0dXJuIHN9LGh0bWxFc2NhcGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZSgvJi9nLFwiJmFtcDtcIikucmVwbGFjZSgvPC9nLFwiJmx0O1wiKS5yZXBsYWNlKC8+L2csXCImZ3Q7XCIpLnJlcGxhY2UoL1wiL2csXCImcXVvdDtcIil9LGJsb2NrVG9IdG1sU3RyaW5nPWZ1bmN0aW9uKGUpe3ZhciB0O3JldHVyblwiPFwiLmNvbmNhdChodG1sRXNjYXBlKGUudGFnTmFtZXx8XCJkaXZcIiksJyBcXG4gICAgY2xhc3M9XCJidWlsZGVyLWJsb2NrICcpLmNvbmNhdChlLmlkLFwiIFwiKS5jb25jYXQoZS5jbGFzc3x8XCJcIiwnXCJcXG4gICAgYnVpbGRlci1pZD1cIicpLmNvbmNhdChlLmlkLCdcIlxcbiAgJykuY29uY2F0KE9iamVjdC5rZXlzKGUucHJvcGVydGllc3x8e30pLm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuXCJcIi5jb25jYXQoaHRtbEVzY2FwZSh0KSwnPVwiJykuY29uY2F0KGh0bWxFc2NhcGUoZS5wcm9wZXJ0aWVzW3RdKSwnXCInKX0pKS5qb2luKFwiIFwiKSxcIlxcbiAgPlwiKS5jb25jYXQoXCJUZXh0XCI9PT0obnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29tcG9uZW50KXx8dm9pZCAwPT09dD92b2lkIDA6dC5uYW1lKT9lLmNvbXBvbmVudC5vcHRpb25zLnRleHQ6ZS5jaGlsZHJlbj9lLmNoaWxkcmVuLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGJsb2NrVG9IdG1sU3RyaW5nKGUpfSkpLmpvaW4oXCJcIik6XCJcIixcIjwvXCIpLmNvbmNhdChlLnRhZ05hbWV8fFwiZGl2XCIsXCI+XCIpLnJlcGxhY2UoL1xccysvZyxcIiBcIil9LExpbms9ZnVuY3Rpb24oZSl7cmV0dXJuIFJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQnVpbGRlclN0b3JlQ29udGV4dC5Db25zdW1lcixudWxsLChmdW5jdGlvbih0KXtyZXR1cm4gdC5yZW5kZXJMaW5rP3QucmVuZGVyTGluayhlKTpSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiYVwiLF9fYXNzaWduKHt9LGUpKX0pKX0sY2FtZWxDYXNlVG9LZWJhYkNhc2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/ZS5yZXBsYWNlKC8oW0EtWl0pL2csKGZ1bmN0aW9uKGUpe3JldHVyblwiLVwiLmNvbmNhdChlWzBdLnRvTG93ZXJDYXNlKCkpfSkpOlwiXCJ9LGtlYmFiQ2FzZVRvQ2FtZWxDYXNlPWZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT1cIlwiKSxlLnJlcGxhY2UoLy0oW2Etel0pL2csKGZ1bmN0aW9uKGUpe3JldHVybiBlWzFdLnRvVXBwZXJDYXNlKCl9KSl9LERldmljZT17ZGVza3RvcDowLHRhYmxldDoxLG1vYmlsZToyfSx2b2lkRWxlbWVudHM9bmV3IFNldChbXCJhcmVhXCIsXCJiYXNlXCIsXCJiclwiLFwiY29sXCIsXCJlbWJlZFwiLFwiaHJcIixcImltZ1wiLFwiaW5wdXRcIixcImxpbmtcIixcIm1ldGFcIixcInBhcmFtXCIsXCJzb3VyY2VcIixcInRyYWNrXCIsXCJ3YnJcIixcInRleHRhcmVhXCJdKSxsYXN0PWZ1bmN0aW9uKGUpe3JldHVybiBlW2UubGVuZ3RoLTFdfTtmdW5jdGlvbiBvbWl0JDEoZSx0KXtmb3IodmFyIG49T2JqZWN0LmFzc2lnbih7fSxlKSxpPTAscj10O2k8ci5sZW5ndGg7aSsrKXtkZWxldGUgbltyW2ldXX1yZXR1cm4gbn12YXIgY3NzQ2FzZT1mdW5jdGlvbihlKXtpZighZSlyZXR1cm4gZTt2YXIgdD1jYW1lbENhc2VUb0tlYmFiQ2FzZShlKTtyZXR1cm4gZVswXT09PWVbMF0udG9VcHBlckNhc2UoKSYmKHQ9XCItXCIrdCksdH07ZnVuY3Rpb24gY2FwaXRhbGl6ZShlKXtpZihlKXJldHVybiBlWzBdLnRvVXBwZXJDYXNlKCkrZS5zbGljZSgxKX12YXIgQnVpbGRlckJsb2NrJDE9ZnVuY3Rpb24oX3N1cGVyKXtmdW5jdGlvbiBCdWlsZGVyQmxvY2soKXt2YXIgX3RoaXM9bnVsbCE9PV9zdXBlciYmX3N1cGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpcztyZXR1cm4gX3RoaXMuc3RhdGU9e2hhc0Vycm9yOiExLHVwZGF0ZXM6MH0sX3RoaXMucHJpdmF0ZVN0YXRlPXtzdGF0ZTp7fSxyb290U3RhdGU6e30sY29udGV4dDp7fSx1cGRhdGU6ZnVuY3Rpb24oKXt9fSxfdGhpcy5vbldpbmRvd01lc3NhZ2U9ZnVuY3Rpb24oZXZlbnQpe3ZhciBtZXNzYWdlPWV2ZW50LmRhdGE7aWYobWVzc2FnZSlzd2l0Y2gobWVzc2FnZS50eXBlKXtjYXNlXCJidWlsZGVyLnNlbGVjdGlvbkNoYW5nZVwiOnZhciBkYXRhPW1lc3NhZ2UuZGF0YTtpZighZGF0YSlicmVhazt2YXIgc2VsZWN0aW9uPWRhdGEuc2VsZWN0aW9uLGlkPV90aGlzLmJsb2NrJiZfdGhpcy5ibG9jay5pZDtpZCYmQXJyYXkuaXNBcnJheShzZWxlY3Rpb24pJiZzZWxlY3Rpb24uaW5kZXhPZihpZCk+LTEmJnNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7d2luZG93LiRibG9jaz1fdGhpcyx3aW5kb3cuJGJsb2Nrc3x8KHdpbmRvdy4kYmxvY2tzPVtdKSx3aW5kb3cuJGJsb2Nrcy5wdXNoKF90aGlzKX0pKTticmVhaztjYXNlXCJidWlsZGVyLnBhdGNoVXBkYXRlc1wiOnZhciBkYXRhPW1lc3NhZ2UuZGF0YTtpZighZGF0YXx8IWRhdGEuZGF0YSlicmVhazt2YXIgcGF0Y2hlcz1kYXRhLmRhdGFbX3RoaXMuYmxvY2suaWRdO2lmKCFwYXRjaGVzKXJldHVybjtsb2NhdGlvbi5ocmVmLmluY2x1ZGVzKFwiYnVpbGRlci5kZWJ1Zz10cnVlXCIpJiZldmFsKFwiZGVidWdnZXJcIik7Zm9yKHZhciBfaT0wLHBhdGNoZXNfMT1wYXRjaGVzO19pPHBhdGNoZXNfMS5sZW5ndGg7X2krKyl7dmFyIHBhdGNoPXBhdGNoZXNfMVtfaV07YXBwbHlQYXRjaFdpdGhNaW5pbWFsTXV0YXRpb25DaGFpbihfdGhpcy5wcm9wcy5ibG9jayxwYXRjaCwhMCl9X3RoaXMuc2V0U3RhdGUoe3VwZGF0ZXM6X3RoaXMuc3RhdGUudXBkYXRlcysxfSl9fSxfdGhpc31yZXR1cm4gX19leHRlbmRzKEJ1aWxkZXJCbG9jayxfc3VwZXIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyQmxvY2sucHJvdG90eXBlLFwic3RvcmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJpdmF0ZVN0YXRlfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLEJ1aWxkZXJCbG9jay5nZXREZXJpdmVkU3RhdGVGcm9tRXJyb3I9ZnVuY3Rpb24oZSl7cmV0dXJue2hhc0Vycm9yOiEwfX0sQnVpbGRlckJsb2NrLnByb3RvdHlwZS5jb21wb25lbnREaWRDYXRjaD1mdW5jdGlvbihlLHQpe2NvbnNvbGUuZXJyb3IoXCJCdWlsZGVyIGJsb2NrIGVycm9yOlwiLGUsdCl9LEJ1aWxkZXJCbG9jay5wcm90b3R5cGUuc3RyaW5nVG9GdW5jdGlvbj1mdW5jdGlvbihlLHQpe3JldHVybiB2b2lkIDA9PT10JiYodD0hMCksc3RyaW5nVG9GdW5jdGlvbihlLHQsdGhpcy5fZXJyb3JzLHRoaXMuX2xvZ3MpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlckJsb2NrLnByb3RvdHlwZSxcImJsb2NrXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BzLmJsb2NrfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyQmxvY2sucHJvdG90eXBlLFwiZW1vdGlvbkNzc1wiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZSx0LG4saSxyLG89dGhpcy5ibG9jaztpZihCdWlsZGVyLmlzU2VydmVyKXt2YXIgYT1vLmFuaW1hdGlvbnMmJm8uYW5pbWF0aW9uc1swXTtpZihhJiZcImhvdmVyXCIhPT1hLnRyaWdnZXIpe3ZhciBzPWEmJmEuc3RlcHMmJmEuc3RlcHNbMF0sbD1zJiZzLnN0eWxlcztsJiYocj1sKX19dmFyIHU9c2l6ZU5hbWVzLnNsaWNlKCkucmV2ZXJzZSgpLGQ9dGhpcy5ibG9jayxjPXt9O2lmKGQucmVzcG9uc2l2ZVN0eWxlcylmb3IodmFyIHA9MCxmPXU7cDxmLmxlbmd0aDtwKyspe3ZhciBtPWZbcF07aWYoXCJsYXJnZVwiPT09bSl0aGlzLnByb3BzLmVtYWlsTW9kZXx8KGNbXCImLmJ1aWxkZXItYmxvY2tcIl09T2JqZWN0LmFzc2lnbih7fSxkLnJlc3BvbnNpdmVTdHlsZXNbbV0scikpO2Vsc2V7dmFyIGg9Z2V0U2l6ZXNGb3JCcmVha3BvaW50cygobnVsbD09PSh0PW51bGw9PT0oZT10aGlzLnByaXZhdGVTdGF0ZS5jb250ZXh0LmJ1aWxkZXJDb250ZW50KXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5tZXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC5icmVha3BvaW50cyl8fHt9KTtjW1wiQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiBcIi5jb25jYXQoaFttXS5tYXgsXCJweClcIildPXtcIiYuYnVpbGRlci1ibG9ja1wiOmQucmVzcG9uc2l2ZVN0eWxlc1ttXX19fXZhciBnPW8uYW5pbWF0aW9ucyYmby5hbmltYXRpb25zLmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVyblwiaG92ZXJcIj09PWUudHJpZ2dlcn0pKTtyZXR1cm4gZyYmKGNbXCI6aG92ZXJcIl09KG51bGw9PT0oaT1udWxsPT09KG49Zy5zdGVwcyl8fHZvaWQgMD09PW4/dm9pZCAwOm5bMV0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnN0eWxlcyl8fHt9LGMudHJhbnNpdGlvbj1cImFsbCBcIi5jb25jYXQoZy5kdXJhdGlvbixcInMgXCIpLmNvbmNhdChjYW1lbENhc2VUb0tlYmFiQ2FzZShnLmVhc2luZykpLGcuZGVsYXkmJihjLnRyYW5zaXRpb25EZWxheT1nLmRlbGF5K1wic1wiKSksY30sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxCdWlsZGVyQmxvY2sucHJvdG90eXBlLmV2YWw9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuc3RyaW5nVG9GdW5jdGlvbihlKSh0aGlzLnByaXZhdGVTdGF0ZS5zdGF0ZSx2b2lkIDAsdGhpcy5ibG9jayxidWlsZGVyLERldmljZSx0aGlzLnByaXZhdGVTdGF0ZS51cGRhdGUsQnVpbGRlcix0aGlzLnByaXZhdGVTdGF0ZS5jb250ZXh0KX0sQnVpbGRlckJsb2NrLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudD1mdW5jdGlvbigpe0J1aWxkZXIuaXNFZGl0aW5nJiZyZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLHRoaXMub25XaW5kb3dNZXNzYWdlKX0sQnVpbGRlckJsb2NrLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudD1mdW5jdGlvbigpe3ZhciBlLHQ9dGhpcyxuPXRoaXMuYmxvY2ssaT1uJiZuLmFuaW1hdGlvbnM7aWYoQnVpbGRlci5pc0VkaXRpbmcmJmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsdGhpcy5vbldpbmRvd01lc3NhZ2UpLGkpe3ZhciByPXthbmltYXRpb25zOmZhc3RDbG9uZShpKX07aWYobi5iaW5kaW5ncylmb3IodmFyIG8gaW4gbi5iaW5kaW5ncylpZigobnVsbD09PShlPW8udHJpbSl8fHZvaWQgMD09PWU/dm9pZCAwOmUuY2FsbChvKSkmJm8uc3RhcnRzV2l0aChcImFuaW1hdGlvbnMuXCIpKXt2YXIgYT10aGlzLnN0cmluZ1RvRnVuY3Rpb24obi5iaW5kaW5nc1tvXSk7dm9pZCAwIT09YSYmc2V0KHIsbyxhKHRoaXMucHJpdmF0ZVN0YXRlLnN0YXRlLG51bGwsbixidWlsZGVyLG51bGwsbnVsbCxCdWlsZGVyLHRoaXMucHJpdmF0ZVN0YXRlLmNvbnRleHQpKX1CdWlsZGVyLmFuaW1hdG9yLmJpbmRBbmltYXRpb25zKHIuYW5pbWF0aW9ucy5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVyblwiaG92ZXJcIiE9PWUudHJpZ2dlcn0pKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBfX2Fzc2lnbihfX2Fzc2lnbih7fSxlKSx7ZWxlbWVudElkOnQuYmxvY2suaWR9KX0pKSl9fSxCdWlsZGVyQmxvY2sucHJvdG90eXBlLmdldEVsZW1lbnQ9ZnVuY3Rpb24oZSx0KXt2YXIgbixpLHIsbyxhLHM9dGhpczt2b2lkIDA9PT1lJiYoZT0wKSx2b2lkIDA9PT10JiYodD10aGlzLnByaXZhdGVTdGF0ZS5zdGF0ZSk7dmFyIGw9dGhpcy5wcm9wcztsLmNoaWxkLGwuZmllbGROYW1lO3ZhciB1LGQ9dGhpcy5ibG9jayxjPShkLnRhZ05hbWV8fFwiZGl2XCIpLnRvTG93ZXJDYXNlKCk7aWYoXCJ0ZW1wbGF0ZVwiPT09Yyl7dmFyIHA9ZC5jaGlsZHJlbj9kLmNoaWxkcmVuLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGJsb2NrVG9IdG1sU3RyaW5nKGUpfSkpLmpvaW4oXCIgXCIpOlwiXCI7cmV0dXJuIGNvbnNvbGUuZGVidWcoXCJ0ZW1wbGF0ZSBodG1sXCIscCksanN4KFwidGVtcGxhdGVcIixfX2Fzc2lnbih7fSxkLnByb3BlcnRpZXMse2Rhbmdlcm91c2x5U2V0SW5uZXJIVE1MOntfX2h0bWw6cH19KSl9dmFyIGY9ZC5jb21wb25lbnQmJihkLmNvbXBvbmVudC5uYW1lfHxkLmNvbXBvbmVudC5jb21wb25lbnQpLG09bnVsbDtkLmNvbXBvbmVudCYmIWQuY29tcG9uZW50LmNsYXNzJiYoZC5jb21wb25lbnQmJmQuY29tcG9uZW50LnRhZz91PWQuY29tcG9uZW50LnRhZzoobT1CdWlsZGVyLmNvbXBvbmVudHMuZmluZCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUubmFtZT09PWZ9KSl8fG51bGwpJiZtLmNsYXNzP3U9bS5jbGFzczptJiZtLnRhZz91PW0udGFnOihudWxsPT1mP3ZvaWQgMDpmLnN0YXJ0c1dpdGgoXCJCdWlsZGVyOlwiKSk/Y29uc29sZS53YXJuKFwiTWlzc2luZyBAYnVpbGRlci5pby93aWRnZXRzIGluc3RhbGxhdGlvbiwgcGxlYXNlIGluc3RhbGwgYW5kIGltcG9ydCBAYnVpbGRlci5pby93aWRnZXRzIHRvIHVzZSBcIi5jb25jYXQoZi5zcGxpdChcIjpcIilbMV0sXCIgaW4geW91ciBjb250ZW50LCBtb3JlIGluZm8gaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL0J1aWxkZXJJTy9idWlsZGVyL3RyZWUvbWFpbi9wYWNrYWdlcy93aWRnZXRzXCIpKTpmJiZjb25zb2xlLndhcm4oXCJNaXNzaW5nIHJlZ2lzdHJhdGlvbiBmb3IgXCIuY29uY2F0KGYsXCIsIGhhdmUgeW91IGluY2x1ZGVkIHRoZSByZWdpc3RyYXRpb24gaW4geW91ciBidW5kbGU/XCIpKSk7dmFyIGg9X19hc3NpZ24oX19hc3NpZ24oe30sZC5wcm9wZXJ0aWVzKSx7c3R5bGU6e319KTtpZihoPV9fYXNzaWduKF9fYXNzaWduKHt9LGgucHJvcGVydGllcyksaCksZC5jb21wb25lbnQmJihoLmNvbXBvbmVudD1mYXN0Q2xvbmUoZC5jb21wb25lbnQpKSxkLmJpbmRpbmdzKWZvcih2YXIgZyBpbiBkLmJpbmRpbmdzKWlmKG51bGw9PT0oaT1nLnRyaW0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNhbGwoZykpe3ZhciB2PXRoaXMuc3RyaW5nVG9GdW5jdGlvbihkLmJpbmRpbmdzW2ddKTtzZXQoaCxnLHYodCxudWxsLGQsYXBpKCksRGV2aWNlLG51bGwsQnVpbGRlcix0aGlzLnByaXZhdGVTdGF0ZS5jb250ZXh0KSl9aWYoaC5oaWRlKXJldHVybiBudWxsO2lmKGRlbGV0ZSBoLmhpZGUsKFwic2hvd1wiaW4gaHx8ZC5iaW5kaW5ncyYmZC5iaW5kaW5ncy5zaG93KSYmIWguc2hvdylyZXR1cm4gbnVsbDtpZihkZWxldGUgaC5zaG93LGQuYWN0aW9ucyl7dmFyIGI9ZnVuY3Rpb24oZSl7aWYoIShudWxsPT09KHI9ZS50cmltKXx8dm9pZCAwPT09cj92b2lkIDA6ci5jYWxsKGUpKSlyZXR1cm5cImNvbnRpbnVlXCI7dmFyIG49ZC5hY3Rpb25zW2VdO2hbXCJvblwiK2NhcGl0YWxpemUoZSldPWZ1bmN0aW9uKGUpe3ZhciBpPXQ7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIFByb3h5JiYoaT1uZXcgUHJveHkodCx7c2V0OmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZVt0XT1uLHMucHJpdmF0ZVN0YXRlLnJvb3RTdGF0ZVt0XT1uLCEwfX0pKSxzLnN0cmluZ1RvRnVuY3Rpb24obiwhMSkoaSxlLHMuYmxvY2ssYnVpbGRlcixEZXZpY2Uscy5wcml2YXRlU3RhdGUudXBkYXRlLEJ1aWxkZXIscy5wcml2YXRlU3RhdGUuY29udGV4dCl9fTtmb3IodmFyIGcgaW4gZC5hY3Rpb25zKWIoZyl9dmFyIHk9KGguY29tcG9uZW50fHxoLm9wdGlvbnMpJiZfX2Fzc2lnbihfX2Fzc2lnbih7fSxoLm9wdGlvbnMpLGguY29tcG9uZW50Lm9wdGlvbnN8fGguY29tcG9uZW50LmRhdGEpLF89dm9pZEVsZW1lbnRzLmhhcyhjKSx4PW0mJihtLmZyYWdtZW50fHxtLm5vV3JhcCksUz0obnVsbD09PShvPWguYXR0cil8fHZvaWQgMD09PW8/dm9pZCAwOm8uc3R5bGUpfHwoXCJzdHJpbmdcIj09dHlwZW9mIGguc3R5bGU/aC5zdHlsZTpcIlwiKXx8XCJcIjtpZihcInN0cmluZ1wiPT10eXBlb2YgUyl7XCJvYmplY3RcIiE9dHlwZW9mIGguc3R5bGUmJihoLnN0eWxlPXt9KTtmb3IodmFyIEI9MCxrPVMuc3BsaXQoXCI7XCIpO0I8ay5sZW5ndGg7QisrKXt2YXIgQz1rW0JdLnNwbGl0KFwiOlwiKTtpZighQy5sZW5ndGgpcmV0dXJuO2c9Q1swXSx2PUNbMV07ZyYmKEMubGVuZ3RoPjImJih2PUMuc2xpY2UoMSkuam9pbihcIjpcIikpLGguc3R5bGVba2ViYWJDYXNlVG9DYW1lbENhc2UoZyldPXYpfX12YXIgdz1fX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbih7fSxvbWl0JDEoaCxbXCJjbGFzc1wiLFwiY29tcG9uZW50XCIsXCJhdHRyXCJdKSksKChuPXt9KVtcInN0cmluZ1wiIT10eXBlb2YgY3x8Yy5pbmNsdWRlcyhcIi1cIik/XCJjbGFzc1wiOlwiY2xhc3NOYW1lXCJdPVwiYnVpbGRlci1ibG9jayBcIi5jb25jYXQodGhpcy5pZCkuY29uY2F0KGQuY2xhc3M/XCIgXCIuY29uY2F0KGQuY2xhc3MpOlwiXCIpLmNvbmNhdCghZC5jb21wb25lbnR8fFtcIkltYWdlXCIsXCJWaWRlb1wiLFwiQmFubmVyXCJdLmluZGV4T2YoZik+LTE/XCJcIjpcIiBidWlsZGVyLWhhcy1jb21wb25lbnRcIikrKGguY2xhc3M/XCIgXCIraC5jbGFzczpcIlwiKSsoQnVpbGRlci5pc0VkaXRpbmcmJihudWxsPT09KGE9dGhpcy5wcml2YXRlU3RhdGUuc3RhdGUuX3NwYWNlcil8fHZvaWQgMD09PWE/dm9pZCAwOmEucGFyZW50KT09PWQuaWQ/XCIgYnVpbGRlci1zcGFjZXItcGFyZW50XCI6XCJcIiksbi5rZXk9dGhpcy5pZCtlLG5bXCJidWlsZGVyLWlkXCJdPXRoaXMuaWQsbikpLDAhPT1lJiZ7XCJidWlsZGVyLWluZGV4XCI6ZX0pO0J1aWxkZXIuaXNFZGl0aW5nJiYod1tcImJ1aWxkZXItaW5saW5lLXN0eWxlc1wiXT1oLmF0dHImJmguYXR0ci5zdHlsZT9PYmplY3Qua2V5cyhoLnN0eWxlKS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuKGU/XCJcIi5jb25jYXQoZSxcIjtcIik6XCJcIikrXCJcIi5jb25jYXQoY3NzQ2FzZSh0KSxcIjpcIikuY29uY2F0KGguc3R5bGVbdF0sXCI7XCIpfSksXCJcIik6XCJcIiksKHcucHJvcGVydGllcyYmdy5wcm9wZXJ0aWVzLmhyZWZ8fHcuaHJlZikmJlwiZGl2XCI9PT1jJiYoYz1cImFcIiksXCJhXCI9PT1jJiYoYz1MaW5rKTt2YXIgUj1kLmNoaWxkcmVufHx3LmNoaWxkcmVufHxbXTtyZXR1cm4ganN4KFJlYWN0X19kZWZhdWx0LkZyYWdtZW50LG51bGwsanN4KENsYXNzTmFtZXMsbnVsbCwoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jc3M7aWYoZS5jeCwhcy5wcm9wcy5lbWFpbE1vZGUpe3ZhciBuPVwiIFwiK3Qocy5lbW90aW9uQ3NzKTt3LmNsYXNzJiYody5jbGFzcys9biksdy5jbGFzc05hbWUmJih3LmNsYXNzTmFtZSs9bil9cmV0dXJuIGpzeChCdWlsZGVyQXN5bmNSZXF1ZXN0c0NvbnRleHQuQ29uc3VtZXIsbnVsbCwoZnVuY3Rpb24oZSl7cmV0dXJuIHMuX2FzeW5jUmVxdWVzdHM9ZSYmZS5yZXF1ZXN0cyxzLl9lcnJvcnM9ZSYmZS5lcnJvcnMscy5fbG9ncz1lJiZlLmxvZ3MsXz9qc3goYyxfX2Fzc2lnbih7fSx3KSk6dSYmKHh8fHMucHJvcHMuZW1haWxNb2RlKT9qc3godSxfX2Fzc2lnbih7fSx5LHthdHRyaWJ1dGVzOncsYnVpbGRlckJsb2NrOmQsYnVpbGRlclN0YXRlOnMucHJpdmF0ZVN0YXRlfSkpOmpzeChjLF9fYXNzaWduKHt9LHcpLHUmJmpzeCh1LF9fYXNzaWduKHtidWlsZGVyU3RhdGU6cy5wcml2YXRlU3RhdGUsYnVpbGRlckJsb2NrOmR9LHkpKSxkLnRleHR8fGgudGV4dD9oLnRleHQ6IXUmJlImJkFycmF5LmlzQXJyYXkoUikmJlIubGVuZ3RoP1IubWFwKChmdW5jdGlvbihlLHQpe3JldHVybiBqc3goQnVpbGRlckJsb2NrLHtrZXk6KHMuaWR8fFwiXCIpK3QsYmxvY2s6ZSxpbmRleDp0LHNpemU6cy5wcm9wcy5zaXplLGZpZWxkTmFtZTpzLnByb3BzLmZpZWxkTmFtZSxjaGlsZDpzLnByb3BzLmNoaWxkLGVtYWlsTW9kZTpzLnByb3BzLmVtYWlsTW9kZX0pfSkpOm51bGwpfSkpfSkpKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXJCbG9jay5wcm90b3R5cGUsXCJpZFwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmJsb2NrO3JldHVybiBlLmlkLnN0YXJ0c1dpdGgoXCJidWlsZGVyXCIpP2UuaWQ6XCJidWlsZGVyLVwiK2UuaWR9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksQnVpbGRlckJsb2NrLnByb3RvdHlwZS5jb250ZW50cz1mdW5jdGlvbihlKXt2YXIgdD10aGlzLG49dGhpcy5ibG9jaztpZih0aGlzLnByaXZhdGVTdGF0ZT1lLG4ucmVwZWF0JiZuLnJlcGVhdC5jb2xsZWN0aW9uKXt2YXIgaT1uLnJlcGVhdC5jb2xsZWN0aW9uLHI9bGFzdCgoaXx8XCJcIikudHJpbSgpLnNwbGl0KFwiKFwiKVswXS50cmltKCkuc3BsaXQoXCIuXCIpKSxvPW4ucmVwZWF0Lml0ZW1OYW1lfHwocj9yK1wiSXRlbVwiOlwiaXRlbVwiKSxhPXRoaXMuc3RyaW5nVG9GdW5jdGlvbihpKShlLnN0YXRlLG51bGwsbixhcGkoKSxEZXZpY2UsbnVsbCxCdWlsZGVyLHRoaXMucHJpdmF0ZVN0YXRlLmNvbnRleHQpO3JldHVybiBBcnJheS5pc0FycmF5KGEpP2EubWFwKChmdW5jdGlvbihuLGkpe3ZhciByLGE9X19hc3NpZ24oX19hc3NpZ24oe30sZS5zdGF0ZSksKChyPXskaW5kZXg6aSwkaXRlbTpufSlbb109bixyW1wiJFwiLmNvbmNhdChvLFwiSW5kZXhcIildPWkscikpO3JldHVybiBqc3goQnVpbGRlclN0b3JlQ29udGV4dC5Qcm92aWRlcix7a2V5OmksdmFsdWU6X19hc3NpZ24oX19hc3NpZ24oe30sZSkse3N0YXRlOmF9KX0sdC5nZXRFbGVtZW50KGksYSkpfSkpOm51bGx9cmV0dXJuIHRoaXMuZ2V0RWxlbWVudCgpfSxCdWlsZGVyQmxvY2sucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXM7cmV0dXJuIHRoaXMuc3RhdGUuaGFzRXJyb3I/anN4KFwic3BhblwiLHtjc3M6e2Rpc3BsYXk6XCJpbmxpbmUtYmxvY2tcIixwYWRkaW5nOjUsY29sb3I6XCIjOTk5XCIsZm9udFNpemU6MTEsZm9udFN0eWxlOlwiaXRhbGljXCJ9fSxcIkJ1aWxkZXIgYmxvY2sgZXJyb3IgOiggQ2hlY2sgY29uc29sZSBmb3IgZGV0YWlsc1wiKTpqc3goQnVpbGRlclN0b3JlQ29udGV4dC5Db25zdW1lcixudWxsLChmdW5jdGlvbih0KXtyZXR1cm4gZS5jb250ZW50cyh0KX0pKX0sQnVpbGRlckJsb2NrfShSZWFjdF9fZGVmYXVsdC5Db21wb25lbnQpLEJ1aWxkZXJCbG9ja3M9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3ZhciB0PW51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpcztyZXR1cm4gdC5vbkNsaWNrRW1wdHlCbG9ja3M9ZnVuY3Rpb24oKXt2YXIgZTtCdWlsZGVyLmlzSWZyYW1lJiZ0Lm5vQmxvY2tzJiYobnVsbD09PShlPXdpbmRvdy5wYXJlbnQpfHx2b2lkIDA9PT1lfHxlLnBvc3RNZXNzYWdlKHt0eXBlOlwiYnVpbGRlci5jbGlja0VtcHR5QmxvY2tzXCIsZGF0YTp7cGFyZW50RWxlbWVudElkOnQucGFyZW50SWQsZGF0YVBhdGg6dC5wYXRofX0sXCIqXCIpKX0sdC5vbkhvdmVyRW1wdHlCbG9ja3M9ZnVuY3Rpb24oKXt2YXIgZTtCdWlsZGVyLmlzRWRpdGluZyYmdC5ub0Jsb2NrcyYmKG51bGw9PT0oZT13aW5kb3cucGFyZW50KXx8dm9pZCAwPT09ZXx8ZS5wb3N0TWVzc2FnZSh7dHlwZTpcImJ1aWxkZXIuaG92ZXJFbXB0eUJsb2Nrc1wiLGRhdGE6e3BhcmVudEVsZW1lbnRJZDp0LnBhcmVudElkLGRhdGFQYXRoOnQucGF0aH19LFwiKlwiKSl9LHR9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImlzUm9vdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5wcm9wcy5jaGlsZH0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJub0Jsb2Nrc1wiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnByb3BzLmJsb2NrcztyZXR1cm4hKGUmJmUubGVuZ3RoKX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJwYXRoXCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMucHJvcHMuZGF0YVBhdGh8fFwiXCI7cmV0dXJuIGUudHJpbSgpJiYoZS5zdGFydHNXaXRoKFwidGhpcy5cIik/ZT1lLnJlcGxhY2UoXCJ0aGlzLlwiLFwiXCIpOmUuc3RhcnRzV2l0aChcImNvbXBvbmVudC5vcHRpb25zLlwiKXx8KGU9XCJjb21wb25lbnQub3B0aW9ucy5cIitlKSksZX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJwYXJlbnRJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcm9wcy5wYXJlbnRFbGVtZW50SWQ/dGhpcy5wcm9wcy5wYXJlbnRFbGVtZW50SWQ6dGhpcy5wcm9wcy5wYXJlbnQmJnRoaXMucHJvcHMucGFyZW50LmlkfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLnByb3BzLmJsb2NrcyxuPXRoaXMucHJvcHMuZW1haWxNb2RlP1wic3BhblwiOlwiZGl2XCI7cmV0dXJuIGpzeChuLF9fYXNzaWduKHtjbGFzc05hbWU6XCJidWlsZGVyLWJsb2Nrc1wiKyh0aGlzLm5vQmxvY2tzP1wiIG5vLWJsb2Nrc1wiOlwiXCIpKyh0aGlzLnByb3BzLmNoaWxkP1wiIGJ1aWxkZXItYmxvY2tzLWNoaWxkXCI6XCJcIikrKHRoaXMucHJvcHMuY2xhc3NOYW1lP1wiIFwiK3RoaXMucHJvcHMuY2xhc3NOYW1lOlwiXCIpLFwiYnVpbGRlci10eXBlXCI6XCJibG9ja3NcIixcImJ1aWxkZXItcGF0aFwiOkJ1aWxkZXIuaXNJZnJhbWU/dGhpcy5wYXRoOnZvaWQgMCxcImJ1aWxkZXItcGFyZW50LWlkXCI6dGhpcy5wYXJlbnRJZCxjc3M6X19hc3NpZ24oX19hc3NpZ24oe30sIXRoaXMucHJvcHMuZW1haWxNb2RlJiZ7ZGlzcGxheTpcImZsZXhcIixmbGV4RGlyZWN0aW9uOlwiY29sdW1uXCIsYWxpZ25JdGVtczpcInN0cmV0Y2hcIn0pLHRoaXMucHJvcHMuc3R5bGUpLG9uQ2xpY2s6ZnVuY3Rpb24oKXtlLm5vQmxvY2tzJiZlLm9uQ2xpY2tFbXB0eUJsb2NrcygpfX0sQnVpbGRlci5pc0VkaXRpbmcmJntvbk1vdXNlRW50ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gZS5vbkhvdmVyRW1wdHlCbG9ja3MoKX19KSx0JiZBcnJheS5pc0FycmF5KHQpJiZ0Lm1hcCgoZnVuY3Rpb24odCxuKXtyZXR1cm4gdCYmXCJAYnVpbGRlci5pby9zZGs6RWxlbWVudFwiPT09dFtcIkB0eXBlXCJdP2pzeChCdWlsZGVyQmxvY2skMSx7a2V5OnQuaWQsYmxvY2s6dCxpbmRleDpuLGZpZWxkTmFtZTplLnByb3BzLmZpZWxkTmFtZSxjaGlsZDplLnByb3BzLmNoaWxkLGVtYWlsTW9kZTplLnByb3BzLmVtYWlsTW9kZX0pOnR9KSl8fHQpfSx0LnJlbmRlckludG89ZnVuY3Rpb24oZSxuLGkpe2lmKHZvaWQgMD09PW4mJihuPXt9KSxlKXt2YXIgcj1udWxsO3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBlP3I9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlKTplIGluc3RhbmNlb2YgRWxlbWVudCYmKHI9ZSksUmVhY3RET00ucmVuZGVyKGpzeChCdWlsZGVyU3RvcmVDb250ZXh0LlByb3ZpZGVyLHt2YWx1ZTppfSxqc3godCxfX2Fzc2lnbih7fSxuKSkpLHIpfX0sdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxOb1dyYXA9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2hpbGRyZW59O2Z1bmN0aW9uIGdldERhdGEoZSl7aWYodm9pZCAwIT09KG51bGw9PWU/dm9pZCAwOmUuZGF0YSkpe3ZhciB0PWUuZGF0YSxuPXQuYmxvY2tzLGk9dC5ibG9ja3NTdHJpbmcscj1BcnJheS5pc0FycmF5KG4pfHxcInN0cmluZ1wiPT10eXBlb2YgaSxvPV9fYXNzaWduKF9fYXNzaWduKHt9LGUuZGF0YSksciYme2Jsb2NrczpufHxKU09OLnBhcnNlKGkpfSk7cmV0dXJuIGRlbGV0ZSBvLmJsb2Nrc1N0cmluZyxvfX12YXIgdmFyaWFudHNTY3JpcHQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm5cIlxcbihmdW5jdGlvbigpIHtcXG4gIGlmICh3aW5kb3cuYnVpbGRlck5vVHJhY2sgfHwgIW5hdmlnYXRvci5jb29raWVFbmFibGVkKSB7XFxuICAgIHJldHVybjtcXG4gIH1cXG5cXG4gIHZhciB2YXJpYW50cyA9IFwiLmNvbmNhdChlLFwiO1xcbiAgZnVuY3Rpb24gcmVtb3ZlVmFyaWFudHMoKSB7XFxuICAgIHZhcmlhbnRzLmZvckVhY2goZnVuY3Rpb24gKHRlbXBsYXRlKSB7XFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGVtcGxhdGVbZGF0YS10ZW1wbGF0ZS12YXJpYW50LWlkPVxcXCInICsgdGVtcGxhdGUuaWQgKyAnXFxcIl0nKS5yZW1vdmUoKTtcXG4gICAgfSk7XFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YXJpYW50cy1zY3JpcHQtXCIpLmNvbmNhdCh0LCdcXCcpLnJlbW92ZSgpO1xcbiAgfVxcblxcbiAgaWYgKHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGVtcGxhdGVcIikuY29udGVudCA9PT0gXFwndW5kZWZpbmVkXFwnKSB7XFxuICAgIHJlbW92ZVZhcmlhbnRzKCk7XFxuICAgIHJldHVybiA7XFxuICB9XFxuXFxuICBmdW5jdGlvbiBzZXRDb29raWUobmFtZSx2YWx1ZSxkYXlzKSB7XFxuICAgIHZhciBleHBpcmVzID0gXCJcIjtcXG4gICAgaWYgKGRheXMpIHtcXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcXG4gICAgICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSArIChkYXlzKjI0KjYwKjYwKjEwMDApKTtcXG4gICAgICAgIGV4cGlyZXMgPSBcIjsgZXhwaXJlcz1cIiArIGRhdGUudG9VVENTdHJpbmcoKTtcXG4gICAgfVxcbiAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgXCI9XCIgKyAodmFsdWUgfHwgXCJcIikgICsgZXhwaXJlcyArIFwiOyBwYXRoPS9cIiArIFwiOyBTZWN1cmU7IFNhbWVTaXRlPU5vbmVcIjtcXG4gIH1cXG5cXG4gIGZ1bmN0aW9uIGdldENvb2tpZShuYW1lKSB7XFxuICAgIHZhciBuYW1lRVEgPSBuYW1lICsgXCI9XCI7XFxuICAgIHZhciBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdChcXCc7XFwnKTtcXG4gICAgZm9yKHZhciBpPTA7aSA8IGNhLmxlbmd0aDtpKyspIHtcXG4gICAgICAgIHZhciBjID0gY2FbaV07XFxuICAgICAgICB3aGlsZSAoYy5jaGFyQXQoMCk9PVxcJyBcXCcpIGMgPSBjLnN1YnN0cmluZygxLGMubGVuZ3RoKTtcXG4gICAgICAgIGlmIChjLmluZGV4T2YobmFtZUVRKSA9PSAwKSByZXR1cm4gYy5zdWJzdHJpbmcobmFtZUVRLmxlbmd0aCxjLmxlbmd0aCk7XFxuICAgIH1cXG4gICAgcmV0dXJuIG51bGw7XFxuICB9XFxuICB2YXIgY29va2llTmFtZSA9IFxcJ2J1aWxkZXIudGVzdHMuJykuY29uY2F0KHQsXCInO1xcbiAgdmFyIHZhcmlhbnRJbkNvb2tpZSA9IGdldENvb2tpZShjb29raWVOYW1lKTtcXG4gIHZhciBhdmFpbGFibGVJRHMgPSB2YXJpYW50cy5tYXAoZnVuY3Rpb24odnIpIHsgcmV0dXJuIHZyLmlkIH0pLmNvbmNhdCgnXCIpLmNvbmNhdCh0LFwiJyk7XFxuICB2YXIgdmFyaWFudElkO1xcbiAgaWYgKGF2YWlsYWJsZUlEcy5pbmRleE9mKHZhcmlhbnRJbkNvb2tpZSkgPiAtMSkge1xcbiAgICB2YXJpYW50SWQgPSB2YXJpYW50SW5Db29raWU7XFxuICB9XFxuICBpZiAoIXZhcmlhbnRJZCkge1xcbiAgICB2YXIgbiA9IDA7XFxuICAgIHZhciByYW5kb20gPSBNYXRoLnJhbmRvbSgpO1xcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcmlhbnRzLmxlbmd0aDsgaSsrKSB7XFxuICAgICAgdmFyIHZhcmlhbnQgPSB2YXJpYW50c1tpXTtcXG4gICAgICB2YXIgdGVzdFJhdGlvID0gdmFyaWFudC50ZXN0UmF0aW87XFxuICAgICAgbiArPSB0ZXN0UmF0aW87XFxuICAgICAgaWYgKHJhbmRvbSA8IG4pIHtcXG4gICAgICAgIHNldENvb2tpZShjb29raWVOYW1lLCB2YXJpYW50LmlkKTtcXG4gICAgICAgIHZhcmlhbnRJZCA9IHZhcmlhbnQuaWQ7XFxuICAgICAgICBicmVhaztcXG4gICAgICB9XFxuICAgIH1cXG4gICAgaWYgKCF2YXJpYW50SWQpIHtcXG4gICAgICB2YXJpYW50SWQgPSBcXFwiXCIpLmNvbmNhdCh0LCdcIjtcXG4gICAgICBzZXRDb29raWUoY29va2llTmFtZSwgXCInKS5jb25jYXQodCwnXCIpO1xcbiAgICB9XFxuICB9XFxuICBpZiAodmFyaWFudElkICYmIHZhcmlhbnRJZCAhPT0gXCInKS5jb25jYXQodCxcIlxcXCIpIHtcXG4gICAgdmFyIHdpbm5pbmdUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RlbXBsYXRlW2RhdGEtdGVtcGxhdGUtdmFyaWFudC1pZD1cXFwiJyArIHZhcmlhbnRJZCArICdcXFwiXScpO1xcbiAgICBpZiAod2lubmluZ1RlbXBsYXRlKSB7XFxuICAgICAgdmFyIHBhcmVudE5vZGUgPSB3aW5uaW5nVGVtcGxhdGUucGFyZW50Tm9kZTtcXG4gICAgICB2YXIgbmV3UGFyZW50ID0gcGFyZW50Tm9kZS5jbG9uZU5vZGUoZmFsc2UpO1xcbiAgICAgIG5ld1BhcmVudC5hcHBlbmRDaGlsZCh3aW5uaW5nVGVtcGxhdGUuY29udGVudC5maXJzdENoaWxkKTtcXG4gICAgICBwYXJlbnROb2RlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG5ld1BhcmVudCwgcGFyZW50Tm9kZSk7XFxuICAgIH1cXG4gIH0gZWxzZSBpZiAodmFyaWFudHMubGVuZ3RoID4gMCkge1xcbiAgICByZW1vdmVWYXJpYW50cygpO1xcbiAgfVxcbn0pKClcIikucmVwbGFjZSgvXFxzKy9nLFwiIFwiKX0sVmFyaWFudHNQcm92aWRlcj1mdW5jdGlvbihlKXt2YXIgdD1lLmluaXRpYWxDb250ZW50LG49ZS5jaGlsZHJlbjtpZihCdWlsZGVyLmlzQnJvd3NlciYmIWJ1aWxkZXIuY2FuVHJhY2spcmV0dXJuIG4oW3RdKTtpZighQm9vbGVhbihPYmplY3Qua2V5cygobnVsbD09dD92b2lkIDA6dC52YXJpYXRpb25zKXx8e30pLmxlbmd0aCkpcmV0dXJuIG4oW3RdKTt2YXIgaT1PYmplY3Qua2V5cyh0LnZhcmlhdGlvbnMpLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKHtpZDplfSx0LnZhcmlhdGlvbnNbZV0pLHtkYXRhOmdldERhdGEodC52YXJpYXRpb25zW2VdKX0pfSkpLHI9X19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLGksITApLFt0XSwhMSk7aWYoQnVpbGRlci5pc1NlcnZlcil7dmFyIG89SlNPTi5zdHJpbmdpZnkoT2JqZWN0LmtleXModC52YXJpYXRpb25zfHx7fSkubWFwKChmdW5jdGlvbihlKXtyZXR1cm57aWQ6ZSx0ZXN0UmF0aW86dC52YXJpYXRpb25zW2VdLnRlc3RSYXRpb319KSkpO3JldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LG51bGwsbihyLChmdW5jdGlvbigpe3JldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIse2lkOlwidmFyaWFudHMtc2NyaXB0LVwiLmNvbmNhdCh0LmlkKSxkYW5nZXJvdXNseVNldElubmVySFRNTDp7X19odG1sOnZhcmlhbnRzU2NyaXB0KG8sdC5pZCl9fSl9KSkpfXZhciBhPVwiYnVpbGRlci50ZXN0cy5cIi5jb25jYXQodC5pZCkscz1idWlsZGVyLmdldENvb2tpZShhKTtpZighcyYmQnVpbGRlci5pc0Jyb3dzZXIpZm9yKHZhciBsPTAsdT1NYXRoLnJhbmRvbSgpLGQ9MDtkPGkubGVuZ3RoO2QrKyl7dmFyIGM9aVtkXTtpZih1PChsKz1jLnRlc3RSYXRpbykpe2J1aWxkZXIuc2V0Q29va2llKGEsYy5pZCkscz1jLmlkO2JyZWFrfX1yZXR1cm4gc3x8KHM9dC5pZCxidWlsZGVyLnNldENvb2tpZShhLHMpKSxuKFtyLmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlkPT09c30pKV0pfSxCdWlsZGVyQ29udGVudD1mdW5jdGlvbihfc3VwZXIpe2Z1bmN0aW9uIEJ1aWxkZXJDb250ZW50KCl7dmFyIF90aGlzPW51bGwhPT1fc3VwZXImJl9zdXBlci5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXM7cmV0dXJuIF90aGlzLnJlZj1udWxsLF90aGlzLnN0YXRlPXtsb2FkaW5nOiFfdGhpcy5wcm9wcy5jb250ZW50LGRhdGE6Z2V0Q29udGVudFdpdGhJbmZvKF90aGlzLnByb3BzLmNvbnRlbnQpLHVwZGF0ZXM6MX0sX3RoaXMub25XaW5kb3dNZXNzYWdlPWZ1bmN0aW9uKGV2ZW50KXt2YXIgX2EsX2IsbWVzc2FnZT1ldmVudC5kYXRhO2lmKG1lc3NhZ2Upc3dpdGNoKG1lc3NhZ2UudHlwZSl7Y2FzZVwiYnVpbGRlci5wYXRjaFVwZGF0ZXNcIjppZihudWxsPT09KF9hPV90aGlzLnByb3BzLm9wdGlvbnMpfHx2b2lkIDA9PT1fYT92b2lkIDA6X2Eubm9FZGl0b3JVcGRhdGVzKXJldHVybjt2YXIgZGF0YT1tZXNzYWdlLmRhdGE7aWYoIWRhdGF8fCFkYXRhLmRhdGEpYnJlYWs7dmFyIHBhdGNoZXM9ZGF0YS5kYXRhW251bGw9PT0oX2I9X3RoaXMuc3RhdGUuZGF0YSl8fHZvaWQgMD09PV9iP3ZvaWQgMDpfYi5pZF07aWYoIXBhdGNoZXN8fCFwYXRjaGVzLmxlbmd0aClyZXR1cm47bG9jYXRpb24uaHJlZi5pbmNsdWRlcyhcImJ1aWxkZXIuZGVidWc9dHJ1ZVwiKSYmZXZhbChcImRlYnVnZ2VyXCIpO2Zvcih2YXIgbmV3RGF0YT1fdGhpcy5zdGF0ZS5kYXRhLF9pPTAscGF0Y2hlc18xPXBhdGNoZXM7X2k8cGF0Y2hlc18xLmxlbmd0aDtfaSsrKXt2YXIgcGF0Y2g9cGF0Y2hlc18xW19pXTtuZXdEYXRhPWFwcGx5UGF0Y2hXaXRoTWluaW1hbE11dGF0aW9uQ2hhaW4obmV3RGF0YSxwYXRjaCwhMSl9X3RoaXMuc2V0U3RhdGUoe3VwZGF0ZXM6X3RoaXMuc3RhdGUudXBkYXRlcysxLGRhdGE6bmV3RGF0YX0pLF90aGlzLnByb3BzLmNvbnRlbnRMb2FkZWQmJl90aGlzLnByb3BzLmNvbnRlbnRMb2FkZWQobmV3RGF0YS5kYXRhLG5ld0RhdGEpfX0sX3RoaXMuc3Vic2NyaXB0aW9ucz1uZXcgU3Vic2NyaXB0aW9uLF90aGlzLmZpcnN0TG9hZD0hMCxfdGhpcy5jbGlja2VkPSExLF90aGlzLnRyYWNrZWRJbXByZXNzaW9uPSExLF90aGlzLmludGVyc2VjdGlvbk9ic2VydmVyPW51bGwsX3RoaXMub25DbGljaz1mdW5jdGlvbihlKXt2YXIgdD1lLm5hdGl2ZUV2ZW50LG49X3RoaXMuZGF0YTtuJiYoYnVpbGRlci5hdXRvVHJhY2smJl90aGlzLmJ1aWxkZXIudHJhY2tJbnRlcmFjdGlvbihuLmlkLF90aGlzLnJlbmRlcmVkVmFyaWFudElkLF90aGlzLmNsaWNrZWQsdCx7Y29udGVudDpufSksX3RoaXMuY2xpY2tlZHx8KF90aGlzLmNsaWNrZWQ9ITApKX0sX3RoaXN9cmV0dXJuIF9fZXh0ZW5kcyhCdWlsZGVyQ29udGVudCxfc3VwZXIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyQ29udGVudC5wcm90b3R5cGUsXCJidWlsZGVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BzLmJ1aWxkZXJ8fGJ1aWxkZXJ9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXJDb250ZW50LnByb3RvdHlwZSxcIm5hbWVcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5wcm9wcztyZXR1cm5cIm1vZGVsXCJpbiBlP2UubW9kZWw6ZS5tb2RlbE5hbWV9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXJDb250ZW50LnByb3RvdHlwZSxcInJlbmRlcmVkVmFyaWFudElkXCIse2dldDpmdW5jdGlvbigpe3ZhciBlLHQsbj10aGlzLnByb3BzLmlzU3RhdGljP3RoaXMuYnVpbGRlci5nZXRDb29raWUoXCJidWlsZGVyLnRlc3RzLlwiLmNvbmNhdChudWxsPT09KGU9dGhpcy5kYXRhKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5pZCkpOm51bGw9PT0odD10aGlzLmRhdGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LnZhcmlhdGlvbklkO2lmKG51bGwhPT1uKXJldHVybiBufSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyQ29udGVudC5wcm90b3R5cGUsXCJvcHRpb25zXCIse2dldDpmdW5jdGlvbigpe3ZhciBlLHQsbj1fX2Fzc2lnbih7fSx0aGlzLnByb3BzLm9wdGlvbnN8fHt9KTtyZXR1cm4gbi5rZXl8fCEobnVsbD09PShlPXRoaXMucHJvcHMuY29udGVudCl8fHZvaWQgMD09PWU/dm9pZCAwOmUuaWQpfHxCdWlsZGVyLmlzRWRpdGluZ3x8QnVpbGRlci5pc1ByZXZpZXdpbmd8fChuLmtleT10aGlzLnByb3BzLmNvbnRlbnQuaWQpLCF0aGlzLnByb3BzLmNvbnRlbnR8fChudWxsPT09KHQ9bi5pbml0aWFsQ29udGVudCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQubGVuZ3RoKXx8IXRoaXMucHJvcHMuaW5saW5lJiZCdWlsZGVyLmlzUHJldmlld2luZ3x8KG4uaW5pdGlhbENvbnRlbnQ9W3RoaXMucHJvcHMuY29udGVudF0pLG59LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXJDb250ZW50LnByb3RvdHlwZSxcImRhdGFcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIGU9KHRoaXMucHJvcHMuaW5saW5lfHwhQnVpbGRlci5pc0Jyb3dzZXJ8fHRoaXMuZmlyc3RMb2FkKSYmdGhpcy5vcHRpb25zLmluaXRpYWxDb250ZW50JiZ0aGlzLm9wdGlvbnMuaW5pdGlhbENvbnRlbnRbMF18fHRoaXMuc3RhdGUuZGF0YTtyZXR1cm4gZ2V0Q29udGVudFdpdGhJbmZvKGUpfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLEJ1aWxkZXJDb250ZW50LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudD1mdW5jdGlvbigpe3ZhciBlLHQ7aWYoIXRoaXMucHJvcHMuaW5saW5lfHxCdWlsZGVyLmlzRWRpdGluZ3x8QnVpbGRlci5pc1ByZXZpZXdpbmcpdGhpcy5zdWJzY3JpYmVUb0NvbnRlbnQoKTtlbHNlIGlmKHRoaXMucHJvcHMuaW5saW5lJiYobnVsbD09PSh0PW51bGw9PT0oZT10aGlzLm9wdGlvbnMpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmluaXRpYWxDb250ZW50KXx8dm9pZCAwPT09dD92b2lkIDA6dC5sZW5ndGgpKXt2YXIgbj10aGlzLm9wdGlvbnMuaW5pdGlhbENvbnRlbnRbMF07KG51bGw9PW4/dm9pZCAwOm4uaWQpJiZ0aGlzLmJ1aWxkZXIudHJhY2tJbXByZXNzaW9uKG4uaWQsdGhpcy5yZW5kZXJlZFZhcmlhbnRJZCx2b2lkIDAse2NvbnRlbnQ6bn0pfUJ1aWxkZXIuaXNFZGl0aW5nJiZhZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLHRoaXMub25XaW5kb3dNZXNzYWdlKX0sQnVpbGRlckNvbnRlbnQucHJvdG90eXBlLnN1YnNjcmliZVRvQ29udGVudD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7XCJfaW5saW5lXCIhPT10aGlzLm5hbWUmJnRoaXMuc3Vic2NyaXB0aW9ucy5hZGQodGhpcy5idWlsZGVyLnF1ZXVlR2V0Q29udGVudCh0aGlzLm5hbWUsdGhpcy5vcHRpb25zKS5zdWJzY3JpYmUoKGZ1bmN0aW9uKHQpe3ZhciBuPXQmJnRbMF07ZS5zZXRTdGF0ZSh7ZGF0YTpuLGxvYWRpbmc6ITF9KTt2YXIgaT0oZS5idWlsZGVyLmVkaXRpbmdNb2RlbHx8ZS5idWlsZGVyLnByZXZpZXdpbmdNb2RlbCk9PT1lLm5hbWU7aWYoIWUucHJvcHMuaW5saW5lJiZlLnByb3BzLmNvbnRlbnQmJmUuZmlyc3RMb2FkJiZpJiYoZS5maXJzdExvYWQ9ITEsZS5zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksZS5zdWJzY3JpYmVUb0NvbnRlbnQoKSksbiYmZS5maXJzdExvYWQmJihlLmZpcnN0TG9hZD0hMSxidWlsZGVyLmF1dG9UcmFjayYmIUJ1aWxkZXIuaXNFZGl0aW5nKSl7dmFyIHI9ITE7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgSW50ZXJzZWN0aW9uT2JzZXJ2ZXImJmUucmVmKXRyeXsoZS5pbnRlcnNlY3Rpb25PYnNlcnZlcj1uZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKGZ1bmN0aW9uKHQsaSl7dC5mb3JFYWNoKChmdW5jdGlvbih0KXt0LmludGVyc2VjdGlvblJhdGlvPjAmJiFlLnRyYWNrZWRJbXByZXNzaW9uJiYoZS5idWlsZGVyLnRyYWNrSW1wcmVzc2lvbihuLmlkLGUucmVuZGVyZWRWYXJpYW50SWQsdm9pZCAwLHtjb250ZW50OmUuZGF0YX0pLGUuZGF0YSxlLnRyYWNrZWRJbXByZXNzaW9uPSEwLGUucmVmJiZpLnVub2JzZXJ2ZShlLnJlZikpfSkpfSkpKS5vYnNlcnZlKGUucmVmKSxyPSEwfWNhdGNoKGUpe2NvbnNvbGUud2FybihcIkNvdWxkIG5vdCBiaW5kIGludGVyc2VjdGlvbiBvYnNlcnZlclwiKX1yfHwoZS50cmFja2VkSW1wcmVzc2lvbj0hMCxlLmJ1aWxkZXIudHJhY2tJbXByZXNzaW9uKG4uaWQsZS5yZW5kZXJlZFZhcmlhbnRJZCx2b2lkIDAse2NvbnRlbnQ6bn0pKX1lLnByb3BzLmNvbnRlbnRMb2FkZWQmJmUucHJvcHMuY29udGVudExvYWRlZChuJiZuLmRhdGEsbil9KSwoZnVuY3Rpb24odCl7ZS5wcm9wcy5jb250ZW50RXJyb3ImJihlLnByb3BzLmNvbnRlbnRFcnJvcih0KSxlLnNldFN0YXRlKHtsb2FkaW5nOiExfSkpfSkpKX0sQnVpbGRlckNvbnRlbnQucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50PWZ1bmN0aW9uKCl7QnVpbGRlci5pc0VkaXRpbmcmJnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsdGhpcy5vbldpbmRvd01lc3NhZ2UpLHRoaXMuc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpLHRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXImJnRoaXMucmVmJiZ0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyLnVub2JzZXJ2ZSh0aGlzLnJlZil9LEJ1aWxkZXJDb250ZW50LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKHRoaXMucHJvcHMuZGF0YU9ubHkpcmV0dXJuIG51bGw7dmFyIHQ9dGhpcy5zdGF0ZS5sb2FkaW5nLG49dGhpcy5kYXRhLGk9dGhpcy5wcm9wcy5kYXRhT25seT9Ob1dyYXA6XCJkaXZcIjtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChWYXJpYW50c1Byb3ZpZGVyLHtpbml0aWFsQ29udGVudDpufSwoZnVuY3Rpb24ocixvKXtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChSZWFjdF9fZGVmYXVsdC5GcmFnbWVudCxudWxsLHIubWFwKChmdW5jdGlvbihhLHMpe3ZhciBsPXM9PT1yLmxlbmd0aC0xP1JlYWN0X19kZWZhdWx0LkZyYWdtZW50OlwidGVtcGxhdGVcIjtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChSZWFjdF9fZGVmYXVsdC5GcmFnbWVudCx7a2V5OlN0cmluZygobnVsbD09YT92b2lkIDA6YS5pZCkrcyl9LFwidGVtcGxhdGVcIiE9PWwmJihudWxsPT1vP3ZvaWQgMDpvKCkpLFJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQobCxfX2Fzc2lnbih7a2V5OlN0cmluZygobnVsbD09YT92b2lkIDA6YS5pZCkrcyl9LFwidGVtcGxhdGVcIj09PWwmJntcImRhdGEtdGVtcGxhdGUtdmFyaWFudC1pZFwiOm51bGw9PWE/dm9pZCAwOmEuaWR9KSxSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KGksX19hc3NpZ24oe30sMD09PXMmJiFlLnByb3BzLmRhdGFPbmx5JiZ7cmVmOmZ1bmN0aW9uKHQpe3JldHVybiBlLnJlZj10fX0se2NsYXNzTmFtZTpcImJ1aWxkZXItY29udGVudFwiLG9uQ2xpY2s6ZS5vbkNsaWNrLFwiYnVpbGRlci1jb250ZW50LWlkXCI6bnVsbD09YT92b2lkIDA6YS5pZCxcImJ1aWxkZXItbW9kZWxcIjplLm5hbWV9KSxlLnByb3BzLmNoaWxkcmVuKG51bGw9PWE/dm9pZCAwOmEuZGF0YSwhZS5wcm9wcy5pbmxpbmUmJnQsbikpKSl9KSkpfSkpfSxCdWlsZGVyQ29udGVudH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxnZXRDb250ZW50V2l0aEluZm89ZnVuY3Rpb24oZSl7dmFyIHQ7aWYoZSl7dmFyIG49YnVpbGRlci5nZXRDb29raWUoXCJidWlsZGVyLnRlc3RzLlwiLmNvbmNhdChlLmlkKSksaT1uPT09ZS5pZD9lOm51bGw9PT0odD1lLnZhcmlhdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0W25dLHI9KG51bGw9PWk/dm9pZCAwOmkubmFtZSl8fCgobnVsbD09aT92b2lkIDA6aS5pZCk9PT1lLmlkP1wiRGVmYXVsdCB2YXJpYXRpb25cIjpcIlwiKTtyZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oe30sZSkse3ZhcmlhdGlvbklkOm4sdGVzdFZhcmlhdGlvbklkOm4sdGVzdFZhcmlhdGlvbk5hbWU6cn0pfXJldHVybiBudWxsfTtmdW5jdGlvbiB1bndyYXBFeHBvcnRzKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGUmJk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLFwiZGVmYXVsdFwiKT9lLmRlZmF1bHQ6ZX1mdW5jdGlvbiBjcmVhdGVDb21tb25qc01vZHVsZShlLHQpe3JldHVybiBlKHQ9e2V4cG9ydHM6e319LHQuZXhwb3J0cyksdC5leHBvcnRzfXZhciBvbkNoYW5nZV8xPWNyZWF0ZUNvbW1vbmpzTW9kdWxlKChmdW5jdGlvbihlLHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBuPVN5bWJvbChcInRhcmdldFwiKSxpPVN5bWJvbChcInVuc3Vic2NyaWJlXCIpLHI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdCYmdC50b1N0cmluZyYmKGUmJihlKz1cIi5cIiksZSs9dC50b1N0cmluZygpKSxlfSxvPWZ1bmN0aW9uKGUpe3JldHVybiBBcnJheS5pc0FycmF5KGUpP2Uuc2xpY2UoKTpPYmplY3QuYXNzaWduKHt9LGUpfSxhPWZ1bmN0aW9uKGUsdCxhKXtpZihcInVuZGVmaW5lZFwiPT10eXBlb2YgUHJveHkpcmV0dXJuIGU7dm9pZCAwPT09YSYmKGE9e30pO3ZhciBzLGwsdT1TeW1ib2woXCJQcm94eVRhcmdldFwiKSxkPSExLGM9ITEscD0hMSxmPWEuZXF1YWxzfHxPYmplY3QuaXMsbT1uZXcgV2Vha01hcCxoPW5ldyBXZWFrTWFwLGc9bmV3IFdlYWtNYXAsdj1mdW5jdGlvbihlLG4saSxhKXtpZighcClpZihkKXtpZihkJiZsJiZ2b2lkIDAhPT1pJiZ2b2lkIDAhPT1hJiZcImxlbmd0aFwiIT09bil7dmFyIHU9bDtlIT09cyYmZnVuY3Rpb24oZSx0KXtmb3IodmFyIG47ZTspLTE9PT0obj1lLmluZGV4T2YoXCIuXCIpKSYmKG49ZS5sZW5ndGgpLHQoZS5zbGljZSgwLG4pKSxlPWUuc2xpY2UobisxKX0oZT1lLnJlcGxhY2UocyxcIlwiKS5zbGljZSgxKSwoZnVuY3Rpb24oZSl7dVtlXT1vKHVbZV0pLHU9dVtlXX0pKSx1W25dPWl9Yz0hMH1lbHNlIHQocihlLG4pLGEsaSl9LGI9ZnVuY3Rpb24oZSx0KXt2YXIgbj1tP20uZ2V0KGUpOnZvaWQgMDtuJiZuLmRlbGV0ZSh0KX0seT1mdW5jdGlvbihlLHQpe2lmKHApcmV0dXJuIGU7aC5zZXQoZSx0KTt2YXIgbj1nLmdldChlKTtyZXR1cm4gdm9pZCAwPT09biYmKG49bmV3IFByb3h5KGUseCksZy5zZXQoZSxuKSksbn0sXz1mdW5jdGlvbihlKXtyZXR1cm4gcHx8ITA9PT1hLmlnbm9yZVN5bWJvbHMmJlwic3ltYm9sXCI9PXR5cGVvZiBlfSx4PXtnZXQ6ZnVuY3Rpb24oZSx0LG8pe2lmKHQ9PT11fHx0PT09bilyZXR1cm4gZTtpZih0PT09aSYmXCJcIj09PWguZ2V0KGUpKXJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gcD0hMCxtPW51bGwsaD1udWxsLGc9bnVsbCxlfShlKTt2YXIgcz1SZWZsZWN0LmdldChlLHQsbyk7aWYoZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PT1lfHxcIm9iamVjdFwiIT10eXBlb2YgZSYmXCJmdW5jdGlvblwiIT10eXBlb2YgZX0ocyl8fGZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgUmVnRXhwfHxlIGluc3RhbmNlb2YgTnVtYmVyfShzKXx8XCJjb25zdHJ1Y3RvclwiPT09dHx8ITA9PT1hLmlzU2hhbGxvdylyZXR1cm4gczt2YXIgbD1mdW5jdGlvbihlLHQpe3ZhciBuPW0/bS5nZXQoZSk6dm9pZCAwO2lmKG4pcmV0dXJuIG47bj1uZXcgTWFwLG0uc2V0KGUsbik7dmFyIGk9bi5nZXQodCk7cmV0dXJuIGl8fChpPVJlZmxlY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCksbi5zZXQodCxpKSksaX0oZSx0KTtpZihsJiYhbC5jb25maWd1cmFibGUpe2lmKGwuc2V0JiYhbC5nZXQpcmV0dXJuO2lmKCExPT09bC53cml0YWJsZSlyZXR1cm4gc31yZXR1cm4geShzLHIoaC5nZXQoZSksdCkpfSxzZXQ6ZnVuY3Rpb24oZSx0LG4saSl7biYmdm9pZCAwIT09blt1XSYmKG49blt1XSk7dmFyIHI9Xyh0KSxvPXI/bnVsbDpSZWZsZWN0LmdldChlLHQsaSksYT1SZWZsZWN0LnNldChlW3VdfHxlLHQsbik7cmV0dXJuIHJ8fGYobyxuKXx8dihoLmdldChlKSx0LG8sbiksYX0sZGVmaW5lUHJvcGVydHk6ZnVuY3Rpb24oZSx0LG4pe3ZhciBpPVJlZmxlY3QuZGVmaW5lUHJvcGVydHkoZSx0LG4pO3JldHVybiBfKHQpfHwoYihlLHQpLHYoaC5nZXQoZSksdCx2b2lkIDAsbi52YWx1ZSkpLGl9LGRlbGV0ZVByb3BlcnR5OmZ1bmN0aW9uKGUsdCl7aWYoIVJlZmxlY3QuaGFzKGUsdCkpcmV0dXJuITA7dmFyIG49Xyh0KSxpPW4/bnVsbDpSZWZsZWN0LmdldChlLHQpLHI9UmVmbGVjdC5kZWxldGVQcm9wZXJ0eShlLHQpO3JldHVybiBufHwoYihlLHQpLHYoaC5nZXQoZSksdCxpKSkscn0sYXBwbHk6ZnVuY3Rpb24oZSx0LG4pe3ZhciBpPXQgaW5zdGFuY2VvZiBEYXRlO2lmKGkmJih0PXRbdV0pLCFkKXtkPSEwLGkmJihsPXQudmFsdWVPZigpKSwoQXJyYXkuaXNBcnJheSh0KXx8XCJbb2JqZWN0IE9iamVjdF1cIj09PXRvU3RyaW5nLmNhbGwodCkpJiYobD1vKHRbdV0pKSxzPShzPWguZ2V0KGUpKS5zbGljZSgwLE1hdGgubWF4KHMubGFzdEluZGV4T2YoXCIuXCIpLDApKTt2YXIgcj1SZWZsZWN0LmFwcGx5KGUsdCxuKTtyZXR1cm4gZD0hMSwoY3x8aSYmIWYobCx0LnZhbHVlT2YoKSkpJiYodihzLFwiXCIsbCx0W3VdfHx0KSxsPW51bGwsYz0hMSkscn1yZXR1cm4gUmVmbGVjdC5hcHBseShlLHQsbil9fSxTPXkoZSxcIlwiKTtyZXR1cm4gdD10LmJpbmQoUyksU307YS50YXJnZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGVbbl18fGV9LGEudW5zdWJzY3JpYmU9ZnVuY3Rpb24oZSl7cmV0dXJuIGVbaV18fGV9LGUuZXhwb3J0cz1hLHQuZGVmYXVsdD1hfSkpLG9uQ2hhbmdlPXVud3JhcEV4cG9ydHMob25DaGFuZ2VfMSksbmV4dFRpY2s9QnVpbGRlci5uZXh0VGljaztmdW5jdGlvbiBkZWJvdW5jZU5leHRUaWNrKGUsdCxuKXtyZXR1cm4gdm9pZCAwPT09dCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZT9kZWJvdW5jZU5leHRUaWNrSW1wbChlKTp7Y29uZmlndXJhYmxlOiEwLGVudW1lcmFibGU6bi5lbnVtZXJhYmxlLGdldDpmdW5jdGlvbigpe3JldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyx0LHtjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTpuLmVudW1lcmFibGUsdmFsdWU6ZGVib3VuY2VOZXh0VGlja0ltcGwobi52YWx1ZSl9KSx0aGlzW3RdfX19ZnVuY3Rpb24gZGVib3VuY2VOZXh0VGlja0ltcGwoZSl7dmFyIHQ9bnVsbCxuPW51bGw7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU9dDtpZih0PVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSxuPXRoaXMsbnVsbCE9PWUpcmV0dXJuO25leHRUaWNrKGkpfTtmdW5jdGlvbiBpKCl7ZS5hcHBseShuLHQpLHQ9bnVsbCxuPW51bGx9fWZ1bmN0aW9uIHRocm90dGxlKGUsdCxuKXt2YXIgaSxyLG87dm9pZCAwPT09biYmKG49e30pO3ZhciBhPW51bGwscz0wLGw9ZnVuY3Rpb24oKXtzPSExPT09bi5sZWFkaW5nPzA6RGF0ZS5ub3coKSxhPW51bGwsbz1lLmFwcGx5KGksciksYXx8KGk9cj1udWxsKX07cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHU9RGF0ZS5ub3coKTtzfHwhMSE9PW4ubGVhZGluZ3x8KHM9dSk7dmFyIGQ9dC0odS1zKTtyZXR1cm4gaT10aGlzLHI9YXJndW1lbnRzLGQ8PTB8fGQ+dD8oYSYmKGNsZWFyVGltZW91dChhKSxhPW51bGwpLHM9dSxvPWUuYXBwbHkoaSxyKSxhfHwoaT1yPW51bGwpKTphfHwhMT09PW4udHJhaWxpbmd8fChhPXNldFRpbWVvdXQobCxkKSksb319dmFyIEJ1aWxkZXJNZXRhQ29udGV4dD1SZWFjdF9fZGVmYXVsdC5jcmVhdGVDb250ZXh0KHtlbWFpbE1vZGU6ITEsYW1wTW9kZTohMSxpc1NlcnZlcjohMX0pLHRyeUV2YWw9ZnVuY3Rpb24oZSx0LG4pe3ZvaWQgMD09PXQmJih0PXt9KTt2YXIgaT1lO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBpJiZpLnRyaW0oKSl7dmFyIHI9IShpLmluY2x1ZGVzKFwiO1wiKXx8aS5pbmNsdWRlcyhcIiByZXR1cm4gXCIpKSxvPWZ1bmN0aW9uKCl7fTt0cnl7QnVpbGRlci5pc0Jyb3dzZXImJihvPW5ldyBGdW5jdGlvbihcInN0YXRlXCIsXCJ2YXIgcm9vdFN0YXRlID0gc3RhdGU7XFxuICAgICAgICBpZiAodHlwZW9mIFByb3h5ICE9PSAndW5kZWZpbmVkJykge1xcbiAgICAgICAgICByb290U3RhdGUgPSBuZXcgUHJveHkocm9vdFN0YXRlLCB7XFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoKSB7XFxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XFxuICAgICAgICAgICAgfSxcXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICh0YXJnZXQsIGtleSkge1xcbiAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3N0YXRlJykge1xcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGU7XFxuICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0W2tleV1cXG4gICAgICAgICAgICB9XFxuICAgICAgICAgIH0pO1xcbiAgICAgICAgfVxcbiAgICAgICAgd2l0aCAocm9vdFN0YXRlKSB7XFxuICAgICAgICAgIFwiLmNvbmNhdChyP1wicmV0dXJuIChcIi5jb25jYXQoZSxcIik7XCIpOmUsXCI7XFxuICAgICAgICB9XCIpKSl9Y2F0Y2goZSl7QnVpbGRlci5pc0Jyb3dzZXImJmNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBjb21waWxlIGphdmFzY3JpcHRcIixlKX10cnl7aWYoQnVpbGRlci5pc0Jyb3dzZXJ8fHNob3VsZEZvcmNlQnJvd3NlclJ1bnRpbWVJbk5vZGUoKSlyZXR1cm4gbyh0fHx7fSk7dmFyIGE9c2FmZUR5bmFtaWNSZXF1aXJlKFwiaXNvbGF0ZWQtdm1cIikscz1nZXRJc29sYXRlQ29udGV4dCgpLGw9bWFrZUZuKGUscixbXCJzdGF0ZVwiXSksdT1zLmV2YWxDbG9zdXJlU3luYyhsLFtuZXcgYS5SZWZlcmVuY2UodHx8e30pXSk7dHJ5e3JldHVybiBKU09OLnBhcnNlKHUpfWNhdGNoKGUpe3JldHVybiB1fX1jYXRjaCh0KXtuJiZuLnB1c2godCksQnVpbGRlci5pc0Jyb3dzZXI/Y29uc29sZS53YXJuKFwiQnVpbGRlciBjdXN0b20gY29kZSBlcnJvcjpcIix0Lm1lc3NhZ2UsXCJpblwiLGUsdC5zdGFjayk6aXNEZWJ1ZygpJiZjb25zb2xlLmRlYnVnKFwiQnVpbGRlciBjdXN0b20gY29kZSBlcnJvcjpcIix0Lm1lc3NhZ2UsXCJpblwiLGUsdC5zdGFjayl9fX07ZnVuY3Rpb24gdG9FcnJvcihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEVycm9yP2U6bmV3IEVycm9yKFN0cmluZyhlKSl9ZnVuY3Rpb24gZ2V0QnVpbGRlclBpeGVsKGUpe3JldHVybntpZDpcImJ1aWxkZXItcGl4ZWwtXCIrTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3BsaXQoXCIuXCIpWzFdLFwiQHR5cGVcIjpcIkBidWlsZGVyLmlvL3NkazpFbGVtZW50XCIsdGFnTmFtZTpcImltZ1wiLHByb3BlcnRpZXM6e3JvbGU6XCJwcmVzZW50YXRpb25cIixcImFyaWEtaGlkZGVuXCI6XCJ0cnVlXCIsc3JjOlwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9hcGkvdjEvcGl4ZWw/YXBpS2V5PVwiLmNvbmNhdChlKX0scmVzcG9uc2l2ZVN0eWxlczp7bGFyZ2U6e2hlaWdodDpcIjBcIix3aWR0aDpcIjBcIixkaXNwbGF5OlwiaW5saW5lLWJsb2NrXCIsb3BhY2l0eTpcIjBcIixvdmVyZmxvdzpcImhpZGRlblwiLHBvaW50ZXJFdmVudHM6XCJub25lXCJ9fX19ZnVuY3Rpb24gcGljayhlKXtmb3IodmFyIHQ9W10sbj0xO248YXJndW1lbnRzLmxlbmd0aDtuKyspdFtuLTFdPWFyZ3VtZW50c1tuXTt2YXIgaT17fTtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbih0KXtpW3RdPWVbdF19KSksaX1mdW5jdGlvbiBvbWl0KGUpe2Zvcih2YXIgdD1bXSxuPTE7bjxhcmd1bWVudHMubGVuZ3RoO24rKyl0W24tMV09YXJndW1lbnRzW25dO3ZhciBpPV9fYXNzaWduKHt9LGUpO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2RlbGV0ZSBpW2VdfSkpLGl9dmFyIGluc3RhbmNlc01hcD1uZXcgTWFwLHdyYXBDb21wb25lbnQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3ZhciBuLGk9dC5idWlsZGVyVGFnfHxcImRpdlwiLHI9W1wiY2hpbGRyZW5cIl0uY29uY2F0KChudWxsPT09KG49ZS5pbnB1dHMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUubmFtZX0pKSl8fFtdKSxvPW9taXQuYXBwbHkodm9pZCAwLF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbdF0sciwhMSksW1wiYXR0cmlidXRlc1wiXSwhMSkpLGE9dDtyZXR1cm4gZS5ub1dyYXA/UmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChlLmNsYXNzLF9fYXNzaWduKHthdHRyaWJ1dGVzOm99LGEpKTpSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KGksX19hc3NpZ24oe30sbyksUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChlLmNsYXNzLF9fYXNzaWduKHt9LGEpKSl9fSxzaXplJDE9ZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdC5rZXlzKGUpLmxlbmd0aH07ZnVuY3Rpb24gZGVib3VuY2UoZSx0LG4pe3ZhciBpO3JldHVybiB2b2lkIDA9PT1uJiYobj0hMSksZnVuY3Rpb24oKXt2YXIgcj10aGlzLG89YXJndW1lbnRzO2NsZWFyVGltZW91dChpKSxpPXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7aT1udWxsLG58fGUuYXBwbHkocixvKX0pLHQpLG4mJiFpJiZlLmFwcGx5KHIsbyl9fXZhciBmb250c0xvYWRlZD1uZXcgU2V0LGZldGNoJDE7Z2xvYmFsVGhpcy5mZXRjaCYmKGZldGNoJDE9Z2xvYmFsVGhpcy5mZXRjaCksbnVsbCE9ZmV0Y2gkMXx8KGZldGNoJDE9cmVxdWlyZShcIm5vZGUtZmV0Y2hcIikpO3ZhciBzaXplTWFwPXtkZXNrdG9wOlwibGFyZ2VcIix0YWJsZXQ6XCJtZWRpdW1cIixtb2JpbGU6XCJzbWFsbFwifSxmZXRjaENhY2hlPXt9O2Z1bmN0aW9uIHNlYXJjaFRvT2JqZWN0JDEoZSl7dmFyIHQ9KGUuc2VhcmNofHxcIlwiKS5zdWJzdHJpbmcoMSkuc3BsaXQoXCImXCIpLG49e307Zm9yKHZhciBpIGluIHQpaWYodFtpXSYmXCJzdHJpbmdcIj09dHlwZW9mIHRbaV0pe3ZhciByPXRbaV0uc3BsaXQoXCI9XCIpO25bZGVjb2RlVVJJQ29tcG9uZW50KHJbMF0pXT1kZWNvZGVVUklDb21wb25lbnQoclsxXSl9cmV0dXJuIG59dmFyIEJ1aWxkZXJDb21wb25lbnQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0KXt2YXIgbixpLHI9dGhpczsocj1lLmNhbGwodGhpcyx0KXx8dGhpcykuc3Vic2NyaXB0aW9ucz1uZXcgU3Vic2NyaXB0aW9uLHIub25TdGF0ZUNoYW5nZT1uZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpLHIuYXNTZXJ2ZXI9QnVpbGRlci5pc1NlcnZlcixyLmNvbnRlbnRSZWY9bnVsbCxyLnN0eWxlUmVmPW51bGwsci5yb290U3RhdGU9QnVpbGRlci5pc1NlcnZlcj97fTpvbkNoYW5nZSh7fSwoZnVuY3Rpb24oKXtyZXR1cm4gci51cGRhdGVTdGF0ZSgpfSkpLHIubGFzdEpzQ29kZT1cIlwiLHIubGFzdEh0dHBSZXF1ZXN0cz17fSxyLmh0dHBTdWJzY3JpcHRpb25QZXJLZXk9e30sci5maXJzdExvYWQ9ITAsci5yZWY9bnVsbCxyLm1lc3NhZ2VMaXN0ZW5lcj1mdW5jdGlvbihlKXt2YXIgdCxuPWUuZGF0YTtzd2l0Y2gobi50eXBlKXtjYXNlXCJidWlsZGVyLmNvbmZpZ3VyZVNka1wiOnZhciBpPW4uZGF0YTtpZighaS5jb250ZW50SWR8fGkuY29udGVudElkIT09KG51bGw9PT0odD1yLnVzZUNvbnRlbnQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmlkKSlyZXR1cm47ci5zaXplcz1nZXRTaXplc0ZvckJyZWFrcG9pbnRzKGkuYnJlYWtwb2ludHN8fHt9KSxyLnNldFN0YXRlKHtzdGF0ZTpPYmplY3QuYXNzaWduKHIucm9vdFN0YXRlLHtkZXZpY2VTaXplOnIuZGV2aWNlU2l6ZVN0YXRlLGRldmljZTpyLmRldmljZX0pLHVwZGF0ZXM6KHIuc3RhdGUmJnIuc3RhdGUudXBkYXRlc3x8MCkrMSxicmVha3BvaW50czppLmJyZWFrcG9pbnRzfSk7YnJlYWs7Y2FzZVwiYnVpbGRlci51cGRhdGVTcGFjZXJcIjp2YXIgbz1uLmRhdGE7ci5yb290U3RhdGUuX3NwYWNlcixyLnVwZGF0ZVN0YXRlKChmdW5jdGlvbihlKXtlLl9zcGFjZXI9b30pKTticmVhaztjYXNlXCJidWlsZGVyLnJlc2V0U3RhdGVcIjp2YXIgYT1uLmRhdGEscz1hLnN0YXRlO2lmKGEubW9kZWw9PT1yLm5hbWUpe2Zvcih2YXIgbCBpbiByLnJvb3RTdGF0ZSlcImZ1bmN0aW9uXCIhPXR5cGVvZiByLnJvb3RTdGF0ZVtsXSYmZGVsZXRlIHIucm9vdFN0YXRlW2xdO09iamVjdC5hc3NpZ24oci5yb290U3RhdGUscyksci5zZXRTdGF0ZShfX2Fzc2lnbihfX2Fzc2lnbih7fSxyLnN0YXRlKSx7c3RhdGU6ci5yb290U3RhdGUsdXBkYXRlczooci5zdGF0ZSYmci5zdGF0ZS51cGRhdGVzfHwwKSsxfSkpfWJyZWFrO2Nhc2VcImJ1aWxkZXIucmVzZXRTeW1ib2xTdGF0ZVwiOnZhciB1PW4uZGF0YS5zdGF0ZSxkPShzPXUuc3RhdGUsdS5tb2RlbCx1LmlkKTtpZihyLnByb3BzLmJ1aWxkZXJCbG9jayYmci5wcm9wcy5idWlsZGVyQmxvY2s9PT1kKXtmb3IodmFyIGwgaW4gci5yb290U3RhdGUpZGVsZXRlIHIucm9vdFN0YXRlW2xdO09iamVjdC5hc3NpZ24oci5yb290U3RhdGUscyksci5zZXRTdGF0ZShfX2Fzc2lnbihfX2Fzc2lnbih7fSxyLnN0YXRlKSx7c3RhdGU6ci5yb290U3RhdGUsdXBkYXRlczooci5zdGF0ZSYmci5zdGF0ZS51cGRhdGVzfHwwKSsxfSkpfX19LHIucmVzaXplRm49ZnVuY3Rpb24oKXt2YXIgZT1yLmRldmljZVNpemVTdGF0ZTtlIT09ci5zdGF0ZS5zdGF0ZS5kZXZpY2VTaXplJiZyLnNldFN0YXRlKF9fYXNzaWduKF9fYXNzaWduKHt9LHIuc3RhdGUpLHt1cGRhdGVzOihyLnN0YXRlJiZyLnN0YXRlLnVwZGF0ZXN8fDApKzEsc3RhdGU6T2JqZWN0LmFzc2lnbihyLnJvb3RTdGF0ZSxfX2Fzc2lnbihfX2Fzc2lnbih7fSxyLnN0YXRlLnN0YXRlKSx7ZGV2aWNlU2l6ZTplfSkpfSkpfSxyLnJlc2l6ZUxpc3RlbmVyPUJ1aWxkZXIuaXNFZGl0aW5nP3Rocm90dGxlKHIucmVzaXplRm4sMjAwKTpkZWJvdW5jZShyLnJlc2l6ZUZuLDQwMCksci5tb3VudGVkPSExLHIudXBkYXRlU3RhdGU9ZnVuY3Rpb24oZSl7dmFyIHQ9ci5yb290U3RhdGU7ZSYmZSh0KSxyLm1vdW50ZWQ/ci5zZXRTdGF0ZSh7dXBkYXRlOnIudXBkYXRlU3RhdGUsc3RhdGU6dCx1cGRhdGVzOihyLnN0YXRlJiZyLnN0YXRlLnVwZGF0ZXN8fDApKzF9KTpyLnN0YXRlPV9fYXNzaWduKF9fYXNzaWduKHt9LHIuc3RhdGUpLHt1cGRhdGU6ci51cGRhdGVTdGF0ZSxzdGF0ZTp0LHVwZGF0ZXM6KHIuc3RhdGUmJnIuc3RhdGUudXBkYXRlc3x8MCkrMX0pLHIubm90aWZ5U3RhdGVDaGFuZ2UoKX0sci5vbkNvbnRlbnRMb2FkZWQ9ZnVuY3Rpb24oZSx0KXtpZihcInBhZ2VcIj09PXIubmFtZSYmQnVpbGRlci5pc0Jyb3dzZXImJmUpe3ZhciBuPWUudGl0bGUsaT1lLnBhZ2VUaXRsZSxvPWUuZGVzY3JpcHRpb24sYT1lLnBhZ2VEZXNjcmlwdGlvbjtpZigobnx8aSkmJihkb2N1bWVudC50aXRsZT1ufHxpKSxvfHxhKXt2YXIgcz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9XCJkZXNjcmlwdGlvblwiXScpO3N8fCgocz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibWV0YVwiKSkuc2V0QXR0cmlidXRlKFwibmFtZVwiLFwiZGVzY3JpcHRpb25cIiksZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzKSkscy5zZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIsb3x8YSl9fWlmKEJ1aWxkZXIuaXNFZGl0aW5nJiZyLm5vdGlmeVN0YXRlQ2hhbmdlKCksci5wcm9wcy5jb250ZW50TG9hZGVkJiZyLnByb3BzLmNvbnRlbnRMb2FkZWQoZSx0KSxlJiZlLmlucHV0cyYmQXJyYXkuaXNBcnJheShlLmlucHV0cykmJmUuaW5wdXRzLmxlbmd0aCYmKGUuc3RhdGV8fChlLnN0YXRlPXt9KSxlLmlucHV0cy5mb3JFYWNoKChmdW5jdGlvbih0KXt0JiZ0Lm5hbWUmJnZvaWQgMCE9PXQuZGVmYXVsdFZhbHVlJiZ2b2lkIDA9PT1lLnN0YXRlW3QubmFtZV0mJihlLnN0YXRlW3QubmFtZV09dC5kZWZhdWx0VmFsdWUpfSkpKSxlJiZlLnN0YXRlKXt2YXIgbD1fX2Fzc2lnbihfX2Fzc2lnbih7fSxyLnN0YXRlKSx7dXBkYXRlczooci5zdGF0ZSYmci5zdGF0ZS51cGRhdGVzfHwwKSsxLHN0YXRlOk9iamVjdC5hc3NpZ24oci5yb290U3RhdGUsX19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oe30sci5zdGF0ZS5zdGF0ZSkse2xvY2F0aW9uOnIubG9jYXRpb25TdGF0ZSxkZXZpY2U6ci5kZXZpY2V9KSxlLnN0YXRlKSxyLmV4dGVybmFsU3RhdGUpLHtkZXZpY2VTaXplOnIuZGV2aWNlU2l6ZVN0YXRlfSkpfSk7ci5tb3VudGVkP3Iuc2V0U3RhdGUobCk6ci5zdGF0ZT1sfWlmKGUmJmUuanNDb2RlJiZCdWlsZGVyLmlzQnJvd3NlciYmIXIub3B0aW9ucy5jb2RlZ2VuKXt2YXIgdT0hMTtpZihCdWlsZGVyLmlzRWRpdGluZyYmKHIubGFzdEpzQ29kZT09PWUuanNDb2RlP3U9ITA6ci5sYXN0SnNDb2RlPWUuanNDb2RlKSwhdSl7dmFyIGQ9ci5zdGF0ZS5zdGF0ZTt0cnl7bmV3IEZ1bmN0aW9uKFwiZGF0YVwiLFwicmVmXCIsXCJzdGF0ZVwiLFwidXBkYXRlXCIsXCJlbGVtZW50XCIsXCJCdWlsZGVyXCIsXCJidWlsZGVyXCIsXCJjb250ZXh0XCIsZS5qc0NvZGUpKGUscixkLHIuc3RhdGUudXBkYXRlLHIucmVmLEJ1aWxkZXIsYnVpbGRlcixyLnN0YXRlLmNvbnRleHQpfWNhdGNoKHQpe3ZhciBjPXRvRXJyb3IodCk7QnVpbGRlci5pc0Jyb3dzZXI/Y29uc29sZS53YXJuKFwiQnVpbGRlciBjdXN0b20gY29kZSBlcnJvcjpcIixjLm1lc3NhZ2UsXCJpblwiLGUuanNDb2RlLGMuc3RhY2spOmlzRGVidWcoKSYmY29uc29sZS5kZWJ1ZyhcIkJ1aWxkZXIgY3VzdG9tIGNvZGUgZXJyb3I6XCIsYy5tZXNzYWdlLFwiaW5cIixlLmpzQ29kZSxjLnN0YWNrKX19fWlmKGUmJmUuaHR0cFJlcXVlc3RzJiYhci5wcm9wcy5ub0FzeW5jJiYhKHU9ITEpKXt2YXIgcD1mdW5jdGlvbih0KXt2YXIgbj1lLmh0dHBSZXF1ZXN0c1t0XTtpZihuJiYoIXIuZGF0YVt0XXx8QnVpbGRlci5pc0VkaXRpbmcpKWlmKEJ1aWxkZXIuaXNCcm93c2VyKXt2YXIgaT1yLmV2YWxFeHByZXNzaW9uKG4pO2lmKEJ1aWxkZXIuaXNFZGl0aW5nJiZyLmxhc3RIdHRwUmVxdWVzdHNbdF09PT1pKXJldHVyblwiY29udGludWVcIjtyLmxhc3RIdHRwUmVxdWVzdHNbdF09aTt2YXIgbz1uLm1hdGNoKC9idWlsZGVyXFwuaW9cXC9hcGlcXC92MlxcLyhbXlxcL1xcP10rKS9pKTtvJiZvWzFdLHIuaGFuZGxlUmVxdWVzdCh0LGkpO3ZhciBhPXIuaHR0cFN1YnNjcmlwdGlvblBlcktleVt0XTthJiZhLnVuc3Vic2NyaWJlKCk7dmFyIHM9ci5odHRwU3Vic2NyaXB0aW9uUGVyS2V5W3RdPXIub25TdGF0ZUNoYW5nZS5zdWJzY3JpYmUoKGZ1bmN0aW9uKCl7dmFyIGU9ci5ldmFsRXhwcmVzc2lvbihuKTtlIT09aSYmKHIuaGFuZGxlUmVxdWVzdCh0LGUpLHIubGFzdEh0dHBSZXF1ZXN0c1t0XT1lKX0pKTtyLnN1YnNjcmlwdGlvbnMuYWRkKHMpfWVsc2Ugci5oYW5kbGVSZXF1ZXN0KHQsci5ldmFsRXhwcmVzc2lvbihuKSl9O2Zvcih2YXIgZiBpbiBlLmh0dHBSZXF1ZXN0cylwKGYpfX07dmFyIG89ci5pbmxpbmVkQ29udGVudDtvJiZvLmNvbnRlbnQmJihvPW8uY29udGVudCksci5zaXplcz1nZXRTaXplc0ZvckJyZWFrcG9pbnRzKChudWxsPT09KG49bnVsbD09bz92b2lkIDA6by5tZXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5icmVha3BvaW50cyl8fHt9KTt2YXIgYT1udWxsPT09KGk9ci5pbmxpbmVkQ29udGVudCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuZGF0YTtpZihhJiZBcnJheS5pc0FycmF5KGEuaW5wdXRzKSYmYS5pbnB1dHMubGVuZ3RoPjAmJihhLnN0YXRlfHwoYS5zdGF0ZT17fSksYS5pbnB1dHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZSYmZS5uYW1lJiZ2b2lkIDAhPT1lLmRlZmF1bHRWYWx1ZSYmdm9pZCAwPT09YS5zdGF0ZVtlLm5hbWVdJiYoYS5zdGF0ZVtlLm5hbWVdPWUuZGVmYXVsdFZhbHVlKX0pKSksci5zdGF0ZT17Y29udGV4dDpfX2Fzc2lnbihfX2Fzc2lnbih7fSx0LmNvbnRleHQpLHthcGlLZXk6ci5wcm9wcy5hcGlLZXl8fGJ1aWxkZXIuYXBpS2V5fSksc3RhdGU6T2JqZWN0LmFzc2lnbihyLnJvb3RTdGF0ZSxfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbih7fSxyLmlubGluZWRDb250ZW50JiZyLmlubGluZWRDb250ZW50LmRhdGEmJnIuaW5saW5lZENvbnRlbnQuZGF0YS5zdGF0ZSkse2lzQnJvd3NlcjpCdWlsZGVyLmlzQnJvd3Nlcixpc1NlcnZlcjohQnVpbGRlci5pc0Jyb3dzZXIsX2h5ZHJhdGU6dC5oeWRyYXRlLGxvY2F0aW9uOnIubG9jYXRpb25TdGF0ZSxkZXZpY2VTaXplOnIuZGV2aWNlU2l6ZVN0YXRlLGRldmljZTpyLmRldmljZX0pLHIuZ2V0SHRtbERhdGEoKSksdC5kYXRhKSksdXBkYXRlczowLGtleTowLHVwZGF0ZTpyLnVwZGF0ZVN0YXRlfSxCdWlsZGVyLmlzQnJvd3Nlcil7dmFyIHM9ci5wcm9wcy5hcGlLZXk7aWYocyYmcyE9PXIuYnVpbGRlci5hcGlLZXkmJiFpbnN0YW5jZXNNYXAuaGFzKHMpKXt2YXIgbD1uZXcgQnVpbGRlcihzLHZvaWQgMCx2b2lkIDAsITApO2luc3RhbmNlc01hcC5zZXQocyxsKX1pZihyLmlubGluZWRDb250ZW50KXt2YXIgdT1yLmlubGluZWRDb250ZW50LmNvbnRlbnR8fHIuaW5saW5lZENvbnRlbnQ7ci5vbkNvbnRlbnRMb2FkZWQobnVsbD09dT92b2lkIDA6dS5kYXRhLGdldENvbnRlbnRXaXRoSW5mbyh1KSl9fXJldHVybiByLnJlZ2lzdGVyQ3VzdG9tQ29tcG9uZW50cygpLHJ9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm9wdGlvbnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKHt9LHQuZGVmYXVsdHMpLHRoaXMucHJvcHMpfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm5hbWVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvcHMubW9kZWx8fHRoaXMucHJvcHMubW9kZWxOYW1lfHx0aGlzLnByb3BzLm5hbWV9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZWxlbWVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZWZ9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaW5saW5lZENvbnRlbnRcIix7Z2V0OmZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNQcmV2aWV3aW5nfHx0aGlzLnByb3BzLmlubGluZUNvbnRlbnQpcmV0dXJuIHRoaXMucHJvcHMuY29udGVudH0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJidWlsZGVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BzLmFwaUtleSYmaW5zdGFuY2VzTWFwLmdldCh0aGlzLnByb3BzLmFwaUtleSl8fHRoaXMucHJvcHMuYnVpbGRlcnx8YnVpbGRlcn0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5nZXRIdG1sRGF0YT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5saW5lZENvbnRlbnQmJnRoaXMuaW5saW5lZENvbnRlbnQuaWR8fHRoaXMucHJvcHMuZW50cnksdD1lJiZCdWlsZGVyLmlzQnJvd3NlciYmZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2NyaXB0W2RhdGEtYnVpbGRlci1qc29uPVwiJy5jb25jYXQoZSwnXCJdLHNjcmlwdFtkYXRhLWJ1aWxkZXItc3RhdGU9XCInKS5jb25jYXQoZSwnXCJdJykpO2lmKHQpdHJ5e3JldHVybiBKU09OLnBhcnNlKHQuaW5uZXJUZXh0KX1jYXRjaChlKXtjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgcGFyc2UgQnVpbGRlci5pbyBIVE1MIGRhdGEgdHJhbnNmZXJcIixlLHQuaW5uZXJUZXh0KX1yZXR1cm57fX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZGV2aWNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmJ1aWxkZXIuZ2V0VXNlckF0dHJpYnV0ZXMoKS5kZXZpY2V8fFwiZGVza3RvcFwifSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImxvY2F0aW9uU3RhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKHt9LHBpY2sodGhpcy5sb2NhdGlvbixcInBhdGhuYW1lXCIsXCJob3N0bmFtZVwiLFwic2VhcmNoXCIsXCJob3N0XCIpKSx7cGF0aDp0aGlzLmxvY2F0aW9uLnBhdGhuYW1lJiZ0aGlzLmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KFwiL1wiKS5zbGljZSgxKXx8XCJcIixxdWVyeTpzZWFyY2hUb09iamVjdCQxKHRoaXMubG9jYXRpb24pfSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZGV2aWNlU2l6ZVN0YXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBCdWlsZGVyLmlzQnJvd3Nlcj90aGlzLnNpemVzLmdldFNpemVGb3JXaWR0aCh3aW5kb3cuaW5uZXJXaWR0aCk6c2l6ZU1hcFt0aGlzLmRldmljZV18fFwibGFyZ2VcIn0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSx0LnJlbmRlckludG89ZnVuY3Rpb24oZSxuLGkscil7aWYodm9pZCAwPT09biYmKG49e30pLHZvaWQgMD09PWkmJihpPSEwKSx2b2lkIDA9PT1yJiYocj0hMSksY29uc29sZS5kZWJ1ZyhcIkJ1aWxkZXJQYWdlLnJlbmRlckludG9cIixlLG4saSx0aGlzKSxlKXt2YXIgbz1udWxsO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlP289ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlKTplIGluc3RhbmNlb2YgRWxlbWVudCYmKG89ZSksbyl7dmFyIGE9by5jbGFzc0xpc3QuY29udGFpbnMoXCJidWlsZGVyLWh5ZHJhdGVkXCIpO2lmKCFhfHxyKXtvLmNsYXNzTGlzdC5hZGQoXCJidWlsZGVyLWh5ZHJhdGVkXCIpO3ZhciBzPWkmJm8uaW5uZXJIVE1MLmluY2x1ZGVzKFwiYnVpbGRlci1ibG9ja1wiKTtpZighby5jbGFzc0xpc3QuY29udGFpbnMoXCJidWlsZGVyLWNvbXBvbmVudFwiKSl7dmFyIGw9by5xdWVyeVNlbGVjdG9yKFwiLmJ1aWxkZXItYXBpLXN0eWxlc1wiKXx8KG8ucHJldmlvdXNFbGVtZW50U2libGluZyYmby5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLm1hdGNoZXMoXCIuYnVpbGRlci1hcGktc3R5bGVzXCIpP28ucHJldmlvdXNFbGVtZW50U2libGluZzpudWxsKSx1PVwiXCI7aWYobClsLmlubmVySFRNTC5yZXBsYWNlKC9cXC9cXCpzdGFydDooW15cXCpdKz8pXFwqXFwvKFtcXHNcXFNdKj8pXFwvXFwqZW5kOihbXlxcKl0rPylcXCpcXC8vZywoZnVuY3Rpb24oZSx0LG4pe3ZhciBpPW51bGw7dHJ5e2k9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtZW1vdGlvbi1jc3M9XCInLmNvbmNhdCh0LCdcIl0nKSl9Y2F0Y2goZSl7Y29uc29sZS53YXJuKGUpfXJldHVybiBpP2kuaW5uZXJIVE1MPW46QnVpbGRlci5pc0VkaXRpbmd8fCh1Kz1lKSxlfSkpLEJ1aWxkZXIubmV4dFRpY2soKGZ1bmN0aW9uKCl7bC5pbm5lckhUTUw9dX0pKTt2YXIgZD1vLnF1ZXJ5U2VsZWN0b3IoXCIuYnVpbGRlci1jb21wb25lbnRcIik7ZD9vPWQ6cz0hMX1sb2NhdGlvbi5zZWFyY2guaW5jbHVkZXMoXCJidWlsZGVyLmRlYnVnPXRydWVcIikmJmNvbnNvbGUuZGVidWcoXCJoeWRyYXRlXCIscyxvKTt2YXIgYz1vO2lmKCFhKXt2YXIgcD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO28uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYmVmb3JlYmVnaW5cIixwKSxwLmFwcGVuZENoaWxkKG8pLGM9cH1pZigoQnVpbGRlci5pc0VkaXRpbmd8fEJ1aWxkZXIuaXNCcm93c2VyJiZsb2NhdGlvbi5zZWFyY2guaW5jbHVkZXMoXCJidWlsZGVyLnByZXZpZXc9XCIpKSYmKHM9ITEpLHMmJm8pe3ZhciBmPVJlYWN0RE9NLnJlbmRlcihSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KHQsX19hc3NpZ24oe30sbikpLGMsYy5idWlsZGVyUm9vdFJlZik7cmV0dXJuIGMuYnVpbGRlclJvb3RSZWY9ZixmfXZhciBtPVJlYWN0RE9NLnJlbmRlcihSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KHQsX19hc3NpZ24oe30sbikpLGMsYy5idWlsZGVyUm9vdFJlZik7cmV0dXJuIGMuYnVpbGRlclJvb3RSZWY9bSxtfWNvbnNvbGUuZGVidWcoXCJUcmllZCB0byBoeWRyYXRlIG11bHRpcGxlIHRpbWVzXCIpfX19LHQucHJvdG90eXBlLnJlZ2lzdGVyQ3VzdG9tQ29tcG9uZW50cz1mdW5jdGlvbigpe2lmKHRoaXMucHJvcHMuY3VzdG9tQ29tcG9uZW50cylmb3IodmFyIGU9MCx0PXRoaXMucHJvcHMuY3VzdG9tQ29tcG9uZW50cztlPHQubGVuZ3RoO2UrKyl7dmFyIG49dFtlXTtpZihuKXt2YXIgaT1uLmNvbXBvbmVudCxyPV9fcmVzdChuLFtcImNvbXBvbmVudFwiXSk7QnVpbGRlci5yZWdpc3RlckNvbXBvbmVudChpLHIpfX19LHQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50PWZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzO3RoaXMubW91bnRlZD0hMCx0aGlzLmFzU2VydmVyJiYodGhpcy5hc1NlcnZlcj0hMSx0aGlzLnVwZGF0ZVN0YXRlKChmdW5jdGlvbihlKXtlLmlzQnJvd3Nlcj0hMCxlLmlzU2VydmVyPSExfSkpKSxCdWlsZGVyLmlzSWZyYW1lJiYobnVsbD09PShlPXdpbmRvdy5wYXJlbnQpfHx2b2lkIDA9PT1lfHxlLnBvc3RNZXNzYWdlKHt0eXBlOlwiYnVpbGRlci5zZGtJbmplY3RlZFwiLGRhdGE6e21vZGVsTmFtZTp0aGlzLm5hbWV9fSxcIipcIikpLEJ1aWxkZXIuaXNCcm93c2VyJiYod2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIix0aGlzLnJlc2l6ZUxpc3RlbmVyKSxCdWlsZGVyLmlzRWRpdGluZyYmd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsdGhpcy5tZXNzYWdlTGlzdGVuZXIpLChCdWlsZGVyLmlzRWRpdGluZ3x8QnVpbGRlci5pc1ByZXZpZXdpbmcpJiZCdWlsZGVyLm5leHRUaWNrKChmdW5jdGlvbigpe3QuZmlyc3RMb2FkPSExLHQucmVsb2FkKCl9KSksc2V0VGltZW91dCgoZnVuY3Rpb24oKXt3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJidWlsZGVyOmNvbXBvbmVudDpsb2FkXCIse2RldGFpbDp7cmVmOnR9fSkpfSkpKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiaXNQcmV2aWV3aW5nXCIse2dldDpmdW5jdGlvbigpe3JldHVybihCdWlsZGVyLmlzU2VydmVyfHxCdWlsZGVyLmlzQnJvd3NlciYmQnVpbGRlci5pc1ByZXZpZXdpbmcmJiF0aGlzLmZpcnN0TG9hZCkmJmJ1aWxkZXIucHJldmlld2luZ01vZGVsPT09dGhpcy5uYW1lfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLm5vdGlmeVN0YXRlQ2hhbmdlPWZ1bmN0aW9uKCl7aWYoIUJ1aWxkZXIuaXNTZXJ2ZXImJnRoaXMmJnRoaXMuc3RhdGUpe3ZhciBlPXRoaXMuc3RhdGUuc3RhdGU7dGhpcy5wcm9wcy5vblN0YXRlQ2hhbmdlJiZ0aGlzLnByb3BzLm9uU3RhdGVDaGFuZ2UoZSksQnVpbGRlci5pc0Jyb3dzZXImJndpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImJ1aWxkZXI6Y29tcG9uZW50OnN0YXRlQ2hhbmdlXCIse2RldGFpbDp7c3RhdGU6ZSxyZWY6dGhpc319KSksdGhpcy5vblN0YXRlQ2hhbmdlLm5leHQoZSl9fSx0LnByb3RvdHlwZS5wcm9jZXNzU3RhdGVGcm9tQXBpPWZ1bmN0aW9uKGUpe3JldHVybiBlfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJsb2NhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcm9wcy5sb2NhdGlvbnx8KEJ1aWxkZXIuaXNCcm93c2VyP2xvY2F0aW9uOnt9KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5nZXRDc3NGcm9tRm9udD1mdW5jdGlvbihlLHQpe3ZhciBuPWUuZmFtaWx5KyhlLmtpbmQmJiFlLmtpbmQuaW5jbHVkZXMoXCIjXCIpP1wiLCBcIitlLmtpbmQ6XCJcIiksaT1uLnNwbGl0KFwiLFwiKVswXSxyPWUuZmlsZVVybD9lLmZpbGVVcmw6ZS5maWxlcyYmZS5maWxlcy5yZWd1bGFyLG89XCJcIjtpZihyJiZuJiZpJiYobys9J1xcbkBmb250LWZhY2Uge1xcbiAgZm9udC1mYW1pbHk6IFwiJy5jb25jYXQobiwnXCI7XFxuICBzcmM6IGxvY2FsKFwiJykuY29uY2F0KGksXCJcXFwiKSwgdXJsKCdcIikuY29uY2F0KHIsXCInKSBmb3JtYXQoJ3dvZmYyJyk7XFxuICBmb250LWRpc3BsYXk6IGZhbGxiYWNrO1xcbiAgZm9udC13ZWlnaHQ6IDQwMDtcXG59XFxuICAgICAgICBcIikudHJpbSgpKSxlLmZpbGVzKWZvcih2YXIgYSBpbiBlLmZpbGVzKXtpZihTdHJpbmcoTnVtYmVyKGEpKT09PWEpe3ZhciBzPWUuZmlsZXNbYV07cyYmcyE9PXImJihvKz0nXFxuQGZvbnQtZmFjZSB7XFxuICBmb250LWZhbWlseTogXCInLmNvbmNhdChuLFwiXFxcIjtcXG4gIHNyYzogdXJsKCdcIikuY29uY2F0KHMsXCInKSBmb3JtYXQoJ3dvZmYyJyk7XFxuICBmb250LWRpc3BsYXk6IGZhbGxiYWNrO1xcbiAgZm9udC13ZWlnaHQ6IFwiKS5jb25jYXQoYSxcIjtcXG59XFxuICAgICAgICAgIFwiKS50cmltKCkpfX1yZXR1cm4gb30sdC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQ9ZnVuY3Rpb24oKXt0aGlzLnVuc3Vic2NyaWJlKCksQnVpbGRlci5pc0Jyb3dzZXImJih3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLHRoaXMucmVzaXplTGlzdGVuZXIpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLHRoaXMubWVzc2FnZUxpc3RlbmVyKSl9LHQucHJvdG90eXBlLmdldEZvbnRDc3M9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5idWlsZGVyLmFsbG93Q3VzdG9tRm9udHMmJihudWxsPT1lP3ZvaWQgMDplLmN1c3RvbUZvbnRzKSYmZS5jdXN0b21Gb250cy5sZW5ndGgmJmUuY3VzdG9tRm9udHMubWFwKChmdW5jdGlvbihuKXtyZXR1cm4gdC5nZXRDc3NGcm9tRm9udChuLGUpfSkpLmpvaW4oXCIgXCIpfHxcIlwifSx0LnByb3RvdHlwZS5lbnN1cmVGb250c0xvYWRlZD1mdW5jdGlvbihlKXtpZih0aGlzLmJ1aWxkZXIuYWxsb3dDdXN0b21Gb250cyYmKG51bGw9PWU/dm9pZCAwOmUuY3VzdG9tRm9udHMpJiZBcnJheS5pc0FycmF5KGUuY3VzdG9tRm9udHMpKWZvcih2YXIgdD0wLG49ZS5jdXN0b21Gb250czt0PG4ubGVuZ3RoO3QrKyl7dmFyIGk9blt0XSxyPWkuZmlsZVVybD9pLmZpbGVVcmw6aS5maWxlcyYmaS5maWxlcy5yZWd1bGFyO2lmKCFmb250c0xvYWRlZC5oYXMocikpe3ZhciBvPXRoaXMuZ2V0Q3NzRnJvbUZvbnQoaSxlKTtpZihmb250c0xvYWRlZC5hZGQociksIW8pY29udGludWU7dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO2EuY2xhc3NOYW1lPVwiYnVpbGRlci1jdXN0b20tZm9udFwiLGEuc2V0QXR0cmlidXRlKFwiZGF0YS1idWlsZGVyLWN1c3RvbS1mb250XCIsciksYS5pbm5lckhUTUw9byxkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGEpfX19LHQucHJvdG90eXBlLmdldENzcz1mdW5jdGlvbihlKXt2YXIgdCxuPW51bGw9PT0odD10aGlzLnVzZUNvbnRlbnQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmlkLGk9KG51bGw9PWU/dm9pZCAwOmUuY3NzQ29kZSl8fFwiXCI7cmV0dXJuIG4mJihpPWkucmVwbGFjZSgvJi9nLFwiLmJ1aWxkZXItY29tcG9uZW50LVwiLmNvbmNhdChuKSkpLGkrdGhpcy5nZXRGb250Q3NzKGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJkYXRhXCIse2dldDpmdW5jdGlvbigpe3ZhciBlLHQ9X19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oe30sdGhpcy5pbmxpbmVkQ29udGVudCYmKG51bGw9PT0oZT10aGlzLmlubGluZWRDb250ZW50LmRhdGEpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLnN0YXRlKSksdGhpcy5leHRlcm5hbFN0YXRlKSx0aGlzLnN0YXRlLnN0YXRlKTtyZXR1cm4gT2JqZWN0LmFzc2lnbih0aGlzLnJvb3RTdGF0ZSx0KSx0fSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZT1mdW5jdGlvbihlKXt2YXIgdD10aGlzO3RoaXMucHJvcHMuZGF0YSYmZS5kYXRhIT09dGhpcy5wcm9wcy5kYXRhJiZ0aGlzLnN0YXRlLnVwZGF0ZSgoZnVuY3Rpb24oZSl7T2JqZWN0LmFzc2lnbihlLHQuZXh0ZXJuYWxTdGF0ZSl9KSksdGhpcy5wcm9wcy5jdXN0b21Db21wb25lbnRzJiZ0aGlzLnByb3BzLmN1c3RvbUNvbXBvbmVudHMhPT1lLmN1c3RvbUNvbXBvbmVudHMmJnRoaXMucmVnaXN0ZXJDdXN0b21Db21wb25lbnRzKCksQnVpbGRlci5pc0VkaXRpbmcmJnRoaXMuaW5saW5lZENvbnRlbnQmJmUuY29udGVudCE9PXRoaXMuaW5saW5lZENvbnRlbnQmJnRoaXMub25Db250ZW50TG9hZGVkKHRoaXMuaW5saW5lZENvbnRlbnQuZGF0YSx0aGlzLmlubGluZWRDb250ZW50KX0sdC5wcm90b3R5cGUuY2hlY2tTdHlsZXM9ZnVuY3Rpb24oZSl7aWYodGhpcy5zdHlsZVJlZil7dmFyIHQ9dGhpcy5nZXRDc3MoZSk7dGhpcy5zdHlsZVJlZi5pbm5lckhUTUwhPT10JiYodGhpcy5zdHlsZVJlZi5pbm5lckhUTUw9dCl9fSx0LnByb3RvdHlwZS5yZWxvYWQ9ZnVuY3Rpb24oKXt0aGlzLnNldFN0YXRlKHtrZXk6dGhpcy5zdGF0ZS5rZXkrMX0pfSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJjb250ZW50XCIse2dldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5saW5lZENvbnRlbnQ7cmV0dXJuIGUmJmUuY29udGVudCYmKGU9X19hc3NpZ24oX19hc3NpZ24oe30sZSkse2RhdGE6ZS5jb250ZW50fSkpLGV9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiZXh0ZXJuYWxTdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oe30sdGhpcy5wcm9wcy5kYXRhKSx0aGlzLnByb3BzLmxvY2FsZT97bG9jYWxlOnRoaXMucHJvcHMubG9jYWxlfTp7fSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwidXNlQ29udGVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250ZW50fHx0aGlzLnN0YXRlLmNvbnRleHQuYnVpbGRlckNvbnRlbnR9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzLG49dGhpcy5jb250ZW50LGk9QnVpbGRlci5pc0Jyb3dzZXImJnRoaXMuZXh0ZXJuYWxTdGF0ZSYmc2l6ZSQxKHRoaXMuZXh0ZXJuYWxTdGF0ZSkmJmhhc2godGhpcy5leHRlcm5hbFN0YXRlKSxyPUJ1aWxkZXIuaXNFZGl0aW5nP3RoaXMubmFtZTp0aGlzLnByb3BzLmVudHJ5O3ImJiFCdWlsZGVyLmlzRWRpdGluZyYmaSYmaS5sZW5ndGg8MzAwJiYocis9XCI6XCIraSk7dmFyIG89dGhpcy5wcm9wcy5kYXRhT25seT9SZWFjdF9fZGVmYXVsdC5GcmFnbWVudDpcImRpdlwiLGE9bnVsbD09PShlPXRoaXMudXNlQ29udGVudCl8fHZvaWQgMD09PWU/dm9pZCAwOmUuaWQ7cmV0dXJuIFJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQobyx7b25DbGljazpmdW5jdGlvbihlKXshQnVpbGRlci5pc0VkaXRpbmd8fHQucHJvcHMuaXNDaGlsZHx8dC5wcm9wcy5zdG9wQ2xpY2tQcm9wYWdhdGlvbldoZW5FZGl0aW5nfHxlLnN0b3BQcm9wYWdhdGlvbigpfSxjbGFzc05hbWU6XCJidWlsZGVyLWNvbXBvbmVudCBcIi5jb25jYXQoYT9cImJ1aWxkZXItY29tcG9uZW50LVwiLmNvbmNhdChhKTpcIlwiKSxcImRhdGEtbmFtZVwiOnRoaXMubmFtZSxcImRhdGEtc291cmNlXCI6XCJSZW5kZXJlZCBieSBCdWlsZGVyLmlvXCIsa2V5OnRoaXMuc3RhdGUua2V5LHJlZjpmdW5jdGlvbihlKXtyZXR1cm4gdC5yZWY9ZX19LFJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQnVpbGRlck1ldGFDb250ZXh0LkNvbnN1bWVyLG51bGwsKGZ1bmN0aW9uKGUpe3JldHVybiBSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1aWxkZXJNZXRhQ29udGV4dC5Qcm92aWRlcix7dmFsdWU6XCJib29sZWFuXCI9PXR5cGVvZiB0LnByb3BzLmFtcE1vZGU/X19hc3NpZ24oX19hc3NpZ24oe30sZSkse2FtcE1vZGU6dC5wcm9wcy5hbXBNb2RlfSk6ZX0sUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCdWlsZGVyQXN5bmNSZXF1ZXN0c0NvbnRleHQuQ29uc3VtZXIsbnVsbCwoZnVuY3Rpb24oZSl7dmFyIGk7cmV0dXJuIHQuX2FzeW5jUmVxdWVzdHM9ZSYmZS5yZXF1ZXN0cyx0Ll9lcnJvcnM9ZSYmZS5lcnJvcnMsdC5fbG9ncz1lJiZlLmxvZ3MsUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCdWlsZGVyQ29udGVudCx7aXNTdGF0aWM6dC5wcm9wcy5pc1N0YXRpY3x8QnVpbGRlci5pc1N0YXRpYyxrZXk6KG51bGw9PT0oaT10LmlubGluZWRDb250ZW50KXx8dm9pZCAwPT09aT92b2lkIDA6aS5pZCl8fChcImNvbnRlbnRcImluIHQucHJvcHMmJiF0LmlzUHJldmlld2luZz9cIm51bGwtY29udGVudC1wcm9wXCI6XCJuby1jb250ZW50LXByb3BcIiksYnVpbGRlcjp0LmJ1aWxkZXIscmVmOmZ1bmN0aW9uKGUpe3JldHVybiB0LmNvbnRlbnRSZWY9ZX0sY29udGVudExvYWRlZDpmdW5jdGlvbihlLG4pe3JldHVybiB0Lm9uQ29udGVudExvYWRlZChlLG4pfSxvcHRpb25zOl9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKHtrZXk6cixlbnRyeTp0LnByb3BzLmVudHJ5fSxuJiZ7aW5pdGlhbENvbnRlbnQ6W25dfSksIW4mJlwiY29udGVudFwiaW4gdC5wcm9wcyYmIXQuaXNQcmV2aWV3aW5nJiZ7aW5pdGlhbENvbnRlbnQ6W119KSx0LnByb3BzLnVybCYme3VybDp0LnByb3BzLnVybH0pLHQucHJvcHMub3B0aW9ucyksdC5wcm9wcy5sb2NhbGU/e2xvY2FsZTp0LnByb3BzLmxvY2FsZX06e30pLHQub3B0aW9ucy5jb2RlZ2VuJiZ7Zm9ybWF0OlwicmVhY3RcIn0pLGlubGluZTp0LnByb3BzLmlubGluZUNvbnRlbnR8fCF0LmlzUHJldmlld2luZyYmXCJjb250ZW50XCJpbiB0LnByb3BzLGNvbnRlbnRFcnJvcjp0LnByb3BzLmNvbnRlbnRFcnJvcixtb2RlbE5hbWU6dC5uYW1lfHxcInBhZ2VcIn0sKGZ1bmN0aW9uKGUsbixpKXt2YXIgcjtpZih0LnByb3BzLmRhdGFPbmx5KXJldHVybiBudWxsO2kmJmkuaWQmJih0LnN0YXRlLmJyZWFrcG9pbnRzJiYoaS5tZXRhPWkubWV0YXx8e30saS5tZXRhLmJyZWFrcG9pbnRzPXQuc3RhdGUuYnJlYWtwb2ludHMpLHQuc3RhdGUuY29udGV4dC5idWlsZGVyQ29udGVudD1pKSxCdWlsZGVyLmlzQnJvd3NlciYmQnVpbGRlci5uZXh0VGljaygoZnVuY3Rpb24oKXt0LmNoZWNrU3R5bGVzKGUpfSkpO3ZhciBvPXQub3B0aW9ucy5jb2RlZ2VuO2lmKG8mJiF0LkNvbXBvbmVudCYmKG51bGw9PWU/dm9pZCAwOmUuYmxvY2tzSnMpKXt2YXIgYT1BcnJheS5mcm9tKG5ldyBTZXQoQnVpbGRlci5jb21wb25lbnRzLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUubmFtZX0pKSkpLHM9QnVpbGRlci5jb21wb25lbnRzLnNsaWNlKCkucmV2ZXJzZSgpLGw9YS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBzLmZpbmQoKGZ1bmN0aW9uKHQpe3JldHVybiB0LmNsYXNzJiZ0Lm5hbWU9PT1lfSkpfSkpLHU9YS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybihlfHxcIlwiKS5yZXBsYWNlKC9bXlxcd10rL2dpLFwiXCIpfSkpLGQ9bC5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiB3cmFwQ29tcG9uZW50KGUpfSkpO3QuQ29tcG9uZW50PShuZXcoRnVuY3Rpb24uYmluZC5hcHBseShGdW5jdGlvbixfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW3ZvaWQgMCxcImpzeFwiLFwiX2Nzc1wiLFwiQnVpbGRlclwiLFwiYnVpbGRlclwiLFwiUmVhY3RcIixcInVzZUJ1aWxkZXJTdGF0ZVwiXSx1LCExKSxbZS5ibG9ja3NKc10sITEpKSkpLmFwcGx5KHZvaWQgMCxfX3NwcmVhZEFycmF5KFtqc3gsY3NzLEJ1aWxkZXIsYnVpbGRlcixSZWFjdF9fZGVmYXVsdCxmdW5jdGlvbihlKXt2YXIgdD1SZWFjdF9fZGVmYXVsdC51c2VTdGF0ZSgwKVsxXTtyZXR1cm4gUmVhY3RfX2RlZmF1bHQudXNlU3RhdGUoKGZ1bmN0aW9uKCl7cmV0dXJuIG9uQ2hhbmdlKGUsKGZ1bmN0aW9uKCl7dCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUrMX0pKX0pKX0pKVswXX1dLGQsITEpKX12YXIgYz0obnVsbD09ZT92b2lkIDA6ZS5ibG9ja3MpfHxbXSxwPWMuZmluZCgoZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1lLmlkKXx8dm9pZCAwPT09dD92b2lkIDA6dC5zdGFydHNXaXRoKFwiYnVpbGRlci1waXhlbFwiKX0pKTtyZXR1cm4gZSYmIXAmJmMubGVuZ3RoPjAmJmMucHVzaChnZXRCdWlsZGVyUGl4ZWwoYnVpbGRlci5hcGlLZXkpKSxlP1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIixfX2Fzc2lnbih7XCJkYXRhLWJ1aWxkZXItY29tcG9uZW50XCI6dC5uYW1lLFwiZGF0YS1idWlsZGVyLWNvbnRlbnQtaWRcIjppLmlkfSx0LmlzUHJldmlld2luZz97XCJkYXRhLWJ1aWxkZXItdmFyaWF0aW9uLWlkXCI6aS50ZXN0VmFyaWF0aW9uSWR8fGkudmFyaWF0aW9uSWR8fGkuaWR9Ont9KSwhbyYmdC5nZXRDc3MoZSkmJlJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiLHtyZWY6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuc3R5bGVSZWY9ZX0sY2xhc3NOYW1lOlwiYnVpbGRlci1jdXN0b20tc3R5bGVzXCIsZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6e19faHRtbDp0LmdldENzcyhlKX19KSxSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1aWxkZXJTdG9yZUNvbnRleHQuUHJvdmlkZXIse3ZhbHVlOl9fYXNzaWduKF9fYXNzaWduKHt9LHQuc3RhdGUpLHtyb290U3RhdGU6dC5yb290U3RhdGUsc3RhdGU6dC5kYXRhLGNvbnRlbnQ6aSxyZW5kZXJMaW5rOnQucHJvcHMucmVuZGVyTGlua30pfSxvJiZ0LkNvbXBvbmVudD9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KHQuQ29tcG9uZW50LHtkYXRhOnQuZGF0YSxjb250ZXh0OnQuc3RhdGUuY29udGV4dH0pOlJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQnVpbGRlckJsb2Nrcyx7a2V5OlN0cmluZyghIShudWxsPT09KHI9bnVsbD09ZT92b2lkIDA6ZS5ibG9ja3MpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmxlbmd0aCkpLGVtYWlsTW9kZTp0LnByb3BzLmVtYWlsTW9kZSxmaWVsZE5hbWU6XCJibG9ja3NcIixibG9ja3M6Y30pKSk6bj9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIse1wiZGF0YS1idWlsZGVyLWNvbXBvbmVudFwiOnQubmFtZSxjbGFzc05hbWU6XCJidWlsZGVyLWxvYWRpbmdcIn0sdC5wcm9wcy5jaGlsZHJlbik6UmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImRpdlwiLHtcImRhdGEtYnVpbGRlci1jb21wb25lbnRcIjp0Lm5hbWUsY2xhc3NOYW1lOlwiYnVpbGRlci1uby1jb250ZW50XCJ9KX0pKX0pKSl9KSkpfSx0LnByb3RvdHlwZS5ldmFsRXhwcmVzc2lvbj1mdW5jdGlvbihlKXt2YXIgdD10aGlzLG49dGhpcy5kYXRhO3JldHVybiBTdHJpbmcoZSkucmVwbGFjZSgve3soW159XSspfX0vZywoZnVuY3Rpb24oZSxpKXtyZXR1cm4gdHJ5RXZhbChpLG4sdC5fZXJyb3JzKX0pKX0sdC5wcm90b3R5cGUuaGFuZGxlUmVxdWVzdD1mdW5jdGlvbihlLHQpe3JldHVybiBfX2F3YWl0ZXIodGhpcyx2b2lkIDAsdm9pZCAwLChmdW5jdGlvbigpe3ZhciBuLGkscixvLGE9dGhpcztyZXR1cm4gX19nZW5lcmF0b3IodGhpcywoZnVuY3Rpb24ocyl7cmV0dXJuIEJ1aWxkZXIuaXNJZnJhbWUmJmZldGNoQ2FjaGVbdF0/KHRoaXMudXBkYXRlU3RhdGUoKGZ1bmN0aW9uKG4pe25bZV09ZmV0Y2hDYWNoZVt0XX0pKSxbMixmZXRjaENhY2hlW3RdXSk6KG49ZnVuY3Rpb24oKXtyZXR1cm4gX19hd2FpdGVyKGEsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgbixpLHIsbztyZXR1cm4gX19nZW5lcmF0b3IodGhpcywoZnVuY3Rpb24oYSl7c3dpdGNoKGEubGFiZWwpe2Nhc2UgMDpuPURhdGUubm93KCksQnVpbGRlci5pc0Jyb3dzZXJ8fGNvbnNvbGUudGltZShcIkZldGNoIFwiK3QpLGEubGFiZWw9MTtjYXNlIDE6cmV0dXJuIGEudHJ5cy5wdXNoKFsxLDQsNSw2XSksWzQsZmV0Y2gkMSh0KV07Y2FzZSAyOnJldHVybls0LGEuc2VudCgpLmpzb24oKV07Y2FzZSAzOnJldHVybiBpPWEuc2VudCgpLFszLDZdO2Nhc2UgNDpyZXR1cm4gcj1hLnNlbnQoKSxvPXRvRXJyb3IociksdGhpcy5fZXJyb3JzJiZ0aGlzLl9lcnJvcnMucHVzaChvKSx0aGlzLl9sb2dzJiZ0aGlzLl9sb2dzLnB1c2goXCJGZXRjaCB0byBcIi5jb25jYXQodCxcIiBlcnJvcmVkIGluIFwiKS5jb25jYXQoRGF0ZS5ub3coKS1uLFwibXNcIikpLFsyXTtjYXNlIDU6cmV0dXJuIEJ1aWxkZXIuaXNCcm93c2VyfHwoY29uc29sZS50aW1lRW5kKFwiRmV0Y2ggXCIrdCksdGhpcy5fbG9ncyYmdGhpcy5fbG9ncy5wdXNoKFwiRmV0Y2hlZCBcIi5jb25jYXQodCxcIiBpbiBcIikuY29uY2F0KERhdGUubm93KCktbixcIm1zXCIpKSksWzddO2Nhc2UgNjpyZXR1cm4gaSYmKEJ1aWxkZXIuaXNJZnJhbWUmJihmZXRjaENhY2hlW3RdPWkpLHRoaXMudXBkYXRlU3RhdGUoKGZ1bmN0aW9uKHQpe3RbZV09aX0pKSksWzIsaV19fSkpfSkpfSwoaT10aGlzLl9hc3luY1JlcXVlc3RzJiZ0aGlzLl9hc3luY1JlcXVlc3RzLmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVybiBpc1JlcXVlc3RJbmZvKGUpJiZlLnVybD09PXR9KSkpPygocj1pLnByb21pc2UpLnRoZW4oKGZ1bmN0aW9uKHQpe3QmJmEudXBkYXRlU3RhdGUoKGZ1bmN0aW9uKG4pe25bZV09dH0pKX0pKSxbMixyXSk6KG89bigpLEJ1aWxkZXIubmV4dFRpY2soKGZ1bmN0aW9uKCl7YS5fYXN5bmNSZXF1ZXN0cyYmYS5fYXN5bmNSZXF1ZXN0cy5wdXNoKG8pfSkpLFsyLG9dKSl9KSl9KSl9LHQucHJvdG90eXBlLnVuc3Vic2NyaWJlPWZ1bmN0aW9uKCl7dGhpcy5zdWJzY3JpcHRpb25zJiYodGhpcy5zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksdGhpcy5zdWJzY3JpcHRpb25zPW5ldyBTdWJzY3JpcHRpb24pfSx0LnByb3RvdHlwZS5oYW5kbGVCdWlsZGVyUmVxdWVzdD1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMsaT10cnlFdmFsKHQsdGhpcy5kYXRhLHRoaXMuX2Vycm9ycyk7dGhpcy5zdWJzY3JpcHRpb25zJiZ0aGlzLnVuc3Vic2NyaWJlKCksaSYmdGhpcy5zdWJzY3JpcHRpb25zLmFkZCh0aGlzLmJ1aWxkZXIucXVldWVHZXRDb250ZW50KGkubW9kZWwsaSkuc3Vic2NyaWJlKChmdW5jdGlvbih0KXt0JiZuLnVwZGF0ZVN0YXRlKChmdW5jdGlvbihuKXtuW2VdPXR9KSl9KSkpfSx0LmRlZmF1bHRzPXtjb2RlZ2VuOkJvb2xlYW4oQnVpbGRlci5pc0Jyb3dzZXImJmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoXCJidWlsZGVyLmNvZGVnZW49dHJ1ZVwiKSl9LF9fZGVjb3JhdGUoW2RlYm91bmNlTmV4dFRpY2ssX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsRnVuY3Rpb24pLF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLFtdKSxfX21ldGFkYXRhKFwiZGVzaWduOnJldHVybnR5cGVcIix2b2lkIDApXSx0LnByb3RvdHlwZSxcIm5vdGlmeVN0YXRlQ2hhbmdlXCIsbnVsbCksdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KTtmdW5jdGlvbiBCdWlsZGVyQmxvY2soZSl7cmV0dXJuIGUudHlwZT1cInJlYWN0XCIsQnVpbGRlci5Db21wb25lbnQoZSl9ZnVuY3Rpb24gdXBkYXRlTWV0YWRhdGEoZSx0KXt2YXIgbj1CdWlsZGVyLmNvbXBvbmVudHMuZmluZCgoZnVuY3Rpb24odCl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGU/dC5uYW1lPT09ZTp0LmNsYXNzPT09dH0pKXx8bnVsbCxpPXQobik7biYmaT9CdWlsZGVyLnJlZ2lzdGVyQ29tcG9uZW50KGkuY2xhc3N8fG4uY2xhc3MsaSk6biYmIWl8fCFuJiZpJiZCdWlsZGVyLnJlZ2lzdGVyQ29tcG9uZW50KGkuY2xhc3MsaSl9ZnVuY3Rpb24gd2l0aEJ1aWxkZXIoZSx0KXtyZXR1cm4gQnVpbGRlckJsb2NrKHQpKGUpLGV9dmFyIGlzQnVpbGRlckVsZW1lbnQ9ZnVuY3Rpb24oZSl7cmV0dXJuIEJvb2xlYW4oXCJvYmplY3RcIj09dHlwZW9mIGUmJmUmJlwiQGJ1aWxkZXIuaW8vc2RrOkVsZW1lbnRcIj09PShudWxsPT1lP3ZvaWQgMDplW1wiQHR5cGVcIl0pKX0sd2l0aENoaWxkcmVuPWZ1bmN0aW9uKGUpe3ZhciB0PVJlYWN0X19kZWZhdWx0LmZvcndhcmRSZWYoKGZ1bmN0aW9uKHQsbil7dmFyIGkscixvPV9fYXNzaWduKHt9LHQpLGE9dC5jaGlsZHJlbnx8dC5idWlsZGVyQmxvY2smJnQuYnVpbGRlckJsb2NrLmNoaWxkcmVuJiZ0LmJ1aWxkZXJCbG9jay5jaGlsZHJlbi5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1aWxkZXJCbG9jayQxLHtrZXk6ZS5pZCxibG9jazplfSl9KSkscz1udWxsPT09KHI9bnVsbD09PShpPXQuYnVpbGRlckJsb2NrKXx8dm9pZCAwPT09aT92b2lkIDA6aS5jb21wb25lbnQpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLm9wdGlvbnM7cmV0dXJuIHMmJk9iamVjdC5rZXlzKHMpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PXNbZV07QXJyYXkuaXNBcnJheSh0KSYmdC5ldmVyeShpc0J1aWxkZXJFbGVtZW50KT9vW2VdPXQubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCdWlsZGVyQmxvY2skMSx7a2V5OmUuaWQsYmxvY2s6ZX0pfSkpOmlzQnVpbGRlckVsZW1lbnQodCkmJihvW2VdPVJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQnVpbGRlckJsb2NrJDEse2Jsb2NrOnR9KSl9KSksUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChlLF9fYXNzaWduKHt9LG8se3JlZjpufSksYSl9KSk7cmV0dXJuIHQuYnVpbGRlck9wdGlvbnM9e2NhbkhhdmVDaGlsZHJlbjohMH0sdH0sbm9XcmFwPWZ1bmN0aW9uKGUpe3ZhciB0PVJlYWN0X19kZWZhdWx0LmZvcndhcmRSZWYoKGZ1bmN0aW9uKHQsbil7dmFyIGk9X19hc3NpZ24oX19hc3NpZ24oe30sdCksdC5hdHRyaWJ1dGVzKTtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChlLF9fYXNzaWduKHt9LGkse3JlZjpufSkpfSkpO3JldHVybiB0LmJ1aWxkZXJPcHRpb25zPXtub1dyYXA6ITB9LHR9LGljb25Vcmw9XCJodHRwczovL2ZpcmViYXNlc3RvcmFnZS5nb29nbGVhcGlzLmNvbS92MC9iL2J1aWxkZXItM2IwYTIuYXBwc3BvdC5jb20vby9pbWFnZXMlMkZiYXNlbGluZS10ZXh0X2ZpZWxkcy0yNHB4JTIwKDEpLnN2Zz9hbHQ9bWVkaWEmdG9rZW49MTIxNzdiNzMtMGVlMy00MmNhLTk4YzYtMGRkMDAzZGUxOTI5XCIsVGV4dENvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7dmFyIHQ9bnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzO3JldHVybiB0LnRleHRSZWY9bnVsbCx0fXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudD1mdW5jdGlvbigpe3RoaXMudGV4dFJlZiYmIS97eyhbXn1dKyl9fS8udGVzdCh0aGlzLnByb3BzLnRleHQpJiYodGhpcy50ZXh0UmVmLmlubmVySFRNTD10aGlzLnByb3BzLnRleHQpfSx0LnByb3RvdHlwZS5ldmFsRXhwcmVzc2lvbj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmFsbG93VGV4dEVkaXQ/U3RyaW5nKGUpOlN0cmluZyhlKS5yZXBsYWNlKC97eyhbXn1dKyl9fS9nLChmdW5jdGlvbihlLG4pe3JldHVybiB0cnlFdmFsKG4sdCl9KSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImFsbG93VGV4dEVkaXRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIEJ1aWxkZXIuaXNCcm93c2VyJiZCdWlsZGVyLmlzRWRpdGluZyYmbG9jYXRpb24uc2VhcmNoLmluY2x1ZGVzKFwiYnVpbGRlci5hbGxvd1RleHRFZGl0PXRydWVcIikmJiEodGhpcy5wcm9wcy5idWlsZGVyQmxvY2smJnRoaXMucHJvcHMuYnVpbGRlckJsb2NrLmJpbmRpbmdzJiYodGhpcy5wcm9wcy5idWlsZGVyQmxvY2suYmluZGluZ3NbXCJjb21wb25lbnQub3B0aW9ucy50ZXh0XCJdfHx0aGlzLnByb3BzLmJ1aWxkZXJCbG9jay5iaW5kaW5nc1tcIm9wdGlvbnMudGV4dFwiXXx8dGhpcy5wcm9wcy5idWlsZGVyQmxvY2suYmluZGluZ3MudGV4dCkpfSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD17b3V0bGluZTpcIm5vbmVcIixcIiYgcDpmaXJzdC1vZi10eXBlLCAmIC5idWlsZGVyLXBhcmFncmFwaDpmaXJzdC1vZi10eXBlXCI6e21hcmdpbjowfSxcIiYgPiBwLCAmIC5idWlsZGVyLXBhcmFncmFwaFwiOntjb2xvcjpcImluaGVyaXRcIixsaW5lSGVpZ2h0OlwiaW5oZXJpdFwiLGxldHRlclNwYWNpbmc6XCJpbmhlcml0XCIsZm9udFdlaWdodDpcImluaGVyaXRcIixmb250U2l6ZTpcImluaGVyaXRcIix0ZXh0QWxpZ246XCJpbmhlcml0XCIsZm9udEZhbWlseTpcImluaGVyaXRcIn19O3JldHVybiBqc3goQnVpbGRlclN0b3JlQ29udGV4dC5Db25zdW1lcixudWxsLChmdW5jdGlvbihuKXt2YXIgaTtyZXR1cm4obnVsbD09PShpPW4uY29udGVudC5tZXRhKXx8dm9pZCAwPT09aT92b2lkIDA6aS5ydGxNb2RlKSYmKHQuZGlyZWN0aW9uPVwicnRsXCIpLGpzeChSZWFjdF9fZGVmYXVsdC5GcmFnbWVudCxudWxsLGpzeChcInNwYW5cIixfX2Fzc2lnbih7cmVmOmZ1bmN0aW9uKHQpe2UudGV4dFJlZj10fSxjc3M6dCxjbGFzc05hbWU6XCJidWlsZGVyLXRleHRcIn0se2Rhbmdlcm91c2x5U2V0SW5uZXJIVE1MOntfX2h0bWw6ZS5ldmFsRXhwcmVzc2lvbihlLnByb3BzLnRleHR8fGUucHJvcHMuY29udGVudHx8XCJcIixuLnN0YXRlKX19KSkpfSkpfSx0fShSZWFjdF9fZGVmYXVsdC5Db21wb25lbnQpLFRleHQ9d2l0aEJ1aWxkZXIoVGV4dENvbXBvbmVudCx7bmFtZTpcIlRleHRcIixzdGF0aWM6ITAsaW1hZ2U6aWNvblVybCxpbnB1dHM6W3tuYW1lOlwidGV4dFwiLHR5cGU6XCJodG1sXCIscmVxdWlyZWQ6ITAsYXV0b0ZvY3VzOiEwLGJ1YmJsZTohMCxkZWZhdWx0VmFsdWU6XCJFbnRlciBzb21lIHRleHQuLi5cIn1dLGRlZmF1bHRTdHlsZXM6e2xpbmVIZWlnaHQ6XCJub3JtYWxcIixoZWlnaHQ6XCJhdXRvXCIsdGV4dEFsaWduOlwiY2VudGVyXCJ9fSk7ZnVuY3Rpb24gU2xvdChlKXt2YXIgdD1lLm5hbWUsbj11c2VDb250ZXh0KEJ1aWxkZXJTdG9yZUNvbnRleHQpLGk9IW4uY29udGV4dC5zeW1ib2xJZDtyZXR1cm4ganN4KFwiZGl2XCIsX19hc3NpZ24oe2Nzczp7cG9pbnRlckV2ZW50czpcImF1dG9cIn19LGkmJntcImJ1aWxkZXItc2xvdFwiOnR9KSxqc3goQnVpbGRlckJsb2Nrcyx7Y2hpbGQ6ITAscGFyZW50RWxlbWVudElkOm4uY29udGV4dC5zeW1ib2xJZCxkYXRhUGF0aDpcInN5bWJvbC5kYXRhLlwiLmNvbmNhdCh0KSxibG9ja3M6bi5zdGF0ZVt0XXx8W119KSl9QnVpbGRlci5yZWdpc3RlckNvbXBvbmVudChTbG90LHtuYW1lOlwiU2xvdFwiLGRlc2NyaXB0aW9uOlwiQWxsb3cgY2hpbGQgYmxvY2tzIHRvIGJlIGluc2VydGVkIGludG8gdGhpcyBjb250ZW50IHdoZW4gdXNlZCBhcyBhIFN5bWJvbFwiLGRvY3NMaW5rOlwiaHR0cHM6Ly93d3cuYnVpbGRlci5pby9jL2RvY3Mvc3ltYm9scy13aXRoLWJsb2Nrc1wiLGltYWdlOlwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9hcGkvdjEvaW1hZ2UvYXNzZXRzJTJGWUpJR2I0aTAxanZ3MFNSZEw1QnQlMkYzYWFkNmRlMzZlYWU0M2I1OWI1MmM4NTE5MGZkZWY1NlwiLGlucHV0czpbe25hbWU6XCJuYW1lXCIsdHlwZTpcInN0cmluZ1wiLHJlcXVpcmVkOiEwLGRlZmF1bHRWYWx1ZTpcImNoaWxkcmVuXCJ9XX0pO3ZhciBGcmFnbWVudENvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIG51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvcHMuYnVpbGRlckJsb2NrJiZ0aGlzLnByb3BzLmJ1aWxkZXJCbG9jay5jaGlsZHJlbiYmdGhpcy5wcm9wcy5idWlsZGVyQmxvY2suY2hpbGRyZW4ubWFwKChmdW5jdGlvbihlLHQpe3JldHVybiBSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1aWxkZXJCbG9jayQxLHtibG9jazplLGtleTplLmlkLGluZGV4OnR9KX0pKX0sdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxGcmFnbWVudD13aXRoQnVpbGRlcihGcmFnbWVudENvbXBvbmVudCx7bmFtZTpcIkNvcmU6RnJhZ21lbnRcIixjYW5IYXZlQ2hpbGRyZW46ITAsbm9XcmFwOiEwLHN0YXRpYzohMCxoaWRlRnJvbUluc2VydE1lbnU6ITB9KSxERUZBVUxUX0FTUEVDVF9SQVRJTyQyPS43MDA0MDQ4NTgyOTk1OTQ4LGRlZmF1bHRCbG9ja3M9W3tcIkB0eXBlXCI6XCJAYnVpbGRlci5pby9zZGs6RWxlbWVudFwiLHJlc3BvbnNpdmVTdHlsZXM6e2xhcmdlOntkaXNwbGF5OlwiZmxleFwiLGZsZXhEaXJlY3Rpb246XCJjb2x1bW5cIixhbGlnbkl0ZW1zOlwic3RyZXRjaFwiLGZsZXhTaHJpbms6XCIwXCIscG9zaXRpb246XCJyZWxhdGl2ZVwiLG1hcmdpblRvcDpcIjMwcHhcIix0ZXh0QWxpZ246XCJjZW50ZXJcIixsaW5lSGVpZ2h0Olwibm9ybWFsXCIsaGVpZ2h0OlwiYXV0b1wiLG1pbkhlaWdodDpcIjIwcHhcIixtaW5XaWR0aDpcIjIwcHhcIixvdmVyZmxvdzpcImhpZGRlblwifX0sY29tcG9uZW50OntuYW1lOlwiSW1hZ2VcIixvcHRpb25zOntpbWFnZTpcImh0dHBzOi8vYnVpbGRlci5pby9hcGkvdjEvaW1hZ2UvYXNzZXRzJTJGcHdnamYwUm9ZV2JkbkpTYnBCQWpYTlJNZTlGMiUyRmZiMjdhN2M3OTAzMjQyOTRhZjhiZTFjMzVmZTMwZjRkXCIsYmFja2dyb3VuZFBvc2l0aW9uOlwiY2VudGVyXCIsYmFja2dyb3VuZFNpemU6XCJjb3ZlclwiLGFzcGVjdFJhdGlvOkRFRkFVTFRfQVNQRUNUX1JBVElPJDJ9fX0se1wiQHR5cGVcIjpcIkBidWlsZGVyLmlvL3NkazpFbGVtZW50XCIscmVzcG9uc2l2ZVN0eWxlczp7bGFyZ2U6e2Rpc3BsYXk6XCJmbGV4XCIsZmxleERpcmVjdGlvbjpcImNvbHVtblwiLGFsaWduSXRlbXM6XCJzdHJldGNoXCIsZmxleFNocmluazpcIjBcIixwb3NpdGlvbjpcInJlbGF0aXZlXCIsbWFyZ2luVG9wOlwiMzBweFwiLHRleHRBbGlnbjpcImNlbnRlclwiLGxpbmVIZWlnaHQ6XCJub3JtYWxcIixoZWlnaHQ6XCJhdXRvXCJ9fSxjb21wb25lbnQ6e25hbWU6XCJUZXh0XCIsb3B0aW9uczp7dGV4dDpcIjxwPkVudGVyIHNvbWUgdGV4dC4uLjwvcD5cIn19fV0sQ29sdW1uc0NvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIG51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gX19leHRlbmRzKHQsZSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwiY29sdW1uc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcm9wcy5jb2x1bW5zfHxbXX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJndXR0ZXJTaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVyblwibnVtYmVyXCI9PXR5cGVvZiB0aGlzLnByb3BzLnNwYWNlP3RoaXMucHJvcHMuc3BhY2V8fDA6MjB9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZ2V0V2lkdGg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY29sdW1uc1tlXSYmdGhpcy5jb2x1bW5zW2VdLndpZHRofHwxMDAvdGhpcy5jb2x1bW5zLmxlbmd0aH0sdC5wcm90b3R5cGUuZ2V0Q29sdW1uV2lkdGg9ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5jb2x1bW5zLG49dGhpcy5ndXR0ZXJTaXplKih0Lmxlbmd0aC0xKS90Lmxlbmd0aDtyZXR1cm5cImNhbGMoXCIuY29uY2F0KHRoaXMuZ2V0V2lkdGgoZSksXCIlIC0gXCIpLmNvbmNhdChuLFwicHgpXCIpfSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgZSx0LG4saSxyPXRoaXMsbz10aGlzLmNvbHVtbnMsYT10aGlzLmd1dHRlclNpemUscz0obnVsbD09PShpPW51bGw9PT0obj1udWxsPT09KHQ9dGhpcy5wcm9wcy5idWlsZGVyU3RhdGUpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmNvbnRleHQuYnVpbGRlckNvbnRlbnQpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLm1ldGEpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmJyZWFrcG9pbnRzKXx8e30sbD1nZXRTaXplc0ZvckJyZWFrcG9pbnRzKHMpO3JldHVybiBqc3goUmVhY3RfX2RlZmF1bHQuRnJhZ21lbnQsbnVsbCxqc3goXCJkaXZcIix7Y2xhc3NOYW1lOlwiYnVpbGRlci1jb2x1bW5zXCIsY3NzOl9fYXNzaWduKHtkaXNwbGF5OlwiZmxleFwifSxcIm5ldmVyXCIhPT10aGlzLnByb3BzLnN0YWNrQ29sdW1uc0F0JiYoZT17fSxlW1wiQG1lZGlhIChtYXgtd2lkdGg6IFwiLmNvbmNhdChcInRhYmxldFwiIT09dGhpcy5wcm9wcy5zdGFja0NvbHVtbnNBdD9sLnNtYWxsLm1heDpsLm1lZGl1bS5tYXgsXCJweClcIildPXtmbGV4RGlyZWN0aW9uOnRoaXMucHJvcHMucmV2ZXJzZUNvbHVtbnNXaGVuU3RhY2tlZD9cImNvbHVtbi1yZXZlcnNlXCI6XCJjb2x1bW5cIixhbGlnbkl0ZW1zOlwic3RyZXRjaFwifSxlKSl9LG8ubWFwKChmdW5jdGlvbihlLHQpe3ZhciBuLGksbz1lLmxpbms/TGluazpcImRpdlwiO3JldHVybiBqc3goUmVhY3RfX2RlZmF1bHQuRnJhZ21lbnQse2tleTp0fSxqc3gobyxfX2Fzc2lnbih7Y2xhc3NOYW1lOlwiYnVpbGRlci1jb2x1bW5cIn0sZS5saW5rP3tocmVmOmUubGlua306bnVsbCx7Y3NzOl9fYXNzaWduKChuPXtkaXNwbGF5OlwiZmxleFwiLGZsZXhEaXJlY3Rpb246XCJjb2x1bW5cIixhbGlnbkl0ZW1zOlwic3RyZXRjaFwiLGxpbmVIZWlnaHQ6XCJub3JtYWxcIn0sbltcIiYgPiAuYnVpbGRlci1ibG9ja3NcIl09e2ZsZXhHcm93OjF9LG4ud2lkdGg9ci5nZXRDb2x1bW5XaWR0aCh0KSxuLm1hcmdpbkxlZnQ9MD09PXQ/MDphLG4pLFwibmV2ZXJcIiE9PXIucHJvcHMuc3RhY2tDb2x1bW5zQXQmJihpPXt9LGlbXCJAbWVkaWEgKG1heC13aWR0aDogXCIuY29uY2F0KFwidGFibGV0XCIhPT1yLnByb3BzLnN0YWNrQ29sdW1uc0F0P2wuc21hbGwubWF4OmwubWVkaXVtLm1heCxcInB4KVwiKV09e3dpZHRoOlwiMTAwJVwiLG1hcmdpbkxlZnQ6MH0saSkpfSksanN4KEJ1aWxkZXJCbG9ja3Mse2tleTp0LGNoaWxkOiEwLHBhcmVudEVsZW1lbnRJZDpyLnByb3BzLmJ1aWxkZXJCbG9jayYmci5wcm9wcy5idWlsZGVyQmxvY2suaWQsYmxvY2tzOmUuYmxvY2tzLGRhdGFQYXRoOlwiY29tcG9uZW50Lm9wdGlvbnMuY29sdW1ucy5cIi5jb25jYXQodCxcIi5ibG9ja3NcIil9KSkpfSkpKSl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksQ29sdW1ucz13aXRoQnVpbGRlcihDb2x1bW5zQ29tcG9uZW50LHtuYW1lOlwiQ29sdW1uc1wiLHN0YXRpYzohMCxpbnB1dHM6W3tuYW1lOlwiY29sdW1uc1wiLHR5cGU6XCJhcnJheVwiLGJyb2FkY2FzdDohMCxzdWJGaWVsZHM6W3tuYW1lOlwiYmxvY2tzXCIsdHlwZTpcImFycmF5XCIsaGlkZUZyb21VSTohMCxkZWZhdWx0VmFsdWU6ZGVmYXVsdEJsb2Nrc30se25hbWU6XCJ3aWR0aFwiLHR5cGU6XCJudW1iZXJcIixoaWRlRnJvbVVJOiEwLGhlbHBlclRleHQ6XCJXaWR0aCAlLCBlLmcuIHNldCB0byA1MCB0byBmaWxsIGhhbGYgb2YgdGhlIHNwYWNlXCJ9LHtuYW1lOlwibGlua1wiLHR5cGU6XCJ1cmxcIixoZWxwZXJUZXh0OlwiT3B0aW9uYWxseSBzZXQgYSB1cmwgdGhhdCBjbGlja2luZyB0aGlzIGNvbHVtbiB3aWxsIGxpbmsgdG9cIn1dLGRlZmF1bHRWYWx1ZTpbe2Jsb2NrczpkZWZhdWx0QmxvY2tzfSx7YmxvY2tzOmRlZmF1bHRCbG9ja3N9XSxvbkNoYW5nZTpmdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7bi5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmRlbGV0ZShcIndpZHRoXCIpfSkpfXZhciBuPWUuZ2V0KFwiY29sdW1uc1wiKTtBcnJheS5pc0FycmF5KG4pJiYoIW4uZmluZCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUuZ2V0KFwid2lkdGhcIil9KSl8fChuLmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVybiFlLmdldChcIndpZHRoXCIpfSkpfHwxMDAhPT1uLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSt0LmdldChcIndpZHRoXCIpfSksMCkpJiZ0KCkpfX0se25hbWU6XCJzcGFjZVwiLHR5cGU6XCJudW1iZXJcIixkZWZhdWx0VmFsdWU6MjAsaGVscGVyVGV4dDpcIlNpemUgb2YgZ2FwIGJldHdlZW4gY29sdW1uc1wiLGFkdmFuY2VkOiEwfSx7bmFtZTpcInN0YWNrQ29sdW1uc0F0XCIsdHlwZTpcInN0cmluZ1wiLGRlZmF1bHRWYWx1ZTpcInRhYmxldFwiLGhlbHBlclRleHQ6XCJDb252ZXJ0IGhvcml6b250YWwgY29sdW1ucyB0byB2ZXJ0aWNhbCBhdCB3aGF0IGRldmljZSBzaXplXCIsZW51bTpbXCJ0YWJsZXRcIixcIm1vYmlsZVwiLFwibmV2ZXJcIl0sYWR2YW5jZWQ6ITB9LHtuYW1lOlwicmV2ZXJzZUNvbHVtbnNXaGVuU3RhY2tlZFwiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOiExLGhlbHBlclRleHQ6XCJXaGVuIHN0YWNraW5nIGNvbHVtbnMgZm9yIG1vYmlsZSBkZXZpY2VzLCByZXZlcnNlIHRoZSBvcmRlcmluZ1wiLGFkdmFuY2VkOiEwfV19KSxFbWJlZENvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7dmFyIHQ9bnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzO3JldHVybiB0LmVsZW1lbnRSZWY9bnVsbCx0LnNjcmlwdHNJbnNlcnRlZD1uZXcgU2V0LHQuc2NyaXB0c1J1bj1uZXcgU2V0LHR9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZT1mdW5jdGlvbihlKXt0aGlzLnByb3BzLmNvbnRlbnQhPT1lLmNvbnRlbnQmJnRoaXMuZmluZEFuZFJ1blNjcmlwdHMoKX0sdC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQ9ZnVuY3Rpb24oKXt0aGlzLmZpbmRBbmRSdW5TY3JpcHRzKCl9LHQucHJvdG90eXBlLmZpbmRBbmRSdW5TY3JpcHRzPWZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtZW50UmVmJiZcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93KWZvcih2YXIgZT10aGlzLmVsZW1lbnRSZWYuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIiksdD0wO3Q8ZS5sZW5ndGg7dCsrKXt2YXIgbj1lW3RdO2lmKG4uc3JjKXtpZih0aGlzLnNjcmlwdHNJbnNlcnRlZC5oYXMobi5zcmMpKWNvbnRpbnVlO3RoaXMuc2NyaXB0c0luc2VydGVkLmFkZChuLnNyYyk7dmFyIGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtpLmFzeW5jPSEwLGkuc3JjPW4uc3JjLGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoaSl9ZWxzZXtpZih0aGlzLnNjcmlwdHNSdW4uaGFzKG4uaW5uZXJUZXh0KSljb250aW51ZTt0aGlzLnNjcmlwdHNSdW4uYWRkKG4uaW5uZXJUZXh0KTt0cnl7bmV3IEZ1bmN0aW9uKG4uaW5uZXJUZXh0KSgpfWNhdGNoKGUpe2NvbnNvbGUud2FybihcIkJ1aWxkZXIgY3VzdG9tIGNvZGUgY29tcG9uZW50IGVycm9yOlwiLGUpfX19fSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJjb250ZW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiBCdWlsZGVyLmlzU2VydmVyPyh0aGlzLnByb3BzLmNvbnRlbnR8fFwiXCIpLnJlcGxhY2UoLzxzY3JpcHRbXFxzXFxTXSo/PFxcL3NjcmlwdD4vZyxcIlwiKTp0aGlzLnByb3BzLmNvbnRlbnR9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImRpdlwiLHtyZWY6ZnVuY3Rpb24odCl7cmV0dXJuIGUuZWxlbWVudFJlZj10fSxjbGFzc05hbWU6XCJidWlsZGVyLWVtYmVkXCIsZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6e19faHRtbDp0aGlzLmNvbnRlbnR9fSl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksRW1iZWQ9d2l0aEJ1aWxkZXIoRW1iZWRDb21wb25lbnQse25hbWU6XCJFbWJlZFwiLHN0YXRpYzohMCxpbnB1dHM6W3tuYW1lOlwidXJsXCIsdHlwZTpcInVybFwiLHJlcXVpcmVkOiEwLGRlZmF1bHRWYWx1ZTpcIlwiLGhlbHBlclRleHQ6XCJlLmcuIGVudGVyIGEgeW91dHViZSB1cmwsIGdvb2dsZSBtYXAsIGV0Y1wiLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZ2V0KFwidXJsXCIpO2lmKHQpe2Uuc2V0KFwiY29udGVudFwiLFwiTG9hZGluZy4uLlwiKTtyZXR1cm4gZmV0Y2goXCJodHRwczovL2lmcmFtZS5seS9hcGkvaWZyYW1lbHk/dXJsPVwiLmNvbmNhdCh0LFwiJmFwaV9rZXk9XCIpLmNvbmNhdChcImFlMGU2MGU3ODIwMWEzZjJiMGRlNGJcIikpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBlLmpzb24oKX0pKS50aGVuKChmdW5jdGlvbihuKXtlLmdldChcInVybFwiKT09PXQmJihuLmh0bWw/ZS5zZXQoXCJjb250ZW50XCIsbi5odG1sKTplLnNldChcImNvbnRlbnRcIixcIkludmFsaWQgdXJsLCBwbGVhc2UgdHJ5IGFub3RoZXJcIikpfSkpLmNhdGNoKChmdW5jdGlvbih0KXtlLnNldChcImNvbnRlbnRcIixcIlRoZXJlIHdhcyBhbiBlcnJvciBlbWJlZGRpbmcgdGhpcyBVUkwsIHBsZWFzZSB0cnkgYWdhaW4gb3IgYW5vdGhlciBVUkxcIil9KSl9ZS5kZWxldGUoXCJjb250ZW50XCIpfX0se25hbWU6XCJjb250ZW50XCIsdHlwZTpcImh0bWxcIixkZWZhdWx0VmFsdWU6JzxkaXYgc3R5bGU9XCJwYWRkaW5nOiAyMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXJcIj4oQ2hvb3NlIGFuIGVtYmVkIFVSTCk8ZGl2PicsaGlkZUZyb21VSTohMH1dfSksZ2xvYmFsUmVwbGFjZU5vZGVzPXt9fHxudWxsLGlzU2hvcGlmeSQxPUJ1aWxkZXIuaXNCcm93c2VyJiZcIlNob3BpZnlcImluIHdpbmRvdztpZihCdWlsZGVyLmlzQnJvd3NlciYmZ2xvYmFsUmVwbGFjZU5vZGVzKXt2YXIgY3VzdG9tQ29kZVF1ZXJ5U2VsZWN0b3JfMT1cIi5idWlsZGVyLWN1c3RvbS1jb2RlXCI7dHJ5e3ZhciBhbGxDdXN0b21Db2RlRWxlbWVudHNfMT1BcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY3VzdG9tQ29kZVF1ZXJ5U2VsZWN0b3JfMSkpLGJ1aWxkZXJUZW1wbGF0ZXM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcInRlbXBsYXRlW2RhdGEtdGVtcGxhdGUtdmFyaWFudC1pZF1cIik7YnVpbGRlclRlbXBsYXRlcy5sZW5ndGgmJkFycmF5LmZyb20oYnVpbGRlclRlbXBsYXRlcykuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY3VzdG9tQ29kZVF1ZXJ5U2VsZWN0b3JfMSk7dC5sZW5ndGgmJihhbGxDdXN0b21Db2RlRWxlbWVudHNfMT1hbGxDdXN0b21Db2RlRWxlbWVudHNfMS5jb25jYXQoQXJyYXkuZnJvbSh0KSkpfSkpLGFsbEN1c3RvbUNvZGVFbGVtZW50c18xLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUucGFyZW50RWxlbWVudCxuPXQmJnQuZ2V0QXR0cmlidXRlKFwiYnVpbGRlci1pZFwiKTtuJiYoZ2xvYmFsUmVwbGFjZU5vZGVzW25dPWdsb2JhbFJlcGxhY2VOb2Rlc1tuXXx8W10sZ2xvYmFsUmVwbGFjZU5vZGVzW25dLnB1c2goaXNTaG9waWZ5JDE/ZTplLmNsb25lTm9kZSghMCkpKX0pKX1jYXRjaChlKXtjb25zb2xlLmVycm9yKFwiQnVpbGRlciByZXBsYWNlIG5vZGVzIGVycm9yOlwiLGUpfX12YXIgQ3VzdG9tQ29kZUNvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KHQpe3ZhciBuLGk9dGhpcztpZigoaT1lLmNhbGwodGhpcyx0KXx8dGhpcykuZWxlbWVudFJlZj1udWxsLGkub3JpZ2luYWxSZWY9bnVsbCxpLnNjcmlwdHNJbnNlcnRlZD1uZXcgU2V0LGkuc2NyaXB0c1J1bj1uZXcgU2V0LGkuZmlyc3RMb2FkPSEwLGkucmVwbGFjZU5vZGVzPSExLGkuc3RhdGU9e2h5ZHJhdGVkOiExfSxCdWlsZGVyLmlzQnJvd3Nlcil7dmFyIHI9bnVsbD09PShuPWkucHJvcHMuYnVpbGRlckJsb2NrKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pZDtpZihpLnJlcGxhY2VOb2Rlcz1Cb29sZWFuKEJ1aWxkZXIuaXNCcm93c2VyJiYodC5yZXBsYWNlTm9kZXN8fGlzU2hvcGlmeSQxKSYmciYmKG51bGw9PWdsb2JhbFJlcGxhY2VOb2Rlcz92b2lkIDA6Z2xvYmFsUmVwbGFjZU5vZGVzW3JdKSksaS5maXJzdExvYWQmJmkucHJvcHMuYnVpbGRlckJsb2NrKWlmKHImJihudWxsPT1nbG9iYWxSZXBsYWNlTm9kZXM/dm9pZCAwOmdsb2JhbFJlcGxhY2VOb2Rlc1tyXSkpe3ZhciBvPWdsb2JhbFJlcGxhY2VOb2Rlc1tyXS5zaGlmdCgpfHxudWxsO2kub3JpZ2luYWxSZWY9bywwPT09Z2xvYmFsUmVwbGFjZU5vZGVzW3JdLmxlbmd0aCYmZGVsZXRlIGdsb2JhbFJlcGxhY2VOb2Rlc1tyXX1lbHNlIGlmKGkucmVwbGFjZU5vZGVzKXt2YXIgYT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLlwiLmNvbmNhdChpLnByb3BzLmJ1aWxkZXJCbG9jay5pZCxcIiAuYnVpbGRlci1jdXN0b20tY29kZVwiKSk7aWYoMT09PWEubGVuZ3RoKXt2YXIgcz1hWzBdO2kub3JpZ2luYWxSZWY9cyxpLm9yaWdpbmFsUmVmLnJlbW92ZSgpfX19cmV0dXJuIGl9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcIm5vUmVhY3RSZW5kZXJcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIEJvb2xlYW4oaXNTaG9waWZ5JDEmJihudWxsPT09KGU9dGhpcy5wcm9wcy5jb2RlKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5tYXRjaCgve1t7JV0vZykpKX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpc0h5ZHJhdGluZ1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4haXNTaG9waWZ5JDEmJnRoaXMub3JpZ2luYWxSZWZ9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlPWZ1bmN0aW9uKGUpe3RoaXMucHJvcHMuY29kZSE9PWUuY29kZSYmdGhpcy5maW5kQW5kUnVuU2NyaXB0cygpfSx0LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5maXJzdExvYWQ9ITEsdGhpcy5yZXBsYWNlTm9kZXN8fCh0aGlzLmlzSHlkcmF0aW5nPyh0aGlzLnNldFN0YXRlKHtoeWRyYXRlZDohMH0pLEJ1aWxkZXIubmV4dFRpY2soKGZ1bmN0aW9uKCl7cmV0dXJuIGUuZmluZEFuZFJ1blNjcmlwdHMoKX0pKSk6dGhpcy5maW5kQW5kUnVuU2NyaXB0cygpKSxCdWlsZGVyLmlzQnJvd3NlciYmdGhpcy5yZXBsYWNlTm9kZXMmJnRoaXMub3JpZ2luYWxSZWYmJnRoaXMuZWxlbWVudFJlZiYmdGhpcy5lbGVtZW50UmVmLmFwcGVuZENoaWxkKHRoaXMub3JpZ2luYWxSZWYpfSx0LnByb3RvdHlwZS5maW5kQW5kUnVuU2NyaXB0cz1mdW5jdGlvbigpe2lmKHRoaXMuZWxlbWVudFJlZiYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdylmb3IodmFyIGU9dGhpcy5lbGVtZW50UmVmLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpLHQ9MDt0PGUubGVuZ3RoO3QrKyl7dmFyIG49ZVt0XTtpZihuLnNyYyl7aWYodGhpcy5zY3JpcHRzSW5zZXJ0ZWQuaGFzKG4uc3JjKSljb250aW51ZTt0aGlzLnNjcmlwdHNJbnNlcnRlZC5hZGQobi5zcmMpO3ZhciBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7aS5hc3luYz0hMCxpLnNyYz1uLnNyYyxkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGkpfWVsc2UgaWYoIW4udHlwZXx8W1widGV4dC9qYXZhc2NyaXB0XCIsXCJhcHBsaWNhdGlvbi9qYXZhc2NyaXB0XCIsXCJhcHBsaWNhdGlvbi9lY21hc2NyaXB0XCJdLmluY2x1ZGVzKG4udHlwZSkpe2lmKHRoaXMuc2NyaXB0c1J1bi5oYXMobi5pbm5lclRleHQpKWNvbnRpbnVlO3RyeXt0aGlzLnNjcmlwdHNSdW4uYWRkKG4uaW5uZXJUZXh0KSxuZXcgRnVuY3Rpb24obi5pbm5lclRleHQpKCl9Y2F0Y2goZSl7Y29uc29sZS53YXJuKFwiQnVpbGRlciBjdXN0b20gY29kZSBjb21wb25lbnQgZXJyb3I6XCIsZSl9fX19LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcImNvZGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuKEJ1aWxkZXIuaXNTZXJ2ZXJ8fHRoaXMuaXNIeWRyYXRpbmcmJnRoaXMuZmlyc3RMb2FkKSYmdGhpcy5wcm9wcy5zY3JpcHRzQ2xpZW50T25seT8odGhpcy5wcm9wcy5jb2RlfHxcIlwiKS5yZXBsYWNlKC88c2NyaXB0XFxiW148XSooPzooPyE8XFwvc2NyaXB0Pik8W148XSopKjxcXC9zY3JpcHQ+L2dpLFwiXCIpOnRoaXMucHJvcHMuY29kZX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiBSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsX19hc3NpZ24oe3JlZjpmdW5jdGlvbih0KXtyZXR1cm4gZS5lbGVtZW50UmVmPXR9LGNsYXNzTmFtZTpcImJ1aWxkZXItY3VzdG9tLWNvZGVcIn0sIXRoaXMucmVwbGFjZU5vZGVzJiYhdGhpcy5ub1JlYWN0UmVuZGVyJiZ7ZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6e19faHRtbDp0aGlzLmNvZGV9fSkpfSx0fShSZWFjdF9fZGVmYXVsdC5Db21wb25lbnQpLEN1c3RvbUNvZGU9d2l0aEJ1aWxkZXIoQ3VzdG9tQ29kZUNvbXBvbmVudCx7bmFtZTpcIkN1c3RvbSBDb2RlXCIsc3RhdGljOiEwLHJlcXVpcmVkUGVybWlzc2lvbnM6W1wiZWRpdENvZGVcIl0saW5wdXRzOlt7bmFtZTpcImNvZGVcIix0eXBlOlwiaHRtbFwiLHJlcXVpcmVkOiEwLGRlZmF1bHRWYWx1ZTpcIjxwPkhlbGxvIHRoZXJlLCBJIGFtIGN1c3RvbSBIVE1MIGNvZGUhPC9wPlwiLGNvZGU6ITB9LF9fYXNzaWduKHtuYW1lOlwicmVwbGFjZU5vZGVzXCIsdHlwZTpcImJvb2xlYW5cIixoZWxwZXJUZXh0OlwiUHJlc2VydmUgc2VydmVyIHJlbmRlcmVkIGRvbSBub2Rlc1wiLGFkdmFuY2VkOiEwfSxpc1Nob3BpZnkkMSYme2RlZmF1bHRWYWx1ZTohMH0pLF9fYXNzaWduKHtuYW1lOlwic2NyaXB0c0NsaWVudE9ubHlcIix0eXBlOlwiYm9vbGVhblwiLGhlbHBlclRleHQ6XCJPbmx5IHByaW50IGFuZCBydW4gc2NyaXB0cyBvbiB0aGUgY2xpZW50LiBJbXBvcnRhbnQgd2hlbiBzY3JpcHRzIGluZmx1ZW5jZSBET00gdGhhdCBjb3VsZCBiZSByZXBsYWNlZCB3aGVuIGNsaWVudCBsb2Fkc1wiLGFkdmFuY2VkOiEwfSwhaXNTaG9waWZ5JDEmJntkZWZhdWx0VmFsdWU6ITB9KV19KTtmdW5jdGlvbiByZW1vdmVQcm90b2NvbChlKXtyZXR1cm4gZS5yZXBsYWNlKC9odHRwKHMpPzovLFwiXCIpfWZ1bmN0aW9uIGlzRWxlbWVudEluVmlld3BvcnQoZSl7dmFyIHQ9ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZXR1cm4gdC50b3A+PTAmJnQubGVmdD49MCYmdC5ib3R0b208PSh3aW5kb3cuaW5uZXJIZWlnaHR8fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpJiZ0LnJpZ2h0PD0od2luZG93LmlubmVyV2lkdGh8fGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCl9ZnVuY3Rpb24gZ2V0U2hvcGlmeUltYWdlVXJsKGUsdCl7aWYoIWV8fCEobnVsbD09ZT92b2lkIDA6ZS5tYXRjaCgvY2RuXFwuc2hvcGlmeVxcLmNvbS8pKXx8IXQpcmV0dXJuIGU7aWYoXCJtYXN0ZXJcIj09PXQpcmV0dXJuIHJlbW92ZVByb3RvY29sKGUpO3ZhciBuPWUubWF0Y2goLyhfXFxkK3goXFxkKyk/KT8oXFwuKGpwZ3xqcGVnfGdpZnxwbmd8Ym1wfGJpdG1hcHx0aWZmfHRpZikoXFw/dj1cXGQrKT8pL2kpO2lmKG4pe3ZhciBpPWUuc3BsaXQoblswXSkscj1uWzNdLG89dC5tYXRjaChcInhcIik/dDpcIlwiLmNvbmNhdCh0LFwieFwiKTtyZXR1cm4gcmVtb3ZlUHJvdG9jb2woXCJcIi5jb25jYXQoaVswXSxcIl9cIikuY29uY2F0KG8pLmNvbmNhdChyKSl9cmV0dXJuIG51bGx9dmFyIERFRkFVTFRfQVNQRUNUX1JBVElPJDE9LjcwNDE7ZnVuY3Rpb24gdXBkYXRlUXVlcnlQYXJhbShlLHQsbil7dm9pZCAwPT09ZSYmKGU9XCJcIik7dmFyIGk9bmV3IFJlZ0V4cChcIihbPyZdKVwiK3QrXCI9Lio/KCZ8JClcIixcImlcIikscj0tMSE9PWUuaW5kZXhPZihcIj9cIik/XCImXCI6XCI/XCI7cmV0dXJuIGUubWF0Y2goaSk/ZS5yZXBsYWNlKGksXCIkMVwiK3QrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KG4pK1wiJDJcIik6ZStyK3QrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KG4pfWZ1bmN0aW9uIGdldFNyY1NldChlKXtpZighZSlyZXR1cm4gZTt2YXIgdD1bMTAwLDIwMCw0MDAsODAwLDEyMDAsMTYwMCwyZTNdO2lmKGUubWF0Y2goL2J1aWxkZXJcXC5pby8pKXt2YXIgbj1lLGk9TnVtYmVyKGUuc3BsaXQoXCI/d2lkdGg9XCIpWzFdKTtyZXR1cm4gaXNOYU4oaSl8fChuPVwiXCIuY29uY2F0KG4sXCIgXCIpLmNvbmNhdChpLFwid1wiKSksdC5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBlIT09aX0pKS5tYXAoKGZ1bmN0aW9uKHQpe3JldHVyblwiXCIuY29uY2F0KHVwZGF0ZVF1ZXJ5UGFyYW0oZSxcIndpZHRoXCIsdCksXCIgXCIpLmNvbmNhdCh0LFwid1wiKX0pKS5jb25jYXQoW25dKS5qb2luKFwiLCBcIil9cmV0dXJuIGUubWF0Y2goL2NkblxcLnNob3BpZnlcXC5jb20vKT90Lm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuW2dldFNob3BpZnlJbWFnZVVybChlLFwiXCIuY29uY2F0KHQsXCJ4XCIpLmNvbmNhdCh0KSksdF19KSkuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4hIWVbMF19KSkubWFwKChmdW5jdGlvbihlKXt2YXIgdD1lWzBdLG49ZVsxXTtyZXR1cm5cIlwiLmNvbmNhdCh0LFwiIFwiKS5jb25jYXQobixcIndcIil9KSkuY29uY2F0KFtlXSkuam9pbihcIiwgXCIpOmV9dmFyIGdldFNpemVzPWZ1bmN0aW9uKGUsdCxuKXt2YXIgaSxyLG8sYSxzLGwsdSxkO3ZvaWQgMD09PW4mJihuPXt9KTt2YXIgYz1cIlwiO2lmKGUpe3ZhciBwPWUuc3BsaXQoXCIsXCIpLGY9cC5sZW5ndGg7Yz1wLm1hcCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZj09PXQrMT9lLnJlcGxhY2UoL1xcKFtcXHNcXFNdKj9cXCkvZyxcIlwiKS50cmltKCk6ZX0pKS5qb2luKFwiLCBcIil9ZWxzZSBpZih0JiZ0LnJlc3BvbnNpdmVTdHlsZXMpe3ZhciBtPVtdLGg9ITEsZz0vXlxcZCsvLHY9Z2V0U2l6ZXNGb3JCcmVha3BvaW50cyhuKTtpZihudWxsPT09KG89bnVsbD09PShyPW51bGw9PT0oaT10LnJlc3BvbnNpdmVTdHlsZXMpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnNtYWxsKXx8dm9pZCAwPT09cj92b2lkIDA6ci53aWR0aCl8fHZvaWQgMD09PW8/dm9pZCAwOm8ubWF0Y2goZykpe2g9ITA7dmFyIGI9XCIobWF4LXdpZHRoOiBcIi5jb25jYXQodi5zbWFsbC5tYXgsXCJweClcIikseT1cIlwiLmNvbmNhdChiLFwiIFwiKS5jb25jYXQodC5yZXNwb25zaXZlU3R5bGVzLnNtYWxsLndpZHRoLnJlcGxhY2UoXCIlXCIsXCJ2d1wiKSk7bS5wdXNoKHkpfWlmKG51bGw9PT0obD1udWxsPT09KHM9bnVsbD09PShhPXQucmVzcG9uc2l2ZVN0eWxlcyl8fHZvaWQgMD09PWE/dm9pZCAwOmEubWVkaXVtKXx8dm9pZCAwPT09cz92b2lkIDA6cy53aWR0aCl8fHZvaWQgMD09PWw/dm9pZCAwOmwubWF0Y2goZykpe2g9ITA7Yj1cIihtYXgtd2lkdGg6IFwiLmNvbmNhdCh2Lm1lZGl1bS5tYXgsXCJweClcIikseT1cIlwiLmNvbmNhdChiLFwiIFwiKS5jb25jYXQodC5yZXNwb25zaXZlU3R5bGVzLm1lZGl1bS53aWR0aC5yZXBsYWNlKFwiJVwiLFwidndcIikpO20ucHVzaCh5KX1pZihudWxsPT09KGQ9bnVsbD09PSh1PXQucmVzcG9uc2l2ZVN0eWxlcyl8fHZvaWQgMD09PXU/dm9pZCAwOnUubGFyZ2UpfHx2b2lkIDA9PT1kP3ZvaWQgMDpkLndpZHRoKXt2YXIgXz10LnJlc3BvbnNpdmVTdHlsZXMubGFyZ2Uud2lkdGgucmVwbGFjZShcIiVcIixcInZ3XCIpO20ucHVzaChfKX1lbHNlIGgmJm0ucHVzaChcIjEwMHZ3XCIpO20ubGVuZ3RoJiYoYz1tLmpvaW4oXCIsIFwiKSl9cmV0dXJuIGN9LEltYWdlQ29tcG9uZW50PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXt2YXIgdD1udWxsIT09ZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXM7cmV0dXJuIHQuc3RhdGU9e2ltYWdlTG9hZGVkOiF0LnVzZUxhenlMb2FkaW5nLGxvYWQ6IXQudXNlTGF6eUxvYWRpbmd9LHQucGljdHVyZVJlZj1udWxsLHQuc2Nyb2xsTGlzdGVuZXI9bnVsbCx0LmludGVyc2VjdGlvbk9ic2VydmVyPW51bGwsdH1yZXR1cm4gX19leHRlbmRzKHQsZSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwidXNlTGF6eUxvYWRpbmdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuKCFCdWlsZGVyLmlzQnJvd3Nlcnx8IWxvY2F0aW9uLnNlYXJjaC5pbmNsdWRlcyhcImJ1aWxkZXIubGF6eUxvYWRJbWFnZXM9ZmFsc2VcIikpJiYoISghQnVpbGRlci5pc0Jyb3dzZXJ8fCFsb2NhdGlvbi5ocmVmLmluY2x1ZGVzKFwiYnVpbGRlci5sYXp5TG9hZEltYWdlcz10cnVlXCIpKXx8dGhpcy5wcm9wcy5sYXp5KX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudD1mdW5jdGlvbigpe0J1aWxkZXIuaXNCcm93c2VyJiYodGhpcy5zY3JvbGxMaXN0ZW5lciYmKHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsdGhpcy5zY3JvbGxMaXN0ZW5lciksdGhpcy5zY3JvbGxMaXN0ZW5lcj1udWxsKSx0aGlzLmludGVyc2VjdGlvbk9ic2VydmVyJiZ0aGlzLnBpY3R1cmVSZWYmJnRoaXMuaW50ZXJzZWN0aW9uT2JzZXJ2ZXIudW5vYnNlcnZlKHRoaXMucGljdHVyZVJlZikpfSx0LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYodGhpcy5wcm9wcy5sYXp5JiZCdWlsZGVyLmlzQnJvd3NlcilpZih0aGlzLnBpY3R1cmVSZWYmJmlzRWxlbWVudEluVmlld3BvcnQodGhpcy5waWN0dXJlUmVmKSl0aGlzLnNldFN0YXRlKHtsb2FkOiEwfSk7ZWxzZSBpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBJbnRlcnNlY3Rpb25PYnNlcnZlciYmdGhpcy5waWN0dXJlUmVmKXsodGhpcy5pbnRlcnNlY3Rpb25PYnNlcnZlcj1uZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKGZ1bmN0aW9uKHQsbil7dC5mb3JFYWNoKChmdW5jdGlvbih0KXt0LmludGVyc2VjdGlvblJhdGlvPjAmJihlLnNldFN0YXRlKHtsb2FkOiEwfSksZS5waWN0dXJlUmVmJiZuLnVub2JzZXJ2ZShlLnBpY3R1cmVSZWYpKX0pKX0pKSkub2JzZXJ2ZSh0aGlzLnBpY3R1cmVSZWYpfWVsc2V7dmFyIHQ9dGhyb3R0bGUoKGZ1bmN0aW9uKG4pe2lmKGUucGljdHVyZVJlZil7dmFyIGk9ZS5waWN0dXJlUmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLHI9d2luZG93LmlubmVySGVpZ2h0LzI7aS50b3A8d2luZG93LmlubmVySGVpZ2h0K3ImJihlLnNldFN0YXRlKF9fYXNzaWduKF9fYXNzaWduKHt9LGUuc3RhdGUpLHtsb2FkOiEwfSkpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsdCksZS5zY3JvbGxMaXN0ZW5lcj1udWxsKX19KSw0MDAse2xlYWRpbmc6ITEsdHJhaWxpbmc6ITB9KTt0aGlzLnNjcm9sbExpc3RlbmVyPXQsd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIix0LHtjYXB0dXJlOiEwLHBhc3NpdmU6ITB9KSx0KCl9fSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJpbWFnZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcm9wcy5pbWFnZXx8dGhpcy5wcm9wcy5zcmN9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuZ2V0U3JjU2V0PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5pbWFnZTtpZihlJiYoZS5tYXRjaCgvYnVpbGRlclxcLmlvLyl8fGUubWF0Y2goL2NkblxcLnNob3BpZnlcXC5jb20vKSkpcmV0dXJuIGdldFNyY1NldChlKX0sdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGUsdCxuPXRoaXMsaT10aGlzLnByb3BzLHI9aS5hc3BlY3RSYXRpbyxvPWkubGF6eSxhPWkuYnVpbGRlckJsb2NrLHM9aS5idWlsZGVyU3RhdGUsbD10aGlzLnByb3BzLmJ1aWxkZXJCbG9jayYmdGhpcy5wcm9wcy5idWlsZGVyQmxvY2suY2hpbGRyZW4sdT10aGlzLnByb3BzLnNyY3NldCxkPWdldFNpemVzKHRoaXMucHJvcHMuc2l6ZXMsYSwobnVsbD09PSh0PW51bGw9PT0oZT1udWxsPT1zP3ZvaWQgMDpzLmNvbnRleHQuYnVpbGRlckNvbnRlbnQpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLm1ldGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmJyZWFrcG9pbnRzKXx8e30pLGM9dGhpcy5pbWFnZTt1JiZjJiZjLmluY2x1ZGVzKFwiYnVpbGRlci5pby9hcGkvdjEvaW1hZ2VcIik/dS5pbmNsdWRlcyhjLnNwbGl0KFwiP1wiKVswXSl8fChjb25zb2xlLmRlYnVnKFwiUmVtb3ZlZCBnaXZlbiBzcmNzZXRcIiksdT10aGlzLmdldFNyY1NldCgpKTpjJiYhdSYmKHU9dGhpcy5nZXRTcmNTZXQoKSk7dmFyIHA9bnVsbD09YT92b2lkIDA6YS5pZC5zdGFydHNXaXRoKFwiYnVpbGRlci1waXhlbC1cIiksZj10aGlzLnByb3BzLmZpdENvbnRlbnQ7cmV0dXJuIGpzeChCdWlsZGVyTWV0YUNvbnRleHQuQ29uc3VtZXIsbnVsbCwoZnVuY3Rpb24oZSl7dmFyIHQsaT1lLmFtcE1vZGUsYT1pP1wiYW1wLWltZ1wiOlwiaW1nXCIscz0oIW98fG4uc3RhdGUubG9hZHx8aSkmJmpzeChhLF9fYXNzaWduKHt9LGk/e2xheW91dDpcInJlc3BvbnNpdmVcIixoZWlnaHQ6bi5wcm9wcy5oZWlnaHR8fChyP01hdGgucm91bmQoMWUzKnIpOnZvaWQgMCksd2lkdGg6bi5wcm9wcy53aWR0aHx8KHI/TWF0aC5yb3VuZCgxZTMvcik6dm9pZCAwKX06bnVsbCx7YWx0Om4ucHJvcHMuYWx0VGV4dCxrZXk6QnVpbGRlci5pc0VkaXRpbmcmJlwic3RyaW5nXCI9PXR5cGVvZiBuLmltYWdlJiZuLmltYWdlLnNwbGl0KFwiP1wiKVswXXx8dm9pZCAwLHJvbGU6bi5wcm9wcy5hbHRUZXh0P3ZvaWQgMDpcInByZXNlbnRhdGlvblwiLGNzczpfX2Fzc2lnbihfX2Fzc2lnbih7b3BhY2l0eTppPzE6bi51c2VMYXp5TG9hZGluZyYmIW4uc3RhdGUuaW1hZ2VMb2FkZWQ/MDoxLHRyYW5zaXRpb246XCJvcGFjaXR5IDAuMnMgZWFzZS1pbi1vdXRcIixvYmplY3RGaXQ6bi5wcm9wcy5iYWNrZ3JvdW5kU2l6ZXx8XCJjb3ZlclwiLG9iamVjdFBvc2l0aW9uOm4ucHJvcHMuYmFja2dyb3VuZFBvc2l0aW9ufHxcImNlbnRlclwifSxyJiYhaSYme3Bvc2l0aW9uOlwiYWJzb2x1dGVcIixoZWlnaHQ6XCIxMDAlXCIsd2lkdGg6XCIxMDAlXCIsbGVmdDowLHRvcDowfSksaSYmKHQ9e30sdFtcIiYgaW1nXCJdPXtvYmplY3RGaXQ6bi5wcm9wcy5iYWNrZ3JvdW5kU2l6ZSxvYmplY3RQb3NpdGlvbjpuLnByb3BzLmJhY2tncm91bmRQb3NpdGlvbn0sdCkpLGxvYWRpbmc6cD9cImVhZ2VyXCI6XCJsYXp5XCIsY2xhc3NOYW1lOlwiYnVpbGRlci1pbWFnZVwiKyhuLnByb3BzLmNsYXNzTmFtZT9cIiBcIituLnByb3BzLmNsYXNzTmFtZTpcIlwiKSxzcmM6bi5pbWFnZX0sIWkmJntvbkxvYWQ6ZnVuY3Rpb24oKXtyZXR1cm4gbi5zZXRTdGF0ZSh7aW1hZ2VMb2FkZWQ6ITB9KX19LHtzcmNTZXQ6dSxzaXplczohaSYmZD9kOnZvaWQgMH0pKTtyZXR1cm4ganN4KFJlYWN0X19kZWZhdWx0LkZyYWdtZW50LG51bGwsaT9zOmpzeChcInBpY3R1cmVcIix7cmVmOmZ1bmN0aW9uKGUpe3JldHVybiBuLnBpY3R1cmVSZWY9ZX19LHUmJnUubWF0Y2goL2J1aWxkZXJcXC5pby8pJiYhbi5wcm9wcy5ub1dlYnAmJmpzeChcInNvdXJjZVwiLHtzcmNTZXQ6dS5yZXBsYWNlKC9cXD8vZyxcIj9mb3JtYXQ9d2VicCZcIiksdHlwZTpcImltYWdlL3dlYnBcIn0pLHMpLCFyfHxpfHxmJiZsJiZsLmxlbmd0aD9udWxsOmpzeChcImRpdlwiLHtjbGFzc05hbWU6XCJidWlsZGVyLWltYWdlLXNpemVyXCIsY3NzOnt3aWR0aDpcIjEwMCVcIixwYWRkaW5nVG9wOjEwMCpyK1wiJVwiLHBvaW50ZXJFdmVudHM6XCJub25lXCIsZm9udFNpemU6MH19LFwiIFwiKSxsJiZsLmxlbmd0aD9mP2wubWFwKChmdW5jdGlvbihlLHQpe3JldHVybiBqc3goQnVpbGRlckJsb2NrJDEse2tleTplLmlkLGJsb2NrOmV9KX0pKTpqc3goXCJkaXZcIix7Y3NzOntkaXNwbGF5OlwiZmxleFwiLGZsZXhEaXJlY3Rpb246XCJjb2x1bW5cIixhbGlnbkl0ZW1zOlwic3RyZXRjaFwiLHBvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6MCxsZWZ0OjAsd2lkdGg6XCIxMDAlXCIsaGVpZ2h0OlwiMTAwJVwifX0sbC5tYXAoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGpzeChCdWlsZGVyQmxvY2skMSx7a2V5OmUuaWQsYmxvY2s6ZX0pfSkpKTpudWxsKX0pKX0sdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxJbWFnZT13aXRoQnVpbGRlcihJbWFnZUNvbXBvbmVudCx7bmFtZTpcIkltYWdlXCIsc3RhdGljOiEwLGltYWdlOlwiaHR0cHM6Ly9maXJlYmFzZXN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vdjAvYi9idWlsZGVyLTNiMGEyLmFwcHNwb3QuY29tL28vaW1hZ2VzJTJGYmFzZWxpbmUtaW5zZXJ0X3Bob3RvLTI0cHguc3ZnP2FsdD1tZWRpYSZ0b2tlbj00ZTVkMGVmNC1mNWU4LTRlNTctYjNhOS0zOGQ2M2E5YjlkYzRcIixkZWZhdWx0U3R5bGVzOntwb3NpdGlvbjpcInJlbGF0aXZlXCIsbWluSGVpZ2h0OlwiMjBweFwiLG1pbldpZHRoOlwiMjBweFwiLG92ZXJmbG93OlwiaGlkZGVuXCJ9LGNhbkhhdmVDaGlsZHJlbjohMCxpbnB1dHM6W3tuYW1lOlwiaW1hZ2VcIix0eXBlOlwiZmlsZVwiLGJ1YmJsZTohMCxhbGxvd2VkRmlsZVR5cGVzOltcImpwZWdcIixcImpwZ1wiLFwicG5nXCIsXCJzdmdcIl0scmVxdWlyZWQ6ITAsZGVmYXVsdFZhbHVlOlwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9hcGkvdjEvaW1hZ2UvYXNzZXRzJTJGWUpJR2I0aTAxanZ3MFNSZEw1QnQlMkY3MmM4MGYxMTRkYzE0OTAxOTA1MWI2ODUyYTllM2I3YVwiLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe2UuZGVsZXRlKFwic3Jjc2V0XCIpLGUuZGVsZXRlKFwibm9XZWJwXCIpO3ZhciB0LG4saT1lLmdldChcImltYWdlXCIpLHI9ZS5nZXQoXCJhc3BlY3RSYXRpb1wiKTtpZihmZXRjaChpKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gZS5ibG9iKCl9KSkudGhlbigoZnVuY3Rpb24odCl7dC50eXBlLmluY2x1ZGVzKFwic3ZnXCIpJiZlLnNldChcIm5vV2VicFwiLCEwKX0pKSxpJiYoIXJ8fC43MDQxPT09cikpcmV0dXJuKHQ9aSx2b2lkIDA9PT1uJiYobj02ZTQpLG5ldyBQcm9taXNlKChmdW5jdGlvbihlLGkpe3ZhciByPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiksbz0hMTtyLm9ubG9hZD1mdW5jdGlvbigpe289ITAsZShyKX0sci5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwoZnVuY3Rpb24oZSl7Y29uc29sZS53YXJuKFwiSW1hZ2UgbG9hZCBmYWlsZWRcIixlLmVycm9yKSxpKGUuZXJyb3IpfSkpLHIuc3JjPXQsc2V0VGltZW91dCgoZnVuY3Rpb24oKXtvfHxpKG5ldyBFcnJvcihcIkltYWdlIGxvYWQgdGltZWQgb3V0XCIpKX0pLG4pfSkpKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbixyPWUuZ2V0KFwiYXNwZWN0UmF0aW9cIik7ZS5nZXQoXCJpbWFnZVwiKSE9PWl8fHImJi43MDQxIT09cnx8dC53aWR0aCYmdC5oZWlnaHQmJihlLnNldChcImFzcGVjdFJhdGlvXCIsKG49dC5oZWlnaHQvdC53aWR0aCxNYXRoLnJvdW5kKDFlMypuKS8xZTMpKSxlLnNldChcImhlaWdodFwiLHQuaGVpZ2h0KSxlLnNldChcIndpZHRoXCIsdC53aWR0aCkpfSkpfX0se25hbWU6XCJiYWNrZ3JvdW5kU2l6ZVwiLHR5cGU6XCJ0ZXh0XCIsZGVmYXVsdFZhbHVlOlwiY292ZXJcIixlbnVtOlt7bGFiZWw6XCJjb250YWluXCIsdmFsdWU6XCJjb250YWluXCIsaGVscGVyVGV4dDpcIlRoZSBpbWFnZSBzaG91bGQgbmV2ZXIgZ2V0IGNyb3BwZWRcIn0se2xhYmVsOlwiY292ZXJcIix2YWx1ZTpcImNvdmVyXCIsaGVscGVyVGV4dDpcIlRoZSBpbWFnZSBzaG91bGQgZmlsbCBpdHMgYm94LCBjcm9wcGluZyB3aGVuIG5lZWRlZFwifV19LHtuYW1lOlwiYmFja2dyb3VuZFBvc2l0aW9uXCIsdHlwZTpcInRleHRcIixkZWZhdWx0VmFsdWU6XCJjZW50ZXJcIixlbnVtOltcImNlbnRlclwiLFwidG9wXCIsXCJsZWZ0XCIsXCJyaWdodFwiLFwiYm90dG9tXCIsXCJ0b3AgbGVmdFwiLFwidG9wIHJpZ2h0XCIsXCJib3R0b20gbGVmdFwiLFwiYm90dG9tIHJpZ2h0XCJdfSx7bmFtZTpcImFsdFRleHRcIix0eXBlOlwic3RyaW5nXCIsaGVscGVyVGV4dDpcIlRleHQgdG8gZGlzcGxheSB3aGVuIHRoZSB1c2VyIGhhcyBpbWFnZXMgb2ZmXCJ9LHtuYW1lOlwiaGVpZ2h0XCIsdHlwZTpcIm51bWJlclwiLGhpZGVGcm9tVUk6ITB9LHtuYW1lOlwid2lkdGhcIix0eXBlOlwibnVtYmVyXCIsaGlkZUZyb21VSTohMH0se25hbWU6XCJzaXplc1wiLHR5cGU6XCJzdHJpbmdcIixoaWRlRnJvbVVJOiEwfSx7bmFtZTpcInNyY3NldFwiLHR5cGU6XCJzdHJpbmdcIixoaWRlRnJvbVVJOiEwfSx7bmFtZTpcImxhenlcIix0eXBlOlwiYm9vbGVhblwiLGRlZmF1bHRWYWx1ZTohMCxoaWRlRnJvbVVJOiEwfSx7bmFtZTpcImZpdENvbnRlbnRcIix0eXBlOlwiYm9vbGVhblwiLGhlbHBlclRleHQ6XCJXaGVuIGNoaWxkIGJsb2NrcyBhcmUgcHJvdmlkZWQsIGZpdCB0byB0aGVtIGluc3RlYWQgb2YgdXNpbmcgdGhlIGltYWdlJ3MgYXNwZWN0IHJhdGlvXCIsZGVmYXVsdFZhbHVlOiEwfSx7bmFtZTpcImFzcGVjdFJhdGlvXCIsdHlwZTpcIm51bWJlclwiLGhlbHBlclRleHQ6XCJUaGlzIGlzIHRoZSByYXRpbyBvZiBoZWlnaHQvd2lkdGgsIGUuZy4gc2V0IHRvIDEuNSBmb3IgYSAzMDBweCB3aWRlIGFuZCAyMDBweCB0YWxsIHBob3RvLiBTZXQgdG8gMCB0byBub3QgZm9yY2UgdGhlIGltYWdlIHRvIG1haW50YWluIGl0J3MgYXNwZWN0IHJhdGlvXCIsYWR2YW5jZWQ6ITAsZGVmYXVsdFZhbHVlOkRFRkFVTFRfQVNQRUNUX1JBVElPJDF9XX0pLERFRkFVTFRfQVNQRUNUX1JBVElPPS43MDA0MDQ4NTgyOTk1OTQ4LFZpZGVvQ29tcG9uZW50PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXt2YXIgdD1udWxsIT09ZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXM7cmV0dXJuIHQudmlkZW89bnVsbCx0LmNvbnRhaW5lclJlZj1udWxsLHQuc2Nyb2xsTGlzdGVuZXI9bnVsbCx0LnN0YXRlPXtsb2FkOiF0LmxhenlMb2FkfSx0fXJldHVybiBfX2V4dGVuZHModCxlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJsYXp5TG9hZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMSE9PXRoaXMucHJvcHMubGF6eUxvYWR9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUudXBkYXRlVmlkZW89ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy52aWRlbztpZih0KXtbXCJtdXRlZFwiLFwicGxheXNJbmxpbmVcIixcImF1dG9QbGF5XCJdLmZvckVhY2goKGZ1bmN0aW9uKG4pe3ZhciBpPW4udG9Mb3dlckNhc2UoKTtlLnByb3BzW25dP3Quc2V0QXR0cmlidXRlKGksaSk6dC5yZW1vdmVBdHRyaWJ1dGUoaSl9KSl9fSx0LnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGU9ZnVuY3Rpb24oKXt0aGlzLnVwZGF0ZVZpZGVvKCl9LHQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztpZih0aGlzLnVwZGF0ZVZpZGVvKCksdGhpcy5sYXp5TG9hZCYmQnVpbGRlci5pc0Jyb3dzZXIpe3ZhciB0PXRocm90dGxlKChmdW5jdGlvbihuKXtpZihlLmNvbnRhaW5lclJlZil7dmFyIGk9ZS5jb250YWluZXJSZWYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkscj13aW5kb3cuaW5uZXJIZWlnaHQvMjtpLnRvcDx3aW5kb3cuaW5uZXJIZWlnaHQrciYmKGUuc2V0U3RhdGUoKGZ1bmN0aW9uKGUpe3JldHVybiBfX2Fzc2lnbihfX2Fzc2lnbih7fSxlKSx7bG9hZDohMH0pfSkpLHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsdCksZS5zY3JvbGxMaXN0ZW5lcj1udWxsKX19KSw0MDAse2xlYWRpbmc6ITEsdHJhaWxpbmc6ITB9KTt0aGlzLnNjcm9sbExpc3RlbmVyPXQsd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIix0LHtjYXB0dXJlOiEwLHBhc3NpdmU6ITB9KSx0KCl9fSx0LnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudD1mdW5jdGlvbigpe0J1aWxkZXIuaXNCcm93c2VyJiZ0aGlzLnNjcm9sbExpc3RlbmVyJiYod2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIix0aGlzLnNjcm9sbExpc3RlbmVyKSx0aGlzLnNjcm9sbExpc3RlbmVyPW51bGwpfSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy5wcm9wcyxuPXQuYXNwZWN0UmF0aW8saT10LmNoaWxkcmVuO3JldHVybiBqc3goXCJkaXZcIix7cmVmOmZ1bmN0aW9uKHQpe3JldHVybiBlLmNvbnRhaW5lclJlZj10fSxjc3M6e3Bvc2l0aW9uOlwicmVsYXRpdmVcIn19LGpzeChcInZpZGVvXCIse2tleTp0aGlzLnByb3BzLnZpZGVvfHxcIm5vLXNyY1wiLHBvc3Rlcjp0aGlzLnByb3BzLnBvc3RlckltYWdlLHJlZjpmdW5jdGlvbih0KXtyZXR1cm4gZS52aWRlbz10fSxhdXRvUGxheTp0aGlzLnByb3BzLmF1dG9QbGF5LG11dGVkOnRoaXMucHJvcHMubXV0ZWQsY29udHJvbHM6dGhpcy5wcm9wcy5jb250cm9scyxsb29wOnRoaXMucHJvcHMubG9vcCxwcmVsb2FkOnRoaXMucHJvcHMucHJlbG9hZHx8XCJtZXRhZGF0YVwiLGNsYXNzTmFtZTpcImJ1aWxkZXItdmlkZW9cIixjc3M6X19hc3NpZ24oe3dpZHRoOlwiMTAwJVwiLGhlaWdodDpcIjEwMCVcIixvYmplY3RGaXQ6dGhpcy5wcm9wcy5maXQsb2JqZWN0UG9zaXRpb246dGhpcy5wcm9wcy5wb3NpdGlvbix6SW5kZXg6Mixib3JkZXJSYWRpdXM6MX0sbj97cG9zaXRpb246XCJhYnNvbHV0ZVwifTpudWxsKX0sKCF0aGlzLmxhenlMb2FkfHx0aGlzLnN0YXRlLmxvYWQpJiZqc3goXCJzb3VyY2VcIix7dHlwZTpcInZpZGVvL21wNFwiLHNyYzp0aGlzLnByb3BzLnZpZGVvfSkpLCFufHx0aGlzLnByb3BzLmZpdENvbnRlbnQmJmk/bnVsbDpqc3goXCJkaXZcIix7Y3NzOnt3aWR0aDpcIjEwMCVcIixwYWRkaW5nVG9wOjEwMCpuK1wiJVwiLHBvaW50ZXJFdmVudHM6XCJub25lXCIsZm9udFNpemU6MH19KSxpJiZ0aGlzLnByb3BzLmZpdENvbnRlbnQ/anN4KFwiZGl2XCIse2Nzczp7ZGlzcGxheTpcImZsZXhcIixmbGV4RGlyZWN0aW9uOlwiY29sdW1uXCIsYWxpZ25JdGVtczpcInN0cmV0Y2hcIn19LGkpOmk/anN4KFwiZGl2XCIse2Nzczp7cG9pbnRlckV2ZW50czpcIm5vbmVcIixkaXNwbGF5OlwiZmxleFwiLGZsZXhEaXJlY3Rpb246XCJjb2x1bW5cIixhbGlnbkl0ZW1zOlwic3RyZXRjaFwiLHBvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6MCxsZWZ0OjAsd2lkdGg6XCIxMDAlXCIsaGVpZ2h0OlwiMTAwJVwifX0saSk6bnVsbCl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksVmlkZW89QnVpbGRlci5yZWdpc3RlckNvbXBvbmVudCh3aXRoQ2hpbGRyZW4oVmlkZW9Db21wb25lbnQpLHtuYW1lOlwiVmlkZW9cIixjYW5IYXZlQ2hpbGRyZW46ITAsZGVmYXVsdFN0eWxlczp7bWluSGVpZ2h0OlwiMjBweFwiLG1pbldpZHRoOlwiMjBweFwifSxpbWFnZTpcImh0dHBzOi8vZmlyZWJhc2VzdG9yYWdlLmdvb2dsZWFwaXMuY29tL3YwL2IvYnVpbGRlci0zYjBhMi5hcHBzcG90LmNvbS9vL2ltYWdlcyUyRmJhc2VsaW5lLXZpZGVvY2FtLTI0cHglMjAoMSkuc3ZnP2FsdD1tZWRpYSZ0b2tlbj00OWE4NGU0YS1iMjBlLTQ5NzctYTY1MC0wNDdmOTg2ODc0YmJcIixpbnB1dHM6W3tuYW1lOlwidmlkZW9cIix0eXBlOlwiZmlsZVwiLGFsbG93ZWRGaWxlVHlwZXM6W1wibXA0XCJdLGJ1YmJsZTohMCxkZWZhdWx0VmFsdWU6XCJodHRwczovL2Nkbi5idWlsZGVyLmlvL28vYXNzZXRzJTJGWUpJR2I0aTAxanZ3MFNSZEw1QnQlMkZkMjc3MzFhNTI2NDY0ZGViYTAwMTYyMTZmNWY5ZTU3MCUyRmNvbXByZXNzZWQ/YXBpS2V5PVlKSUdiNGkwMWp2dzBTUmRMNUJ0JnRva2VuPWQyNzczMWE1MjY0NjRkZWJhMDAxNjIxNmY1ZjllNTcwJmFsdD1tZWRpYSZvcHRpbWl6ZWQ9dHJ1ZVwiLHJlcXVpcmVkOiEwfSx7bmFtZTpcInBvc3RlckltYWdlXCIsdHlwZTpcImZpbGVcIixhbGxvd2VkRmlsZVR5cGVzOltcImpwZWdcIixcInBuZ1wiXSxoZWxwZXJUZXh0OlwiSW1hZ2UgdG8gc2hvdyBiZWZvcmUgdGhlIHZpZGVvIHBsYXlzXCJ9LHtuYW1lOlwiYXV0b1BsYXlcIix0eXBlOlwiYm9vbGVhblwiLGRlZmF1bHRWYWx1ZTohMH0se25hbWU6XCJjb250cm9sc1wiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOiExfSx7bmFtZTpcIm11dGVkXCIsdHlwZTpcImJvb2xlYW5cIixkZWZhdWx0VmFsdWU6ITB9LHtuYW1lOlwibG9vcFwiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOiEwfSx7bmFtZTpcInBsYXlzSW5saW5lXCIsdHlwZTpcImJvb2xlYW5cIixkZWZhdWx0VmFsdWU6ITB9LHtuYW1lOlwiZml0XCIsdHlwZTpcInRleHRcIixkZWZhdWx0VmFsdWU6XCJjb3ZlclwiLGVudW06W1wiY29udGFpblwiLFwiY292ZXJcIixcImZpbGxcIixcImF1dG9cIl19LHtuYW1lOlwicHJlbG9hZFwiLHR5cGU6XCJ0ZXh0XCIsZGVmYXVsdFZhbHVlOlwibWV0YWRhdGFcIixlbnVtOltcImF1dG9cIixcIm1ldGFkYXRhXCIsXCJub25lXCJdfSx7bmFtZTpcImZpdENvbnRlbnRcIix0eXBlOlwiYm9vbGVhblwiLGhlbHBlclRleHQ6XCJXaGVuIGNoaWxkIGJsb2NrcyBhcmUgcHJvdmlkZWQsIGZpdCB0byB0aGVtIGluc3RlYWQgb2YgdXNpbmcgdGhlIGFzcGVjdCByYXRpb1wiLGRlZmF1bHRWYWx1ZTohMCxhZHZhbmNlZDohMH0se25hbWU6XCJwb3NpdGlvblwiLHR5cGU6XCJ0ZXh0XCIsZGVmYXVsdFZhbHVlOlwiY2VudGVyXCIsZW51bTpbXCJjZW50ZXJcIixcInRvcFwiLFwibGVmdFwiLFwicmlnaHRcIixcImJvdHRvbVwiLFwidG9wIGxlZnRcIixcInRvcCByaWdodFwiLFwiYm90dG9tIGxlZnRcIixcImJvdHRvbSByaWdodFwiXX0se25hbWU6XCJoZWlnaHRcIix0eXBlOlwibnVtYmVyXCIsYWR2YW5jZWQ6ITB9LHtuYW1lOlwid2lkdGhcIix0eXBlOlwibnVtYmVyXCIsYWR2YW5jZWQ6ITB9LHtuYW1lOlwiYXNwZWN0UmF0aW9cIix0eXBlOlwibnVtYmVyXCIsYWR2YW5jZWQ6ITAsZGVmYXVsdFZhbHVlOkRFRkFVTFRfQVNQRUNUX1JBVElPfSx7bmFtZTpcImxhenlMb2FkXCIsdHlwZTpcImJvb2xlYW5cIixoZWxwZXJUZXh0OidMb2FkIHRoaXMgdmlkZW8gXCJsYXppbHlcIiAtIGFzIGluIG9ubHkgd2hlbiBhIHVzZXIgc2Nyb2xscyBuZWFyIHRoZSB2aWRlby4gUmVjb21tZW5kZWQgZm9yIG9wdG1pemVkIHBlcmZvcm1hbmNlIGFuZCBiYW5kd2lkdGggY29uc3VtcHRpb24nLGRlZmF1bHRWYWx1ZTohMCxhZHZhbmNlZDohMH1dfSksc2l6ZT1mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmtleXMoZSkubGVuZ3RofSxpc1Nob3BpZnk9QnVpbGRlci5pc0Jyb3dzZXImJlwiU2hvcGlmeVwiaW4gd2luZG93LHJlZnM9e307aWYoQnVpbGRlci5pc0Jyb3dzZXIpdHJ5e0FycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltidWlsZGVyLXN0YXRpYy1zeW1ib2xdXCIpKS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD1lLmdldEF0dHJpYnV0ZShcImJ1aWxkZXItc3RhdGljLXN5bWJvbFwiKTt0JiYocmVmc1t0XT1lKX0pKX1jYXRjaChlKXtjb25zb2xlLmVycm9yKFwiQnVpbGRlciByZXBsYWNlIG5vZGVzIGVycm9yOlwiLGUpfXZhciBTeW1ib2xDb21wb25lbnQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3ZhciB0PW51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpcztyZXR1cm4gdC5yZWY9bnVsbCx0LnN0YXRpY1JlZj1udWxsLHR9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInBsYWNlaG9sZGVyXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBqc3goXCJkaXZcIix7Y3NzOntwYWRkaW5nOjEwfX0sXCJTeW1ib2xzIGxldCB5b3UgcmV1c2UgZHluYW1pYyBlbGVtZW50cyBhY3Jvc3MgeW91ciBjb250ZW50LiBQbGVhc2UgY2hvb3NlIGEgbW9kZWwgYW5kIGVudHJ5IGZvciB0aGlzIHN5bWJvbC5cIil9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQ9ZnVuY3Rpb24oKXt2YXIgZSx0LG47dGhpcy51c2VTdGF0aWMmJnRoaXMuc3RhdGljUmVmJiZyZWZzW251bGw9PT0oZT10aGlzLnByb3BzLmJ1aWxkZXJCbG9jayl8fHZvaWQgMD09PWU/dm9pZCAwOmUuaWRdJiYobnVsbD09PSh0PXRoaXMuc3RhdGljUmVmLnBhcmVudE5vZGUpfHx2b2lkIDA9PT10fHx0LnJlcGxhY2VDaGlsZChyZWZzW251bGw9PT0obj10aGlzLnByb3BzLmJ1aWxkZXJCbG9jayl8fHZvaWQgMD09PW4/dm9pZCAwOm4uaWRdLHRoaXMuc3RhdGljUmVmKSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInVzZVN0YXRpY1wiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZTtyZXR1cm4gQm9vbGVhbihCdWlsZGVyLmlzQnJvd3NlciYmcmVmc1tudWxsPT09KGU9dGhpcy5wcm9wcy5idWlsZGVyQmxvY2spfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmlkXSYmIShCdWlsZGVyLmlzRWRpdGluZ3x8QnVpbGRlci5pc1ByZXZpZXdpbmcpKX0sZW51bWVyYWJsZTohMSxjb25maWd1cmFibGU6ITB9KSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgZSx0PXRoaXM7aWYodGhpcy51c2VTdGF0aWMpcmV0dXJuIGpzeChcImRpdlwiLHtyZWY6ZnVuY3Rpb24oZSl7cmV0dXJuIHQuc3RhdGljUmVmPWV9fSk7dmFyIG49dGhpcy5wcm9wcy5zeW1ib2wsaT0hMTtufHwoaT0hMCk7dmFyIHI9dGhpcy5wcm9wcy5kYXRhT25seT9Ob1dyYXA6dGhpcy5wcm9wcy5idWlsZGVyQmxvY2smJnRoaXMucHJvcHMuYnVpbGRlckJsb2NrLnRhZ05hbWV8fFwiZGl2XCIsbz1ufHx7fSxhPW8ubW9kZWwscz1vLmVudHJ5LGw9by5kYXRhLHU9by5jb250ZW50LGQ9by5pbmxpbmUsYz1vLm93bmVySWQscD0obnVsbD09bj92b2lkIDA6bi5keW5hbWljKXx8dGhpcy5wcm9wcy5keW5hbWljO2EmJihzfHxwKXx8KG51bGw9PT0oZT1udWxsPT11P3ZvaWQgMDp1LmRhdGEpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmJsb2Nrc0pzKXx8ZHx8KGk9ITApO3ZhciBmPXA/dm9pZCAwOlthLHNdLmpvaW4oXCI6XCIpLG09QnVpbGRlci5pc0VkaXRpbmc/bnVsbDpsJiZzaXplKGwpJiZoYXNoKGwpO2YmJm0mJm0ubGVuZ3RoPDMwMCYmKGYrPVwiOlwiK20pO3ZhciBoPXRoaXMucHJvcHMuYXR0cmlidXRlc3x8e307cmV0dXJuIGpzeChCdWlsZGVyU3RvcmVDb250ZXh0LkNvbnN1bWVyLHtrZXk6KGF8fFwibm8gbW9kZWxcIikrXCI6XCIrKHN8fFwibm8gZW50cnlcIil9LChmdW5jdGlvbihlKXt2YXIgbyxkLHAsbSxnLHYsYix5LF8seCxTLEI9XCJcIi5jb25jYXQoZixcIl9cIikuY29uY2F0KChudWxsPT09KG89bnVsbD09ZT92b2lkIDA6ZS5zdGF0ZSl8fHZvaWQgMD09PW8/dm9pZCAwOm8ubG9jYWxlKXx8XCJEZWZhdWx0XCIpO3JldHVybiBqc3gocixfX2Fzc2lnbih7XCJkYXRhLW1vZGVsXCI6YX0saCx7Y2xhc3NOYW1lOihoLmNsYXNzfHxoLmNsYXNzTmFtZXx8XCJcIikrXCIgYnVpbGRlci1zeW1ib2xcIisoKG51bGw9PW4/dm9pZCAwOm4uaW5saW5lKT9cIiBidWlsZGVyLWlubGluZS1zeW1ib2xcIjpcIlwiKSsoKG51bGw9PW4/dm9pZCAwOm4uZHluYW1pYyl8fHQucHJvcHMuZHluYW1pYz9cIiBidWlsZGVyLWR5bmFtaWMtc3ltYm9sXCI6XCJcIil9KSxpP3QucGxhY2Vob2xkZXI6anN4KEJ1aWxkZXJDb21wb25lbnQsX19hc3NpZ24oe30sYyYme2FwaUtleTpjfSwobnVsbD09PShkPWUuc3RhdGUpfHx2b2lkIDA9PT1kP3ZvaWQgMDpkLmxvY2FsZSkmJntsb2NhbGU6ZS5zdGF0ZS5sb2NhbGV9LHtpc0NoaWxkOiEwLHJlZjpmdW5jdGlvbihlKXtyZXR1cm4gdC5yZWY9ZX0sY29udGV4dDpfX2Fzc2lnbihfX2Fzc2lnbih7fSxlLmNvbnRleHQpLHtzeW1ib2xJZDpudWxsPT09KHA9dC5wcm9wcy5idWlsZGVyQmxvY2spfHx2b2lkIDA9PT1wP3ZvaWQgMDpwLmlkfSksbW9kZWw6YSxlbnRyeTpzLGRhdGE6X19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oe30sbCksISF0LnByb3BzLmluaGVyaXRTdGF0ZSYmb21pdCQyKGUuc3RhdGUsXCJjaGlsZHJlblwiKSksbnVsbD09PShfPW51bGw9PT0oeT1udWxsPT09KGI9bnVsbD09PSh2PW51bGw9PT0oZz1udWxsPT09KG09dC5wcm9wcy5idWlsZGVyQmxvY2spfHx2b2lkIDA9PT1tP3ZvaWQgMDptLmNvbXBvbmVudCl8fHZvaWQgMD09PWc/dm9pZCAwOmcub3B0aW9ucyl8fHZvaWQgMD09PXY/dm9pZCAwOnYuc3ltYm9sKXx8dm9pZCAwPT09Yj92b2lkIDA6Yi5jb250ZW50KXx8dm9pZCAwPT09eT92b2lkIDA6eS5kYXRhKXx8dm9pZCAwPT09Xz92b2lkIDA6Xy5zdGF0ZSkscmVuZGVyTGluazplLnJlbmRlckxpbmssaW5saW5lQ29udGVudDpudWxsPT1uP3ZvaWQgMDpuLmlubGluZX0sdSYme2NvbnRlbnQ6dX0se2tleTpCLG9wdGlvbnM6e2tleTpCLG5vRWRpdG9yVXBkYXRlczohMH0sY29kZWdlbjohIShudWxsPT09KHg9bnVsbD09dT92b2lkIDA6dS5kYXRhKXx8dm9pZCAwPT09eD92b2lkIDA6eC5ibG9ja3NKcyksaHlkcmF0ZTpudWxsPT09KFM9ZS5zdGF0ZSl8fHZvaWQgMD09PVM/dm9pZCAwOlMuX2h5ZHJhdGUsYnVpbGRlckJsb2NrOnQucHJvcHMuYnVpbGRlckJsb2NrLGRhdGFPbmx5OnQucHJvcHMuZGF0YU9ubHl9KSx0LnByb3BzLmNoaWxkcmVuKSl9KSl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksU3ltYm9sJDE9d2l0aEJ1aWxkZXIoU3ltYm9sQ29tcG9uZW50LHtuYW1lOlwiU3ltYm9sXCIsbm9XcmFwOiEwLHN0YXRpYzohMCxpbnB1dHM6W3tuYW1lOlwic3ltYm9sXCIsdHlwZTpcInVpU3ltYm9sXCJ9LHtuYW1lOlwiZGF0YU9ubHlcIixoZWxwZXJUZXh0OlwiTWFrZSB0aGlzIGEgZGF0YSBzeW1ib2wgdGhhdCBkb2Vzbid0IGRpc3BsYXkgYW55IFVJXCIsdHlwZTpcImJvb2xlYW5cIixkZWZhdWx0VmFsdWU6ITEsYWR2YW5jZWQ6ITAsaGlkZUZyb21VSTohMH0se25hbWU6XCJpbmhlcml0U3RhdGVcIixoZWxwZXJUZXh0OlwiSW5oZXJpdCB0aGUgcGFyZW50IGNvbXBvbmVudCBzdGF0ZSBhbmQgZGF0YVwiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOmlzU2hvcGlmeSxhZHZhbmNlZDohMH0se25hbWU6XCJyZW5kZXJUb0xpcXVpZFwiLGhlbHBlclRleHQ6XCJSZW5kZXIgdGhpcyBzeW1ib2xzIGNvbnRlbnRzIHRvIGxpcXVpZC4gVHVybiBvZmYgdG8gZmV0Y2ggd2l0aCBqYXZhc2NyaXB0IGFuZCB1c2UgY3VzdG9tIHRhcmdldGluZ1wiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOmlzU2hvcGlmeSxhZHZhbmNlZDohMCxoaWRlRnJvbVVJOiEwfSx7bmFtZTpcInVzZUNoaWxkcmVuXCIsaGlkZUZyb21VSTohMCx0eXBlOlwiYm9vbGVhblwifV19KSxCdXR0b25Db21wb25lbnQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3JldHVybiBudWxsIT09ZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXMucHJvcHMubGluaz9MaW5rOlwic3BhblwiO3JldHVybiBSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KGUsX19hc3NpZ24oe3JvbGU6XCJidXR0b25cIixocmVmOnRoaXMucHJvcHMubGluayx0YXJnZXQ6dGhpcy5wcm9wcy5vcGVuTGlua0luTmV3VGFiP1wiX2JsYW5rXCI6dm9pZCAwfSx0aGlzLnByb3BzLmF0dHJpYnV0ZXMpLHRoaXMucHJvcHMudGV4dCl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksQnV0dG9uPXdpdGhCdWlsZGVyKEJ1dHRvbkNvbXBvbmVudCx7bmFtZTpcIkNvcmU6QnV0dG9uXCIsaW1hZ2U6XCJodHRwczovL2Nkbi5idWlsZGVyLmlvL2FwaS92MS9pbWFnZS9hc3NldHMlMkZJc3hQS01vMmdQUlJLZWFrVXp0ajFENnVxZWQyJTJGODFhMTU2ODFjM2U3NGRmMDk2NzdkZmM1N2E2MTViMTNcIixkZWZhdWx0U3R5bGVzOnthcHBlYXJhbmNlOlwibm9uZVwiLHBhZGRpbmdUb3A6XCIxNXB4XCIscGFkZGluZ0JvdHRvbTpcIjE1cHhcIixwYWRkaW5nTGVmdDpcIjI1cHhcIixwYWRkaW5nUmlnaHQ6XCIyNXB4XCIsYmFja2dyb3VuZENvbG9yOlwiIzAwMDAwMFwiLGNvbG9yOlwid2hpdGVcIixib3JkZXJSYWRpdXM6XCI0cHhcIix0ZXh0QWxpZ246XCJjZW50ZXJcIixjdXJzb3I6XCJwb2ludGVyXCJ9LGlucHV0czpbe25hbWU6XCJ0ZXh0XCIsdHlwZTpcInRleHRcIixkZWZhdWx0VmFsdWU6XCJDbGljayBtZSFcIixidWJibGU6ITB9LHtuYW1lOlwibGlua1wiLHR5cGU6XCJ1cmxcIixidWJibGU6ITB9LHtuYW1lOlwib3BlbkxpbmtJbk5ld1RhYlwiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOiExLGZyaWVuZGx5TmFtZTpcIk9wZW4gbGluayBpbiBuZXcgdGFiXCJ9XSxzdGF0aWM6ITAsbm9XcmFwOiEwfSksU2VjdGlvbkNvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7dmFyIHQ9bnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzO3JldHVybiB0LnJlZj1udWxsLHQudW5tb3VudENhbGxiYWNrcz1bXSx0LnN0YXRlPXtpblZpZXc6ITF9LHR9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSxcInJlbmRlckNvbnRlbnRzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiEwIT09dGhpcy5wcm9wcy5sYXp5TG9hZHx8dGhpcy5zdGF0ZS5pblZpZXd9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQ9ZnVuY3Rpb24oKXt0aGlzLnVubW91bnRDYWxsYmFja3MuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUoKX0pKX0sdC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKHRoaXMucHJvcHMubGF6eUxvYWQpaWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIEludGVyc2VjdGlvbk9ic2VydmVyJiZ0aGlzLnJlZil7dmFyIHQ9bmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChmdW5jdGlvbih0LG4pe3QuZm9yRWFjaCgoZnVuY3Rpb24odCl7dC5pbnRlcnNlY3Rpb25SYXRpbz4wJiYoZS5zZXRTdGF0ZSh7aW5WaWV3OiEwfSksZS5yZWYmJm4udW5vYnNlcnZlKGUucmVmKSl9KSl9KSx7cm9vdE1hcmdpbjpcIjEwcHhcIn0pO3Qub2JzZXJ2ZSh0aGlzLnJlZiksdGhpcy51bm1vdW50Q2FsbGJhY2tzLnB1c2goKGZ1bmN0aW9uKCl7ZS5yZWYmJnQudW5vYnNlcnZlKGUucmVmKX0pKX1lbHNlIHRoaXMuc2V0U3RhdGUoe2luVmlldzohMH0pfSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiBqc3goXCJzZWN0aW9uXCIse3JlZjpmdW5jdGlvbih0KXtyZXR1cm4gZS5yZWY9dH0sY3NzOl9fYXNzaWduKHt3aWR0aDpcIjEwMCVcIixhbGlnblNlbGY6XCJzdHJldGNoXCIsZmxleEdyb3c6MSxib3hTaXppbmc6XCJib3JkZXItYm94XCIsbWF4V2lkdGg6dGhpcy5wcm9wcy5tYXhXaWR0aCxkaXNwbGF5OlwiZmxleFwiLGZsZXhEaXJlY3Rpb246XCJjb2x1bW5cIixhbGlnbkl0ZW1zOlwic3RyZXRjaFwiLG1hcmdpbkxlZnQ6XCJhdXRvXCIsbWFyZ2luUmlnaHQ6XCJhdXRvXCJ9LHRoaXMucmVuZGVyQ29udGVudHM/bnVsbDp0aGlzLnByb3BzLmxhenlTdHlsZXMpfSx0aGlzLnJlbmRlckNvbnRlbnRzP2pzeChSZWFjdF9fZGVmYXVsdC5GcmFnbWVudCxudWxsLHRoaXMucHJvcHMuY2hpbGRyZW4sdGhpcy5wcm9wcy5idWlsZGVyQmxvY2smJnRoaXMucHJvcHMuYnVpbGRlckJsb2NrLmNoaWxkcmVuJiZ0aGlzLnByb3BzLmJ1aWxkZXJCbG9jay5jaGlsZHJlbi5tYXAoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGpzeChCdWlsZGVyQmxvY2skMSx7a2V5OmUuaWQsYmxvY2s6ZX0pfSkpKTpudWxsKX0sdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxTZWN0aW9uPXdpdGhCdWlsZGVyKFNlY3Rpb25Db21wb25lbnQse25hbWU6XCJDb3JlOlNlY3Rpb25cIixzdGF0aWM6ITAsaW1hZ2U6XCJodHRwczovL2Nkbi5idWlsZGVyLmlvL2FwaS92MS9pbWFnZS9hc3NldHMlMkZJc3hQS01vMmdQUlJLZWFrVXp0ajFENnVxZWQyJTJGNjgyZWZlZjIzYWNlNDlhZmFjNjE3NDhkZDMwNWM3MGFcIixpbnB1dHM6W3tuYW1lOlwibWF4V2lkdGhcIix0eXBlOlwibnVtYmVyXCIsZGVmYXVsdFZhbHVlOjEyMDB9LHtuYW1lOlwibGF6eUxvYWRcIix0eXBlOlwiYm9vbGVhblwiLGRlZmF1bHRWYWx1ZTohMSxhZHZhbmNlZDohMCxkZXNjcmlwdGlvbjpcIk9ubHkgcmVuZGVyIHRoaXMgc2VjdGlvbiB3aGVuIGluIHZpZXdcIn1dLGRlZmF1bHRTdHlsZXM6e3BhZGRpbmdMZWZ0OlwiMjBweFwiLHBhZGRpbmdSaWdodDpcIjIwcHhcIixwYWRkaW5nVG9wOlwiNTBweFwiLHBhZGRpbmdCb3R0b206XCI1MHB4XCIsbWFyZ2luVG9wOlwiMHB4XCIsd2lkdGg6XCIxMDB2d1wiLG1hcmdpbkxlZnQ6XCJjYWxjKDUwJSAtIDUwdncpXCJ9LGNhbkhhdmVDaGlsZHJlbjohMCxkZWZhdWx0Q2hpbGRyZW46W3tcIkB0eXBlXCI6XCJAYnVpbGRlci5pby9zZGs6RWxlbWVudFwiLHJlc3BvbnNpdmVTdHlsZXM6e2xhcmdlOnt0ZXh0QWxpZ246XCJjZW50ZXJcIn19LGNvbXBvbmVudDp7bmFtZTpcIlRleHRcIixvcHRpb25zOnt0ZXh0OlwiPHA+PGI+SSBhbSBhIHNlY3Rpb24hIE15IGNvbnRlbnQga2VlcHMgZnJvbSBnZXR0aW5nIHRvbyB3aWRlLCBzbyB0aGF0IGl0J3MgZWFzeSB0byByZWFkIGV2ZW4gb24gYmlnIHNjcmVlbnMuPC9iPjwvcD48cD5Mb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgY29uc2VjdGV0dXIgYWRpcGlzY2luZyBlbGl0LCBzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCB1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YS4gVXQgZW5pbSBhZCBtaW5pbSB2ZW5pYW0sIHF1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbyBsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYSBjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlIGlydXJlIGRvbG9yIGluIHJlcHJlaGVuZGVyaXQgaW4gdm9sdXB0YXRlIHZlbGl0IGVzc2UgY2lsbHVtIGRvbG9yZSBldSBmdWdpYXQgbnVsbGEgcGFyaWF0dXI8L3A+XCJ9fX1dfSksU3RhdGVQcm92aWRlckNvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIG51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCdWlsZGVyU3RvcmVDb250ZXh0LkNvbnN1bWVyLG51bGwsKGZ1bmN0aW9uKHQpe3JldHVybiBSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1aWxkZXJTdG9yZUNvbnRleHQuUHJvdmlkZXIse3ZhbHVlOl9fYXNzaWduKF9fYXNzaWduKHt9LHQpLHtzdGF0ZTpfX2Fzc2lnbihfX2Fzc2lnbih7fSx0LnN0YXRlKSxlLnByb3BzLnN0YXRlKSxjb250ZXh0Ol9fYXNzaWduKF9fYXNzaWduKHt9LHQuY29udGV4dCksZS5wcm9wcy5jb250ZXh0KX0pfSxlLnByb3BzLmJ1aWxkZXJCbG9jayYmZS5wcm9wcy5idWlsZGVyQmxvY2suY2hpbGRyZW4mJmUucHJvcHMuYnVpbGRlckJsb2NrLmNoaWxkcmVuLm1hcCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCdWlsZGVyQmxvY2skMSx7YmxvY2s6ZSxrZXk6ZS5pZCxpbmRleDp0LGNoaWxkOiEwfSl9KSksZS5wcm9wcy5jaGlsZHJlbil9KSl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksU3RhdGVQcm92aWRlcj13aXRoQnVpbGRlcihTdGF0ZVByb3ZpZGVyQ29tcG9uZW50LHtuYW1lOlwiQnVpbGRlcjpTdGF0ZVByb3ZpZGVyXCIsY2FuSGF2ZUNoaWxkcmVuOiEwLHN0YXRpYzohMCxub1dyYXA6ITAsaGlkZUZyb21JbnNlcnRNZW51OiEwfSkscHJlZmV0Y2hlZD1uZXcgU2V0O2Z1bmN0aW9uIHNlYXJjaFRvT2JqZWN0KGUpe3ZhciB0PShlLnNlYXJjaHx8XCJcIikuc3Vic3RyaW5nKDEpLnNwbGl0KFwiJlwiKSxuPXt9O2Zvcih2YXIgaSBpbiB0KWlmKHRbaV0mJlwic3RyaW5nXCI9PXR5cGVvZiB0W2ldKXt2YXIgcj10W2ldLnNwbGl0KFwiPVwiKTtuW2RlY29kZVVSSUNvbXBvbmVudChyWzBdKV09ZGVjb2RlVVJJQ29tcG9uZW50KHJbMV0pfXJldHVybiBufXZhciBSb3V0ZXJDb21wb25lbnQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3ZhciB0PW51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpcztyZXR1cm4gdC5idWlsZGVyPWJ1aWxkZXIsdC5yb3V0ZWQ9ITEsdC5wcmVsb2FkUXVldWU9MCx0Lm9uUG9wU3RhdGU9ZnVuY3Rpb24oZSl7dC51cGRhdGVMb2NhdGlvblN0YXRlKCl9LHQub25Nb3VzZU92ZXJPclRvdWNoU3RhcnQ9ZnVuY3Rpb24oZSl7aWYoISh0LnByZWxvYWRRdWV1ZT40KSYmITEhPT10LnByb3BzLnByZWxvYWRPbkhvdmVyKXt2YXIgbj10LmZpbmRIcmVmVGFyZ2V0KGUpO2lmKG4pe3ZhciBpPW4uZ2V0QXR0cmlidXRlKFwiaHJlZlwiKTtpZihpKXtpZighdC5pc1JlbGF0aXZlKGkpKXt2YXIgcj10LmNvbnZlcnRUb1JlbGF0aXZlKGkpO2lmKCFyKXJldHVybjtpPXJ9aWYoIWkuc3RhcnRzV2l0aChcIiNcIikmJiFwcmVmZXRjaGVkLmhhcyhpKSl7cHJlZmV0Y2hlZC5hZGQoaSk7dmFyIG89dC5wYXJzZVVybChpKTt0LnByZWxvYWRRdWV1ZSsrO3ZhciBhPWJ1aWxkZXIuZ2V0VXNlckF0dHJpYnV0ZXMoKTthLnVybFBhdGg9by5wYXRobmFtZSxhLnF1ZXJ5U3RyaW5nPW8uc2VhcmNoO3ZhciBzPWJ1aWxkZXIuZ2V0KHQubW9kZWwse3VzZXJBdHRyaWJ1dGVzOmEsa2V5OnQubW9kZWwrXCI6XCIrby5wYXRobmFtZStvLnNlYXJjaH0pLnN1YnNjcmliZSgoZnVuY3Rpb24oKXt0LnByZWxvYWRRdWV1ZS0tLHMudW5zdWJzY3JpYmUoKX0pKX19fX19LHQub25DbGljaz1mdW5jdGlvbihlKXtyZXR1cm4gX19hd2FpdGVyKHQsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgdCxuLGkscjtyZXR1cm4gX19nZW5lcmF0b3IodGhpcywoZnVuY3Rpb24obyl7aWYoITE9PT10aGlzLnByb3BzLmhhbmRsZVJvdXRpbmcpcmV0dXJuWzJdO2lmKDAhPT1lLmJ1dHRvbnx8ZS5jdHJsS2V5fHxlLmRlZmF1bHRQcmV2ZW50ZWR8fGUubWV0YUtleSlyZXR1cm5bMl07aWYoISh0PXRoaXMuZmluZEhyZWZUYXJnZXQoZSkpKXJldHVyblsyXTtpZih0LnRhcmdldCYmXCJfY2xpZW50XCIhPT10LnRhcmdldClyZXR1cm5bMl07aWYoIShuPXQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKSkpcmV0dXJuWzJdO2lmKHRoaXMucHJvcHMub25Sb3V0ZSYmKGk9e3VybDpuLGFuY2hvck5vZGU6dCxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3RoaXMuZGVmYXVsdFByZXZlbnRlZD0hMH0sZGVmYXVsdFByZXZlbnRlZDohMX0sdGhpcy5wcm9wcy5vblJvdXRlKGkpLGkuZGVmYXVsdFByZXZlbnRlZCkpcmV0dXJuWzJdO2lmKCF0aGlzLmlzUmVsYXRpdmUobikpe2lmKCEocj10aGlzLmNvbnZlcnRUb1JlbGF0aXZlKG4pKSlyZXR1cm5bMl07bj1yfXJldHVybiBuLnN0YXJ0c1dpdGgoXCIjXCIpfHwoZS5wcmV2ZW50RGVmYXVsdCgpLHRoaXMucm91dGUobikpLFsyXX0pKX0pKX0sdC5wcml2YXRlU3RhdGU9bnVsbCx0fXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5yb3V0ZT1mdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gdGhpcy5yb3V0ZWQ9ITAsXCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09PSh0PXdpbmRvdy5oaXN0b3J5KXx8dm9pZCAwPT09dD92b2lkIDA6dC5wdXNoU3RhdGUpPyhoaXN0b3J5LnB1c2hTdGF0ZShudWxsLFwiXCIsZSksdGhpcy51cGRhdGVMb2NhdGlvblN0YXRlKCksITApOihsb2NhdGlvbi5ocmVmPWUsITEpfSx0LnByb3RvdHlwZS51cGRhdGVMb2NhdGlvblN0YXRlPWZ1bmN0aW9uKCl7dGhpcy5wcml2YXRlU3RhdGUmJnRoaXMucHJpdmF0ZVN0YXRlLnVwZGF0ZSgoZnVuY3Rpb24oZSl7ZS5sb2NhdGlvbj1fX2Fzc2lnbihfX2Fzc2lnbih7fSxlLmxvY2F0aW9uKSx7cGF0aG5hbWU6bG9jYXRpb24ucGF0aG5hbWUsc2VhcmNoOmxvY2F0aW9uLnNlYXJjaCxwYXRoOmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KFwiL1wiKS5zbGljZSgxKSxxdWVyeTpzZWFyY2hUb09iamVjdChsb2NhdGlvbil9KX0pKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwibW9kZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHJvcHMubW9kZWx8fFwicGFnZVwifSxlbnVtZXJhYmxlOiExLGNvbmZpZ3VyYWJsZTohMH0pLHQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50PWZ1bmN0aW9uKCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGRvY3VtZW50JiYoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdGhpcy5vbkNsaWNrKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsdGhpcy5vblBvcFN0YXRlKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsdGhpcy5vbk1vdXNlT3Zlck9yVG91Y2hTdGFydCksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIix0aGlzLm9uTW91c2VPdmVyT3JUb3VjaFN0YXJ0KSl9LHQucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50PWZ1bmN0aW9uKCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGRvY3VtZW50JiYoZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdGhpcy5vbkNsaWNrKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsdGhpcy5vbk1vdXNlT3Zlck9yVG91Y2hTdGFydCksd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLHRoaXMub25Qb3BTdGF0ZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIix0aGlzLm9uTW91c2VPdmVyT3JUb3VjaFN0YXJ0KSl9LHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLm1vZGVsO3JldHVybiBqc3goQnVpbGRlclN0b3JlQ29udGV4dC5Db25zdW1lcixudWxsLChmdW5jdGlvbihuKXtlLnByaXZhdGVTdGF0ZT1uO3ZhciBpPW4uc3RhdGUmJm4uc3RhdGUubG9jYXRpb24mJm4uc3RhdGUubG9jYXRpb24ucGF0aG5hbWUrbi5zdGF0ZS5sb2NhdGlvbi5zZWFyY2g7cmV0dXJuIGpzeChcImRpdlwiLHtjbGFzc05hbWU6XCJidWlsZGVyLXJvdXRlclwiLFwiZGF0YS1tb2RlbFwiOnR9LGpzeChcInN0eWxlXCIsbnVsbCxcIlxcbiAgICAgICAgICAgICAgICBAa2V5ZnJhbWVzIGJ1aWxkZXJMb2FkaW5nU3Bpbm5lciB7XFxuICAgICAgICAgICAgICAgICAgMCUge1xcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XFxuICAgICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgICAgIDEwMCUge1xcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcXG4gICAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAgICAgLyogVE9ETzogb3ZlcnJpZGFibGUgdGFnICovXFxuICAgICAgICAgICAgICAgIC5idWlsZGVyLXBhZ2UtbG9hZGluZyB7XFxuICAgICAgICAgICAgICAgICAgLXdlYmtpdC1hbmltYXRpb246IGJ1aWxkZXJMb2FkaW5nU3Bpbm5lciAxcyBpbmZpbml0ZSBsaW5lYXI7XFxuICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBidWlsZGVyTG9hZGluZ1NwaW5uZXIgMXMgaW5maW5pdGUgbGluZWFyO1xcbiAgICAgICAgICAgICAgICAgIC13ZWJraXQtdHJhbnNmb3JtOiB0cmFuc2xhdGVaKDApO1xcbiAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWigwKTtcXG4gICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7XFxuICAgICAgICAgICAgICAgICAgd2lkdGg6IDM2cHg7XFxuICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAzNnB4O1xcbiAgICAgICAgICAgICAgICAgIG1hcmdpbjogNnB4IGF1dG87XFxuICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHRyYW5zcGFyZW50O1xcbiAgICAgICAgICAgICAgICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgIzgwODI4NDtcXG4gICAgICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAgXCIpLGpzeChCdWlsZGVyQ29tcG9uZW50LHtrZXk6aSxkYXRhOmUucHJvcHMuZGF0YSxjb250ZW50OmUucm91dGVkP3ZvaWQgMDplLnByb3BzLmNvbnRlbnQsbW9kZWxOYW1lOnQsb3B0aW9uczp7a2V5OkJ1aWxkZXIuaXNFZGl0aW5nP3ZvaWQgMDplLm1vZGVsK1wiOlwiK2l9fSxlLnByb3BzLmNoaWxkcmVufHxqc3goXCJkaXZcIix7Y3NzOntkaXNwbGF5OlwiZmxleFwifX0sanN4KFwiZGl2XCIse2Nzczp7bWFyZ2luOlwiNDB2aCBhdXRvXCJ9LGNsYXNzTmFtZTpcImJ1aWxkZXItcGFnZS1sb2FkaW5nXCJ9KSkpKX0pKX0sdC5wcm90b3R5cGUuZmluZEhyZWZUYXJnZXQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUudGFyZ2V0O3Q7KXtpZih0IGluc3RhbmNlb2YgSFRNTEFuY2hvckVsZW1lbnQmJnQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKSlyZXR1cm4gdDtpZih0PT09ZS5jdXJyZW50VGFyZ2V0KWJyZWFrO3Q9dC5wYXJlbnRFbGVtZW50fXJldHVybiBudWxsfSx0LnByb3RvdHlwZS5pc1JlbGF0aXZlPWZ1bmN0aW9uKGUpe3JldHVybiFlLm1hdGNoKC9eKFxcL1xcL3xodHRwcz86XFwvXFwvKS9pKX0sdC5wcm90b3R5cGUucGFyc2VVcmw9ZnVuY3Rpb24oZSl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7cmV0dXJuIHQuaHJlZj1lLHR9LHQucHJvdG90eXBlLmNvbnZlcnRUb1JlbGF0aXZlPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMucGFyc2VVcmwobG9jYXRpb24uaHJlZiksbj10aGlzLnBhcnNlVXJsKGUpO2lmKHQuaG9zdD09PW4uaG9zdCl7dmFyIGk9bi5wYXRobmFtZSsobi5zZWFyY2g/bi5zZWFyY2g6XCJcIik7cmV0dXJuIGkuc3RhcnRzV2l0aChcIiNcIik/bnVsbDppfHxcIi9cIn1yZXR1cm4gbnVsbH0sdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxSb3V0ZXI9d2l0aEJ1aWxkZXIoUm91dGVyQ29tcG9uZW50LHtuYW1lOlwiQ29yZTpSb3V0ZXJcIixoaWRlRnJvbUluc2VydE1lbnU6ITAsaW5wdXRzOlt7bmFtZTpcIm1vZGVsXCIsdHlwZTpcInN0cmluZ1wiLGRlZmF1bHRWYWx1ZTpcInBhZ2VcIixhZHZhbmNlZDohMH0se25hbWU6XCJoYW5kbGVSb3V0aW5nXCIsdHlwZTpcImJvb2xlYW5cIixkZWZhdWx0VmFsdWU6ITAsYWR2YW5jZWQ6ITB9LHtuYW1lOlwicHJlbG9hZE9uSG92ZXJcIix0eXBlOlwiYm9vbGVhblwiLGRlZmF1bHRWYWx1ZTohMCxhZHZhbmNlZDohMH0se25hbWU6XCJvblJvdXRlXCIsdHlwZTpcImZ1bmN0aW9uXCIsYWR2YW5jZWQ6ITB9XX0pO2Z1bmN0aW9uIE11dGF0aW9uKGUpe3ZhciB0LG4saT1SZWFjdF9fZGVmYXVsdC51c2VSZWYobnVsbCk7dXNlV2FpdEZvclNlbGVjdG9yKGUuc2VsZWN0b3IsKGZ1bmN0aW9uKHQpe1wiYWZ0ZXJFbmRcIiE9PWUudHlwZSYmKHQuaW5uZXJIVE1MPVwiXCIpLHQuYXBwZW5kQ2hpbGQoaS5jdXJyZW50LmZpcnN0RWxlbWVudENoaWxkKX0pKTt2YXIgcj1udWxsPT09KHQ9ZS5idWlsZGVyQmxvY2spfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmNoaWxkcmVuO3JldHVybiBqc3goXCJzcGFuXCIse3N0eWxlOntkaXNwbGF5Olwibm9uZVwifSxyZWY6aX0sanN4KEJ1aWxkZXJCbG9ja3Mse3N0eWxlOntkaXNwbGF5OlwiaW5saW5lXCJ9LGNoaWxkOiEwLHBhcmVudEVsZW1lbnRJZDpudWxsPT09KG49ZS5idWlsZGVyQmxvY2spfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlkLGRhdGFQYXRoOlwidGhpcy5jaGlsZHJlblwiLGJsb2NrczpyfSkpfWZ1bmN0aW9uIHVzZVdhaXRGb3JTZWxlY3RvcihlLHQpe1JlYWN0X19kZWZhdWx0LnVzZUxheW91dEVmZmVjdCgoZnVuY3Rpb24oKXt0cnl7dmFyIG49ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlKTtpZihuKXJldHVybiB2b2lkIHQobil9Y2F0Y2goZSl7Y29uc29sZS53YXJuKGUpfXZhciBpPW5ldyBNdXRhdGlvbk9ic2VydmVyKChmdW5jdGlvbigpe3RyeXt2YXIgbj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUpO24mJihpLmRpc2Nvbm5lY3QoKSx0KG4pKX1jYXRjaChlKXtjb25zb2xlLndhcm4oZSl9fSkpO3JldHVybiBpLm9ic2VydmUoZG9jdW1lbnQuYm9keSx7YXR0cmlidXRlczohMCxzdWJ0cmVlOiEwLGNoYXJhY3RlckRhdGE6ITB9KSxmdW5jdGlvbigpe2kuZGlzY29ubmVjdCgpfX0pLFtlXSl9QnVpbGRlci5yZWdpc3RlckNvbXBvbmVudChNdXRhdGlvbix7bmFtZTpcIkJ1aWxkZXI6TXV0YXRpb25cIixjYW5IYXZlQ2hpbGRyZW46ITAsbm9XcmFwOiEwLGhpZGVGcm9tSW5zZXJ0TWVudTohMCxpbnB1dHM6W3tuYW1lOlwidHlwZVwiLHR5cGU6XCJzdHJpbmdcIixkZWZhdWx0VmFsdWU6XCJyZXBsYWNlXCIsZW51bTpbe2xhYmVsOlwiUmVwbGFjZVwiLHZhbHVlOlwicmVwbGFjZVwiLGhlbHBlclRleHQ6XCJSZXBsYWNlIHRoZSBjb250ZW50cyBvZiB0aGlzIHNpdGUgcmVnaW9uIHdpdGggY29udGVudCBmcm9tIEJ1aWxkZXJcIn0se2xhYmVsOlwiQXBwZW5kXCIsdmFsdWU6XCJhZnRlckVuZFwiLGhlbHBlclRleHQ6XCJBcHBlbmQgQnVpbGRlciBjb250ZW50IGFmdGVyIHRoZSBjaG9zZW4gc2l0ZSByZWdpb25cIn1dfSx7bmFtZTpcInNlbGVjdG9yXCIsdHlwZTpcImJ1aWxkZXI6ZG9tU2VsZWN0b3JcIn1dfSk7dmFyIGdldD1mdW5jdGlvbihlLHQsbil7dmFyIGk9U3RyaW5nLnByb3RvdHlwZS5zcGxpdC5jYWxsKHQsL1ssW1xcXS5dKz8vKS5maWx0ZXIoQm9vbGVhbikucmVkdWNlKChmdW5jdGlvbihlLHQpe3JldHVybiBudWxsIT1lP2VbdF06ZX0pLGUpO3JldHVybiB2b2lkIDA9PT1pfHxpPT09ZT9uOml9LE1VTFRJUEFSVF9DT05URU5UX1RZUEU9XCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIsSlNPTl9DT05URU5UX1RZUEU9XCJhcHBsaWNhdGlvbi9qc29uXCIsRU5DT0RFRF9DT05URU5UX1RZUEU9XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixGb3JtQ29tcG9uZW50PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXt2YXIgdD1udWxsIT09ZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXM7cmV0dXJuIHQucmVmPW51bGwsdC5zdGF0ZT17c3RhdGU6XCJ1bnN1Ym1pdHRlZFwiLHJlc3BvbnNlRGF0YTpudWxsLGZvcm1FcnJvck1lc3NhZ2U6XCJcIn0sdH1yZXR1cm4gX19leHRlbmRzKHQsZSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLFwic3VibWlzc2lvblN0YXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBCdWlsZGVyLmlzRWRpdGluZyYmdGhpcy5wcm9wcy5wcmV2aWV3U3RhdGV8fHRoaXMuc3RhdGUuc3RhdGV9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSksdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4ganN4KEJ1aWxkZXJTdG9yZUNvbnRleHQuQ29uc3VtZXIsbnVsbCwoZnVuY3Rpb24odCl7cmV0dXJuIGpzeChCdWlsZGVyU3RvcmVDb250ZXh0LlByb3ZpZGVyLHt2YWx1ZTpfX2Fzc2lnbihfX2Fzc2lnbih7fSx0KSx7c3RhdGU6X19hc3NpZ24oX19hc3NpZ24oe30sdC5zdGF0ZSkse2Zvcm1FcnJvck1lc3NhZ2U6ZS5zdGF0ZS5mb3JtRXJyb3JNZXNzYWdlfSl9KX0sanN4KFwiZm9ybVwiLF9fYXNzaWduKHt2YWxpZGF0ZTplLnByb3BzLnZhbGlkYXRlLHJlZjpmdW5jdGlvbih0KXtyZXR1cm4gZS5yZWY9dH0sYWN0aW9uOiFlLnByb3BzLnNlbmRXaXRoSnMmJmUucHJvcHMuYWN0aW9uLG1ldGhvZDplLnByb3BzLm1ldGhvZCxuYW1lOmUucHJvcHMubmFtZSxvblN1Ym1pdDpmdW5jdGlvbih0KXt2YXIgbixpPWUucHJvcHMuc2VuZFdpdGhKc3x8XCJlbWFpbFwiPT09ZS5wcm9wcy5zZW5kU3VibWlzc2lvbnNUbztpZihcInphcGllclwiPT09ZS5wcm9wcy5zZW5kU3VibWlzc2lvbnNUbyl0LnByZXZlbnREZWZhdWx0KCk7ZWxzZSBpZihpKXtpZighZS5wcm9wcy5hY3Rpb24mJlwiZW1haWxcIiE9PWUucHJvcHMuc2VuZFN1Ym1pc3Npb25zVG8pcmV0dXJuIHZvaWQgdC5wcmV2ZW50RGVmYXVsdCgpO3QucHJldmVudERlZmF1bHQoKTt2YXIgcj10LmN1cnJlbnRUYXJnZXQsbz1lLnByb3BzLmN1c3RvbUhlYWRlcnN8fHt9LGE9dm9pZCAwLHM9bmV3IEZvcm1EYXRhKHIpLGw9QXJyYXkuZnJvbSh0LmN1cnJlbnRUYXJnZXQucXVlcnlTZWxlY3RvckFsbChcImlucHV0LHNlbGVjdCx0ZXh0YXJlYVwiKSkuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4hIWUubmFtZX0pKS5tYXAoKGZ1bmN0aW9uKGUpe3ZhciB0LG49ZS5uYW1lO2lmKGUgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KWlmKFwicmFkaW9cIj09PWUudHlwZSl7aWYoZS5jaGVja2VkKXJldHVybntrZXk6bix2YWx1ZTp0PWUubmFtZX19ZWxzZSBpZihcImNoZWNrYm94XCI9PT1lLnR5cGUpdD1lLmNoZWNrZWQ7ZWxzZSBpZihcIm51bWJlclwiPT09ZS50eXBlfHxcInJhbmdlXCI9PT1lLnR5cGUpe3ZhciBpPWUudmFsdWVBc051bWJlcjtpc05hTihpKXx8KHQ9aSl9ZWxzZSB0PVwiZmlsZVwiPT09ZS50eXBlP2UuZmlsZXM6ZS52YWx1ZTtlbHNlIHQ9ZS52YWx1ZTtyZXR1cm57a2V5Om4sdmFsdWU6dH19KSksdT1lLnByb3BzLmNvbnRlbnRUeXBlO2lmKFwiZW1haWxcIj09PWUucHJvcHMuc2VuZFN1Ym1pc3Npb25zVG8mJih1PU1VTFRJUEFSVF9DT05URU5UX1RZUEUpLEFycmF5LmZyb20obCkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS52YWx1ZTsodCBpbnN0YW5jZW9mIEZpbGV8fEFycmF5LmlzQXJyYXkodCkmJnRbMF1pbnN0YW5jZW9mIEZpbGV8fHQgaW5zdGFuY2VvZiBGaWxlTGlzdCkmJih1PU1VTFRJUEFSVF9DT05URU5UX1RZUEUpfSkpLHU9PT1NVUxUSVBBUlRfQ09OVEVOVF9UWVBFKWE9cztlbHNlIGlmKHU9PT1KU09OX0NPTlRFTlRfVFlQRSl7dmFyIGQ9e307QXJyYXkuZnJvbShsKS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD1lLnZhbHVlLG49ZS5rZXk7c2V0KGQsbix0KX0pKSxhPUpTT04uc3RyaW5naWZ5KGQpfWVsc2V7aWYodSE9PUVOQ09ERURfQ09OVEVOVF9UWVBFKXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJVbnN1cHBvcnRlZCBjb250ZW50IHR5cGU6IFwiLHUpO2E9QXJyYXkuZnJvbShsKS5tYXAoKGZ1bmN0aW9uKGUpe3ZhciB0PWUudmFsdWUsbj1lLmtleTtyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KG4pK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudCh0KX0pKS5qb2luKFwiJlwiKX11JiZ1IT09TVVMVElQQVJUX0NPTlRFTlRfVFlQRSYmKGkmJihudWxsPT09KG49ZS5wcm9wcy5hY3Rpb24pfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmluY2x1ZGVzKFwiemFwaWVyLmNvbVwiKSl8fChvW1wiY29udGVudC10eXBlXCJdPXUpKTt2YXIgYz1uZXcgQ3VzdG9tRXZlbnQoXCJwcmVzdWJtaXRcIix7ZGV0YWlsOntib2R5OmF9fSk7aWYoZS5yZWYmJihlLnJlZi5kaXNwYXRjaEV2ZW50KGMpLGMuZGVmYXVsdFByZXZlbnRlZCkpcmV0dXJuO2Uuc2V0U3RhdGUoX19hc3NpZ24oX19hc3NpZ24oe30sZS5zdGF0ZSkse3N0YXRlOlwic2VuZGluZ1wifSkpO3ZhciBwPVwiXCIuY29uY2F0KFwiZGV2XCI9PT1idWlsZGVyLmVudj9cImh0dHA6Ly9sb2NhbGhvc3Q6NTAwMFwiOlwiaHR0cHM6Ly9idWlsZGVyLmlvXCIsXCIvYXBpL3YxL2Zvcm0tc3VibWl0P2FwaUtleT1cIikuY29uY2F0KGJ1aWxkZXIuYXBpS2V5LFwiJnRvPVwiKS5jb25jYXQoYnRvYShlLnByb3BzLnNlbmRTdWJtaXNzaW9uc1RvRW1haWx8fFwiXCIpLFwiJm5hbWU9XCIpLmNvbmNhdChlbmNvZGVVUklDb21wb25lbnQoZS5wcm9wcy5uYW1lfHxcIlwiKSk7ZmV0Y2goXCJlbWFpbFwiPT09ZS5wcm9wcy5zZW5kU3VibWlzc2lvbnNUbz9wOmUucHJvcHMuYWN0aW9uLHtib2R5OmEsaGVhZGVyczpvLG1ldGhvZDplLnByb3BzLm1ldGhvZHx8XCJwb3N0XCJ9KS50aGVuKChmdW5jdGlvbih0KXtyZXR1cm4gX19hd2FpdGVyKGUsdm9pZCAwLHZvaWQgMCwoZnVuY3Rpb24oKXt2YXIgZSxuLGkscixvO3JldHVybiBfX2dlbmVyYXRvcih0aGlzLChmdW5jdGlvbihhKXtzd2l0Y2goYS5sYWJlbCl7Y2FzZSAwOnJldHVybihuPXQuaGVhZGVycy5nZXQoXCJjb250ZW50LXR5cGVcIikpJiYtMSE9PW4uaW5kZXhPZihKU09OX0NPTlRFTlRfVFlQRSk/WzQsdC5qc29uKCldOlszLDJdO2Nhc2UgMTpyZXR1cm4gZT1hLnNlbnQoKSxbMyw0XTtjYXNlIDI6cmV0dXJuWzQsdC50ZXh0KCldO2Nhc2UgMzplPWEuc2VudCgpLGEubGFiZWw9NDtjYXNlIDQ6aWYoIXQub2smJnRoaXMucHJvcHMuZXJyb3JNZXNzYWdlUGF0aCYmKGk9Z2V0KGUsdGhpcy5wcm9wcy5lcnJvck1lc3NhZ2VQYXRoKSkmJihcInN0cmluZ1wiIT10eXBlb2YgaSYmKGk9SlNPTi5zdHJpbmdpZnkoaSkpLHRoaXMuc2V0U3RhdGUoX19hc3NpZ24oX19hc3NpZ24oe30sdGhpcy5zdGF0ZSkse2Zvcm1FcnJvck1lc3NhZ2U6aX0pKSksdGhpcy5zZXRTdGF0ZShfX2Fzc2lnbihfX2Fzc2lnbih7fSx0aGlzLnN0YXRlKSx7cmVzcG9uc2VEYXRhOmUsc3RhdGU6dC5vaz9cInN1Y2Nlc3NcIjpcImVycm9yXCJ9KSksdC5vayl7aWYocj1uZXcgQ3VzdG9tRXZlbnQoXCJzdWJtaXQ6c3VjY2Vzc1wiLHtkZXRhaWw6e3Jlczp0LGJvZHk6ZX19KSx0aGlzLnJlZil7aWYodGhpcy5yZWYuZGlzcGF0Y2hFdmVudChyKSxyLmRlZmF1bHRQcmV2ZW50ZWQpcmV0dXJuWzJdOyExIT09dGhpcy5wcm9wcy5yZXNldEZvcm1PblN1Ym1pdCYmdGhpcy5yZWYucmVzZXQoKX10aGlzLnByb3BzLnN1Y2Nlc3NVcmwmJih0aGlzLnJlZj8obz1uZXcgQ3VzdG9tRXZlbnQoXCJyb3V0ZVwiLHtkZXRhaWw6e3VybDp0aGlzLnByb3BzLnN1Y2Nlc3NVcmx9fSksdGhpcy5yZWYuZGlzcGF0Y2hFdmVudChvKSxvLmRlZmF1bHRQcmV2ZW50ZWR8fChsb2NhdGlvbi5ocmVmPXRoaXMucHJvcHMuc3VjY2Vzc1VybCkpOmxvY2F0aW9uLmhyZWY9dGhpcy5wcm9wcy5zdWNjZXNzVXJsKX1yZXR1cm5bMl19fSkpfSkpfSksKGZ1bmN0aW9uKHQpe3ZhciBuPW5ldyBDdXN0b21FdmVudChcInN1Ym1pdDplcnJvclwiLHtkZXRhaWw6e2Vycm9yOnR9fSk7ZS5yZWYmJihlLnJlZi5kaXNwYXRjaEV2ZW50KG4pLG4uZGVmYXVsdFByZXZlbnRlZCl8fGUuc2V0U3RhdGUoX19hc3NpZ24oX19hc3NpZ24oe30sZS5zdGF0ZSkse3Jlc3BvbnNlRGF0YTp0LHN0YXRlOlwiZXJyb3JcIn0pKX0pKX19fSxlLnByb3BzLmF0dHJpYnV0ZXMpLGUucHJvcHMuYnVpbGRlckJsb2NrJiZlLnByb3BzLmJ1aWxkZXJCbG9jay5jaGlsZHJlbiYmZS5wcm9wcy5idWlsZGVyQmxvY2suY2hpbGRyZW4ubWFwKChmdW5jdGlvbihlLHQpe3JldHVybiBqc3goQnVpbGRlckJsb2NrJDEse2tleTplLmlkLGJsb2NrOmV9KX0pKSxcImVycm9yXCI9PT1lLnN1Ym1pc3Npb25TdGF0ZSYmanN4KEJ1aWxkZXJCbG9ja3Mse2RhdGFQYXRoOlwiZXJyb3JNZXNzYWdlXCIsYmxvY2tzOmUucHJvcHMuZXJyb3JNZXNzYWdlfSksXCJzZW5kaW5nXCI9PT1lLnN1Ym1pc3Npb25TdGF0ZSYmanN4KEJ1aWxkZXJCbG9ja3Mse2RhdGFQYXRoOlwic2VuZGluZ01lc3NhZ2VcIixibG9ja3M6ZS5wcm9wcy5zZW5kaW5nTWVzc2FnZX0pLFwiZXJyb3JcIj09PWUuc3VibWlzc2lvblN0YXRlJiZlLnN0YXRlLnJlc3BvbnNlRGF0YSYmanN4KFwicHJlXCIse2NsYXNzTmFtZTpcImJ1aWxkZXItZm9ybS1lcnJvci10ZXh0XCIsY3NzOntwYWRkaW5nOjEwLGNvbG9yOlwicmVkXCIsdGV4dEFsaWduOlwiY2VudGVyXCJ9fSxKU09OLnN0cmluZ2lmeShlLnN0YXRlLnJlc3BvbnNlRGF0YSxudWxsLDIpKSxcInN1Y2Nlc3NcIj09PWUuc3VibWlzc2lvblN0YXRlJiZqc3goQnVpbGRlckJsb2Nrcyx7ZGF0YVBhdGg6XCJzdWNjZXNzTWVzc2FnZVwiLGJsb2NrczplLnByb3BzLnN1Y2Nlc3NNZXNzYWdlfSkpKX0pKX0sdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxGb3JtPXdpdGhCdWlsZGVyKEZvcm1Db21wb25lbnQse25hbWU6XCJGb3JtOkZvcm1cIixkZWZhdWx0czp7cmVzcG9uc2l2ZVN0eWxlczp7bGFyZ2U6e21hcmdpblRvcDpcIjE1cHhcIixwYWRkaW5nQm90dG9tOlwiMTVweFwifX19LGltYWdlOlwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9hcGkvdjEvaW1hZ2UvYXNzZXRzJTJGSXN4UEtNbzJnUFJSS2Vha1V6dGoxRDZ1cWVkMiUyRmVmMzZkMmE4NDYxMzQ5MTBiNjRiODhlNmQxOGM1Y2E1XCIsaW5wdXRzOlt7bmFtZTpcInNlbmRTdWJtaXNzaW9uc1RvXCIsdHlwZTpcInN0cmluZ1wiLGVudW06W3tsYWJlbDpcIlNlbmQgdG8gZW1haWxcIix2YWx1ZTpcImVtYWlsXCIsaGVscGVyVGV4dDpcIlNlbmQgZm9ybSBzdWJtaXNzaW9ucyB0byB0aGUgZW1haWwgYWRkcmVzcyBvZiB5b3VyIGNob29zaW5nXCJ9LHtsYWJlbDpcIkN1c3RvbVwiLHZhbHVlOlwiY3VzdG9tXCIsaGVscGVyVGV4dDpcIkhhbmRsZSB3aGVyZSB0aGUgZm9ybSByZXF1ZXN0cyBnbyBtYW51YWxseSB3aXRoIGEgbGl0dGxlIGNvZGUsIGUuZy4gdG8geW91ciBvd24gY3VzdG9tIGJhY2tlbmRcIn1dLGRlZmF1bHRWYWx1ZTpcImVtYWlsXCJ9LHtuYW1lOlwic2VuZFN1Ym1pc3Npb25zVG9FbWFpbFwiLHR5cGU6XCJzdHJpbmdcIixyZXF1aXJlZDohMCxkZWZhdWx0VmFsdWU6XCJ5b3VyQGVtYWlsLmNvbVwiLHNob3dJZjonb3B0aW9ucy5nZXQoXCJzZW5kU3VibWlzc2lvbnNUb1wiKSA9PT0gXCJlbWFpbFwiJ30se25hbWU6XCJzZW5kV2l0aEpzXCIsdHlwZTpcImJvb2xlYW5cIixoZWxwZXJUZXh0OlwiU2V0IHRvIGZhbHNlIHRvIHVzZSBiYXNpYyBodG1sIGZvcm0gYWN0aW9uXCIsZGVmYXVsdFZhbHVlOiEwLHNob3dJZjonb3B0aW9ucy5nZXQoXCJzZW5kU3VibWlzc2lvbnNUb1wiKSA9PT0gXCJjdXN0b21cIid9LHtuYW1lOlwibmFtZVwiLHR5cGU6XCJzdHJpbmdcIixkZWZhdWx0VmFsdWU6XCJNeSBmb3JtXCJ9LHtuYW1lOlwiYWN0aW9uXCIsdHlwZTpcInN0cmluZ1wiLGhlbHBlclRleHQ6XCJVUkwgdG8gc2VuZCB0aGUgZm9ybSBkYXRhIHRvXCIsc2hvd0lmOidvcHRpb25zLmdldChcInNlbmRTdWJtaXNzaW9uc1RvXCIpID09PSBcImN1c3RvbVwiJ30se25hbWU6XCJjb250ZW50VHlwZVwiLHR5cGU6XCJzdHJpbmdcIixkZWZhdWx0VmFsdWU6SlNPTl9DT05URU5UX1RZUEUsYWR2YW5jZWQ6ITAsZW51bTpbSlNPTl9DT05URU5UX1RZUEUsTVVMVElQQVJUX0NPTlRFTlRfVFlQRSxFTkNPREVEX0NPTlRFTlRfVFlQRV0sc2hvd0lmOidvcHRpb25zLmdldChcInNlbmRTdWJtaXNzaW9uc1RvXCIpID09PSBcImN1c3RvbVwiICYmIG9wdGlvbnMuZ2V0KFwic2VuZFdpdGhKc1wiKSA9PT0gdHJ1ZSd9LHtuYW1lOlwibWV0aG9kXCIsdHlwZTpcInN0cmluZ1wiLHNob3dJZjonb3B0aW9ucy5nZXQoXCJzZW5kU3VibWlzc2lvbnNUb1wiKSA9PT0gXCJjdXN0b21cIicsZGVmYXVsdFZhbHVlOlwiUE9TVFwiLGFkdmFuY2VkOiEwfSx7bmFtZTpcInByZXZpZXdTdGF0ZVwiLHR5cGU6XCJzdHJpbmdcIixlbnVtOltcInVuc3VibWl0dGVkXCIsXCJzZW5kaW5nXCIsXCJzdWNjZXNzXCIsXCJlcnJvclwiXSxkZWZhdWx0VmFsdWU6XCJ1bnN1Ym1pdHRlZFwiLGhlbHBlclRleHQ6J0Nob29zZSBhIHN0YXRlIHRvIGVkaXQsIGUuZy4gY2hvb3NlIFwic3VjY2Vzc1wiIHRvIHNob3cgd2hhdCB1c2VycyBzZWUgb24gc3VjY2VzcyBhbmQgZWRpdCB0aGUgbWVzc2FnZScsc2hvd0lmOidvcHRpb25zLmdldChcInNlbmRTdWJtaXNzaW9uc1RvXCIpICE9PSBcInphcGllclwiICYmIG9wdGlvbnMuZ2V0KFwic2VuZFdpdGhKc1wiKSA9PT0gdHJ1ZSd9LHtuYW1lOlwic3VjY2Vzc1VybFwiLHR5cGU6XCJ1cmxcIixoZWxwZXJUZXh0OlwiT3B0aW9uYWwgVVJMIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIG9uIGZvcm0gc3VibWlzc2lvbiBzdWNjZXNzXCIsc2hvd0lmOidvcHRpb25zLmdldChcInNlbmRTdWJtaXNzaW9uc1RvXCIpICE9PSBcInphcGllclwiICYmIG9wdGlvbnMuZ2V0KFwic2VuZFdpdGhKc1wiKSA9PT0gdHJ1ZSd9LHtuYW1lOlwicmVzZXRGb3JtT25TdWJtaXRcIix0eXBlOlwiYm9vbGVhblwiLHNob3dJZjpmdW5jdGlvbihlKXtyZXR1cm5cImN1c3RvbVwiPT09ZS5nZXQoXCJzZW5kU3VibWlzc2lvbnNUb1wiKSYmITA9PT1lLmdldChcInNlbmRXaXRoSnNcIil9LGFkdmFuY2VkOiEwfSx7bmFtZTpcInN1Y2Nlc3NNZXNzYWdlXCIsdHlwZTpcInVpQmxvY2tzXCIsaGlkZUZyb21VSTohMCxkZWZhdWx0VmFsdWU6W3tcIkB0eXBlXCI6XCJAYnVpbGRlci5pby9zZGs6RWxlbWVudFwiLHJlc3BvbnNpdmVTdHlsZXM6e2xhcmdlOnttYXJnaW5Ub3A6XCIxMHB4XCJ9fSxjb21wb25lbnQ6e25hbWU6XCJUZXh0XCIsb3B0aW9uczp7dGV4dDpcIjxzcGFuPlRoYW5rcyE8L3NwYW4+XCJ9fX1dfSx7bmFtZTpcInZhbGlkYXRlXCIsdHlwZTpcImJvb2xlYW5cIixkZWZhdWx0VmFsdWU6ITAsYWR2YW5jZWQ6ITB9LHtuYW1lOlwiZXJyb3JNZXNzYWdlUGF0aFwiLHR5cGU6XCJ0ZXh0XCIsYWR2YW5jZWQ6ITAsaGVscGVyVGV4dDonUGF0aCB0byB3aGVyZSB0byBnZXQgdGhlIGVycm9yIG1lc3NhZ2UgZnJvbSBpbiBhIEpTT04gcmVzcG9uc2UgdG8gZGlzcGxheSB0byB0aGUgdXNlciwgZS5nLiBcImVycm9yLm1lc3NhZ2VcIiBmb3IgYSByZXNwb25zZSBsaWtlIHsgXCJlcnJvclwiOiB7IFwibWVzc2FnZVwiOiBcInRoaXMgdXNlcm5hbWUgaXMgdGFrZW5cIiB9fSd9LHtuYW1lOlwiZXJyb3JNZXNzYWdlXCIsdHlwZTpcInVpQmxvY2tzXCIsaGlkZUZyb21VSTohMCxkZWZhdWx0VmFsdWU6W3tcIkB0eXBlXCI6XCJAYnVpbGRlci5pby9zZGs6RWxlbWVudFwiLHJlc3BvbnNpdmVTdHlsZXM6e2xhcmdlOnttYXJnaW5Ub3A6XCIxMHB4XCJ9fSxiaW5kaW5nczp7XCJjb21wb25lbnQub3B0aW9ucy50ZXh0XCI6XCJzdGF0ZS5mb3JtRXJyb3JNZXNzYWdlIHx8IGJsb2NrLmNvbXBvbmVudC5vcHRpb25zLnRleHRcIn0sY29tcG9uZW50OntuYW1lOlwiVGV4dFwiLG9wdGlvbnM6e3RleHQ6XCI8c3Bhbj5Gb3JtIHN1Ym1pc3Npb24gZXJyb3IgOiggUGxlYXNlIGNoZWNrIHlvdXIgYW5zd2VycyBhbmQgdHJ5IGFnYWluPC9zcGFuPlwifX19XX0se25hbWU6XCJzZW5kaW5nTWVzc2FnZVwiLHR5cGU6XCJ1aUJsb2Nrc1wiLGhpZGVGcm9tVUk6ITAsZGVmYXVsdFZhbHVlOlt7XCJAdHlwZVwiOlwiQGJ1aWxkZXIuaW8vc2RrOkVsZW1lbnRcIixyZXNwb25zaXZlU3R5bGVzOntsYXJnZTp7bWFyZ2luVG9wOlwiMTBweFwifX0sY29tcG9uZW50OntuYW1lOlwiVGV4dFwiLG9wdGlvbnM6e3RleHQ6XCI8c3Bhbj5TZW5kaW5nLi4uPC9zcGFuPlwifX19XX0sX19hc3NpZ24oX19hc3NpZ24oe25hbWU6XCJjdXN0b21IZWFkZXJzXCIsdHlwZTpcIm1hcFwifSx7dmFsdWVUeXBlOnt0eXBlOlwic3RyaW5nXCJ9fSkse2FkdmFuY2VkOiEwLHNob3dJZjonb3B0aW9ucy5nZXQoXCJzZW5kU3VibWlzc2lvbnNUb1wiKSA9PT0gXCJjdXN0b21cIiAmJiBvcHRpb25zLmdldChcInNlbmRXaXRoSnNcIikgPT09IHRydWUnfSldLG5vV3JhcDohMCxjYW5IYXZlQ2hpbGRyZW46ITAsZGVmYXVsdENoaWxkcmVuOlt7XCJAdHlwZVwiOlwiQGJ1aWxkZXIuaW8vc2RrOkVsZW1lbnRcIixyZXNwb25zaXZlU3R5bGVzOntsYXJnZTp7bWFyZ2luVG9wOlwiMTBweFwifX0sY29tcG9uZW50OntuYW1lOlwiVGV4dFwiLG9wdGlvbnM6e3RleHQ6XCI8c3Bhbj5FbnRlciB5b3VyIG5hbWU8L3NwYW4+XCJ9fX0se1wiQHR5cGVcIjpcIkBidWlsZGVyLmlvL3NkazpFbGVtZW50XCIscmVzcG9uc2l2ZVN0eWxlczp7bGFyZ2U6e21hcmdpblRvcDpcIjEwcHhcIn19LGNvbXBvbmVudDp7bmFtZTpcIkZvcm06SW5wdXRcIixvcHRpb25zOntuYW1lOlwibmFtZVwiLHBsYWNlaG9sZGVyOlwiSmFuZSBEb2VcIn19fSx7XCJAdHlwZVwiOlwiQGJ1aWxkZXIuaW8vc2RrOkVsZW1lbnRcIixyZXNwb25zaXZlU3R5bGVzOntsYXJnZTp7bWFyZ2luVG9wOlwiMTBweFwifX0sY29tcG9uZW50OntuYW1lOlwiVGV4dFwiLG9wdGlvbnM6e3RleHQ6XCI8c3Bhbj5FbnRlciB5b3VyIGVtYWlsPC9zcGFuPlwifX19LHtcIkB0eXBlXCI6XCJAYnVpbGRlci5pby9zZGs6RWxlbWVudFwiLHJlc3BvbnNpdmVTdHlsZXM6e2xhcmdlOnttYXJnaW5Ub3A6XCIxMHB4XCJ9fSxjb21wb25lbnQ6e25hbWU6XCJGb3JtOklucHV0XCIsb3B0aW9uczp7bmFtZTpcImVtYWlsXCIscGxhY2Vob2xkZXI6XCJqYW5lQGRvZS5jb21cIn19fSx7XCJAdHlwZVwiOlwiQGJ1aWxkZXIuaW8vc2RrOkVsZW1lbnRcIixyZXNwb25zaXZlU3R5bGVzOntsYXJnZTp7bWFyZ2luVG9wOlwiMTBweFwifX0sY29tcG9uZW50OntuYW1lOlwiRm9ybTpTdWJtaXRCdXR0b25cIixvcHRpb25zOnt0ZXh0OlwiU3VibWl0XCJ9fX1dfSksRm9ybUlucHV0Q29tcG9uZW50PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtyZXR1cm4gbnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImlucHV0XCIsX19hc3NpZ24oe2tleTpCdWlsZGVyLmlzRWRpdGluZyYmdGhpcy5wcm9wcy5kZWZhdWx0VmFsdWU/dGhpcy5wcm9wcy5kZWZhdWx0VmFsdWU6XCJkZWZhdWx0LWtleVwiLHBsYWNlaG9sZGVyOnRoaXMucHJvcHMucGxhY2Vob2xkZXIsdHlwZTp0aGlzLnByb3BzLnR5cGUsbmFtZTp0aGlzLnByb3BzLm5hbWUsdmFsdWU6dGhpcy5wcm9wcy52YWx1ZSxkZWZhdWx0VmFsdWU6dGhpcy5wcm9wcy5kZWZhdWx0VmFsdWUscmVxdWlyZWQ6dGhpcy5wcm9wcy5yZXF1aXJlZH0sdGhpcy5wcm9wcy5hdHRyaWJ1dGVzKSl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksRm9ybUlucHV0PXdpdGhCdWlsZGVyKEZvcm1JbnB1dENvbXBvbmVudCx7bmFtZTpcIkZvcm06SW5wdXRcIixpbWFnZTpcImh0dHBzOi8vY2RuLmJ1aWxkZXIuaW8vYXBpL3YxL2ltYWdlL2Fzc2V0cyUyRklzeFBLTW8yZ1BSUktlYWtVenRqMUQ2dXFlZDIlMkZhZDZmMzc4ODlkOWU0MGJiYmJjNzJjZGI1ODc1ZDZjYVwiLGlucHV0czpbe25hbWU6XCJ0eXBlXCIsdHlwZTpcInRleHRcIixlbnVtOltcInRleHRcIixcIm51bWJlclwiLFwiZW1haWxcIixcInVybFwiLFwiY2hlY2tib3hcIixcInJhZGlvXCIsXCJyYW5nZVwiLFwiZGF0ZVwiLFwiZGF0ZXRpbWUtbG9jYWxcIixcInNlYXJjaFwiLFwidGVsXCIsXCJ0aW1lXCIsXCJmaWxlXCIsXCJtb250aFwiLFwid2Vla1wiLFwicGFzc3dvcmRcIixcImNvbG9yXCIsXCJoaWRkZW5cIl0sZGVmYXVsdFZhbHVlOlwidGV4dFwifSx7bmFtZTpcIm5hbWVcIix0eXBlOlwic3RyaW5nXCIscmVxdWlyZWQ6ITAsaGVscGVyVGV4dDonRXZlcnkgaW5wdXQgaW4gYSBmb3JtIG5lZWRzIGEgdW5pcXVlIG5hbWUgZGVzY3JpYmluZyB3aGF0IGl0IHRha2VzLCBlLmcuIFwiZW1haWxcIid9LHtuYW1lOlwicGxhY2Vob2xkZXJcIix0eXBlOlwic3RyaW5nXCIsZGVmYXVsdFZhbHVlOlwiSGVsbG8gdGhlcmVcIixoZWxwZXJUZXh0OlwiVGV4dCB0byBkaXNwbGF5IHdoZW4gdGhlcmUgaXMgbm8gdmFsdWVcIn0se25hbWU6XCJkZWZhdWx0VmFsdWVcIix0eXBlOlwic3RyaW5nXCJ9LHtuYW1lOlwidmFsdWVcIix0eXBlOlwic3RyaW5nXCIsYWR2YW5jZWQ6ITB9LHtuYW1lOlwicmVxdWlyZWRcIix0eXBlOlwiYm9vbGVhblwiLGhlbHBlclRleHQ6XCJJcyB0aGlzIGlucHV0IHJlcXVpcmVkIHRvIGJlIGZpbGxlZCBvdXQgdG8gc3VibWl0IGEgZm9ybVwiLGRlZmF1bHRWYWx1ZTohMX1dLG5vV3JhcDohMCxzdGF0aWM6ITAsZGVmYXVsdFN0eWxlczp7cGFkZGluZ1RvcDpcIjEwcHhcIixwYWRkaW5nQm90dG9tOlwiMTBweFwiLHBhZGRpbmdMZWZ0OlwiMTBweFwiLHBhZGRpbmdSaWdodDpcIjEwcHhcIixib3JkZXJSYWRpdXM6XCIzcHhcIixib3JkZXJXaWR0aDpcIjFweFwiLGJvcmRlclN0eWxlOlwic29saWRcIixib3JkZXJDb2xvcjpcIiNjY2NcIn19KSxGb3JtU3VibWl0QnV0dG9uQ29tcG9uZW50PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtyZXR1cm4gbnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLF9fYXNzaWduKHt0eXBlOlwic3VibWl0XCJ9LHRoaXMucHJvcHMuYXR0cmlidXRlcyksdGhpcy5wcm9wcy50ZXh0KX0sdH0oUmVhY3RfX2RlZmF1bHQuQ29tcG9uZW50KSxGb3JtU3VibWl0QnV0dG9uPXdpdGhCdWlsZGVyKEZvcm1TdWJtaXRCdXR0b25Db21wb25lbnQse25hbWU6XCJGb3JtOlN1Ym1pdEJ1dHRvblwiLGltYWdlOlwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9hcGkvdjEvaW1hZ2UvYXNzZXRzJTJGSXN4UEtNbzJnUFJSS2Vha1V6dGoxRDZ1cWVkMiUyRmRmMjgyMGZmZWQxZjQzNDlhOTRjNDBiMzIyMWY1Yjk4XCIsZGVmYXVsdFN0eWxlczp7YXBwZWFyYW5jZTpcIm5vbmVcIixwYWRkaW5nVG9wOlwiMTVweFwiLHBhZGRpbmdCb3R0b206XCIxNXB4XCIscGFkZGluZ0xlZnQ6XCIyNXB4XCIscGFkZGluZ1JpZ2h0OlwiMjVweFwiLGJhY2tncm91bmRDb2xvcjpcIiMzODk4RUNcIixjb2xvcjpcIndoaXRlXCIsYm9yZGVyUmFkaXVzOlwiNHB4XCIsY3Vyc29yOlwicG9pbnRlclwifSxpbnB1dHM6W3tuYW1lOlwidGV4dFwiLHR5cGU6XCJ0ZXh0XCIsZGVmYXVsdFZhbHVlOlwiQ2xpY2sgbWVcIn1dLHN0YXRpYzohMCxub1dyYXA6ITB9KSxMYWJlbENvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIG51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIFJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiLF9fYXNzaWduKHtodG1sRm9yOnRoaXMucHJvcHMuZm9yfSx0aGlzLnByb3BzLmF0dHJpYnV0ZXMpLHRoaXMucHJvcHMudGV4dCYmUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInNwYW5cIix7Y2xhc3NOYW1lOlwiYnVpbGRlci1sYWJlbC10ZXh0XCIsZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6e19faHRtbDp0aGlzLnByb3BzLnRleHR9fSksdGhpcy5wcm9wcy5idWlsZGVyQmxvY2smJnRoaXMucHJvcHMuYnVpbGRlckJsb2NrLmNoaWxkcmVuJiZ0aGlzLnByb3BzLmJ1aWxkZXJCbG9jay5jaGlsZHJlbi5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBSZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1aWxkZXJCbG9jayQxLHtrZXk6ZS5pZCxibG9jazplfSl9KSkpfSx0fShSZWFjdF9fZGVmYXVsdC5Db21wb25lbnQpLExhYmVsPXdpdGhCdWlsZGVyKExhYmVsQ29tcG9uZW50LHtuYW1lOlwiRm9ybTpMYWJlbFwiLGltYWdlOlwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9hcGkvdjEvaW1hZ2UvYXNzZXRzJTJGSXN4UEtNbzJnUFJSS2Vha1V6dGoxRDZ1cWVkMiUyRjkzMjIzNDJmMDRiNTQ1ZmI5YTgwOTFjZDgwMWRmYjViXCIsaW5wdXRzOlt7bmFtZTpcInRleHRcIix0eXBlOlwiaHRtbFwiLHJpY2hUZXh0OiEwLGRlZmF1bHRWYWx1ZTpcIkxhYmVsXCJ9LHtuYW1lOlwiZm9yXCIsdHlwZTpcInRleHRcIixoZWxwZXJUZXh0OlwiVGhlIG5hbWUgb2YgdGhlIGlucHV0IHRoaXMgbGFiZWwgaXMgZm9yXCIsYWR2YW5jZWQ6ITB9XSxub1dyYXA6ITAsc3RhdGljOiEwLGNhbkhhdmVDaGlsZHJlbjohMH0pLEZvcm1TZWxlY3RDb21wb25lbnQ9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3JldHVybiBudWxsIT09ZSYmZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cmV0dXJuIF9fZXh0ZW5kcyh0LGUpLHQucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXMucHJvcHMub3B0aW9ucztyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiLF9fYXNzaWduKHt2YWx1ZTp0aGlzLnByb3BzLnZhbHVlLGtleTpCdWlsZGVyLmlzRWRpdGluZyYmdGhpcy5wcm9wcy5kZWZhdWx0VmFsdWU/dGhpcy5wcm9wcy5kZWZhdWx0VmFsdWU6XCJkZWZhdWx0LWtleVwiLGRlZmF1bHRWYWx1ZTp0aGlzLnByb3BzLmRlZmF1bHRWYWx1ZSxuYW1lOnRoaXMucHJvcHMubmFtZX0sdGhpcy5wcm9wcy5hdHRyaWJ1dGVzKSxlJiZlLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIFJlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIix7dmFsdWU6ZS52YWx1ZX0sZS5uYW1lfHxlLnZhbHVlKX0pKSl9LHR9KFJlYWN0X19kZWZhdWx0LkNvbXBvbmVudCksRm9ybVNlbGVjdD13aXRoQnVpbGRlcihGb3JtU2VsZWN0Q29tcG9uZW50LHtuYW1lOlwiRm9ybTpTZWxlY3RcIixpbWFnZTpcImh0dHBzOi8vY2RuLmJ1aWxkZXIuaW8vYXBpL3YxL2ltYWdlL2Fzc2V0cyUyRklzeFBLTW8yZ1BSUktlYWtVenRqMUQ2dXFlZDIlMkY4M2FjY2EwOTNmYjI0YWFmOTRkZWUxMzZlOWE0YjA0NVwiLGRlZmF1bHRTdHlsZXM6e2FsaWduU2VsZjpcImZsZXgtc3RhcnRcIn0saW5wdXRzOlt7bmFtZTpcIm9wdGlvbnNcIix0eXBlOlwibGlzdFwiLHJlcXVpcmVkOiEwLHN1YkZpZWxkczpbe25hbWU6XCJ2YWx1ZVwiLHR5cGU6XCJ0ZXh0XCIscmVxdWlyZWQ6ITB9LHtuYW1lOlwibmFtZVwiLHR5cGU6XCJ0ZXh0XCJ9XSxkZWZhdWx0VmFsdWU6W3t2YWx1ZTpcIm9wdGlvbiAxXCJ9LHt2YWx1ZTpcIm9wdGlvbiAyXCJ9XX0se25hbWU6XCJuYW1lXCIsdHlwZTpcInN0cmluZ1wiLHJlcXVpcmVkOiEwLGhlbHBlclRleHQ6J0V2ZXJ5IHNlbGVjdCBpbiBhIGZvcm0gbmVlZHMgYSB1bmlxdWUgbmFtZSBkZXNjcmliaW5nIHdoYXQgaXQgZ2V0cywgZS5nLiBcImVtYWlsXCInfSx7bmFtZTpcImRlZmF1bHRWYWx1ZVwiLHR5cGU6XCJzdHJpbmdcIn0se25hbWU6XCJ2YWx1ZVwiLHR5cGU6XCJzdHJpbmdcIixhZHZhbmNlZDohMH0se25hbWU6XCJyZXF1aXJlZFwiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOiExfV0sc3RhdGljOiEwLG5vV3JhcDohMH0pLFRleHRBcmVhQ29tcG9uZW50PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXtyZXR1cm4gbnVsbCE9PWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfXJldHVybiBfX2V4dGVuZHModCxlKSx0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIsX19hc3NpZ24oe3BsYWNlaG9sZGVyOnRoaXMucHJvcHMucGxhY2Vob2xkZXIsbmFtZTp0aGlzLnByb3BzLm5hbWUsdmFsdWU6dGhpcy5wcm9wcy52YWx1ZSxkZWZhdWx0VmFsdWU6dGhpcy5wcm9wcy5kZWZhdWx0VmFsdWV9LHRoaXMucHJvcHMuYXR0cmlidXRlcykpfSx0fShSZWFjdF9fZGVmYXVsdC5Db21wb25lbnQpLFRleHRBcmVhPXdpdGhCdWlsZGVyKFRleHRBcmVhQ29tcG9uZW50LHtuYW1lOlwiRm9ybTpUZXh0QXJlYVwiLGltYWdlOlwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9hcGkvdjEvaW1hZ2UvYXNzZXRzJTJGSXN4UEtNbzJnUFJSS2Vha1V6dGoxRDZ1cWVkMiUyRmY3NGEyZjNkZTU4YzRjM2U5MzkyMDRlNWI2YjhmNmMzXCIsaW5wdXRzOlt7YWR2YW5jZWQ6ITAsbmFtZTpcInZhbHVlXCIsdHlwZTpcInN0cmluZ1wifSx7bmFtZTpcIm5hbWVcIix0eXBlOlwic3RyaW5nXCIscmVxdWlyZWQ6ITAsaGVscGVyVGV4dDonRXZlcnkgaW5wdXQgaW4gYSBmb3JtIG5lZWRzIGEgdW5pcXVlIG5hbWUgZGVzY3JpYmluZyB3aGF0IGl0IGdldHMsIGUuZy4gXCJlbWFpbFwiJ30se25hbWU6XCJkZWZhdWx0VmFsdWVcIix0eXBlOlwic3RyaW5nXCJ9LHtuYW1lOlwicGxhY2Vob2xkZXJcIix0eXBlOlwic3RyaW5nXCIsZGVmYXVsdFZhbHVlOlwiSGVsbG8gdGhlcmVcIn0se25hbWU6XCJyZXF1aXJlZFwiLHR5cGU6XCJib29sZWFuXCIsZGVmYXVsdFZhbHVlOiExfV0sZGVmYXVsdFN0eWxlczp7cGFkZGluZ1RvcDpcIjEwcHhcIixwYWRkaW5nQm90dG9tOlwiMTBweFwiLHBhZGRpbmdMZWZ0OlwiMTBweFwiLHBhZGRpbmdSaWdodDpcIjEwcHhcIixib3JkZXJSYWRpdXM6XCIzcHhcIixib3JkZXJXaWR0aDpcIjFweFwiLGJvcmRlclN0eWxlOlwic29saWRcIixib3JkZXJDb2xvcjpcIiNjY2NcIn0sc3RhdGljOiEwLG5vV3JhcDohMH0pLEltZ0NvbXBvbmVudD1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7cmV0dXJuIG51bGwhPT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gX19leHRlbmRzKHQsZSksdC5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5wcm9wcy5hdHRyaWJ1dGVzfHx7fTtyZXR1cm4gUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImltZ1wiLF9fYXNzaWduKHt9LHRoaXMucHJvcHMuYXR0cmlidXRlcyx7c3JjOnRoaXMucHJvcHMuaW1hZ2V8fGUuc3JjfSkpfSx0fShSZWFjdF9fZGVmYXVsdC5Db21wb25lbnQpLEltZz13aXRoQnVpbGRlcihJbWdDb21wb25lbnQse25hbWU6XCJSYXc6SW1nXCIsaGlkZUZyb21JbnNlcnRNZW51OiEwLGltYWdlOlwiaHR0cHM6Ly9maXJlYmFzZXN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vdjAvYi9idWlsZGVyLTNiMGEyLmFwcHNwb3QuY29tL28vaW1hZ2VzJTJGYmFzZWxpbmUtaW5zZXJ0X3Bob3RvLTI0cHguc3ZnP2FsdD1tZWRpYSZ0b2tlbj00ZTVkMGVmNC1mNWU4LTRlNTctYjNhOS0zOGQ2M2E5YjlkYzRcIixpbnB1dHM6W3tuYW1lOlwiaW1hZ2VcIixidWJibGU6ITAsdHlwZTpcImZpbGVcIixhbGxvd2VkRmlsZVR5cGVzOltcImpwZWdcIixcImpwZ1wiLFwicG5nXCIsXCJzdmdcIl0scmVxdWlyZWQ6ITB9XSxub1dyYXA6ITAsc3RhdGljOiEwfSksUmF3VGV4dD1mdW5jdGlvbihlKXt2YXIgdD1lLmF0dHJpYnV0ZXN8fHt9O3JldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLHtjbGFzc05hbWU6KG51bGw9PXQ/dm9pZCAwOnQuY2xhc3MpfHwobnVsbD09dD92b2lkIDA6dC5jbGFzc05hbWUpLGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOntfX2h0bWw6ZS50ZXh0fHxcIlwifX0pfTtmdW5jdGlvbiB1c2VJc1ByZXZpZXdpbmcoKXt2YXIgZT11c2VTdGF0ZSghMSksdD1lWzBdLG49ZVsxXTtyZXR1cm4gdXNlRWZmZWN0KChmdW5jdGlvbigpeyhCdWlsZGVyLmlzRWRpdGluZ3x8QnVpbGRlci5pc1ByZXZpZXdpbmcpJiZuKCEwKX0pLFtdKSx0fUJ1aWxkZXIucmVnaXN0ZXJDb21wb25lbnQoUmF3VGV4dCx7bmFtZTpcIkJ1aWxkZXI6UmF3VGV4dFwiLGhpZGVGcm9tSW5zZXJ0TWVudTohMCxpbnB1dHM6W3tuYW1lOlwidGV4dFwiLGJ1YmJsZTohMCx0eXBlOlwibG9uZ1RleHRcIixyZXF1aXJlZDohMH1dfSksQnVpbGRlci5pc1JlYWN0PSEwO2V4cG9ydHtCdWlsZGVyQXN5bmNSZXF1ZXN0c0NvbnRleHQsQnVpbGRlckJsb2NrLEJ1aWxkZXJCbG9jayQxIGFzIEJ1aWxkZXJCbG9ja0NvbXBvbmVudCxCdWlsZGVyQmxvY2tzLEJ1aWxkZXJDb21wb25lbnQsQnVpbGRlckNvbnRlbnQsQnVpbGRlck1ldGFDb250ZXh0LEJ1aWxkZXJDb21wb25lbnQgYXMgQnVpbGRlclBhZ2UsQnVpbGRlclN0b3JlQ29udGV4dCxCdXR0b24sQ29sdW1ucyxCdWlsZGVyQ29tcG9uZW50IGFzIENvbnRlbnQsQ3VzdG9tQ29kZSxTbG90IGFzIERyb3B6b25lLEVtYmVkLEZvcm0sRm9ybUlucHV0LEZvcm1TZWxlY3QsRm9ybVN1Ym1pdEJ1dHRvbixGcmFnbWVudCxJbWFnZSxJbWcsTGFiZWwsTXV0YXRpb24sUmF3VGV4dCxSb3V0ZXIsU2VjdGlvbixTdGF0ZVByb3ZpZGVyLFN5bWJvbCQxIGFzIFN5bWJvbCxUZXh0LFRleHRBcmVhLFZpZGVvLGdldFNyY1NldCxub1dyYXAsb25DaGFuZ2Usc3RyaW5nVG9GdW5jdGlvbix1cGRhdGVNZXRhZGF0YSx1c2VJc1ByZXZpZXdpbmcsd2l0aEJ1aWxkZXIsd2l0aENoaWxkcmVufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJ1aWxkZXItcmVhY3QuZXM1LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@builder.io/react/dist/builder-react.es5.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@builder.io/sdk/dist/index.esm.js":
/*!********************************************************!*\
  !*** ./node_modules/@builder.io/sdk/dist/index.esm.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BehaviorSubject: () => (/* binding */ BehaviorSubject),\n/* harmony export */   Builder: () => (/* binding */ Builder),\n/* harmony export */   BuilderComponent: () => (/* binding */ BuilderComponent),\n/* harmony export */   Subscription: () => (/* binding */ Subscription),\n/* harmony export */   builder: () => (/* binding */ builder),\n/* harmony export */   isBrowser: () => (/* binding */ isBrowser)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ \"(ssr)/./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var hash_sum__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! hash-sum */ \"(ssr)/./node_modules/hash-sum/hash-sum.js\");\n/* harmony import */ var hash_sum__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(hash_sum__WEBPACK_IMPORTED_MODULE_0__);\n\n\n\n(function () {\n  if (typeof window === 'undefined' || typeof window.CustomEvent === 'function') return false;\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: null };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n\n  window.CustomEvent = CustomEvent;\n})();\n\nvar isSafari = typeof window !== 'undefined' &&\r\n    /^((?!chrome|android).)*safari/i.test(window.navigator.userAgent);\r\nvar isClient = typeof window !== 'undefined';\r\n// TODO: queue all of these in a debounceNextTick\r\nfunction nextTick(fn) {\r\n    // if (typeof process !== 'undefined' && process.nextTick) {\r\n    //   console.log('process.nextTick?');\r\n    //   process.nextTick(fn);\r\n    //   return;\r\n    // }\r\n    // FIXME: fix the real safari issue of this randomly not working\r\n    if (!isClient || isSafari || typeof MutationObserver === 'undefined') {\r\n        setTimeout(fn);\r\n        return;\r\n    }\r\n    var called = 0;\r\n    var observer = new MutationObserver(function () { return fn(); });\r\n    var element = document.createTextNode('');\r\n    observer.observe(element, {\r\n        characterData: true,\r\n    });\r\n    // tslint:disable-next-line\r\n    element.data = String((called = ++called));\r\n}\n\nvar PROPERTY_NAME_DENY_LIST = Object.freeze(['__proto__', 'prototype', 'constructor']);\r\n// TODO: unit tests\r\nvar QueryString = /** @class */ (function () {\r\n    function QueryString() {\r\n    }\r\n    QueryString.parseDeep = function (queryString) {\r\n        var obj = this.parse(queryString);\r\n        return this.deepen(obj);\r\n    };\r\n    QueryString.stringifyDeep = function (obj) {\r\n        var map = this.flatten(obj);\r\n        return this.stringify(map);\r\n    };\r\n    QueryString.parse = function (queryString) {\r\n        var query = {};\r\n        var pairs = (queryString[0] === '?' ? queryString.substr(1) : queryString).split('&');\r\n        for (var i = 0; i < pairs.length; i++) {\r\n            var pair = pairs[i].split('=');\r\n            // TODO: node support?\r\n            try {\r\n                query[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');\r\n            }\r\n            catch (error) {\r\n                // Ignore malformed URI components\r\n            }\r\n        }\r\n        return query;\r\n    };\r\n    QueryString.stringify = function (map) {\r\n        var str = '';\r\n        for (var key in map) {\r\n            if (map.hasOwnProperty(key)) {\r\n                var value = map[key];\r\n                if (str) {\r\n                    str += '&';\r\n                }\r\n                str += encodeURIComponent(key) + '=' + encodeURIComponent(value);\r\n            }\r\n        }\r\n        return str;\r\n    };\r\n    QueryString.deepen = function (map) {\r\n        // FIXME; Should be type Tree = Record<string, string | Tree>\r\n        // requires a typescript upgrade.\r\n        var output = {};\r\n        for (var k in map) {\r\n            var t = output;\r\n            var parts = k.split('.');\r\n            var key = parts.pop();\r\n            for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\r\n                var part = parts_1[_i];\r\n                assertAllowedPropertyName(part);\r\n                t = t[part] = t[part] || {};\r\n            }\r\n            t[key] = map[k];\r\n        }\r\n        return output;\r\n    };\r\n    QueryString.flatten = function (obj, _current, _res) {\r\n        if (_res === void 0) { _res = {}; }\r\n        for (var key in obj) {\r\n            var value = obj[key];\r\n            var newKey = _current ? _current + '.' + key : key;\r\n            if (value && typeof value === 'object') {\r\n                this.flatten(value, newKey, _res);\r\n            }\r\n            else {\r\n                _res[newKey] = value;\r\n            }\r\n        }\r\n        return _res;\r\n    };\r\n    return QueryString;\r\n}());\r\nfunction assertAllowedPropertyName(name) {\r\n    if (PROPERTY_NAME_DENY_LIST.indexOf(name) >= 0)\r\n        throw new Error(\"Property name \\\"\".concat(name, \"\\\" is not allowed\"));\r\n}\n\nvar version = \"2.2.2\";\n\nvar Subscription = /** @class */ (function () {\r\n    function Subscription(listeners, listener) {\r\n        this.listeners = listeners;\r\n        this.listener = listener;\r\n        this.unsubscribed = false;\r\n        this.otherSubscriptions = [];\r\n    }\r\n    Object.defineProperty(Subscription.prototype, \"closed\", {\r\n        get: function () {\r\n            return this.unsubscribed;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Subscription.prototype.add = function (subscription) {\r\n        this.otherSubscriptions.push(subscription);\r\n    };\r\n    Subscription.prototype.unsubscribe = function () {\r\n        if (this.unsubscribed) {\r\n            return;\r\n        }\r\n        if (this.listener && this.listeners) {\r\n            var index = this.listeners.indexOf(this.listener);\r\n            if (index > -1) {\r\n                this.listeners.splice(index, 1);\r\n            }\r\n        }\r\n        this.otherSubscriptions.forEach(function (sub) { return sub.unsubscribe(); });\r\n        this.unsubscribed = true;\r\n    };\r\n    return Subscription;\r\n}());\r\n// TODO: follow minimal basic spec: https://github.com/tc39/proposal-observable\r\nvar BehaviorSubject = /** @class */ (function () {\r\n    function BehaviorSubject(value) {\r\n        var _this = this;\r\n        this.value = value;\r\n        this.listeners = [];\r\n        this.errorListeners = [];\r\n        this.then = function () {\r\n            var _a;\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return (_a = _this.toPromise()).then.apply(_a, args);\r\n        };\r\n    }\r\n    BehaviorSubject.prototype.next = function (value) {\r\n        this.value = value;\r\n        for (var _i = 0, _a = this.listeners; _i < _a.length; _i++) {\r\n            var listener = _a[_i];\r\n            listener(value);\r\n        }\r\n    };\r\n    // TODO: implement this as PIPE instead\r\n    BehaviorSubject.prototype.map = function (fn) {\r\n        var newSubject = new BehaviorSubject(fn(this.value));\r\n        // TODO: on destroy delete these\r\n        this.subscribe(function (val) {\r\n            newSubject.next(fn(val));\r\n        });\r\n        this.catch(function (err) {\r\n            newSubject.error(err);\r\n        });\r\n        return newSubject;\r\n    };\r\n    BehaviorSubject.prototype.catch = function (errorListener) {\r\n        this.errorListeners.push(errorListener);\r\n        return new Subscription(this.errorListeners, errorListener);\r\n    };\r\n    BehaviorSubject.prototype.error = function (error) {\r\n        for (var _i = 0, _a = this.errorListeners; _i < _a.length; _i++) {\r\n            var listener = _a[_i];\r\n            listener(error);\r\n        }\r\n    };\r\n    BehaviorSubject.prototype.subscribe = function (listener, errorListener) {\r\n        this.listeners.push(listener);\r\n        if (errorListener) {\r\n            this.errorListeners.push(errorListener);\r\n        }\r\n        return new Subscription(this.listeners, listener);\r\n    };\r\n    BehaviorSubject.prototype.toPromise = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var subscription = _this.subscribe(function (value) {\r\n                resolve(value);\r\n                subscription.unsubscribe();\r\n            }, function (err) {\r\n                reject(err);\r\n                subscription.unsubscribe();\r\n            });\r\n        });\r\n    };\r\n    BehaviorSubject.prototype.promise = function () {\r\n        return this.toPromise();\r\n    };\r\n    return BehaviorSubject;\r\n}());\n\nvar State = {\r\n    Pending: 'Pending',\r\n    Fulfilled: 'Fulfilled',\r\n    Rejected: 'Rejected',\r\n};\r\nfunction isFunction(val) {\r\n    return val && typeof val === 'function';\r\n}\r\nfunction isObject(val) {\r\n    return val && typeof val === 'object';\r\n}\r\nvar TinyPromise = /** @class */ (function () {\r\n    function TinyPromise(executor) {\r\n        this._state = State.Pending;\r\n        this._handlers = [];\r\n        this._value = null;\r\n        executor(this._resolve.bind(this), this._reject.bind(this));\r\n    }\r\n    TinyPromise.prototype._resolve = function (x) {\r\n        var _this = this;\r\n        if (x instanceof TinyPromise) {\r\n            x.then(this._resolve.bind(this), this._reject.bind(this));\r\n        }\r\n        else if (isObject(x) || isFunction(x)) {\r\n            var called_1 = false;\r\n            try {\r\n                var thenable = x.then;\r\n                if (isFunction(thenable)) {\r\n                    thenable.call(x, function (result) {\r\n                        if (!called_1)\r\n                            _this._resolve(result);\r\n                        called_1 = true;\r\n                        return undefined;\r\n                    }, function (error) {\r\n                        if (!called_1)\r\n                            _this._reject(error);\r\n                        called_1 = true;\r\n                        return undefined;\r\n                    });\r\n                }\r\n                else {\r\n                    this._fulfill(x);\r\n                }\r\n            }\r\n            catch (ex) {\r\n                if (!called_1) {\r\n                    this._reject(ex);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this._fulfill(x);\r\n        }\r\n    };\r\n    TinyPromise.prototype._fulfill = function (result) {\r\n        var _this = this;\r\n        this._state = State.Fulfilled;\r\n        this._value = result;\r\n        this._handlers.forEach(function (handler) { return _this._callHandler(handler); });\r\n    };\r\n    TinyPromise.prototype._reject = function (error) {\r\n        var _this = this;\r\n        this._state = State.Rejected;\r\n        this._value = error;\r\n        this._handlers.forEach(function (handler) { return _this._callHandler(handler); });\r\n    };\r\n    TinyPromise.prototype._isPending = function () {\r\n        return this._state === State.Pending;\r\n    };\r\n    TinyPromise.prototype._isFulfilled = function () {\r\n        return this._state === State.Fulfilled;\r\n    };\r\n    TinyPromise.prototype._isRejected = function () {\r\n        return this._state === State.Rejected;\r\n    };\r\n    TinyPromise.prototype._addHandler = function (onFulfilled, onRejected) {\r\n        this._handlers.push({\r\n            onFulfilled: onFulfilled,\r\n            onRejected: onRejected,\r\n        });\r\n    };\r\n    TinyPromise.prototype._callHandler = function (handler) {\r\n        if (this._isFulfilled() && isFunction(handler.onFulfilled)) {\r\n            handler.onFulfilled(this._value);\r\n        }\r\n        else if (this._isRejected() && isFunction(handler.onRejected)) {\r\n            handler.onRejected(this._value);\r\n        }\r\n    };\r\n    TinyPromise.prototype.then = function (onFulfilled, onRejected) {\r\n        var _this = this;\r\n        switch (this._state) {\r\n            case State.Pending: {\r\n                return new TinyPromise(function (resolve, reject) {\r\n                    _this._addHandler(function (value) {\r\n                        nextTick(function () {\r\n                            try {\r\n                                if (isFunction(onFulfilled)) {\r\n                                    resolve(onFulfilled(value));\r\n                                }\r\n                                else {\r\n                                    resolve(value);\r\n                                }\r\n                            }\r\n                            catch (ex) {\r\n                                reject(ex);\r\n                            }\r\n                        });\r\n                    }, function (error) {\r\n                        nextTick(function () {\r\n                            try {\r\n                                if (isFunction(onRejected)) {\r\n                                    resolve(onRejected(error));\r\n                                }\r\n                                else {\r\n                                    reject(error);\r\n                                }\r\n                            }\r\n                            catch (ex) {\r\n                                reject(ex);\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n            case State.Fulfilled: {\r\n                return new TinyPromise(function (resolve, reject) {\r\n                    nextTick(function () {\r\n                        try {\r\n                            if (isFunction(onFulfilled)) {\r\n                                resolve(onFulfilled(_this._value));\r\n                            }\r\n                            else {\r\n                                resolve(_this._value);\r\n                            }\r\n                        }\r\n                        catch (ex) {\r\n                            reject(ex);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n            case State.Rejected: {\r\n                return new TinyPromise(function (resolve, reject) {\r\n                    nextTick(function () {\r\n                        try {\r\n                            if (isFunction(onRejected)) {\r\n                                resolve(onRejected(_this._value));\r\n                            }\r\n                            else {\r\n                                reject(_this._value);\r\n                            }\r\n                        }\r\n                        catch (ex) {\r\n                            reject(ex);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    };\r\n    return TinyPromise;\r\n}());\r\nvar Promise$1 = (typeof Promise !== 'undefined' ? Promise : TinyPromise);\n\n// Webpack workaround to conditionally require certain external modules\r\n// only on the server and not bundle them on the client\r\nvar serverOnlyRequire;\r\ntry {\r\n    // tslint:disable-next-line:no-eval\r\n    serverOnlyRequire = eval('require');\r\n}\r\ncatch (err) {\r\n    // all good\r\n    serverOnlyRequire = (function () { return null; });\r\n}\r\nvar serverOnlyRequire$1 = serverOnlyRequire;\n\nfunction promiseResolve(value) {\r\n    return new Promise$1(function (resolve) { return resolve(value); });\r\n}\r\n// Adapted from https://raw.githubusercontent.com/developit/unfetch/master/src/index.mjs\r\nfunction tinyFetch(url, options) {\r\n    if (options === void 0) { options = {}; }\r\n    return new Promise$1(function (resolve, reject) {\r\n        var request = new XMLHttpRequest();\r\n        request.open(options.method || 'get', url, true);\r\n        if (options.headers) {\r\n            for (var i in options.headers) {\r\n                request.setRequestHeader(i, options.headers[i]);\r\n            }\r\n        }\r\n        request.withCredentials = options.credentials === 'include';\r\n        request.onload = function () {\r\n            resolve(response());\r\n        };\r\n        request.onerror = reject;\r\n        request.send(options.body);\r\n        function response() {\r\n            var keys = [];\r\n            var all = [];\r\n            var headers = {};\r\n            var header = undefined;\r\n            request\r\n                .getAllResponseHeaders()\r\n                .replace(/^(.*?):[^\\S\\n]*([\\s\\S]*?)$/gm, function (_match, _key, value) {\r\n                var key = _key;\r\n                keys.push((key = key.toLowerCase()));\r\n                all.push([key, value]);\r\n                header = headers[key];\r\n                headers[key] = header ? \"\".concat(header, \",\").concat(value) : value;\r\n                return '';\r\n            });\r\n            return {\r\n                ok: ((request.status / 100) | 0) === 2,\r\n                status: request.status,\r\n                statusText: request.statusText,\r\n                url: request.responseURL,\r\n                clone: response,\r\n                text: function () { return promiseResolve(request.responseText); },\r\n                json: function () { return promiseResolve(request.responseText).then(JSON.parse); },\r\n                blob: function () { return promiseResolve(new Blob([request.response])); },\r\n                headers: {\r\n                    keys: function () { return keys; },\r\n                    entries: function () { return all; },\r\n                    get: function (n) { return headers[n.toLowerCase()]; },\r\n                    has: function (n) { return n.toLowerCase() in headers; },\r\n                },\r\n            };\r\n        }\r\n    });\r\n}\r\nfunction getFetch() {\r\n    // If fetch is defined, in the browser, via polyfill, or in a Cloudflare worker, use it.\r\n    var _fetch = undefined;\r\n    if (globalThis.fetch) {\r\n        _fetch !== null && _fetch !== void 0 ? _fetch : (_fetch = globalThis.fetch);\r\n    }\r\n    else if (typeof window === 'undefined') {\r\n        // If fetch is not defined, in a Node.js environment, use node-fetch.\r\n        try {\r\n            // node-fetch@^3 is ESM only, and will throw error on require.\r\n            _fetch !== null && _fetch !== void 0 ? _fetch : (_fetch = serverOnlyRequire$1('node-fetch'));\r\n        }\r\n        catch (e) {\r\n            // If node-fetch is not installed, use tiny-fetch.\r\n            console.warn('node-fetch is not installed. consider polyfilling fetch or installing node-fetch.');\r\n            console.warn(e);\r\n        }\r\n    }\r\n    // Otherwise, use tiny-fetch.\r\n    return _fetch !== null && _fetch !== void 0 ? _fetch : tinyFetch;\r\n}\n\nfunction assign(target) {\r\n    var to = Object(target);\r\n    for (var index = 1; index < arguments.length; index++) {\r\n        var nextSource = arguments[index];\r\n        if (nextSource != null) {\r\n            // Skip over if undefined or null\r\n            for (var nextKey in nextSource) {\r\n                // Avoid bugs when hasOwnProperty is shadowed\r\n                if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n                    to[nextKey] = nextSource[nextKey];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return to;\r\n}\n\nfunction throttle(func, wait, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var context;\r\n    var args;\r\n    var result;\r\n    var timeout = null;\r\n    var previous = 0;\r\n    var later = function () {\r\n        previous = options.leading === false ? 0 : Date.now();\r\n        timeout = null;\r\n        result = func.apply(context, args);\r\n        if (!timeout)\r\n            context = args = null;\r\n    };\r\n    return function () {\r\n        var now = Date.now();\r\n        if (!previous && options.leading === false)\r\n            previous = now;\r\n        var remaining = wait - (now - previous);\r\n        context = this;\r\n        args = arguments;\r\n        if (remaining <= 0 || remaining > wait) {\r\n            if (timeout) {\r\n                clearTimeout(timeout);\r\n                timeout = null;\r\n            }\r\n            previous = now;\r\n            result = func.apply(context, args);\r\n            if (!timeout)\r\n                context = args = null;\r\n        }\r\n        else if (!timeout && options.trailing !== false) {\r\n            timeout = setTimeout(later, remaining);\r\n        }\r\n        return result;\r\n    };\r\n}\n\nvar camelCaseToKebabCase = function (str) {\r\n    return str ? str.replace(/([A-Z])/g, function (g) { return \"-\".concat(g[0].toLowerCase()); }) : '';\r\n};\r\nvar Animator = /** @class */ (function () {\r\n    function Animator() {\r\n    }\r\n    Animator.prototype.bindAnimations = function (animations) {\r\n        for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {\r\n            var animation = animations_1[_i];\r\n            switch (animation.trigger) {\r\n                case 'pageLoad':\r\n                    this.triggerAnimation(animation);\r\n                    break;\r\n                case 'hover':\r\n                    this.bindHoverAnimation(animation);\r\n                    break;\r\n                case 'scrollInView':\r\n                    this.bindScrollInViewAnimation(animation);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    Animator.prototype.warnElementNotPresent = function (id) {\r\n        console.warn(\"Cannot animate element: element with ID \".concat(id, \" not found!\"));\r\n    };\r\n    Animator.prototype.augmentAnimation = function (animation, element) {\r\n        var stylesUsed = this.getAllStylesUsed(animation);\r\n        var computedStyle = getComputedStyle(element);\r\n        // const computedStyle = getComputedStyle(element);\r\n        // // FIXME: this will break if original load is in one reponsive size then resize to another hmmm\r\n        // Need to use transform instead of left since left can change on screen sizes\r\n        var firstStyles = animation.steps[0].styles;\r\n        var lastStyles = animation.steps[animation.steps.length - 1].styles;\r\n        var bothStyles = [firstStyles, lastStyles];\r\n        // FIXME: this won't work as expected for augmented animations - may need the editor itself to manage this\r\n        for (var _i = 0, bothStyles_1 = bothStyles; _i < bothStyles_1.length; _i++) {\r\n            var styles = bothStyles_1[_i];\r\n            for (var _a = 0, stylesUsed_1 = stylesUsed; _a < stylesUsed_1.length; _a++) {\r\n                var style = stylesUsed_1[_a];\r\n                if (!(style in styles)) {\r\n                    styles[style] = computedStyle[style];\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Animator.prototype.getAllStylesUsed = function (animation) {\r\n        var properties = [];\r\n        for (var _i = 0, _a = animation.steps; _i < _a.length; _i++) {\r\n            var step = _a[_i];\r\n            for (var key in step.styles) {\r\n                if (properties.indexOf(key) === -1) {\r\n                    properties.push(key);\r\n                }\r\n            }\r\n        }\r\n        return properties;\r\n    };\r\n    Animator.prototype.triggerAnimation = function (animation) {\r\n        var _this = this;\r\n        // TODO: do for ALL elements\r\n        var elements = Array.prototype.slice.call(document.getElementsByClassName(animation.elementId || animation.id || ''));\r\n        if (!elements.length) {\r\n            this.warnElementNotPresent(animation.elementId || animation.id || '');\r\n            return;\r\n        }\r\n        Array.from(elements).forEach(function (element) {\r\n            _this.augmentAnimation(animation, element);\r\n            // TODO: do this properly, may have other animations of different properties\r\n            // TODO: only override the properties\r\n            // TODO: if there is an entrance and hover animation, the transition duration will get effed\r\n            // element.setAttribute('style', '');\r\n            // const styledUsed = this.getAllStylesUsed(animation);\r\n            element.style.transition = 'none';\r\n            element.style.transitionDelay = '0';\r\n            assign(element.style, animation.steps[0].styles);\r\n            // TODO: queue/batch these timeouts\r\n            // TODO: only include properties explicitly set in the animation\r\n            // using Object.keys(styles)\r\n            setTimeout(function () {\r\n                element.style.transition = \"all \".concat(animation.duration, \"s \").concat(camelCaseToKebabCase(animation.easing));\r\n                if (animation.delay) {\r\n                    element.style.transitionDelay = animation.delay + 's';\r\n                }\r\n                assign(element.style, animation.steps[1].styles);\r\n                // TODO: maybe remove/reset transitoin property after animation duration\r\n                // TODO: queue timers\r\n                setTimeout(function () {\r\n                    // TODO: what if has other transition (reset back to what it was)\r\n                    element.style.transition = '';\r\n                    element.style.transitionDelay = '';\r\n                }, (animation.delay || 0) * 1000 + animation.duration * 1000 + 100);\r\n            });\r\n        });\r\n    };\r\n    Animator.prototype.bindHoverAnimation = function (animation) {\r\n        var _this = this;\r\n        // TODO: is it multiple binding when editing...?\r\n        // TODO: unbind on element remove\r\n        // TODO: apply to ALL elements\r\n        var elements = Array.prototype.slice.call(document.getElementsByClassName(animation.elementId || animation.id || ''));\r\n        if (!elements.length) {\r\n            this.warnElementNotPresent(animation.elementId || animation.id || '');\r\n            return;\r\n        }\r\n        Array.from(elements).forEach(function (element) {\r\n            _this.augmentAnimation(animation, element);\r\n            var defaultState = animation.steps[0].styles;\r\n            var hoverState = animation.steps[1].styles;\r\n            function attachDefaultState() {\r\n                assign(element.style, defaultState);\r\n            }\r\n            function attachHoverState() {\r\n                assign(element.style, hoverState);\r\n            }\r\n            attachDefaultState();\r\n            element.addEventListener('mouseenter', attachHoverState);\r\n            element.addEventListener('mouseleave', attachDefaultState);\r\n            // TODO: queue/batch these timeouts\r\n            setTimeout(function () {\r\n                element.style.transition = \"all \".concat(animation.duration, \"s \").concat(camelCaseToKebabCase(animation.easing));\r\n                if (animation.delay) {\r\n                    element.style.transitionDelay = animation.delay + 's';\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // TODO: unbind on element remove\r\n    Animator.prototype.bindScrollInViewAnimation = function (animation) {\r\n        var _this = this;\r\n        // TODO: apply to ALL matching elements\r\n        var elements = Array.prototype.slice.call(document.getElementsByClassName(animation.elementId || animation.id || ''));\r\n        if (!elements.length) {\r\n            this.warnElementNotPresent(animation.elementId || animation.id || '');\r\n            return;\r\n        }\r\n        // TODO: if server side rendered and scrolled into view don't animate...\r\n        Array.from(elements).forEach(function (element) {\r\n            _this.augmentAnimation(animation, element);\r\n            var triggered = false;\r\n            var pendingAnimation = false;\r\n            function immediateOnScroll() {\r\n                if (!triggered && isScrolledIntoView(element)) {\r\n                    triggered = true;\r\n                    pendingAnimation = true;\r\n                    setTimeout(function () {\r\n                        assign(element.style, animation.steps[1].styles);\r\n                        if (!animation.repeat) {\r\n                            document.removeEventListener('scroll', onScroll);\r\n                        }\r\n                        setTimeout(function () {\r\n                            pendingAnimation = false;\r\n                            if (!animation.repeat) {\r\n                                element.style.transition = '';\r\n                                element.style.transitionDelay = '';\r\n                            }\r\n                        }, (animation.duration + (animation.delay || 0)) * 1000 + 100);\r\n                    });\r\n                }\r\n                else if (animation.repeat &&\r\n                    triggered &&\r\n                    !pendingAnimation &&\r\n                    !isScrolledIntoView(element)) {\r\n                    // we want to repeat the animation every time the the element is out of view and back again\r\n                    triggered = false;\r\n                    assign(element.style, animation.steps[0].styles);\r\n                }\r\n            }\r\n            // TODO: roll all of these in one for more efficiency of checking all the rects\r\n            var onScroll = throttle(immediateOnScroll, 200, { leading: false });\r\n            // TODO: fully in view or partially\r\n            function isScrolledIntoView(elem) {\r\n                var rect = elem.getBoundingClientRect();\r\n                var windowHeight = window.innerHeight;\r\n                var thresholdPercent = (animation.thresholdPercent || 0) / 100;\r\n                var threshold = thresholdPercent * windowHeight;\r\n                // TODO: partial in view? or what if element is larger than screen itself\r\n                return (rect.bottom > threshold && rect.top < windowHeight - threshold // Element is peeking top or bottom\r\n                // (rect.top > 0 && rect.bottom < window.innerHeight) || // element fits within the screen and is fully on screen (not hanging off at all)\r\n                // (rect.top < 0 && rect.bottom > window.innerHeight) // element is larger than the screen and hangs over the top and bottom\r\n                );\r\n            }\r\n            var defaultState = animation.steps[0].styles;\r\n            function attachDefaultState() {\r\n                assign(element.style, defaultState);\r\n            }\r\n            attachDefaultState();\r\n            // TODO: queue/batch these timeouts!\r\n            setTimeout(function () {\r\n                element.style.transition = \"all \".concat(animation.duration, \"s \").concat(camelCaseToKebabCase(animation.easing));\r\n                if (animation.delay) {\r\n                    element.style.transitionDelay = animation.delay + 's';\r\n                }\r\n            });\r\n            // TODO: one listener for everything\r\n            document.addEventListener('scroll', onScroll, { capture: true, passive: true });\r\n            // Do an initial check\r\n            immediateOnScroll();\r\n        });\r\n    };\r\n    return Animator;\r\n}());\n\n/**\r\n * Only gets one level up from hostname\r\n * wwww.example.com -> example.com\r\n * www.example.co.uk -> example.co.uk\r\n */\r\nfunction getTopLevelDomain(host) {\r\n    var parts = host.split('.');\r\n    if (parts.length > 2) {\r\n        return parts.slice(1).join('.');\r\n    }\r\n    return host;\r\n}\n\n/**\r\n * RegExp to match field-content in RFC 7230 sec 3.2\r\n *\r\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\r\n * field-vchar   = VCHAR / obs-text\r\n * obs-text      = %x80-FF\r\n */\r\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\r\nvar Cookies = /** @class */ (function () {\r\n    function Cookies(request, response) {\r\n        this.request = request;\r\n        this.response = response;\r\n    }\r\n    Cookies.prototype.get = function (name) {\r\n        var header = this.request.headers['cookie'];\r\n        if (!header) {\r\n            return;\r\n        }\r\n        var match = header.match(getPattern(name));\r\n        if (!match) {\r\n            return;\r\n        }\r\n        var value = match[1];\r\n        return value;\r\n    };\r\n    Cookies.prototype.set = function (name, value, opts) {\r\n        var res = this.response;\r\n        var req = this.request;\r\n        var headers = res.getHeader('Set-Cookie') || [];\r\n        // TODO: just make this always true\r\n        var secure = this.secure !== undefined\r\n            ? !!this.secure\r\n            : req.protocol === 'https' || req.connection.encrypted;\r\n        var cookie = new Cookie(name, value, opts);\r\n        if (typeof headers === 'string') {\r\n            headers = [headers];\r\n        }\r\n        if (!secure && opts && opts.secure) {\r\n            throw new Error('Cannot send secure cookie over unencrypted connection');\r\n        }\r\n        cookie.secure = secure;\r\n        if (opts && 'secure' in opts) {\r\n            cookie.secure = !!opts.secure;\r\n        }\r\n        cookie.domain = req.headers.host && getTopLevelDomain(req.headers.host);\r\n        pushCookie(headers, cookie);\r\n        var setHeader = res.setHeader;\r\n        setHeader.call(res, 'Set-Cookie', headers);\r\n        return this;\r\n    };\r\n    return Cookies;\r\n}());\r\nvar Cookie = /** @class */ (function () {\r\n    function Cookie(name, value, attrs) {\r\n        this.path = '/';\r\n        this.domain = undefined;\r\n        this.httpOnly = true;\r\n        this.sameSite = false;\r\n        this.secure = false;\r\n        this.overwrite = false;\r\n        this.name = '';\r\n        this.value = '';\r\n        if (!fieldContentRegExp.test(name)) {\r\n            throw new TypeError('argument name is invalid');\r\n        }\r\n        if (value && !fieldContentRegExp.test(value)) {\r\n            throw new TypeError('argument value is invalid');\r\n        }\r\n        if (!value) {\r\n            this.expires = new Date(0);\r\n        }\r\n        this.name = name;\r\n        this.value = value || '';\r\n        if (attrs.expires) {\r\n            this.expires = attrs.expires;\r\n        }\r\n        if (attrs.secure) {\r\n            this.secure = attrs.secure;\r\n        }\r\n    }\r\n    Cookie.prototype.toString = function () {\r\n        return \"\".concat(this.name, \"=\").concat(this.value);\r\n    };\r\n    Cookie.prototype.toHeader = function () {\r\n        var header = this.toString();\r\n        if (this.maxAge) {\r\n            this.expires = new Date(Date.now() + this.maxAge);\r\n        }\r\n        if (this.path) {\r\n            header += \"; path=\".concat(this.path);\r\n        }\r\n        if (this.expires) {\r\n            header += \"; expires=\".concat(this.expires.toUTCString());\r\n        }\r\n        if (this.domain) {\r\n            header += \"; domain=\".concat(this.domain);\r\n        }\r\n        // TODO: samesite=none by default (?)\r\n        header += \"; SameSite=\".concat(this.sameSite === true ? 'strict' : 'None');\r\n        // TODO: On by default\r\n        if (this.secure) {\r\n            header += '; secure';\r\n        }\r\n        if (this.httpOnly) {\r\n            header += '; httponly';\r\n        }\r\n        return header;\r\n    };\r\n    return Cookie;\r\n}());\r\nfunction getPattern(name) {\r\n    return new RegExp(\"(?:^|;) *\".concat(name.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&'), \"=([^;]*)\"));\r\n}\r\nfunction pushCookie(headers, cookie) {\r\n    if (cookie.overwrite) {\r\n        for (var i = headers.length - 1; i >= 0; i--) {\r\n            if (headers[i].indexOf(\"\".concat(cookie.name, \"=\")) === 0) {\r\n                headers.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    headers.push(cookie.toHeader());\r\n}\n\nfunction omit(obj) {\r\n    var values = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        values[_i - 1] = arguments[_i];\r\n    }\r\n    var newObject = Object.assign({}, obj);\r\n    for (var _a = 0, values_1 = values; _a < values_1.length; _a++) {\r\n        var key = values_1[_a];\r\n        delete newObject[key];\r\n    }\r\n    return newObject;\r\n}\n\n/**\r\n * @credit https://stackoverflow.com/a/2117523\r\n */\r\nfunction uuidv4() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n        var r = (Math.random() * 16) | 0, v = c == 'x' ? r : (r & 0x3) | 0x8;\r\n        return v.toString(16);\r\n    });\r\n}\r\n/**\r\n * Slightly cleaner and smaller UUIDs\r\n */\r\nfunction uuid() {\r\n    return uuidv4().replace(/-/g, '');\r\n}\n\nfunction emptyUrl() {\r\n    return {\r\n        query: null,\r\n        port: null,\r\n        auth: null,\r\n        hash: null,\r\n        host: null,\r\n        hostname: null,\r\n        href: null,\r\n        path: null,\r\n        pathname: null,\r\n        protocol: null,\r\n        search: null,\r\n        slashes: null,\r\n    };\r\n}\r\n// Replacement for `url.parse` using `URL` global object that works with relative paths.\r\n// Assumptions: this function operates in a NodeJS environment.\r\nfunction parse$1(url) {\r\n    var _a;\r\n    var out = emptyUrl();\r\n    var u;\r\n    var pathOnly = url === '' || url[0] === '/';\r\n    if (pathOnly) {\r\n        u = new URL(url, 'http://0.0.0.0/');\r\n        out.href = u.href;\r\n        out.href = (_a = out.href) === null || _a === void 0 ? void 0 : _a.slice(14); // remove 'http://0.0.0.0/'\r\n    }\r\n    else {\r\n        u = new URL(url);\r\n        out.href = u.href;\r\n        out.port = u.port === '' ? null : u.port;\r\n        out.hash = u.hash === '' ? null : u.hash;\r\n        out.host = u.host;\r\n        out.hostname = u.hostname;\r\n        out.href = u.href;\r\n        out.pathname = u.pathname;\r\n        out.protocol = u.protocol;\r\n        out.slashes = url[u.protocol.length] === '/'; // check if the mimetype is proceeded by a slash\r\n    }\r\n    out.search = u.search;\r\n    out.query = u.search.slice(1); // remove '?'\r\n    out.path = \"\".concat(u.pathname).concat(u.search);\r\n    out.pathname = u.pathname;\r\n    return out;\r\n}\n\n/**\r\n * Safe conversion to error type. Intended to be used in catch blocks where the\r\n *  value is not guaranteed to be an error.\r\n *\r\n *  @example\r\n *  try {\r\n *    throw new Error('Something went wrong')\r\n *  }\r\n *  catch (err: unknown) {\r\n *    const error: Error = toError(err)\r\n *  }\r\n */\r\nfunction toError(err) {\r\n    if (err instanceof Error)\r\n        return err;\r\n    return new Error(String(err));\r\n}\n\nvar DEFAULT_API_VERSION = 'v3';\n\nfunction datePlusMinutes(minutes) {\r\n    if (minutes === void 0) { minutes = 30; }\r\n    return new Date(Date.now() + minutes * 60000);\r\n}\r\nvar isPositiveNumber = function (thing) {\r\n    return typeof thing === 'number' && !isNaN(thing) && thing >= 0;\r\n};\r\nvar isReactNative = typeof navigator === 'object' && navigator.product === 'ReactNative';\r\nvar validEnvList = [\r\n    'production',\r\n    'qa',\r\n    'test',\r\n    'development',\r\n    'dev',\r\n    'cdn-qa',\r\n    'cloud',\r\n    'fast',\r\n    'cdn2',\r\n    'cdn-prod',\r\n];\r\nfunction getQueryParam(url, variable) {\r\n    var query = url.split('?')[1] || '';\r\n    var vars = query.split('&');\r\n    for (var i = 0; i < vars.length; i++) {\r\n        var pair = vars[i].split('=');\r\n        if (decodeURIComponent(pair[0]) === variable) {\r\n            return decodeURIComponent(pair[1]);\r\n        }\r\n    }\r\n    return null;\r\n}\r\nvar urlParser = {\r\n    parse: function (url) {\r\n        var el = document.createElement('a');\r\n        el.href = url;\r\n        var out = {};\r\n        var props = [\r\n            'username',\r\n            'password',\r\n            'host',\r\n            'hostname',\r\n            'port',\r\n            'protocol',\r\n            'origin',\r\n            'pathname',\r\n            'search',\r\n            'hash',\r\n        ];\r\n        for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\r\n            var prop = props_1[_i];\r\n            out[prop] = el[prop];\r\n        }\r\n        // IE 11 pathname handling workaround\r\n        // (IE omits preceeding '/', unlike other browsers)\r\n        if ((out.pathname || out.pathname === '') &&\r\n            typeof out.pathname === 'string' &&\r\n            out.pathname.indexOf('/') !== 0) {\r\n            out.pathname = '/' + out.pathname;\r\n        }\r\n        return out;\r\n    },\r\n};\r\nvar parse = isReactNative\r\n    ? function () { return emptyUrl(); }\r\n    : typeof window === 'object'\r\n        ? urlParser.parse\r\n        : parse$1;\r\nfunction setCookie(name, value, expires) {\r\n    try {\r\n        var expiresString = '';\r\n        // TODO: need to know if secure server side\r\n        if (expires) {\r\n            expiresString = '; expires=' + expires.toUTCString();\r\n        }\r\n        var secure = isBrowser ? location.protocol === 'https:' : true;\r\n        document.cookie =\r\n            name +\r\n                '=' +\r\n                (value || '') +\r\n                expiresString +\r\n                '; path=/' +\r\n                \"; domain=\".concat(getTopLevelDomain(location.hostname)) +\r\n                (secure ? '; secure; SameSite=None' : '');\r\n    }\r\n    catch (err) {\r\n        console.warn('Could not set cookie', err);\r\n    }\r\n}\r\nfunction getCookie(name) {\r\n    try {\r\n        return (decodeURIComponent(document.cookie.replace(new RegExp('(?:(?:^|.*;)\\\\s*' +\r\n            encodeURIComponent(name).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') +\r\n            '\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$'), '$1')) || null);\r\n    }\r\n    catch (err) {\r\n        console.warn('Could not get cookie', err);\r\n    }\r\n}\r\nfunction size(object) {\r\n    return Object.keys(object).length;\r\n}\r\nfunction find(target, callback) {\r\n    var list = target;\r\n    // Makes sures is always has an positive integer as length.\r\n    var length = list.length >>> 0;\r\n    var thisArg = arguments[1];\r\n    for (var i = 0; i < length; i++) {\r\n        var element = list[i];\r\n        if (callback.call(thisArg, element, i, list)) {\r\n            return element;\r\n        }\r\n    }\r\n}\r\nvar sessionStorageKey = 'builderSessionId';\r\nvar localStorageKey = 'builderVisitorId';\r\nvar isBrowser = typeof window !== 'undefined' && !isReactNative;\r\nvar isIframe = isBrowser && window.top !== window.self;\r\nfunction BuilderComponent(info) {\r\n    if (info === void 0) { info = {}; }\r\n    return Builder.Component(info);\r\n}\r\nvar Builder = /** @class */ (function () {\r\n    function Builder(apiKey, request, response, forceNewInstance, authToken, apiVersion) {\r\n        if (apiKey === void 0) { apiKey = null; }\r\n        if (forceNewInstance === void 0) { forceNewInstance = false; }\r\n        if (authToken === void 0) { authToken = null; }\r\n        var _this = this;\r\n        this.request = request;\r\n        this.response = response;\r\n        this.eventsQueue = [];\r\n        this.throttledClearEventsQueue = throttle(function () {\r\n            _this.processEventsQueue();\r\n            // Extend the session cookie\r\n            _this.setCookie(sessionStorageKey, _this.sessionId, datePlusMinutes(30));\r\n        }, 5);\r\n        this.env = 'production';\r\n        this.sessionId = this.getSessionId();\r\n        this.targetContent = true;\r\n        this.contentPerRequest = 1;\r\n        // TODO: make array or function\r\n        this.allowCustomFonts = true;\r\n        this.cookies = null;\r\n        // TODO: api options object\r\n        this.cachebust = false;\r\n        this.overrideParams = '';\r\n        this.noCache = false;\r\n        this.preview = false;\r\n        this.apiVersion$ = new BehaviorSubject(undefined);\r\n        this.canTrack$ = new BehaviorSubject(!this.browserTrackingDisabled);\r\n        this.apiKey$ = new BehaviorSubject(null);\r\n        this.authToken$ = new BehaviorSubject(null);\r\n        this.userAttributesChanged = new BehaviorSubject(null);\r\n        this.editingMode$ = new BehaviorSubject(isIframe);\r\n        // TODO: decorator to do this stuff with the get/set (how do with typing too? compiler?)\r\n        this.editingModel$ = new BehaviorSubject(null);\r\n        this.userAgent = (typeof navigator === 'object' && navigator.userAgent) || '';\r\n        this.trackingHooks = [];\r\n        // Set this to control the userId\r\n        // TODO: allow changing it mid session and updating existing data to be associated\r\n        // e.g. for when a user navigates and then logs in\r\n        this.visitorId = this.getVisitorId();\r\n        this.autoTrack = !Builder.isBrowser\r\n            ? false\r\n            : !this.isDevelopmentEnv &&\r\n                !(Builder.isBrowser && location.search.indexOf('builder.preview=') !== -1);\r\n        this.trackingUserAttributes = {};\r\n        this.blockContentLoading = '';\r\n        this.observersByKey = {};\r\n        this.noEditorUpdates = {};\r\n        this.overrides = {};\r\n        this.queryOptions = {};\r\n        this.getContentQueue = null;\r\n        this.priorContentQueue = null;\r\n        this.testCookiePrefix = 'builder.tests';\r\n        this.cookieQueue = [];\r\n        // TODO: use a window variable for this perhaps, e.g. bc webcomponents may be loading builder twice\r\n        // with it's and react (use rollup build to fix)\r\n        if (Builder.isBrowser && !forceNewInstance && Builder.singletonInstance) {\r\n            return Builder.singletonInstance;\r\n        }\r\n        if (this.request && this.response) {\r\n            this.setUserAgent(this.request.headers['user-agent'] || '');\r\n            this.cookies = new Cookies(this.request, this.response);\r\n        }\r\n        if (apiKey) {\r\n            this.apiKey = apiKey;\r\n        }\r\n        if (apiVersion) {\r\n            this.apiVersion = apiVersion;\r\n        }\r\n        if (authToken) {\r\n            this.authToken = authToken;\r\n        }\r\n        if (isBrowser) {\r\n            this.bindMessageListeners();\r\n            if (Builder.isEditing) {\r\n                parent.postMessage({\r\n                    type: 'builder.animatorOptions',\r\n                    data: {\r\n                        options: {\r\n                            version: 2,\r\n                        },\r\n                    },\r\n                }, '*');\r\n            }\r\n            // TODO: postmessage to parent the builder info for every package\r\n            // type: 'builder.sdk', data: { name: '@builder.io/react', version: '0.1.23' }\r\n            // (window as any).BUILDER_VERSION = Builder.VERSION;\r\n            // Ensure always one Builder global singleton\r\n            // TODO: some people won't want this, e.g. rakuten\r\n            // Maybe hide this behind symbol or on document, etc\r\n            // if ((window as any).Builder) {\r\n            //   Builder.components = (window as any).Builder.components;\r\n            // } else {\r\n            //   (window as any).Builder = Builder;\r\n            // }\r\n        }\r\n        if (isIframe) {\r\n            this.messageFrameLoaded();\r\n        }\r\n        // TODO: on destroy clear subscription\r\n        this.canTrack$.subscribe(function (value) {\r\n            if (value) {\r\n                if (typeof sessionStorage !== 'undefined') {\r\n                    try {\r\n                        if (!sessionStorage.getItem(sessionStorageKey)) {\r\n                            sessionStorage.setItem(sessionStorageKey, _this.sessionId);\r\n                        }\r\n                    }\r\n                    catch (err) {\r\n                        console.debug('Session storage error', err);\r\n                    }\r\n                }\r\n                if (_this.eventsQueue.length) {\r\n                    _this.throttledClearEventsQueue();\r\n                }\r\n                if (_this.cookieQueue.length) {\r\n                    _this.cookieQueue.forEach(function (item) {\r\n                        _this.setCookie(item[0], item[1]);\r\n                    });\r\n                    _this.cookieQueue.length = 0;\r\n                }\r\n            }\r\n        });\r\n        if (isBrowser) {\r\n            // TODO: defer so subclass constructor runs and injects location service\r\n            this.setTestsFromUrl();\r\n            // TODO: do this on every request send?\r\n            this.getOverridesFromQueryString();\r\n        }\r\n    }\r\n    Builder.register = function (type, info) {\r\n        // TODO: all must have name and can't conflict?\r\n        var typeList = this.registry[type];\r\n        if (!typeList) {\r\n            typeList = this.registry[type] = [];\r\n        }\r\n        typeList.push(info);\r\n        if (Builder.isBrowser) {\r\n            var message = {\r\n                type: 'builder.register',\r\n                data: {\r\n                    type: type,\r\n                    info: info,\r\n                },\r\n            };\r\n            try {\r\n                parent.postMessage(message, '*');\r\n                if (parent !== window) {\r\n                    window.postMessage(message, '*');\r\n                }\r\n            }\r\n            catch (err) {\r\n                console.debug('Could not postmessage', err);\r\n            }\r\n        }\r\n        this.registryChange.next(this.registry);\r\n    };\r\n    Builder.registerEditor = function (info) {\r\n        if (Builder.isBrowser) {\r\n            window.postMessage({\r\n                type: 'builder.registerEditor',\r\n                data: omit(info, 'component'),\r\n            }, '*');\r\n            var hostname = location.hostname;\r\n            if (!Builder.isTrustedHost(hostname)) {\r\n                console.error('Builder.registerEditor() called in the wrong environment! You cannot load custom editors from your app, they must be loaded through the Builder.io app itself. Follow the readme here for more details: https://github.com/builderio/builder/tree/master/plugins/cloudinary or contact chat us in our Spectrum community for help: https://spectrum.chat/builder');\r\n            }\r\n        }\r\n        this.editors.push(info);\r\n    };\r\n    Builder.registerPlugin = function (info) {\r\n        this.plugins.push(info);\r\n    };\r\n    Builder.registerAction = function (action) {\r\n        this.actions.push(action);\r\n    };\r\n    Builder.registerTrustedHost = function (host) {\r\n        this.trustedHosts.push(host);\r\n    };\r\n    /**\r\n     * @param context @type {import('isolated-vm').Context}\r\n     * Use this function to control the execution context of custom code on the server.\r\n     * const ivm = require('isolated-vm');\r\n     * const isolate = new ivm.Isolate({ memoryLimit: 128 });\r\n     * const context = isolate.createContextSync();\r\n     * Builder.setServerContext(context);\r\n     */\r\n    Builder.setServerContext = function (context) {\r\n        this.serverContext = context;\r\n    };\r\n    Builder.isTrustedHost = function (hostname) {\r\n        return (this.trustedHosts.findIndex(function (trustedHost) {\r\n            return trustedHost.startsWith('*.')\r\n                ? hostname.endsWith(trustedHost.slice(1))\r\n                : trustedHost === hostname;\r\n        }) > -1);\r\n    };\r\n    Builder.runAction = function (action) {\r\n        // TODO\r\n        var actionObject = typeof action === 'string' ? find(this.actions, function (item) { return item.name === action; }) : action;\r\n        if (!actionObject) {\r\n            throw new Error(\"Action not found: \".concat(action));\r\n        }\r\n    };\r\n    Builder.fields = function (name, fields) {\r\n        var _a;\r\n        (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n            type: 'builder.fields',\r\n            data: { name: name, fields: fields },\r\n        }, '*');\r\n    };\r\n    /**\r\n     * @deprecated\r\n     * @hidden\r\n     *\r\n     * Use Builder.register('editor.settings', {}) instead.\r\n     */\r\n    Builder.set = function (settings) {\r\n        Builder.register('editor.settings', settings);\r\n    };\r\n    Builder.import = function (packageName) {\r\n        if (!Builder.isBrowser) {\r\n            // TODO: server side support *maybe*\r\n            console.warn('Builder.import used on the server - this should only be used in the browser');\r\n            return;\r\n        }\r\n        var System = window.System;\r\n        if (!System) {\r\n            console.warn('System.js not available. Please include System.js when using Builder.import');\r\n            return;\r\n        }\r\n        return System.import(\"https://cdn.builder.io/systemjs/\".concat(packageName));\r\n    };\r\n    Object.defineProperty(Builder, \"editingPage\", {\r\n        // useCdnApi = false;\r\n        get: function () {\r\n            return this._editingPage;\r\n        },\r\n        set: function (editingPage) {\r\n            this._editingPage = editingPage;\r\n            if (isBrowser && isIframe) {\r\n                if (editingPage) {\r\n                    document.body.classList.add('builder-editing-page');\r\n                }\r\n                else {\r\n                    document.body.classList.remove('builder-editing-page');\r\n                }\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prepareComponentSpecToSend = function (spec) {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, spec), (spec.inputs && {\r\n            inputs: spec.inputs.map(function (input) {\r\n                var _a;\r\n                // TODO: do for nexted fields too\r\n                // TODO: probably just convert all functions, not just\r\n                // TODO: put this in input hooks: { onChange: ..., showIf: ... }\r\n                var keysToConvertFnToString = ['onChange', 'showIf'];\r\n                for (var _i = 0, keysToConvertFnToString_1 = keysToConvertFnToString; _i < keysToConvertFnToString_1.length; _i++) {\r\n                    var key = keysToConvertFnToString_1[_i];\r\n                    if (input[key] && typeof input[key] === 'function') {\r\n                        var fn = input[key];\r\n                        input = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, input), (_a = {}, _a[key] = \"return (\".concat(fn.toString(), \").apply(this, arguments)\"), _a));\r\n                    }\r\n                }\r\n                return input;\r\n            }),\r\n        })), { hooks: Object.keys(spec.hooks || {}).reduce(function (memo, key) {\r\n                var value = spec.hooks && spec.hooks[key];\r\n                if (!value) {\r\n                    return memo;\r\n                }\r\n                if (typeof value === 'string') {\r\n                    memo[key] = value;\r\n                }\r\n                else {\r\n                    memo[key] = \"return (\".concat(value.toString(), \").apply(this, arguments)\");\r\n                }\r\n                return memo;\r\n            }, {}), class: undefined });\r\n    };\r\n    Builder.registerBlock = function (component, options) {\r\n        this.registerComponent(component, options);\r\n    };\r\n    Builder.registerComponent = function (component, options) {\r\n        var _a;\r\n        var spec = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ class: component }, component.builderOptions), options);\r\n        this.addComponent(spec);\r\n        var editable = options.models && this.singletonInstance.editingModel\r\n            ? isBrowser && options.models.includes(this.singletonInstance.editingModel)\r\n            : isBrowser;\r\n        if (editable) {\r\n            var sendSpec = this.prepareComponentSpecToSend(spec);\r\n            (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n                type: 'builder.registerComponent',\r\n                data: sendSpec,\r\n            }, '*');\r\n        }\r\n    };\r\n    Builder.addComponent = function (component) {\r\n        var current = find(this.components, function (item) { return item.name === component.name; });\r\n        if (current) {\r\n            // FIXME: why does sometimes we get an extra post without class - probably\r\n            // from postMessage handler wrong in some place\r\n            if (current.class && !component.class) {\r\n                return;\r\n            }\r\n            this.components.splice(this.components.indexOf(current), 1, component);\r\n        }\r\n        else {\r\n            this.components.push(component);\r\n        }\r\n    };\r\n    // TODO: style guide, etc off this system as well?\r\n    Builder.component = function (info) {\r\n        var _this = this;\r\n        if (info === void 0) { info = {}; }\r\n        return function (component) {\r\n            var _a;\r\n            var spec = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, info), { class: component });\r\n            if (!spec.name) {\r\n                spec.name = component.name;\r\n            }\r\n            _this.addComponent(spec);\r\n            var sendSpec = _this.prepareComponentSpecToSend(spec);\r\n            // TODO: serialize component name and inputs\r\n            if (isBrowser) {\r\n                (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n                    type: 'builder.registerComponent',\r\n                    data: sendSpec,\r\n                }, '*');\r\n            }\r\n            return component;\r\n        };\r\n    };\r\n    Object.defineProperty(Builder, \"Component\", {\r\n        get: function () {\r\n            return this.component;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.processEventsQueue = function () {\r\n        if (!this.eventsQueue.length) {\r\n            return;\r\n        }\r\n        var events = this.eventsQueue;\r\n        this.eventsQueue = [];\r\n        var fullUserAttributes = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, Builder.overrideUserAttributes), this.trackingUserAttributes);\r\n        for (var _i = 0, events_1 = events; _i < events_1.length; _i++) {\r\n            var event_1 = events_1[_i];\r\n            if (!event_1.data.metadata) {\r\n                event_1.data.metadata = {};\r\n            }\r\n            if (!event_1.data.metadata.user) {\r\n                event_1.data.metadata.user = {};\r\n            }\r\n            Object.assign(event_1.data.metadata.user, fullUserAttributes, event_1.data.metadata.user);\r\n        }\r\n        var host = this.host;\r\n        getFetch()(\"\".concat(host, \"/api/v1/track\"), {\r\n            method: 'POST',\r\n            body: JSON.stringify({ events: events }),\r\n            headers: {\r\n                'content-type': 'application/json',\r\n            },\r\n            mode: 'cors',\r\n        }).catch(function () {\r\n            // Not the end of the world\r\n        });\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"browserTrackingDisabled\", {\r\n        get: function () {\r\n            return Builder.isBrowser && Boolean(window.builderNoTrack || !navigator.cookieEnabled);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"canTrack\", {\r\n        get: function () {\r\n            return this.canTrack$.value;\r\n        },\r\n        set: function (canTrack) {\r\n            if (this.canTrack !== canTrack) {\r\n                this.canTrack$.next(canTrack);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"apiVersion\", {\r\n        get: function () {\r\n            return this.apiVersion$.value;\r\n        },\r\n        set: function (apiVersion) {\r\n            if (this.apiVersion !== apiVersion) {\r\n                this.apiVersion$.next(apiVersion);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"editingMode\", {\r\n        get: function () {\r\n            return this.editingMode$.value;\r\n        },\r\n        set: function (value) {\r\n            if (value !== this.editingMode) {\r\n                this.editingMode$.next(value);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"editingModel\", {\r\n        get: function () {\r\n            return this.editingModel$.value;\r\n        },\r\n        set: function (value) {\r\n            if (value !== this.editingModel) {\r\n                this.editingModel$.next(value);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.findParentElement = function (target, callback, checkElement) {\r\n        if (checkElement === void 0) { checkElement = true; }\r\n        if (!(target instanceof HTMLElement)) {\r\n            return null;\r\n        }\r\n        var parent = checkElement ? target : target.parentElement;\r\n        do {\r\n            if (!parent) {\r\n                return null;\r\n            }\r\n            var matches = callback(parent);\r\n            if (matches) {\r\n                return parent;\r\n            }\r\n        } while ((parent = parent.parentElement));\r\n        return null;\r\n    };\r\n    Builder.prototype.findBuilderParent = function (target) {\r\n        return this.findParentElement(target, function (el) {\r\n            var id = el.getAttribute('builder-id') || el.id;\r\n            return Boolean(id && id.indexOf('builder-') === 0);\r\n        });\r\n    };\r\n    Builder.prototype.setUserAgent = function (userAgent) {\r\n        this.userAgent = userAgent || '';\r\n    };\r\n    /**\r\n     * Set a hook to modify events being tracked from builder, such as impressions and clicks\r\n     *\r\n     * For example, to track the model ID of each event associated with content for querying\r\n     * by mode, you can do\r\n     *\r\n     *    builder.setTrackingHook((event, context) => {\r\n     *      if (context.content) {\r\n     *        event.data.metadata.modelId = context.content.modelId\r\n     *      }\r\n     *    })\r\n     */\r\n    Builder.prototype.setTrackingHook = function (hook) {\r\n        this.trackingHooks.push(hook);\r\n    };\r\n    Builder.prototype.track = function (eventName, properties, context) {\r\n        if (properties === void 0) { properties = {}; }\r\n        // TODO: queue up track requests and fire them off when canTrack set to true - otherwise may get lots of clicks with no impressions\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        var apiKey = this.apiKey;\r\n        if (!apiKey) {\r\n            console.error('Builder integration error: Looks like the Builder SDK has not been initialized properly (your API key has not been set). Make sure you are calling `builder.init(\"YOUR-API-KEY\");` as early as possible in your application\\'s code.');\r\n            return;\r\n        }\r\n        var eventData = JSON.parse(JSON.stringify({\r\n            type: eventName,\r\n            data: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, omit(properties, 'meta')), { metadata: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ sdkVersion: Builder.VERSION, url: location.href }, properties.meta), properties.metadata), ownerId: apiKey, userAttributes: this.getUserAttributes(), sessionId: this.sessionId, visitorId: this.visitorId }),\r\n        }));\r\n        for (var _i = 0, _a = this.trackingHooks; _i < _a.length; _i++) {\r\n            var hook = _a[_i];\r\n            var returnValue = hook(eventData, context || {});\r\n            if (returnValue) {\r\n                eventData = returnValue;\r\n            }\r\n        }\r\n        // batch events\r\n        this.eventsQueue.push(eventData);\r\n        if (this.canTrack) {\r\n            this.throttledClearEventsQueue();\r\n        }\r\n    };\r\n    Builder.prototype.getSessionId = function () {\r\n        var _this = this;\r\n        var sessionId = null;\r\n        try {\r\n            if (Builder.isBrowser && typeof sessionStorage !== 'undefined') {\r\n                sessionId = this.getCookie(sessionStorageKey);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.debug('Session storage error', err);\r\n            // It's ok\r\n        }\r\n        if (!sessionId) {\r\n            sessionId = uuid();\r\n        }\r\n        // Give the app a second to start up and set canTrack to false if needed\r\n        if (Builder.isBrowser) {\r\n            setTimeout(function () {\r\n                try {\r\n                    if (_this.canTrack) {\r\n                        _this.setCookie(sessionStorageKey, sessionId, datePlusMinutes(30));\r\n                    }\r\n                }\r\n                catch (err) {\r\n                    console.debug('Cookie setting error', err);\r\n                }\r\n            });\r\n        }\r\n        return sessionId;\r\n    };\r\n    Builder.prototype.getVisitorId = function () {\r\n        var _this = this;\r\n        if (this.visitorId) {\r\n            return this.visitorId;\r\n        }\r\n        var visitorId = null;\r\n        try {\r\n            if (Builder.isBrowser && typeof localStorage !== 'undefined') {\r\n                // TODO: cookie instead?\r\n                visitorId = localStorage.getItem(localStorageKey);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.debug('Local storage error', err);\r\n            // It's ok\r\n        }\r\n        if (!visitorId) {\r\n            visitorId = uuid();\r\n        }\r\n        this.visitorId = visitorId;\r\n        // Give the app a second to start up and set canTrack to false if needed\r\n        if (Builder.isBrowser) {\r\n            setTimeout(function () {\r\n                try {\r\n                    if (_this.canTrack && typeof localStorage !== 'undefined' && visitorId) {\r\n                        localStorage.setItem(localStorageKey, visitorId);\r\n                    }\r\n                }\r\n                catch (err) {\r\n                    console.debug('Session storage error', err);\r\n                }\r\n            });\r\n        }\r\n        return visitorId;\r\n    };\r\n    Builder.prototype.trackImpression = function (contentId, variationId, properties, context) {\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        // TODO: use this.track method\r\n        this.track('impression', {\r\n            contentId: contentId,\r\n            variationId: variationId !== contentId ? variationId : undefined,\r\n            metadata: properties,\r\n        }, context);\r\n    };\r\n    Builder.prototype.trackConversion = function (amount, contentId, variationId, customProperties, context) {\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        var meta = typeof contentId === 'object' ? contentId : customProperties;\r\n        var useContentId = typeof contentId === 'string' ? contentId : undefined;\r\n        this.track('conversion', { amount: amount, variationId: variationId, meta: meta, contentId: useContentId }, context);\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"isDevelopmentEnv\", {\r\n        // TODO: set this for QA\r\n        get: function () {\r\n            // Automatic determining of development environment\r\n            return (Builder.isIframe ||\r\n                (Builder.isBrowser && (location.hostname === 'localhost' || location.port !== '')) ||\r\n                this.env !== 'production');\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.trackInteraction = function (contentId, variationId, alreadyTrackedOne, event, context) {\r\n        if (alreadyTrackedOne === void 0) { alreadyTrackedOne = false; }\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        var target = event && event.target;\r\n        var targetBuilderElement = target && this.findBuilderParent(target);\r\n        function round(num) {\r\n            return Math.round(num * 1000) / 1000;\r\n        }\r\n        var metadata = {};\r\n        if (event) {\r\n            var clientX = event.clientX, clientY = event.clientY;\r\n            if (target) {\r\n                var targetRect = target.getBoundingClientRect();\r\n                var xOffset = clientX - targetRect.left;\r\n                var yOffset = clientY - targetRect.top;\r\n                var xRatio = round(xOffset / targetRect.width);\r\n                var yRatio = round(yOffset / targetRect.height);\r\n                metadata.targetOffset = {\r\n                    x: xRatio,\r\n                    y: yRatio,\r\n                };\r\n            }\r\n            if (targetBuilderElement) {\r\n                var targetRect = targetBuilderElement.getBoundingClientRect();\r\n                var xOffset = clientX - targetRect.left;\r\n                var yOffset = clientY - targetRect.top;\r\n                var xRatio = round(xOffset / targetRect.width);\r\n                var yRatio = round(yOffset / targetRect.height);\r\n                metadata.builderTargetOffset = {\r\n                    x: xRatio,\r\n                    y: yRatio,\r\n                };\r\n            }\r\n        }\r\n        var builderId = targetBuilderElement &&\r\n            (targetBuilderElement.getAttribute('builder-id') || targetBuilderElement.id);\r\n        if (builderId && targetBuilderElement) {\r\n            metadata.builderElementIndex = [].slice\r\n                .call(document.getElementsByClassName(builderId))\r\n                .indexOf(targetBuilderElement);\r\n        }\r\n        this.track('click', {\r\n            contentId: contentId,\r\n            metadata: metadata,\r\n            variationId: variationId !== contentId ? variationId : undefined,\r\n            unique: !alreadyTrackedOne,\r\n            targetBuilderElement: builderId || undefined,\r\n        }, context);\r\n    };\r\n    Builder.prototype.component = function (info) {\r\n        if (info === void 0) { info = {}; }\r\n        return Builder.component(info);\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"apiKey\", {\r\n        get: function () {\r\n            return this.apiKey$.value;\r\n        },\r\n        set: function (key) {\r\n            this.apiKey$.next(key);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"authToken\", {\r\n        get: function () {\r\n            return this.authToken$.value;\r\n        },\r\n        set: function (token) {\r\n            this.authToken$.next(token);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.modifySearch = function (search) {\r\n        return search.replace(/(^|&|\\?)(builder_.*?)=/gi, function (_match, group1, group2) { return group1 + group2.replace(/_/g, '.') + '='; });\r\n    };\r\n    Builder.prototype.setTestsFromUrl = function () {\r\n        var search = this.getLocation().search;\r\n        var params = QueryString.parseDeep(this.modifySearch(search || '').substr(1));\r\n        var tests = params.builder && params.builder.tests;\r\n        if (tests && typeof tests === 'object') {\r\n            for (var key in tests) {\r\n                if (tests.hasOwnProperty(key)) {\r\n                    this.setTestCookie(key, tests[key]);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Builder.prototype.resetOverrides = function () {\r\n        // Ugly - pass down instances per request instead using react context\r\n        // or use builder.get('foo', { req, res }) in react...........\r\n        Builder.overrideUserAttributes = {};\r\n        this.cachebust = false;\r\n        this.noCache = false;\r\n        this.preview = false;\r\n        this.editingModel = null;\r\n        this.overrides = {};\r\n        this.env = 'production';\r\n        this.userAgent = '';\r\n        this.request = undefined;\r\n        this.response = undefined;\r\n    };\r\n    Builder.prototype.getOverridesFromQueryString = function () {\r\n        var location = this.getLocation();\r\n        var params = QueryString.parseDeep(this.modifySearch(location.search || '').substr(1));\r\n        var builder = params.builder;\r\n        if (builder) {\r\n            var userAttributes = builder.userAttributes, overrides = builder.overrides, env = builder.env; builder.host; var api = builder.api, cachebust = builder.cachebust, noCache = builder.noCache, preview = builder.preview, editing = builder.editing, frameEditing = builder.frameEditing, options = builder.options, overrideParams = builder.params;\r\n            if (userAttributes) {\r\n                this.setUserAttributes(userAttributes);\r\n            }\r\n            if (options) {\r\n                // picking only locale, includeRefs, and enrich for now\r\n                this.queryOptions = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, (options.locale && { locale: options.locale })), (options.includeRefs && { includeRefs: options.includeRefs })), (options.enrich && { enrich: options.enrich }));\r\n            }\r\n            if (overrides) {\r\n                this.overrides = overrides;\r\n            }\r\n            if (validEnvList.indexOf(env || api) > -1) {\r\n                this.env = env || api;\r\n            }\r\n            if (Builder.isEditing) {\r\n                var editingModel = frameEditing || editing || preview;\r\n                if (editingModel && editingModel !== 'true') {\r\n                    this.editingModel = editingModel;\r\n                }\r\n            }\r\n            if (cachebust) {\r\n                this.cachebust = true;\r\n            }\r\n            if (noCache) {\r\n                this.noCache = true;\r\n            }\r\n            if (preview) {\r\n                this.preview = true;\r\n            }\r\n            if (params) {\r\n                this.overrideParams = overrideParams;\r\n            }\r\n        }\r\n    };\r\n    Builder.prototype.messageFrameLoaded = function () {\r\n        var _a;\r\n        (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n            type: 'builder.loaded',\r\n            data: {\r\n                value: true,\r\n            },\r\n        }, '*');\r\n    };\r\n    Builder.prototype.bindMessageListeners = function () {\r\n        var _this = this;\r\n        if (isBrowser) {\r\n            addEventListener('message', function (event) {\r\n                var _a, _b, _c, _d, _e;\r\n                var url = parse(event.origin);\r\n                var isRestricted = ['builder.register', 'builder.registerComponent'].indexOf((_a = event.data) === null || _a === void 0 ? void 0 : _a.type) === -1;\r\n                var isTrusted = url.hostname && Builder.isTrustedHost(url.hostname);\r\n                if (isRestricted && !isTrusted) {\r\n                    return;\r\n                }\r\n                var data = event.data;\r\n                if (data) {\r\n                    switch (data.type) {\r\n                        case 'builder.ping': {\r\n                            (_b = window.parent) === null || _b === void 0 ? void 0 : _b.postMessage({\r\n                                type: 'builder.pong',\r\n                                data: {},\r\n                            }, '*');\r\n                            break;\r\n                        }\r\n                        case 'builder.register': {\r\n                            // TODO: possibly do this for all...\r\n                            if (event.source === window) {\r\n                                break;\r\n                            }\r\n                            var options = data.data;\r\n                            if (!options) {\r\n                                break;\r\n                            }\r\n                            var type = options.type, info = options.info;\r\n                            // TODO: all must have name and can't conflict?\r\n                            var typeList = Builder.registry[type];\r\n                            if (!typeList) {\r\n                                typeList = Builder.registry[type] = [];\r\n                            }\r\n                            typeList.push(info);\r\n                            Builder.registryChange.next(Builder.registry);\r\n                            break;\r\n                        }\r\n                        case 'builder.settingsChange': {\r\n                            // TODO: possibly do this for all...\r\n                            if (event.source === window) {\r\n                                break;\r\n                            }\r\n                            var settings = data.data;\r\n                            if (!settings) {\r\n                                break;\r\n                            }\r\n                            Object.assign(Builder.settings, settings);\r\n                            Builder.settingsChange.next(Builder.settings);\r\n                            break;\r\n                        }\r\n                        case 'builder.registerEditor': {\r\n                            // TODO: possibly do this for all...\r\n                            if (event.source === window) {\r\n                                break;\r\n                            }\r\n                            var info_1 = data.data;\r\n                            if (!info_1) {\r\n                                break;\r\n                            }\r\n                            var hasComponent_1 = !!info_1.component;\r\n                            Builder.editors.every(function (thisInfo, index) {\r\n                                if (info_1.name === thisInfo.name) {\r\n                                    if (thisInfo.component && !hasComponent_1) {\r\n                                        return false;\r\n                                    }\r\n                                    else {\r\n                                        Builder.editors[index] = thisInfo;\r\n                                    }\r\n                                    return false;\r\n                                }\r\n                                return true;\r\n                            });\r\n                            break;\r\n                        }\r\n                        case 'builder.triggerAnimation': {\r\n                            Builder.animator.triggerAnimation(data.data);\r\n                            break;\r\n                        }\r\n                        case 'builder.contentUpdate':\r\n                            var key = data.data.key || data.data.alias || data.data.entry || data.data.modelName;\r\n                            var contentData = data.data.data; // hmmm...\r\n                            var observer = _this.observersByKey[key];\r\n                            if (observer && !_this.noEditorUpdates[key]) {\r\n                                observer.next([contentData]);\r\n                            }\r\n                            break;\r\n                        case 'builder.getComponents':\r\n                            (_c = window.parent) === null || _c === void 0 ? void 0 : _c.postMessage({\r\n                                type: 'builder.components',\r\n                                data: Builder.components.map(function (item) { return Builder.prepareComponentSpecToSend(item); }),\r\n                            }, '*');\r\n                            break;\r\n                        case 'builder.editingModel':\r\n                            _this.editingModel = data.data.model;\r\n                            break;\r\n                        case 'builder.registerComponent':\r\n                            var componentData = data.data;\r\n                            Builder.addComponent(componentData);\r\n                            break;\r\n                        case 'builder.blockContentLoading':\r\n                            if (typeof data.data.model === 'string') {\r\n                                _this.blockContentLoading = data.data.model;\r\n                            }\r\n                            break;\r\n                        case 'builder.editingMode':\r\n                            var editingMode = data.data;\r\n                            if (editingMode) {\r\n                                _this.editingMode = true;\r\n                                document.body.classList.add('builder-editing');\r\n                            }\r\n                            else {\r\n                                _this.editingMode = false;\r\n                                document.body.classList.remove('builder-editing');\r\n                            }\r\n                            break;\r\n                        case 'builder.editingPageMode':\r\n                            var editingPageMode = data.data;\r\n                            Builder.editingPage = editingPageMode;\r\n                            break;\r\n                        case 'builder.overrideUserAttributes':\r\n                            var userAttributes = data.data;\r\n                            assign(Builder.overrideUserAttributes, userAttributes);\r\n                            _this.flushGetContentQueue(true);\r\n                            // TODO: refetch too\r\n                            break;\r\n                        case 'builder.overrideTestGroup':\r\n                            var _f = data.data, variationId = _f.variationId, contentId = _f.contentId;\r\n                            if (variationId && contentId) {\r\n                                _this.setTestCookie(contentId, variationId);\r\n                                _this.flushGetContentQueue(true);\r\n                            }\r\n                            break;\r\n                        case 'builder.evaluate': {\r\n                            var text = data.data.text;\r\n                            var args = data.data.arguments || [];\r\n                            var id_1 = data.data.id;\r\n                            // tslint:disable-next-line:no-function-constructor-with-string-args\r\n                            var fn = new Function(text);\r\n                            var result = void 0;\r\n                            var error = null;\r\n                            try {\r\n                                result = fn.apply(_this, args);\r\n                            }\r\n                            catch (err) {\r\n                                error = toError(err);\r\n                            }\r\n                            if (error) {\r\n                                (_d = window.parent) === null || _d === void 0 ? void 0 : _d.postMessage({\r\n                                    type: 'builder.evaluateError',\r\n                                    data: { id: id_1, error: error.message },\r\n                                }, '*');\r\n                            }\r\n                            else {\r\n                                if (result && typeof result.then === 'function') {\r\n                                    result\r\n                                        .then(function (finalResult) {\r\n                                        var _a;\r\n                                        (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n                                            type: 'builder.evaluateResult',\r\n                                            data: { id: id_1, result: finalResult },\r\n                                        }, '*');\r\n                                    })\r\n                                        .catch(console.error);\r\n                                }\r\n                                else {\r\n                                    (_e = window.parent) === null || _e === void 0 ? void 0 : _e.postMessage({\r\n                                        type: 'builder.evaluateResult',\r\n                                        data: { result: result, id: id_1 },\r\n                                    }, '*');\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"defaultCanTrack\", {\r\n        get: function () {\r\n            return Boolean(Builder.isBrowser &&\r\n                navigator.userAgent.trim() &&\r\n                !navigator.userAgent.match(/bot|crawler|spider|robot|crawling|prerender|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex|phantom|headless|selenium|puppeteer/i) &&\r\n                !this.browserTrackingDisabled);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.init = function (apiKey, canTrack, req, res, authToken, apiVersion) {\r\n        if (canTrack === void 0) { canTrack = this.defaultCanTrack; }\r\n        if (req) {\r\n            this.request = req;\r\n        }\r\n        if (res) {\r\n            this.response = res;\r\n        }\r\n        this.canTrack = canTrack;\r\n        this.apiKey = apiKey;\r\n        if (authToken) {\r\n            this.authToken = authToken;\r\n        }\r\n        if (apiVersion) {\r\n            this.apiVersion = apiVersion;\r\n        }\r\n        return this;\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"previewingModel\", {\r\n        get: function () {\r\n            var search = this.getLocation().search;\r\n            var params = QueryString.parse((search || '').substr(1));\r\n            return params['builder.preview'];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    // TODO: allow adding location object as property and/or in constructor\r\n    Builder.prototype.getLocation = function () {\r\n        var _a;\r\n        var parsedLocation = {};\r\n        // in ssr mode\r\n        if (this.request) {\r\n            parsedLocation = parse((_a = this.request.url) !== null && _a !== void 0 ? _a : '');\r\n        }\r\n        else if (typeof location === 'object') {\r\n            // in the browser\r\n            parsedLocation = parse(location.href);\r\n        }\r\n        // IE11 bug with parsed path being empty string\r\n        // causes issues with our user targeting\r\n        if (parsedLocation.pathname === '') {\r\n            parsedLocation.pathname = '/';\r\n        }\r\n        return parsedLocation;\r\n    };\r\n    Builder.prototype.getUserAttributes = function (userAgent) {\r\n        if (userAgent === void 0) { userAgent = this.userAgent || ''; }\r\n        var isMobile = {\r\n            Android: function () {\r\n                return userAgent.match(/Android/i);\r\n            },\r\n            BlackBerry: function () {\r\n                return userAgent.match(/BlackBerry/i);\r\n            },\r\n            iOS: function () {\r\n                return userAgent.match(/iPhone|iPod/i);\r\n            },\r\n            Opera: function () {\r\n                return userAgent.match(/Opera Mini/i);\r\n            },\r\n            Windows: function () {\r\n                return userAgent.match(/IEMobile/i) || userAgent.match(/WPDesktop/i);\r\n            },\r\n            any: function () {\r\n                return (isMobile.Android() ||\r\n                    isMobile.BlackBerry() ||\r\n                    isMobile.iOS() ||\r\n                    isMobile.Opera() ||\r\n                    isMobile.Windows());\r\n            },\r\n        };\r\n        var isTablet = userAgent.match(/Tablet|iPad/i);\r\n        var url = this.getLocation();\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ urlPath: url.pathname, host: url.host || url.hostname, \r\n            // TODO: maybe an option to choose to target off of mobile/tablet/desktop or just mobile/desktop\r\n            device: isTablet ? 'tablet' : isMobile.any() ? 'mobile' : 'desktop' }, Builder.overrideUserAttributes);\r\n    };\r\n    Builder.prototype.setUserAttributes = function (options) {\r\n        assign(Builder.overrideUserAttributes, options);\r\n        this.userAttributesChanged.next(options);\r\n    };\r\n    /**\r\n     * Set user attributes just for tracking purposes.\r\n     *\r\n     * Do this so properties exist on event objects for querying insights, but\r\n     * won't affect targeting\r\n     *\r\n     * Use this when you want to track properties but don't need to target off\r\n     * of them to optimize cache efficiency\r\n     */\r\n    Builder.prototype.setTrackingUserAttributes = function (attributes) {\r\n        assign(this.trackingUserAttributes, attributes);\r\n    };\r\n    Builder.prototype.get = function (modelName, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var instance = this;\r\n        if (!Builder.isBrowser) {\r\n            instance = new Builder(options.apiKey || this.apiKey, options.req, options.res, undefined, options.authToken || this.authToken, options.apiVersion || this.apiVersion);\r\n            instance.setUserAttributes(this.getUserAttributes());\r\n        }\r\n        else {\r\n            // NOTE: All these are when .init is not called and the customer\r\n            // directly calls .get on the singleton instance of Builder\r\n            if (options.apiKey && !this.apiKey) {\r\n                this.apiKey = options.apiKey;\r\n            }\r\n            if (options.authToken && !this.authToken) {\r\n                this.authToken = options.authToken;\r\n            }\r\n            if (options.apiVersion && !this.apiVersion) {\r\n                this.apiVersion = options.apiVersion;\r\n            }\r\n        }\r\n        return instance.queueGetContent(modelName, options).map(\r\n        /* map( */ function (matches) {\r\n            var match = matches && matches[0];\r\n            if (Builder.isStatic) {\r\n                return match;\r\n            }\r\n            var matchData = match && match.data;\r\n            if (!matchData) {\r\n                return null;\r\n            }\r\n            if (typeof matchData.blocksString !== 'undefined') {\r\n                matchData.blocks = JSON.parse(matchData.blocksString);\r\n                delete matchData.blocksString;\r\n            }\r\n            return {\r\n                // TODO: add ab test info here and other high level stuff\r\n                data: matchData,\r\n                id: match.id,\r\n                variationId: match.testVariationId || match.variationId || null,\r\n                testVariationId: match.testVariationId || match.variationId || null,\r\n                testVariationName: match.testVariationName || null,\r\n                lastUpdated: match.lastUpdated || null,\r\n            };\r\n        });\r\n        // );\r\n    };\r\n    // TODO: entry id in options\r\n    Builder.prototype.queueGetContent = function (modelName, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        // TODO: if query do modelName + query\r\n        var key = options.key ||\r\n            options.alias ||\r\n            // TODO: SDKs only pass entry key when given to them, and never when editing...\r\n            // options.entry ||\r\n            // TODO: this is ugly - instead of multiple of same model with different options are sent\r\n            // say requires key/alias. Or if not perhaps make a reliable hash of the options and use that.\r\n            // TODO: store last user state on last request and if user attributes different now\r\n            // give a warning that need to use keys to request new contente\r\n            // (options &&\r\n            //   Object.keys(options).filter(key => key !== 'model').length &&\r\n            //   JSON.stringify({ model: modelName, ...options, initialContent: undefined })) ||\r\n            modelName;\r\n        var isEditingThisModel = this.editingModel === modelName;\r\n        // TODO: include params in this key........\r\n        var currentObservable = this.observersByKey[key];\r\n        // if (options.query && options.query._id) {\r\n        //   this.flushGetContentQueue([options])\r\n        // }\r\n        if (this.apiKey === 'DEMO' && !this.overrides[key] && !options.initialContent) {\r\n            options.initialContent = [];\r\n        }\r\n        var initialContent = options.initialContent;\r\n        // TODO: refresh option in options\r\n        if (currentObservable && (!currentObservable.value || options.cache)) {\r\n            // TODO: test if this ran, otherwise on 404 some observers may never be called...\r\n            if (currentObservable.value) {\r\n                nextTick(function () {\r\n                    // TODO: return a new observable and only that one fires subscribers, don't refire for existing ones\r\n                    currentObservable.next(currentObservable.value);\r\n                });\r\n            }\r\n            return currentObservable;\r\n        }\r\n        if (isEditingThisModel) {\r\n            if (Builder.isBrowser) {\r\n                parent.postMessage({ type: 'builder.updateContent', data: { options: options } }, '*');\r\n            }\r\n        }\r\n        if (!initialContent /* || isEditingThisModel */) {\r\n            if (!this.getContentQueue) {\r\n                this.getContentQueue = [];\r\n            }\r\n            this.getContentQueue.push((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options), { model: modelName, key: key }));\r\n            if (this.getContentQueue && this.getContentQueue.length >= this.contentPerRequest) {\r\n                var queue_1 = this.getContentQueue.slice();\r\n                this.getContentQueue = [];\r\n                nextTick(function () {\r\n                    _this.flushGetContentQueue(false, queue_1);\r\n                });\r\n            }\r\n            else {\r\n                nextTick(function () {\r\n                    _this.flushGetContentQueue();\r\n                });\r\n            }\r\n        }\r\n        var observable = new BehaviorSubject(null);\r\n        this.observersByKey[key] = observable;\r\n        if (options.noEditorUpdates) {\r\n            this.noEditorUpdates[key] = true;\r\n        }\r\n        if (initialContent) {\r\n            nextTick(function () {\r\n                // TODO: need to testModify this I think...?\r\n                observable.next(initialContent);\r\n            });\r\n        }\r\n        return observable;\r\n    };\r\n    // this is needed to satisfy the Angular SDK, which used to rely on the more complex version of `requestUrl`.\r\n    // even though we only use `fetch()` now, we prefer to keep the old behavior and use the `fetch` that comes from\r\n    // the core SDK for consistency\r\n    Builder.prototype.requestUrl = function (url, options) {\r\n        return getFetch()(url, (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ next: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ revalidate: 1 }, options === null || options === void 0 ? void 0 : options.next) }, options)).then(function (res) { return res.json(); });\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"host\", {\r\n        get: function () {\r\n            switch (this.env) {\r\n                case 'qa':\r\n                    return 'https://qa.builder.io';\r\n                case 'test':\r\n                    return 'https://builder-io-test.web.app';\r\n                case 'fast':\r\n                    return 'https://fast.builder.io';\r\n                case 'cloud':\r\n                    return 'https://cloud.builder.io';\r\n                case 'cdn2':\r\n                    return 'https://cdn2.builder.io';\r\n                case 'cdn-qa':\r\n                    return 'https://cdn-qa.builder.io';\r\n                case 'development':\r\n                case 'dev':\r\n                    return 'http://localhost:5000';\r\n                case 'cdn-prod':\r\n                    return 'https://cdn.builder.io';\r\n                default:\r\n                    return Builder.overrideHost || 'https://cdn.builder.io';\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.flushGetContentQueue = function (usePastQueue, useQueue) {\r\n        var _this = this;\r\n        if (usePastQueue === void 0) { usePastQueue = false; }\r\n        if (!this.apiKey) {\r\n            throw new Error(\"Fetching content failed, expected apiKey to be defined instead got: \".concat(this.apiKey));\r\n        }\r\n        if (this.apiVersion) {\r\n            if (!['v1', 'v3'].includes(this.apiVersion)) {\r\n                throw new Error(\"Invalid apiVersion: expected 'v1' or 'v3', received '\".concat(this.apiVersion, \"'\"));\r\n            }\r\n        }\r\n        else {\r\n            this.apiVersion = DEFAULT_API_VERSION;\r\n        }\r\n        if (!usePastQueue && !this.getContentQueue) {\r\n            return;\r\n        }\r\n        var queue = useQueue || (usePastQueue ? this.priorContentQueue : this.getContentQueue) || [];\r\n        // TODO: do this on every request send?\r\n        this.getOverridesFromQueryString();\r\n        var queryParams = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ \r\n            // TODO: way to force a request to be in a separate queue. or just lower queue limit to be 1 by default\r\n            omit: queue[0].omit || 'meta.componentsUsed', apiKey: this.apiKey }, queue[0].options), this.queryOptions);\r\n        if (queue[0].locale) {\r\n            queryParams.locale = queue[0].locale;\r\n        }\r\n        if (queue[0].fields) {\r\n            queryParams.fields = queue[0].fields;\r\n        }\r\n        if (queue[0].format) {\r\n            queryParams.format = queue[0].format;\r\n        }\r\n        if ('noTraverse' in queue[0]) {\r\n            queryParams.noTraverse = queue[0].noTraverse;\r\n        }\r\n        if ('includeUnpublished' in queue[0]) {\r\n            queryParams.includeUnpublished = queue[0].includeUnpublished;\r\n        }\r\n        if (queue[0].sort) {\r\n            queryParams.sort = queue[0].sort;\r\n        }\r\n        var pageQueryParams = typeof location !== 'undefined'\r\n            ? QueryString.parseDeep(location.search.substr(1))\r\n            : {}; // TODO: WHAT about SSR (this.request) ?\r\n        var userAttributes = \r\n        // FIXME: HACK: only checks first in queue for user attributes overrides, should check all\r\n        // TODO: merge user attributes provided here with defaults and current user attiributes (?)\r\n        queue && queue[0].userAttributes\r\n            ? queue[0].userAttributes\r\n            : this.targetContent\r\n                ? this.getUserAttributes()\r\n                : {\r\n                    urlPath: this.getLocation().pathname,\r\n                };\r\n        var fullUrlQueueItem = queue.find(function (item) { return !!item.includeUrl; });\r\n        if (fullUrlQueueItem) {\r\n            var location_1 = this.getLocation();\r\n            if (location_1.origin) {\r\n                queryParams.url = \"\".concat(location_1.origin).concat(location_1.pathname).concat(location_1.search);\r\n            }\r\n        }\r\n        var urlQueueItem = useQueue === null || useQueue === void 0 ? void 0 : useQueue.find(function (item) { return item.url; });\r\n        if (urlQueueItem === null || urlQueueItem === void 0 ? void 0 : urlQueueItem.url) {\r\n            userAttributes.urlPath = urlQueueItem.url.split('?')[0];\r\n        }\r\n        // TODO: merge in the attribute from query string ones\r\n        // TODO: make this an option per component/request\r\n        queryParams.userAttributes = userAttributes;\r\n        if (!usePastQueue && !useQueue) {\r\n            this.priorContentQueue = queue;\r\n            this.getContentQueue = null;\r\n        }\r\n        var cachebust = this.cachebust ||\r\n            isIframe ||\r\n            pageQueryParams.cachebust ||\r\n            pageQueryParams['builder.cachebust'];\r\n        if (cachebust || this.env !== 'production') {\r\n            queryParams.cachebust = true;\r\n        }\r\n        if (Builder.isEditing) {\r\n            queryParams.isEditing = true;\r\n        }\r\n        if (this.noCache || this.env !== 'production') {\r\n            queryParams.noCache = true;\r\n        }\r\n        if (size(this.overrides)) {\r\n            for (var key in this.overrides) {\r\n                if (this.overrides.hasOwnProperty(key)) {\r\n                    queryParams[\"overrides.\".concat(key)] = this.overrides[key];\r\n                }\r\n            }\r\n        }\r\n        for (var _i = 0, queue_2 = queue; _i < queue_2.length; _i++) {\r\n            var options = queue_2[_i];\r\n            if (options.format) {\r\n                queryParams.format = options.format;\r\n            }\r\n            // TODO: remove me and make permodel\r\n            if (options.static) {\r\n                queryParams.static = options.static;\r\n            }\r\n            if (options.cachebust) {\r\n                queryParams.cachebust = options.cachebust;\r\n            }\r\n            if (isPositiveNumber(options.cacheSeconds)) {\r\n                queryParams.cacheSeconds = options.cacheSeconds;\r\n            }\r\n            if (isPositiveNumber(options.staleCacheSeconds)) {\r\n                queryParams.staleCacheSeconds = options.staleCacheSeconds;\r\n            }\r\n            var properties = [\r\n                'prerender',\r\n                'extractCss',\r\n                'limit',\r\n                'offset',\r\n                'query',\r\n                'preview',\r\n                'model',\r\n                'entry',\r\n                'rev',\r\n                'static',\r\n            ];\r\n            for (var _a = 0, properties_1 = properties; _a < properties_1.length; _a++) {\r\n                var key = properties_1[_a];\r\n                var value = options[key];\r\n                if (value !== undefined) {\r\n                    queryParams.options = queryParams.options || {};\r\n                    queryParams.options[options.key] = queryParams.options[options.key] || {};\r\n                    queryParams.options[options.key][key] = JSON.stringify(value);\r\n                }\r\n            }\r\n        }\r\n        if (this.preview) {\r\n            queryParams.preview = 'true';\r\n        }\r\n        var hasParams = Object.keys(queryParams).length > 0;\r\n        // TODO: option to force dev or qa api here\r\n        var host = this.host;\r\n        var keyNames = queue.map(function (item) { return encodeURIComponent(item.key); }).join(',');\r\n        if (this.overrideParams) {\r\n            var params = omit(QueryString.parse(this.overrideParams), 'apiKey');\r\n            assign(queryParams, params);\r\n        }\r\n        var queryStr = QueryString.stringifyDeep(queryParams);\r\n        var format = queryParams.format;\r\n        var requestOptions = { headers: {}, next: { revalidate: 1 } };\r\n        if (this.authToken) {\r\n            requestOptions.headers = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, requestOptions.headers), { Authorization: \"Bearer \".concat(this.authToken) });\r\n        }\r\n        var fn = format === 'solid' || format === 'react' ? 'codegen' : 'query';\r\n        // NOTE: this is a hack to get around the fact that the codegen endpoint is not yet available in v3\r\n        var apiVersionBasedOnFn = fn === 'query' ? this.apiVersion : 'v1';\r\n        var url = \"\".concat(host, \"/api/\").concat(apiVersionBasedOnFn, \"/\").concat(fn, \"/\").concat(this.apiKey, \"/\").concat(keyNames) +\r\n            (queryParams && hasParams ? \"?\".concat(queryStr) : '');\r\n        var promise = getFetch()(url, requestOptions)\r\n            .then(function (res) { return res.json(); })\r\n            .then(function (result) {\r\n            for (var _i = 0, queue_3 = queue; _i < queue_3.length; _i++) {\r\n                var options = queue_3[_i];\r\n                var keyName = options.key;\r\n                if (options.model === _this.blockContentLoading && !options.noEditorUpdates) {\r\n                    continue;\r\n                }\r\n                var isEditingThisModel = _this.editingModel === options.model;\r\n                if (isEditingThisModel && Builder.isEditing) {\r\n                    parent.postMessage({ type: 'builder.updateContent', data: { options: options } }, '*');\r\n                    // return;\r\n                }\r\n                var observer = _this.observersByKey[keyName];\r\n                if (!observer) {\r\n                    return;\r\n                }\r\n                var data = result[keyName];\r\n                var sorted = data; // sortBy(data, item => item.priority);\r\n                if (data) {\r\n                    var testModifiedResults = Builder.isServer\r\n                        ? sorted\r\n                        : _this.processResultsForTests(sorted);\r\n                    observer.next(testModifiedResults);\r\n                }\r\n                else {\r\n                    var search = _this.getLocation().search;\r\n                    if ((search || '').includes('builder.preview=' + options.model)) {\r\n                        var previewData = {\r\n                            id: 'preview',\r\n                            name: 'Preview',\r\n                            data: {},\r\n                        };\r\n                        observer.next([previewData]);\r\n                    }\r\n                    observer.next([]);\r\n                }\r\n            }\r\n        }, function (err) {\r\n            for (var _i = 0, queue_4 = queue; _i < queue_4.length; _i++) {\r\n                var options = queue_4[_i];\r\n                var observer = _this.observersByKey[options.key];\r\n                if (!observer) {\r\n                    return;\r\n                }\r\n                observer.error(err);\r\n            }\r\n        });\r\n        return promise;\r\n    };\r\n    Builder.prototype.processResultsForTests = function (results) {\r\n        var _this = this;\r\n        var _a;\r\n        var mappedResults = results.map(function (item) {\r\n            if (!item.variations) {\r\n                return item;\r\n            }\r\n            var cookieValue = _this.getTestCookie(item.id);\r\n            var cookieVariation = cookieValue === item.id ? item : item.variations[cookieValue];\r\n            if (cookieVariation) {\r\n                return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, item), { data: cookieVariation.data, variationId: cookieValue, testVariationId: cookieValue, testVariationName: cookieVariation.name });\r\n            }\r\n            if (_this.canTrack && item.variations && size(item.variations)) {\r\n                var n = 0;\r\n                var random = Math.random();\r\n                for (var id in item.variations) {\r\n                    var variation = item.variations[id];\r\n                    var testRatio = variation.testRatio;\r\n                    n += testRatio;\r\n                    if (random < n) {\r\n                        _this.setTestCookie(item.id, variation.id);\r\n                        var variationName = variation.name || (variation.id === item.id ? 'Default variation' : '');\r\n                        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, item), { data: variation.data, variationId: variation.id, testVariationId: variation.id, variationName: variationName, testVariationName: variationName });\r\n                    }\r\n                }\r\n                _this.setTestCookie(item.id, item.id);\r\n            }\r\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, item), { variationId: item.id }), (item.variations &&\r\n                size(item.variations) && {\r\n                testVariationId: item.id,\r\n                testVariationName: 'Default variation',\r\n            }));\r\n        });\r\n        if (isIframe) {\r\n            (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({ type: 'builder.contentResults', data: { results: mappedResults } }, '*');\r\n        }\r\n        return mappedResults;\r\n    };\r\n    Builder.prototype.getTestCookie = function (contentId) {\r\n        return this.getCookie(\"\".concat(this.testCookiePrefix, \".\").concat(contentId));\r\n    };\r\n    Builder.prototype.setTestCookie = function (contentId, variationId) {\r\n        if (!this.canTrack) {\r\n            this.cookieQueue.push([contentId, variationId]);\r\n            return;\r\n        }\r\n        // 30 days from now\r\n        var future = new Date();\r\n        future.setDate(future.getDate() + 30);\r\n        return this.setCookie(\"\".concat(this.testCookiePrefix, \".\").concat(contentId), variationId, future);\r\n    };\r\n    Builder.prototype.getCookie = function (name) {\r\n        if (this.cookies) {\r\n            return this.cookies.get(name);\r\n        }\r\n        return Builder.isBrowser && getCookie(name);\r\n    };\r\n    Builder.prototype.setCookie = function (name, value, expires) {\r\n        if (this.cookies && !(Builder.isServer && Builder.isStatic)) {\r\n            return this.cookies.set(name, value, {\r\n                expires: expires,\r\n                secure: this.getLocation().protocol === 'https:',\r\n            });\r\n        }\r\n        return Builder.isBrowser && setCookie(name, value, expires);\r\n    };\r\n    Builder.prototype.getContent = function (modelName, options) {\r\n        if (options === void 0) { options = {}; }\r\n        if (!this.apiKey) {\r\n            throw new Error(\"Fetching content from model \".concat(modelName, \" failed, expected apiKey to be defined instead got: \").concat(this.apiKey));\r\n        }\r\n        return this.queueGetContent(modelName, options);\r\n    };\r\n    Builder.prototype.getAll = function (modelName, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var instance = this;\r\n        if (!Builder.isBrowser) {\r\n            instance = new Builder(options.apiKey || this.apiKey, options.req, options.res, false, options.authToken || this.authToken, options.apiVersion || this.apiVersion);\r\n            instance.setUserAttributes(this.getUserAttributes());\r\n        }\r\n        else {\r\n            // NOTE: All these are when .init is not called and the customer\r\n            // directly calls .get on the singleton instance of Builder\r\n            if (options.apiKey && !this.apiKey) {\r\n                this.apiKey = options.apiKey;\r\n            }\r\n            if (options.authToken && !this.authToken) {\r\n                this.authToken = options.authToken;\r\n            }\r\n            if (options.apiVersion && !this.apiVersion) {\r\n                this.apiVersion = options.apiVersion;\r\n            }\r\n        }\r\n        // Set noTraverse=true if NOT already passed by user, for query performance\r\n        if (!('noTraverse' in options)) {\r\n            options.noTraverse = true;\r\n        }\r\n        return instance\r\n            .getContent(modelName, (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ limit: 30 }, options), { key: options.key ||\r\n                // Make the key include all options, so we don't reuse cache for the same content fetched\r\n                // with different options\r\n                Builder.isBrowser\r\n                ? \"\".concat(modelName, \":\").concat(hash_sum__WEBPACK_IMPORTED_MODULE_0___default()(omit(options, 'initialContent', 'req', 'res')))\r\n                : undefined }))\r\n            .promise();\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @deprecated. This is buggy, and always behind by a version.\r\n     */\r\n    Builder.VERSION = version;\r\n    Builder.components = [];\r\n    /**\r\n     * Makes it so that a/b tests generate code like {@link\r\n     * https://www.builder.io/blog/high-performance-no-code#__next:~:text=Static%20generated%20A%2FB%20testing}\r\n     * instead of the old way where we render only one test group at a time on the\r\n     * server. This is the preferred/better way not and we should ultimately make it\r\n     * the default\r\n     */\r\n    Builder.isStatic = true;\r\n    Builder.animator = new Animator();\r\n    Builder.nextTick = nextTick;\r\n    Builder.throttle = throttle;\r\n    Builder.editors = [];\r\n    Builder.trustedHosts = [\r\n        '*.beta.builder.io',\r\n        'beta.builder.io',\r\n        'builder.io',\r\n        'localhost',\r\n        'qa.builder.io',\r\n    ];\r\n    Builder.plugins = [];\r\n    Builder.actions = [];\r\n    Builder.registry = {};\r\n    Builder.registryChange = new BehaviorSubject({});\r\n    Builder._editingPage = false;\r\n    Builder.isIframe = isIframe;\r\n    Builder.isBrowser = isBrowser;\r\n    Builder.isReactNative = isReactNative;\r\n    Builder.isServer = !isBrowser && !isReactNative;\r\n    Builder.previewingModel = Builder.isBrowser && getQueryParam(location.href, 'builder.preview');\r\n    Builder.settings = {};\r\n    Builder.settingsChange = new BehaviorSubject({});\r\n    // TODO: this is quick and dirty, do better implementation later. Also can be unreliable\r\n    // if page 301s etc. Use a query param instead? also could have issues with redirects. Injecting var could\r\n    // work but is async...\r\n    Builder.isEditing = Boolean(isIframe &&\r\n        ((document.referrer && document.referrer.match(/builder\\.io|localhost:1234/)) ||\r\n            location.search.indexOf('builder.frameEditing=') !== -1));\r\n    Builder.isPreviewing = Boolean(isBrowser &&\r\n        (location.search.indexOf('builder.preview=') !== -1 ||\r\n            location.search.indexOf('builder.frameEditing=') !== -1));\r\n    Builder.isReact = false;\r\n    Builder.overrideUserAttributes = {};\r\n    return Builder;\r\n}());\n\nvar builder = new Builder(null, undefined, undefined, true);\r\nBuilder.singletonInstance = builder;\n\n\n//# sourceMappingURL=index.esm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGJ1aWxkZXIuaW8vc2RrL2Rpc3QvaW5kZXguZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFpQztBQUNMOztBQUU1QjtBQUNBOztBQUVBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxjQUFjO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxxQkFBcUI7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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O0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBLHVGQUF1Rix3Q0FBd0MsMEJBQTBCO0FBQ3pKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsV0FBVyxjQUFjO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCwrQ0FBSTtBQUN2RCw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBOztBQUV3RjtBQUN4RiIsInNvdXJjZXMiOlsid2VicGFjazovL2J1aWxkZXItYXBwLy4vbm9kZV9tb2R1bGVzL0BidWlsZGVyLmlvL3Nkay9kaXN0L2luZGV4LmVzbS5qcz81YjRlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF9fYXNzaWduIH0gZnJvbSAndHNsaWInO1xuaW1wb3J0IGhhc2ggZnJvbSAnaGFzaC1zdW0nO1xuXG4oZnVuY3Rpb24gKCkge1xuICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIGZhbHNlO1xuXG4gIGZ1bmN0aW9uIEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMpIHtcbiAgICBwYXJhbXMgPSBwYXJhbXMgfHwgeyBidWJibGVzOiBmYWxzZSwgY2FuY2VsYWJsZTogZmFsc2UsIGRldGFpbDogbnVsbCB9O1xuICAgIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBldnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwpO1xuICAgIHJldHVybiBldnQ7XG4gIH1cblxuICB3aW5kb3cuQ3VzdG9tRXZlbnQgPSBDdXN0b21FdmVudDtcbn0pKCk7XG5cbnZhciBpc1NhZmFyaSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcclxudmFyIGlzQ2xpZW50ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XHJcbi8vIFRPRE86IHF1ZXVlIGFsbCBvZiB0aGVzZSBpbiBhIGRlYm91bmNlTmV4dFRpY2tcclxuZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcclxuICAgIC8vIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5uZXh0VGljaykge1xyXG4gICAgLy8gICBjb25zb2xlLmxvZygncHJvY2Vzcy5uZXh0VGljaz8nKTtcclxuICAgIC8vICAgcHJvY2Vzcy5uZXh0VGljayhmbik7XHJcbiAgICAvLyAgIHJldHVybjtcclxuICAgIC8vIH1cclxuICAgIC8vIEZJWE1FOiBmaXggdGhlIHJlYWwgc2FmYXJpIGlzc3VlIG9mIHRoaXMgcmFuZG9tbHkgbm90IHdvcmtpbmdcclxuICAgIGlmICghaXNDbGllbnQgfHwgaXNTYWZhcmkgfHwgdHlwZW9mIE11dGF0aW9uT2JzZXJ2ZXIgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgc2V0VGltZW91dChmbik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIGNhbGxlZCA9IDA7XHJcbiAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAoKSB7IHJldHVybiBmbigpOyB9KTtcclxuICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpO1xyXG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50LCB7XHJcbiAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSxcclxuICAgIH0pO1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXHJcbiAgICBlbGVtZW50LmRhdGEgPSBTdHJpbmcoKGNhbGxlZCA9ICsrY2FsbGVkKSk7XHJcbn1cblxudmFyIFBST1BFUlRZX05BTUVfREVOWV9MSVNUID0gT2JqZWN0LmZyZWV6ZShbJ19fcHJvdG9fXycsICdwcm90b3R5cGUnLCAnY29uc3RydWN0b3InXSk7XHJcbi8vIFRPRE86IHVuaXQgdGVzdHNcclxudmFyIFF1ZXJ5U3RyaW5nID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlTdHJpbmcoKSB7XHJcbiAgICB9XHJcbiAgICBRdWVyeVN0cmluZy5wYXJzZURlZXAgPSBmdW5jdGlvbiAocXVlcnlTdHJpbmcpIHtcclxuICAgICAgICB2YXIgb2JqID0gdGhpcy5wYXJzZShxdWVyeVN0cmluZyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVlcGVuKG9iaik7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTdHJpbmcuc3RyaW5naWZ5RGVlcCA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICB2YXIgbWFwID0gdGhpcy5mbGF0dGVuKG9iaik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RyaW5naWZ5KG1hcCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTdHJpbmcucGFyc2UgPSBmdW5jdGlvbiAocXVlcnlTdHJpbmcpIHtcclxuICAgICAgICB2YXIgcXVlcnkgPSB7fTtcclxuICAgICAgICB2YXIgcGFpcnMgPSAocXVlcnlTdHJpbmdbMF0gPT09ICc/JyA/IHF1ZXJ5U3RyaW5nLnN1YnN0cigxKSA6IHF1ZXJ5U3RyaW5nKS5zcGxpdCgnJicpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFpcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBub2RlIHN1cHBvcnQ/XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVtkZWNvZGVVUklDb21wb25lbnQocGFpclswXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0gfHwgJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIG1hbGZvcm1lZCBVUkkgY29tcG9uZW50c1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBxdWVyeTtcclxuICAgIH07XHJcbiAgICBRdWVyeVN0cmluZy5zdHJpbmdpZnkgPSBmdW5jdGlvbiAobWFwKSB7XHJcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBtYXApIHtcclxuICAgICAgICAgICAgaWYgKG1hcC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBtYXBba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChzdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJyYnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RyICs9IGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U3RyaW5nLmRlZXBlbiA9IGZ1bmN0aW9uIChtYXApIHtcclxuICAgICAgICAvLyBGSVhNRTsgU2hvdWxkIGJlIHR5cGUgVHJlZSA9IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IFRyZWU+XHJcbiAgICAgICAgLy8gcmVxdWlyZXMgYSB0eXBlc2NyaXB0IHVwZ3JhZGUuXHJcbiAgICAgICAgdmFyIG91dHB1dCA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGsgaW4gbWFwKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gb3V0cHV0O1xyXG4gICAgICAgICAgICB2YXIgcGFydHMgPSBrLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBwYXJ0cy5wb3AoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwYXJ0c18xID0gcGFydHM7IF9pIDwgcGFydHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gcGFydHNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICBhc3NlcnRBbGxvd2VkUHJvcGVydHlOYW1lKHBhcnQpO1xyXG4gICAgICAgICAgICAgICAgdCA9IHRbcGFydF0gPSB0W3BhcnRdIHx8IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRba2V5XSA9IG1hcFtrXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcclxuICAgIH07XHJcbiAgICBRdWVyeVN0cmluZy5mbGF0dGVuID0gZnVuY3Rpb24gKG9iaiwgX2N1cnJlbnQsIF9yZXMpIHtcclxuICAgICAgICBpZiAoX3JlcyA9PT0gdm9pZCAwKSB7IF9yZXMgPSB7fTsgfVxyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gb2JqW2tleV07XHJcbiAgICAgICAgICAgIHZhciBuZXdLZXkgPSBfY3VycmVudCA/IF9jdXJyZW50ICsgJy4nICsga2V5IDoga2V5O1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mbGF0dGVuKHZhbHVlLCBuZXdLZXksIF9yZXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3Jlc1tuZXdLZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIF9yZXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5U3RyaW5nO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBhc3NlcnRBbGxvd2VkUHJvcGVydHlOYW1lKG5hbWUpIHtcclxuICAgIGlmIChQUk9QRVJUWV9OQU1FX0RFTllfTElTVC5pbmRleE9mKG5hbWUpID49IDApXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgbmFtZSBcXFwiXCIuY29uY2F0KG5hbWUsIFwiXFxcIiBpcyBub3QgYWxsb3dlZFwiKSk7XHJcbn1cblxudmFyIHZlcnNpb24gPSBcIjIuMi4yXCI7XG5cbnZhciBTdWJzY3JpcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTdWJzY3JpcHRpb24obGlzdGVuZXJzLCBsaXN0ZW5lcikge1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gbGlzdGVuZXJzO1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXIgPSBsaXN0ZW5lcjtcclxuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub3RoZXJTdWJzY3JpcHRpb25zID0gW107XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Vic2NyaXB0aW9uLnByb3RvdHlwZSwgXCJjbG9zZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy51bnN1YnNjcmliZWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5vdGhlclN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xyXG4gICAgfTtcclxuICAgIFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudW5zdWJzY3JpYmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXIgJiYgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5saXN0ZW5lcnMuaW5kZXhPZih0aGlzLmxpc3RlbmVyKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vdGhlclN1YnNjcmlwdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoc3ViKSB7IHJldHVybiBzdWIudW5zdWJzY3JpYmUoKTsgfSk7XHJcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZWQgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTdWJzY3JpcHRpb247XHJcbn0oKSk7XHJcbi8vIFRPRE86IGZvbGxvdyBtaW5pbWFsIGJhc2ljIHNwZWM6IGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLW9ic2VydmFibGVcclxudmFyIEJlaGF2aW9yU3ViamVjdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJlaGF2aW9yU3ViamVjdCh2YWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5lcnJvckxpc3RlbmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMudGhlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAoX2EgPSBfdGhpcy50b1Byb21pc2UoKSkudGhlbi5hcHBseShfYSwgYXJncyk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5saXN0ZW5lcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF9hW19pXTtcclxuICAgICAgICAgICAgbGlzdGVuZXIodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBUT0RPOiBpbXBsZW1lbnQgdGhpcyBhcyBQSVBFIGluc3RlYWRcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgdmFyIG5ld1N1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KGZuKHRoaXMudmFsdWUpKTtcclxuICAgICAgICAvLyBUT0RPOiBvbiBkZXN0cm95IGRlbGV0ZSB0aGVzZVxyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgbmV3U3ViamVjdC5uZXh0KGZuKHZhbCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBuZXdTdWJqZWN0LmVycm9yKGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld1N1YmplY3Q7XHJcbiAgICB9O1xyXG4gICAgQmVoYXZpb3JTdWJqZWN0LnByb3RvdHlwZS5jYXRjaCA9IGZ1bmN0aW9uIChlcnJvckxpc3RlbmVyKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvckxpc3RlbmVycy5wdXNoKGVycm9yTGlzdGVuZXIpO1xyXG4gICAgICAgIHJldHVybiBuZXcgU3Vic2NyaXB0aW9uKHRoaXMuZXJyb3JMaXN0ZW5lcnMsIGVycm9yTGlzdGVuZXIpO1xyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5lcnJvckxpc3RlbmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBsaXN0ZW5lcihlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGxpc3RlbmVyLCBlcnJvckxpc3RlbmVyKSB7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XHJcbiAgICAgICAgaWYgKGVycm9yTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckxpc3RlbmVycy5wdXNoKGVycm9yTGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFN1YnNjcmlwdGlvbih0aGlzLmxpc3RlbmVycywgbGlzdGVuZXIpO1xyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUudG9Qcm9taXNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUucHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50b1Byb21pc2UoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQmVoYXZpb3JTdWJqZWN0O1xyXG59KCkpO1xuXG52YXIgU3RhdGUgPSB7XHJcbiAgICBQZW5kaW5nOiAnUGVuZGluZycsXHJcbiAgICBGdWxmaWxsZWQ6ICdGdWxmaWxsZWQnLFxyXG4gICAgUmVqZWN0ZWQ6ICdSZWplY3RlZCcsXHJcbn07XHJcbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsKSB7XHJcbiAgICByZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbic7XHJcbn1cclxuZnVuY3Rpb24gaXNPYmplY3QodmFsKSB7XHJcbiAgICByZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnO1xyXG59XHJcbnZhciBUaW55UHJvbWlzZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRpbnlQcm9taXNlKGV4ZWN1dG9yKSB7XHJcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBTdGF0ZS5QZW5kaW5nO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xyXG4gICAgICAgIGV4ZWN1dG9yKHRoaXMuX3Jlc29sdmUuYmluZCh0aGlzKSwgdGhpcy5fcmVqZWN0LmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgVGlueVByb21pc2UucHJvdG90eXBlLl9yZXNvbHZlID0gZnVuY3Rpb24gKHgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh4IGluc3RhbmNlb2YgVGlueVByb21pc2UpIHtcclxuICAgICAgICAgICAgeC50aGVuKHRoaXMuX3Jlc29sdmUuYmluZCh0aGlzKSwgdGhpcy5fcmVqZWN0LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpc09iamVjdCh4KSB8fCBpc0Z1bmN0aW9uKHgpKSB7XHJcbiAgICAgICAgICAgIHZhciBjYWxsZWRfMSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRoZW5hYmxlID0geC50aGVuO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24odGhlbmFibGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbmFibGUuY2FsbCh4LCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2FsbGVkXzEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWRfMSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2FsbGVkXzEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVkXzEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZnVsZmlsbCh4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY2FsbGVkXzEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWplY3QoZXgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9mdWxmaWxsKHgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGwgPSBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zdGF0ZSA9IFN0YXRlLkZ1bGZpbGxlZDtcclxuICAgICAgICB0aGlzLl92YWx1ZSA9IHJlc3VsdDtcclxuICAgICAgICB0aGlzLl9oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoYW5kbGVyKSB7IHJldHVybiBfdGhpcy5fY2FsbEhhbmRsZXIoaGFuZGxlcik7IH0pO1xyXG4gICAgfTtcclxuICAgIFRpbnlQcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0ID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zdGF0ZSA9IFN0YXRlLlJlamVjdGVkO1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlID0gZXJyb3I7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAoaGFuZGxlcikgeyByZXR1cm4gX3RoaXMuX2NhbGxIYW5kbGVyKGhhbmRsZXIpOyB9KTtcclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2lzUGVuZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGUgPT09IFN0YXRlLlBlbmRpbmc7XHJcbiAgICB9O1xyXG4gICAgVGlueVByb21pc2UucHJvdG90eXBlLl9pc0Z1bGZpbGxlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGUgPT09IFN0YXRlLkZ1bGZpbGxlZDtcclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2lzUmVqZWN0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlID09PSBTdGF0ZS5SZWplY3RlZDtcclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2FkZEhhbmRsZXIgPSBmdW5jdGlvbiAob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKHtcclxuICAgICAgICAgICAgb25GdWxmaWxsZWQ6IG9uRnVsZmlsbGVkLFxyXG4gICAgICAgICAgICBvblJlamVjdGVkOiBvblJlamVjdGVkLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRpbnlQcm9taXNlLnByb3RvdHlwZS5fY2FsbEhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlcikge1xyXG4gICAgICAgIGlmICh0aGlzLl9pc0Z1bGZpbGxlZCgpICYmIGlzRnVuY3Rpb24oaGFuZGxlci5vbkZ1bGZpbGxlZCkpIHtcclxuICAgICAgICAgICAgaGFuZGxlci5vbkZ1bGZpbGxlZCh0aGlzLl92YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2lzUmVqZWN0ZWQoKSAmJiBpc0Z1bmN0aW9uKGhhbmRsZXIub25SZWplY3RlZCkpIHtcclxuICAgICAgICAgICAgaGFuZGxlci5vblJlamVjdGVkKHRoaXMuX3ZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVGlueVByb21pc2UucHJvdG90eXBlLnRoZW4gPSBmdW5jdGlvbiAob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5fc3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5QZW5kaW5nOiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbnlQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYWRkSGFuZGxlcihmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFRpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbihvbkZ1bGZpbGxlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvbkZ1bGZpbGxlZCh2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24ob25SZWplY3RlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvblJlamVjdGVkKGVycm9yKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5GdWxmaWxsZWQ6IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGlueVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG9uRnVsZmlsbGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob25GdWxmaWxsZWQoX3RoaXMuX3ZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzLl92YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIFN0YXRlLlJlamVjdGVkOiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbnlQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0VGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbihvblJlamVjdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob25SZWplY3RlZChfdGhpcy5fdmFsdWUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChfdGhpcy5fdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRpbnlQcm9taXNlO1xyXG59KCkpO1xyXG52YXIgUHJvbWlzZSQxID0gKHR5cGVvZiBQcm9taXNlICE9PSAndW5kZWZpbmVkJyA/IFByb21pc2UgOiBUaW55UHJvbWlzZSk7XG5cbi8vIFdlYnBhY2sgd29ya2Fyb3VuZCB0byBjb25kaXRpb25hbGx5IHJlcXVpcmUgY2VydGFpbiBleHRlcm5hbCBtb2R1bGVzXHJcbi8vIG9ubHkgb24gdGhlIHNlcnZlciBhbmQgbm90IGJ1bmRsZSB0aGVtIG9uIHRoZSBjbGllbnRcclxudmFyIHNlcnZlck9ubHlSZXF1aXJlO1xyXG50cnkge1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWV2YWxcclxuICAgIHNlcnZlck9ubHlSZXF1aXJlID0gZXZhbCgncmVxdWlyZScpO1xyXG59XHJcbmNhdGNoIChlcnIpIHtcclxuICAgIC8vIGFsbCBnb29kXHJcbiAgICBzZXJ2ZXJPbmx5UmVxdWlyZSA9IChmdW5jdGlvbiAoKSB7IHJldHVybiBudWxsOyB9KTtcclxufVxyXG52YXIgc2VydmVyT25seVJlcXVpcmUkMSA9IHNlcnZlck9ubHlSZXF1aXJlO1xuXG5mdW5jdGlvbiBwcm9taXNlUmVzb2x2ZSh2YWx1ZSkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlJDEoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmV0dXJuIHJlc29sdmUodmFsdWUpOyB9KTtcclxufVxyXG4vLyBBZGFwdGVkIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2RldmVsb3BpdC91bmZldGNoL21hc3Rlci9zcmMvaW5kZXgubWpzXHJcbmZ1bmN0aW9uIHRpbnlGZXRjaCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UkMShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICByZXF1ZXN0Lm9wZW4ob3B0aW9ucy5tZXRob2QgfHwgJ2dldCcsIHVybCwgdHJ1ZSk7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuaGVhZGVycykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIG9wdGlvbnMuaGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKGksIG9wdGlvbnMuaGVhZGVyc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmVxdWVzdC53aXRoQ3JlZGVudGlhbHMgPSBvcHRpb25zLmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZSc7XHJcbiAgICAgICAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UoKSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSByZWplY3Q7XHJcbiAgICAgICAgcmVxdWVzdC5zZW5kKG9wdGlvbnMuYm9keSk7XHJcbiAgICAgICAgZnVuY3Rpb24gcmVzcG9uc2UoKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgICAgIHZhciBhbGwgPSBbXTtcclxuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSB7fTtcclxuICAgICAgICAgICAgdmFyIGhlYWRlciA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgcmVxdWVzdFxyXG4gICAgICAgICAgICAgICAgLmdldEFsbFJlc3BvbnNlSGVhZGVycygpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXiguKj8pOlteXFxTXFxuXSooW1xcc1xcU10qPykkL2dtLCBmdW5jdGlvbiAoX21hdGNoLCBfa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IF9rZXk7XHJcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2goKGtleSA9IGtleS50b0xvd2VyQ2FzZSgpKSk7XHJcbiAgICAgICAgICAgICAgICBhbGwucHVzaChba2V5LCB2YWx1ZV0pO1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyID0gaGVhZGVyc1trZXldO1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyc1trZXldID0gaGVhZGVyID8gXCJcIi5jb25jYXQoaGVhZGVyLCBcIixcIikuY29uY2F0KHZhbHVlKSA6IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG9rOiAoKHJlcXVlc3Quc3RhdHVzIC8gMTAwKSB8IDApID09PSAyLFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiByZXF1ZXN0LnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHJlcXVlc3Quc3RhdHVzVGV4dCxcclxuICAgICAgICAgICAgICAgIHVybDogcmVxdWVzdC5yZXNwb25zZVVSTCxcclxuICAgICAgICAgICAgICAgIGNsb25lOiByZXNwb25zZSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHByb21pc2VSZXNvbHZlKHJlcXVlc3QucmVzcG9uc2VUZXh0KTsgfSxcclxuICAgICAgICAgICAgICAgIGpzb246IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHByb21pc2VSZXNvbHZlKHJlcXVlc3QucmVzcG9uc2VUZXh0KS50aGVuKEpTT04ucGFyc2UpOyB9LFxyXG4gICAgICAgICAgICAgICAgYmxvYjogZnVuY3Rpb24gKCkgeyByZXR1cm4gcHJvbWlzZVJlc29sdmUobmV3IEJsb2IoW3JlcXVlc3QucmVzcG9uc2VdKSk7IH0sXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5czogZnVuY3Rpb24gKCkgeyByZXR1cm4ga2V5czsgfSxcclxuICAgICAgICAgICAgICAgICAgICBlbnRyaWVzOiBmdW5jdGlvbiAoKSB7IHJldHVybiBhbGw7IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAobikgeyByZXR1cm4gaGVhZGVyc1tuLnRvTG93ZXJDYXNlKCldOyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGhhczogZnVuY3Rpb24gKG4pIHsgcmV0dXJuIG4udG9Mb3dlckNhc2UoKSBpbiBoZWFkZXJzOyB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBnZXRGZXRjaCgpIHtcclxuICAgIC8vIElmIGZldGNoIGlzIGRlZmluZWQsIGluIHRoZSBicm93c2VyLCB2aWEgcG9seWZpbGwsIG9yIGluIGEgQ2xvdWRmbGFyZSB3b3JrZXIsIHVzZSBpdC5cclxuICAgIHZhciBfZmV0Y2ggPSB1bmRlZmluZWQ7XHJcbiAgICBpZiAoZ2xvYmFsVGhpcy5mZXRjaCkge1xyXG4gICAgICAgIF9mZXRjaCAhPT0gbnVsbCAmJiBfZmV0Y2ggIT09IHZvaWQgMCA/IF9mZXRjaCA6IChfZmV0Y2ggPSBnbG9iYWxUaGlzLmZldGNoKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgLy8gSWYgZmV0Y2ggaXMgbm90IGRlZmluZWQsIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudCwgdXNlIG5vZGUtZmV0Y2guXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gbm9kZS1mZXRjaEBeMyBpcyBFU00gb25seSwgYW5kIHdpbGwgdGhyb3cgZXJyb3Igb24gcmVxdWlyZS5cclxuICAgICAgICAgICAgX2ZldGNoICE9PSBudWxsICYmIF9mZXRjaCAhPT0gdm9pZCAwID8gX2ZldGNoIDogKF9mZXRjaCA9IHNlcnZlck9ubHlSZXF1aXJlJDEoJ25vZGUtZmV0Y2gnKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIElmIG5vZGUtZmV0Y2ggaXMgbm90IGluc3RhbGxlZCwgdXNlIHRpbnktZmV0Y2guXHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybignbm9kZS1mZXRjaCBpcyBub3QgaW5zdGFsbGVkLiBjb25zaWRlciBwb2x5ZmlsbGluZyBmZXRjaCBvciBpbnN0YWxsaW5nIG5vZGUtZmV0Y2guJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBPdGhlcndpc2UsIHVzZSB0aW55LWZldGNoLlxyXG4gICAgcmV0dXJuIF9mZXRjaCAhPT0gbnVsbCAmJiBfZmV0Y2ggIT09IHZvaWQgMCA/IF9mZXRjaCA6IHRpbnlGZXRjaDtcclxufVxuXG5mdW5jdGlvbiBhc3NpZ24odGFyZ2V0KSB7XHJcbiAgICB2YXIgdG8gPSBPYmplY3QodGFyZ2V0KTtcclxuICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBhcmd1bWVudHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgdmFyIG5leHRTb3VyY2UgPSBhcmd1bWVudHNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChuZXh0U291cmNlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgLy8gU2tpcCBvdmVyIGlmIHVuZGVmaW5lZCBvciBudWxsXHJcbiAgICAgICAgICAgIGZvciAodmFyIG5leHRLZXkgaW4gbmV4dFNvdXJjZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gQXZvaWQgYnVncyB3aGVuIGhhc093blByb3BlcnR5IGlzIHNoYWRvd2VkXHJcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5leHRTb3VyY2UsIG5leHRLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9bbmV4dEtleV0gPSBuZXh0U291cmNlW25leHRLZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRvO1xyXG59XG5cbmZ1bmN0aW9uIHRocm90dGxlKGZ1bmMsIHdhaXQsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICB2YXIgY29udGV4dDtcclxuICAgIHZhciBhcmdzO1xyXG4gICAgdmFyIHJlc3VsdDtcclxuICAgIHZhciB0aW1lb3V0ID0gbnVsbDtcclxuICAgIHZhciBwcmV2aW91cyA9IDA7XHJcbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcHJldmlvdXMgPSBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlID8gMCA6IERhdGUubm93KCk7XHJcbiAgICAgICAgdGltZW91dCA9IG51bGw7XHJcbiAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgICAgICBpZiAoIXRpbWVvdXQpXHJcbiAgICAgICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGlmICghcHJldmlvdXMgJiYgb3B0aW9ucy5sZWFkaW5nID09PSBmYWxzZSlcclxuICAgICAgICAgICAgcHJldmlvdXMgPSBub3c7XHJcbiAgICAgICAgdmFyIHJlbWFpbmluZyA9IHdhaXQgLSAobm93IC0gcHJldmlvdXMpO1xyXG4gICAgICAgIGNvbnRleHQgPSB0aGlzO1xyXG4gICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgaWYgKHJlbWFpbmluZyA8PSAwIHx8IHJlbWFpbmluZyA+IHdhaXQpIHtcclxuICAgICAgICAgICAgaWYgKHRpbWVvdXQpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcclxuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHByZXZpb3VzID0gbm93O1xyXG4gICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG4gICAgICAgICAgICBpZiAoIXRpbWVvdXQpXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gYXJncyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCF0aW1lb3V0ICYmIG9wdGlvbnMudHJhaWxpbmcgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCByZW1haW5pbmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxufVxuXG52YXIgY2FtZWxDYXNlVG9LZWJhYkNhc2UgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICByZXR1cm4gc3RyID8gc3RyLnJlcGxhY2UoLyhbQS1aXSkvZywgZnVuY3Rpb24gKGcpIHsgcmV0dXJuIFwiLVwiLmNvbmNhdChnWzBdLnRvTG93ZXJDYXNlKCkpOyB9KSA6ICcnO1xyXG59O1xyXG52YXIgQW5pbWF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBbmltYXRvcigpIHtcclxuICAgIH1cclxuICAgIEFuaW1hdG9yLnByb3RvdHlwZS5iaW5kQW5pbWF0aW9ucyA9IGZ1bmN0aW9uIChhbmltYXRpb25zKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhbmltYXRpb25zXzEgPSBhbmltYXRpb25zOyBfaSA8IGFuaW1hdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IGFuaW1hdGlvbnNfMVtfaV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAoYW5pbWF0aW9uLnRyaWdnZXIpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3BhZ2VMb2FkJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXJBbmltYXRpb24oYW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2hvdmVyJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRIb3ZlckFuaW1hdGlvbihhbmltYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnc2Nyb2xsSW5WaWV3JzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRTY3JvbGxJblZpZXdBbmltYXRpb24oYW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBbmltYXRvci5wcm90b3R5cGUud2FybkVsZW1lbnROb3RQcmVzZW50ID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwiQ2Fubm90IGFuaW1hdGUgZWxlbWVudDogZWxlbWVudCB3aXRoIElEIFwiLmNvbmNhdChpZCwgXCIgbm90IGZvdW5kIVwiKSk7XHJcbiAgICB9O1xyXG4gICAgQW5pbWF0b3IucHJvdG90eXBlLmF1Z21lbnRBbmltYXRpb24gPSBmdW5jdGlvbiAoYW5pbWF0aW9uLCBlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIHN0eWxlc1VzZWQgPSB0aGlzLmdldEFsbFN0eWxlc1VzZWQoYW5pbWF0aW9uKTtcclxuICAgICAgICB2YXIgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XHJcbiAgICAgICAgLy8gY29uc3QgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XHJcbiAgICAgICAgLy8gLy8gRklYTUU6IHRoaXMgd2lsbCBicmVhayBpZiBvcmlnaW5hbCBsb2FkIGlzIGluIG9uZSByZXBvbnNpdmUgc2l6ZSB0aGVuIHJlc2l6ZSB0byBhbm90aGVyIGhtbW1cclxuICAgICAgICAvLyBOZWVkIHRvIHVzZSB0cmFuc2Zvcm0gaW5zdGVhZCBvZiBsZWZ0IHNpbmNlIGxlZnQgY2FuIGNoYW5nZSBvbiBzY3JlZW4gc2l6ZXNcclxuICAgICAgICB2YXIgZmlyc3RTdHlsZXMgPSBhbmltYXRpb24uc3RlcHNbMF0uc3R5bGVzO1xyXG4gICAgICAgIHZhciBsYXN0U3R5bGVzID0gYW5pbWF0aW9uLnN0ZXBzW2FuaW1hdGlvbi5zdGVwcy5sZW5ndGggLSAxXS5zdHlsZXM7XHJcbiAgICAgICAgdmFyIGJvdGhTdHlsZXMgPSBbZmlyc3RTdHlsZXMsIGxhc3RTdHlsZXNdO1xyXG4gICAgICAgIC8vIEZJWE1FOiB0aGlzIHdvbid0IHdvcmsgYXMgZXhwZWN0ZWQgZm9yIGF1Z21lbnRlZCBhbmltYXRpb25zIC0gbWF5IG5lZWQgdGhlIGVkaXRvciBpdHNlbGYgdG8gbWFuYWdlIHRoaXNcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGJvdGhTdHlsZXNfMSA9IGJvdGhTdHlsZXM7IF9pIDwgYm90aFN0eWxlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgc3R5bGVzID0gYm90aFN0eWxlc18xW19pXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBzdHlsZXNVc2VkXzEgPSBzdHlsZXNVc2VkOyBfYSA8IHN0eWxlc1VzZWRfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHN0eWxlc1VzZWRfMVtfYV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIShzdHlsZSBpbiBzdHlsZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzW3N0eWxlXSA9IGNvbXB1dGVkU3R5bGVbc3R5bGVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFuaW1hdG9yLnByb3RvdHlwZS5nZXRBbGxTdHlsZXNVc2VkID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xyXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGFuaW1hdGlvbi5zdGVwczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHN0ZXAgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzdGVwLnN0eWxlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaW5kZXhPZihrZXkpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwcm9wZXJ0aWVzO1xyXG4gICAgfTtcclxuICAgIEFuaW1hdG9yLnByb3RvdHlwZS50cmlnZ2VyQW5pbWF0aW9uID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gVE9ETzogZG8gZm9yIEFMTCBlbGVtZW50c1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYW5pbWF0aW9uLmVsZW1lbnRJZCB8fCBhbmltYXRpb24uaWQgfHwgJycpKTtcclxuICAgICAgICBpZiAoIWVsZW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndhcm5FbGVtZW50Tm90UHJlc2VudChhbmltYXRpb24uZWxlbWVudElkIHx8IGFuaW1hdGlvbi5pZCB8fCAnJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hdWdtZW50QW5pbWF0aW9uKGFuaW1hdGlvbiwgZWxlbWVudCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGRvIHRoaXMgcHJvcGVybHksIG1heSBoYXZlIG90aGVyIGFuaW1hdGlvbnMgb2YgZGlmZmVyZW50IHByb3BlcnRpZXNcclxuICAgICAgICAgICAgLy8gVE9ETzogb25seSBvdmVycmlkZSB0aGUgcHJvcGVydGllc1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBpZiB0aGVyZSBpcyBhbiBlbnRyYW5jZSBhbmQgaG92ZXIgYW5pbWF0aW9uLCB0aGUgdHJhbnNpdGlvbiBkdXJhdGlvbiB3aWxsIGdldCBlZmZlZFxyXG4gICAgICAgICAgICAvLyBlbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnJyk7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IHN0eWxlZFVzZWQgPSB0aGlzLmdldEFsbFN0eWxlc1VzZWQoYW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ25vbmUnO1xyXG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcwJztcclxuICAgICAgICAgICAgYXNzaWduKGVsZW1lbnQuc3R5bGUsIGFuaW1hdGlvbi5zdGVwc1swXS5zdHlsZXMpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBxdWV1ZS9iYXRjaCB0aGVzZSB0aW1lb3V0c1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBvbmx5IGluY2x1ZGUgcHJvcGVydGllcyBleHBsaWNpdGx5IHNldCBpbiB0aGUgYW5pbWF0aW9uXHJcbiAgICAgICAgICAgIC8vIHVzaW5nIE9iamVjdC5rZXlzKHN0eWxlcylcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSBcImFsbCBcIi5jb25jYXQoYW5pbWF0aW9uLmR1cmF0aW9uLCBcInMgXCIpLmNvbmNhdChjYW1lbENhc2VUb0tlYmFiQ2FzZShhbmltYXRpb24uZWFzaW5nKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uLmRlbGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSBhbmltYXRpb24uZGVsYXkgKyAncyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhc3NpZ24oZWxlbWVudC5zdHlsZSwgYW5pbWF0aW9uLnN0ZXBzWzFdLnN0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBtYXliZSByZW1vdmUvcmVzZXQgdHJhbnNpdG9pbiBwcm9wZXJ0eSBhZnRlciBhbmltYXRpb24gZHVyYXRpb25cclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHF1ZXVlIHRpbWVyc1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogd2hhdCBpZiBoYXMgb3RoZXIgdHJhbnNpdGlvbiAocmVzZXQgYmFjayB0byB3aGF0IGl0IHdhcylcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfSwgKGFuaW1hdGlvbi5kZWxheSB8fCAwKSAqIDEwMDAgKyBhbmltYXRpb24uZHVyYXRpb24gKiAxMDAwICsgMTAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgQW5pbWF0b3IucHJvdG90eXBlLmJpbmRIb3ZlckFuaW1hdGlvbiA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFRPRE86IGlzIGl0IG11bHRpcGxlIGJpbmRpbmcgd2hlbiBlZGl0aW5nLi4uP1xyXG4gICAgICAgIC8vIFRPRE86IHVuYmluZCBvbiBlbGVtZW50IHJlbW92ZVxyXG4gICAgICAgIC8vIFRPRE86IGFwcGx5IHRvIEFMTCBlbGVtZW50c1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYW5pbWF0aW9uLmVsZW1lbnRJZCB8fCBhbmltYXRpb24uaWQgfHwgJycpKTtcclxuICAgICAgICBpZiAoIWVsZW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndhcm5FbGVtZW50Tm90UHJlc2VudChhbmltYXRpb24uZWxlbWVudElkIHx8IGFuaW1hdGlvbi5pZCB8fCAnJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hdWdtZW50QW5pbWF0aW9uKGFuaW1hdGlvbiwgZWxlbWVudCk7XHJcbiAgICAgICAgICAgIHZhciBkZWZhdWx0U3RhdGUgPSBhbmltYXRpb24uc3RlcHNbMF0uc3R5bGVzO1xyXG4gICAgICAgICAgICB2YXIgaG92ZXJTdGF0ZSA9IGFuaW1hdGlvbi5zdGVwc1sxXS5zdHlsZXM7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaERlZmF1bHRTdGF0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGFzc2lnbihlbGVtZW50LnN0eWxlLCBkZWZhdWx0U3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaEhvdmVyU3RhdGUoKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NpZ24oZWxlbWVudC5zdHlsZSwgaG92ZXJTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYXR0YWNoRGVmYXVsdFN0YXRlKCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGF0dGFjaEhvdmVyU3RhdGUpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBhdHRhY2hEZWZhdWx0U3RhdGUpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBxdWV1ZS9iYXRjaCB0aGVzZSB0aW1lb3V0c1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9IFwiYWxsIFwiLmNvbmNhdChhbmltYXRpb24uZHVyYXRpb24sIFwicyBcIikuY29uY2F0KGNhbWVsQ2FzZVRvS2ViYWJDYXNlKGFuaW1hdGlvbi5lYXNpbmcpKTtcclxuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24uZGVsYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9IGFuaW1hdGlvbi5kZWxheSArICdzJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gVE9ETzogdW5iaW5kIG9uIGVsZW1lbnQgcmVtb3ZlXHJcbiAgICBBbmltYXRvci5wcm90b3R5cGUuYmluZFNjcm9sbEluVmlld0FuaW1hdGlvbiA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFRPRE86IGFwcGx5IHRvIEFMTCBtYXRjaGluZyBlbGVtZW50c1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYW5pbWF0aW9uLmVsZW1lbnRJZCB8fCBhbmltYXRpb24uaWQgfHwgJycpKTtcclxuICAgICAgICBpZiAoIWVsZW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndhcm5FbGVtZW50Tm90UHJlc2VudChhbmltYXRpb24uZWxlbWVudElkIHx8IGFuaW1hdGlvbi5pZCB8fCAnJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVE9ETzogaWYgc2VydmVyIHNpZGUgcmVuZGVyZWQgYW5kIHNjcm9sbGVkIGludG8gdmlldyBkb24ndCBhbmltYXRlLi4uXHJcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hdWdtZW50QW5pbWF0aW9uKGFuaW1hdGlvbiwgZWxlbWVudCk7XHJcbiAgICAgICAgICAgIHZhciB0cmlnZ2VyZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHBlbmRpbmdBbmltYXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgZnVuY3Rpb24gaW1tZWRpYXRlT25TY3JvbGwoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRyaWdnZXJlZCAmJiBpc1Njcm9sbGVkSW50b1ZpZXcoZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdBbmltYXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ24oZWxlbWVudC5zdHlsZSwgYW5pbWF0aW9uLnN0ZXBzWzFdLnN0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYW5pbWF0aW9uLnJlcGVhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgb25TY3JvbGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0FuaW1hdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbmltYXRpb24ucmVwZWF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgKGFuaW1hdGlvbi5kdXJhdGlvbiArIChhbmltYXRpb24uZGVsYXkgfHwgMCkpICogMTAwMCArIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhbmltYXRpb24ucmVwZWF0ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIXBlbmRpbmdBbmltYXRpb24gJiZcclxuICAgICAgICAgICAgICAgICAgICAhaXNTY3JvbGxlZEludG9WaWV3KGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2Ugd2FudCB0byByZXBlYXQgdGhlIGFuaW1hdGlvbiBldmVyeSB0aW1lIHRoZSB0aGUgZWxlbWVudCBpcyBvdXQgb2YgdmlldyBhbmQgYmFjayBhZ2FpblxyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2lnbihlbGVtZW50LnN0eWxlLCBhbmltYXRpb24uc3RlcHNbMF0uc3R5bGVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBUT0RPOiByb2xsIGFsbCBvZiB0aGVzZSBpbiBvbmUgZm9yIG1vcmUgZWZmaWNpZW5jeSBvZiBjaGVja2luZyBhbGwgdGhlIHJlY3RzXHJcbiAgICAgICAgICAgIHZhciBvblNjcm9sbCA9IHRocm90dGxlKGltbWVkaWF0ZU9uU2Nyb2xsLCAyMDAsIHsgbGVhZGluZzogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGZ1bGx5IGluIHZpZXcgb3IgcGFydGlhbGx5XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzU2Nyb2xsZWRJbnRvVmlldyhlbGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgdmFyIHRocmVzaG9sZFBlcmNlbnQgPSAoYW5pbWF0aW9uLnRocmVzaG9sZFBlcmNlbnQgfHwgMCkgLyAxMDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGhyZXNob2xkID0gdGhyZXNob2xkUGVyY2VudCAqIHdpbmRvd0hlaWdodDtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHBhcnRpYWwgaW4gdmlldz8gb3Igd2hhdCBpZiBlbGVtZW50IGlzIGxhcmdlciB0aGFuIHNjcmVlbiBpdHNlbGZcclxuICAgICAgICAgICAgICAgIHJldHVybiAocmVjdC5ib3R0b20gPiB0aHJlc2hvbGQgJiYgcmVjdC50b3AgPCB3aW5kb3dIZWlnaHQgLSB0aHJlc2hvbGQgLy8gRWxlbWVudCBpcyBwZWVraW5nIHRvcCBvciBib3R0b21cclxuICAgICAgICAgICAgICAgIC8vIChyZWN0LnRvcCA+IDAgJiYgcmVjdC5ib3R0b20gPCB3aW5kb3cuaW5uZXJIZWlnaHQpIHx8IC8vIGVsZW1lbnQgZml0cyB3aXRoaW4gdGhlIHNjcmVlbiBhbmQgaXMgZnVsbHkgb24gc2NyZWVuIChub3QgaGFuZ2luZyBvZmYgYXQgYWxsKVxyXG4gICAgICAgICAgICAgICAgLy8gKHJlY3QudG9wIDwgMCAmJiByZWN0LmJvdHRvbSA+IHdpbmRvdy5pbm5lckhlaWdodCkgLy8gZWxlbWVudCBpcyBsYXJnZXIgdGhhbiB0aGUgc2NyZWVuIGFuZCBoYW5ncyBvdmVyIHRoZSB0b3AgYW5kIGJvdHRvbVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZGVmYXVsdFN0YXRlID0gYW5pbWF0aW9uLnN0ZXBzWzBdLnN0eWxlcztcclxuICAgICAgICAgICAgZnVuY3Rpb24gYXR0YWNoRGVmYXVsdFN0YXRlKCkge1xyXG4gICAgICAgICAgICAgICAgYXNzaWduKGVsZW1lbnQuc3R5bGUsIGRlZmF1bHRTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYXR0YWNoRGVmYXVsdFN0YXRlKCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IHF1ZXVlL2JhdGNoIHRoZXNlIHRpbWVvdXRzIVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9IFwiYWxsIFwiLmNvbmNhdChhbmltYXRpb24uZHVyYXRpb24sIFwicyBcIikuY29uY2F0KGNhbWVsQ2FzZVRvS2ViYWJDYXNlKGFuaW1hdGlvbi5lYXNpbmcpKTtcclxuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24uZGVsYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9IGFuaW1hdGlvbi5kZWxheSArICdzJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IG9uZSBsaXN0ZW5lciBmb3IgZXZlcnl0aGluZ1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBvblNjcm9sbCwgeyBjYXB0dXJlOiB0cnVlLCBwYXNzaXZlOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAvLyBEbyBhbiBpbml0aWFsIGNoZWNrXHJcbiAgICAgICAgICAgIGltbWVkaWF0ZU9uU2Nyb2xsKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFuaW1hdG9yO1xyXG59KCkpO1xuXG4vKipcclxuICogT25seSBnZXRzIG9uZSBsZXZlbCB1cCBmcm9tIGhvc3RuYW1lXHJcbiAqIHd3d3cuZXhhbXBsZS5jb20gLT4gZXhhbXBsZS5jb21cclxuICogd3d3LmV4YW1wbGUuY28udWsgLT4gZXhhbXBsZS5jby51a1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0VG9wTGV2ZWxEb21haW4oaG9zdCkge1xyXG4gICAgdmFyIHBhcnRzID0gaG9zdC5zcGxpdCgnLicpO1xyXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA+IDIpIHtcclxuICAgICAgICByZXR1cm4gcGFydHMuc2xpY2UoMSkuam9pbignLicpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhvc3Q7XHJcbn1cblxuLyoqXHJcbiAqIFJlZ0V4cCB0byBtYXRjaCBmaWVsZC1jb250ZW50IGluIFJGQyA3MjMwIHNlYyAzLjJcclxuICpcclxuICogZmllbGQtY29udGVudCA9IGZpZWxkLXZjaGFyIFsgMSooIFNQIC8gSFRBQiApIGZpZWxkLXZjaGFyIF1cclxuICogZmllbGQtdmNoYXIgICA9IFZDSEFSIC8gb2JzLXRleHRcclxuICogb2JzLXRleHQgICAgICA9ICV4ODAtRkZcclxuICovXHJcbnZhciBmaWVsZENvbnRlbnRSZWdFeHAgPSAvXltcXHUwMDA5XFx1MDAyMC1cXHUwMDdlXFx1MDA4MC1cXHUwMGZmXSskLztcclxudmFyIENvb2tpZXMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDb29raWVzKHJlcXVlc3QsIHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDtcclxuICAgICAgICB0aGlzLnJlc3BvbnNlID0gcmVzcG9uc2U7XHJcbiAgICB9XHJcbiAgICBDb29raWVzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHZhciBoZWFkZXIgPSB0aGlzLnJlcXVlc3QuaGVhZGVyc1snY29va2llJ107XHJcbiAgICAgICAgaWYgKCFoZWFkZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWF0Y2ggPSBoZWFkZXIubWF0Y2goZ2V0UGF0dGVybihuYW1lKSk7XHJcbiAgICAgICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB2YWx1ZSA9IG1hdGNoWzFdO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH07XHJcbiAgICBDb29raWVzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIG9wdHMpIHtcclxuICAgICAgICB2YXIgcmVzID0gdGhpcy5yZXNwb25zZTtcclxuICAgICAgICB2YXIgcmVxID0gdGhpcy5yZXF1ZXN0O1xyXG4gICAgICAgIHZhciBoZWFkZXJzID0gcmVzLmdldEhlYWRlcignU2V0LUNvb2tpZScpIHx8IFtdO1xyXG4gICAgICAgIC8vIFRPRE86IGp1c3QgbWFrZSB0aGlzIGFsd2F5cyB0cnVlXHJcbiAgICAgICAgdmFyIHNlY3VyZSA9IHRoaXMuc2VjdXJlICE9PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgPyAhIXRoaXMuc2VjdXJlXHJcbiAgICAgICAgICAgIDogcmVxLnByb3RvY29sID09PSAnaHR0cHMnIHx8IHJlcS5jb25uZWN0aW9uLmVuY3J5cHRlZDtcclxuICAgICAgICB2YXIgY29va2llID0gbmV3IENvb2tpZShuYW1lLCB2YWx1ZSwgb3B0cyk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBoZWFkZXJzID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBoZWFkZXJzID0gW2hlYWRlcnNdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXNlY3VyZSAmJiBvcHRzICYmIG9wdHMuc2VjdXJlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHNlbmQgc2VjdXJlIGNvb2tpZSBvdmVyIHVuZW5jcnlwdGVkIGNvbm5lY3Rpb24nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29va2llLnNlY3VyZSA9IHNlY3VyZTtcclxuICAgICAgICBpZiAob3B0cyAmJiAnc2VjdXJlJyBpbiBvcHRzKSB7XHJcbiAgICAgICAgICAgIGNvb2tpZS5zZWN1cmUgPSAhIW9wdHMuc2VjdXJlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb29raWUuZG9tYWluID0gcmVxLmhlYWRlcnMuaG9zdCAmJiBnZXRUb3BMZXZlbERvbWFpbihyZXEuaGVhZGVycy5ob3N0KTtcclxuICAgICAgICBwdXNoQ29va2llKGhlYWRlcnMsIGNvb2tpZSk7XHJcbiAgICAgICAgdmFyIHNldEhlYWRlciA9IHJlcy5zZXRIZWFkZXI7XHJcbiAgICAgICAgc2V0SGVhZGVyLmNhbGwocmVzLCAnU2V0LUNvb2tpZScsIGhlYWRlcnMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb29raWVzO1xyXG59KCkpO1xyXG52YXIgQ29va2llID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ29va2llKG5hbWUsIHZhbHVlLCBhdHRycykge1xyXG4gICAgICAgIHRoaXMucGF0aCA9ICcvJztcclxuICAgICAgICB0aGlzLmRvbWFpbiA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLmh0dHBPbmx5ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNhbWVTaXRlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZWN1cmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm92ZXJ3cml0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICcnO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSAnJztcclxuICAgICAgICBpZiAoIWZpZWxkQ29udGVudFJlZ0V4cC50ZXN0KG5hbWUpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2FyZ3VtZW50IG5hbWUgaXMgaW52YWxpZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsdWUgJiYgIWZpZWxkQ29udGVudFJlZ0V4cC50ZXN0KHZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdhcmd1bWVudCB2YWx1ZSBpcyBpbnZhbGlkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5leHBpcmVzID0gbmV3IERhdGUoMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlIHx8ICcnO1xyXG4gICAgICAgIGlmIChhdHRycy5leHBpcmVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXhwaXJlcyA9IGF0dHJzLmV4cGlyZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhdHRycy5zZWN1cmUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWN1cmUgPSBhdHRycy5zZWN1cmU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgQ29va2llLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCJcIi5jb25jYXQodGhpcy5uYW1lLCBcIj1cIikuY29uY2F0KHRoaXMudmFsdWUpO1xyXG4gICAgfTtcclxuICAgIENvb2tpZS5wcm90b3R5cGUudG9IZWFkZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGhlYWRlciA9IHRoaXMudG9TdHJpbmcoKTtcclxuICAgICAgICBpZiAodGhpcy5tYXhBZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5leHBpcmVzID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIHRoaXMubWF4QWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGF0aCkge1xyXG4gICAgICAgICAgICBoZWFkZXIgKz0gXCI7IHBhdGg9XCIuY29uY2F0KHRoaXMucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmV4cGlyZXMpIHtcclxuICAgICAgICAgICAgaGVhZGVyICs9IFwiOyBleHBpcmVzPVwiLmNvbmNhdCh0aGlzLmV4cGlyZXMudG9VVENTdHJpbmcoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmRvbWFpbikge1xyXG4gICAgICAgICAgICBoZWFkZXIgKz0gXCI7IGRvbWFpbj1cIi5jb25jYXQodGhpcy5kb21haW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUT0RPOiBzYW1lc2l0ZT1ub25lIGJ5IGRlZmF1bHQgKD8pXHJcbiAgICAgICAgaGVhZGVyICs9IFwiOyBTYW1lU2l0ZT1cIi5jb25jYXQodGhpcy5zYW1lU2l0ZSA9PT0gdHJ1ZSA/ICdzdHJpY3QnIDogJ05vbmUnKTtcclxuICAgICAgICAvLyBUT0RPOiBPbiBieSBkZWZhdWx0XHJcbiAgICAgICAgaWYgKHRoaXMuc2VjdXJlKSB7XHJcbiAgICAgICAgICAgIGhlYWRlciArPSAnOyBzZWN1cmUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5odHRwT25seSkge1xyXG4gICAgICAgICAgICBoZWFkZXIgKz0gJzsgaHR0cG9ubHknO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGVhZGVyO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb29raWU7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGdldFBhdHRlcm4obmFtZSkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoXCIoPzpefDspICpcIi5jb25jYXQobmFtZS5yZXBsYWNlKC9bLVtcXF17fSgpKis/LixcXFxcXiR8I1xcc10vZywgJ1xcXFwkJicpLCBcIj0oW147XSopXCIpKTtcclxufVxyXG5mdW5jdGlvbiBwdXNoQ29va2llKGhlYWRlcnMsIGNvb2tpZSkge1xyXG4gICAgaWYgKGNvb2tpZS5vdmVyd3JpdGUpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gaGVhZGVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBpZiAoaGVhZGVyc1tpXS5pbmRleE9mKFwiXCIuY29uY2F0KGNvb2tpZS5uYW1lLCBcIj1cIikpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGhlYWRlcnMucHVzaChjb29raWUudG9IZWFkZXIoKSk7XHJcbn1cblxuZnVuY3Rpb24gb21pdChvYmopIHtcclxuICAgIHZhciB2YWx1ZXMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFsdWVzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgdmFyIG5ld09iamVjdCA9IE9iamVjdC5hc3NpZ24oe30sIG9iaik7XHJcbiAgICBmb3IgKHZhciBfYSA9IDAsIHZhbHVlc18xID0gdmFsdWVzOyBfYSA8IHZhbHVlc18xLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgIHZhciBrZXkgPSB2YWx1ZXNfMVtfYV07XHJcbiAgICAgICAgZGVsZXRlIG5ld09iamVjdFtrZXldO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ld09iamVjdDtcclxufVxuXG4vKipcclxuICogQGNyZWRpdCBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjExNzUyM1xyXG4gKi9cclxuZnVuY3Rpb24gdXVpZHY0KCkge1xyXG4gICAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICB2YXIgciA9IChNYXRoLnJhbmRvbSgpICogMTYpIHwgMCwgdiA9IGMgPT0gJ3gnID8gciA6IChyICYgMHgzKSB8IDB4ODtcclxuICAgICAgICByZXR1cm4gdi50b1N0cmluZygxNik7XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICogU2xpZ2h0bHkgY2xlYW5lciBhbmQgc21hbGxlciBVVUlEc1xyXG4gKi9cclxuZnVuY3Rpb24gdXVpZCgpIHtcclxuICAgIHJldHVybiB1dWlkdjQoKS5yZXBsYWNlKC8tL2csICcnKTtcclxufVxuXG5mdW5jdGlvbiBlbXB0eVVybCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcXVlcnk6IG51bGwsXHJcbiAgICAgICAgcG9ydDogbnVsbCxcclxuICAgICAgICBhdXRoOiBudWxsLFxyXG4gICAgICAgIGhhc2g6IG51bGwsXHJcbiAgICAgICAgaG9zdDogbnVsbCxcclxuICAgICAgICBob3N0bmFtZTogbnVsbCxcclxuICAgICAgICBocmVmOiBudWxsLFxyXG4gICAgICAgIHBhdGg6IG51bGwsXHJcbiAgICAgICAgcGF0aG5hbWU6IG51bGwsXHJcbiAgICAgICAgcHJvdG9jb2w6IG51bGwsXHJcbiAgICAgICAgc2VhcmNoOiBudWxsLFxyXG4gICAgICAgIHNsYXNoZXM6IG51bGwsXHJcbiAgICB9O1xyXG59XHJcbi8vIFJlcGxhY2VtZW50IGZvciBgdXJsLnBhcnNlYCB1c2luZyBgVVJMYCBnbG9iYWwgb2JqZWN0IHRoYXQgd29ya3Mgd2l0aCByZWxhdGl2ZSBwYXRocy5cclxuLy8gQXNzdW1wdGlvbnM6IHRoaXMgZnVuY3Rpb24gb3BlcmF0ZXMgaW4gYSBOb2RlSlMgZW52aXJvbm1lbnQuXHJcbmZ1bmN0aW9uIHBhcnNlJDEodXJsKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICB2YXIgb3V0ID0gZW1wdHlVcmwoKTtcclxuICAgIHZhciB1O1xyXG4gICAgdmFyIHBhdGhPbmx5ID0gdXJsID09PSAnJyB8fCB1cmxbMF0gPT09ICcvJztcclxuICAgIGlmIChwYXRoT25seSkge1xyXG4gICAgICAgIHUgPSBuZXcgVVJMKHVybCwgJ2h0dHA6Ly8wLjAuMC4wLycpO1xyXG4gICAgICAgIG91dC5ocmVmID0gdS5ocmVmO1xyXG4gICAgICAgIG91dC5ocmVmID0gKF9hID0gb3V0LmhyZWYpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zbGljZSgxNCk7IC8vIHJlbW92ZSAnaHR0cDovLzAuMC4wLjAvJ1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdSA9IG5ldyBVUkwodXJsKTtcclxuICAgICAgICBvdXQuaHJlZiA9IHUuaHJlZjtcclxuICAgICAgICBvdXQucG9ydCA9IHUucG9ydCA9PT0gJycgPyBudWxsIDogdS5wb3J0O1xyXG4gICAgICAgIG91dC5oYXNoID0gdS5oYXNoID09PSAnJyA/IG51bGwgOiB1Lmhhc2g7XHJcbiAgICAgICAgb3V0Lmhvc3QgPSB1Lmhvc3Q7XHJcbiAgICAgICAgb3V0Lmhvc3RuYW1lID0gdS5ob3N0bmFtZTtcclxuICAgICAgICBvdXQuaHJlZiA9IHUuaHJlZjtcclxuICAgICAgICBvdXQucGF0aG5hbWUgPSB1LnBhdGhuYW1lO1xyXG4gICAgICAgIG91dC5wcm90b2NvbCA9IHUucHJvdG9jb2w7XHJcbiAgICAgICAgb3V0LnNsYXNoZXMgPSB1cmxbdS5wcm90b2NvbC5sZW5ndGhdID09PSAnLyc7IC8vIGNoZWNrIGlmIHRoZSBtaW1ldHlwZSBpcyBwcm9jZWVkZWQgYnkgYSBzbGFzaFxyXG4gICAgfVxyXG4gICAgb3V0LnNlYXJjaCA9IHUuc2VhcmNoO1xyXG4gICAgb3V0LnF1ZXJ5ID0gdS5zZWFyY2guc2xpY2UoMSk7IC8vIHJlbW92ZSAnPydcclxuICAgIG91dC5wYXRoID0gXCJcIi5jb25jYXQodS5wYXRobmFtZSkuY29uY2F0KHUuc2VhcmNoKTtcclxuICAgIG91dC5wYXRobmFtZSA9IHUucGF0aG5hbWU7XHJcbiAgICByZXR1cm4gb3V0O1xyXG59XG5cbi8qKlxyXG4gKiBTYWZlIGNvbnZlcnNpb24gdG8gZXJyb3IgdHlwZS4gSW50ZW5kZWQgdG8gYmUgdXNlZCBpbiBjYXRjaCBibG9ja3Mgd2hlcmUgdGhlXHJcbiAqICB2YWx1ZSBpcyBub3QgZ3VhcmFudGVlZCB0byBiZSBhbiBlcnJvci5cclxuICpcclxuICogIEBleGFtcGxlXHJcbiAqICB0cnkge1xyXG4gKiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NvbWV0aGluZyB3ZW50IHdyb25nJylcclxuICogIH1cclxuICogIGNhdGNoIChlcnI6IHVua25vd24pIHtcclxuICogICAgY29uc3QgZXJyb3I6IEVycm9yID0gdG9FcnJvcihlcnIpXHJcbiAqICB9XHJcbiAqL1xyXG5mdW5jdGlvbiB0b0Vycm9yKGVycikge1xyXG4gICAgaWYgKGVyciBpbnN0YW5jZW9mIEVycm9yKVxyXG4gICAgICAgIHJldHVybiBlcnI7XHJcbiAgICByZXR1cm4gbmV3IEVycm9yKFN0cmluZyhlcnIpKTtcclxufVxuXG52YXIgREVGQVVMVF9BUElfVkVSU0lPTiA9ICd2Myc7XG5cbmZ1bmN0aW9uIGRhdGVQbHVzTWludXRlcyhtaW51dGVzKSB7XHJcbiAgICBpZiAobWludXRlcyA9PT0gdm9pZCAwKSB7IG1pbnV0ZXMgPSAzMDsgfVxyXG4gICAgcmV0dXJuIG5ldyBEYXRlKERhdGUubm93KCkgKyBtaW51dGVzICogNjAwMDApO1xyXG59XHJcbnZhciBpc1Bvc2l0aXZlTnVtYmVyID0gZnVuY3Rpb24gKHRoaW5nKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHRoaW5nID09PSAnbnVtYmVyJyAmJiAhaXNOYU4odGhpbmcpICYmIHRoaW5nID49IDA7XHJcbn07XHJcbnZhciBpc1JlYWN0TmF0aXZlID0gdHlwZW9mIG5hdmlnYXRvciA9PT0gJ29iamVjdCcgJiYgbmF2aWdhdG9yLnByb2R1Y3QgPT09ICdSZWFjdE5hdGl2ZSc7XHJcbnZhciB2YWxpZEVudkxpc3QgPSBbXHJcbiAgICAncHJvZHVjdGlvbicsXHJcbiAgICAncWEnLFxyXG4gICAgJ3Rlc3QnLFxyXG4gICAgJ2RldmVsb3BtZW50JyxcclxuICAgICdkZXYnLFxyXG4gICAgJ2Nkbi1xYScsXHJcbiAgICAnY2xvdWQnLFxyXG4gICAgJ2Zhc3QnLFxyXG4gICAgJ2NkbjInLFxyXG4gICAgJ2Nkbi1wcm9kJyxcclxuXTtcclxuZnVuY3Rpb24gZ2V0UXVlcnlQYXJhbSh1cmwsIHZhcmlhYmxlKSB7XHJcbiAgICB2YXIgcXVlcnkgPSB1cmwuc3BsaXQoJz8nKVsxXSB8fCAnJztcclxuICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpO1xyXG4gICAgICAgIGlmIChkZWNvZGVVUklDb21wb25lbnQocGFpclswXSkgPT09IHZhcmlhYmxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxudmFyIHVybFBhcnNlciA9IHtcclxuICAgIHBhcnNlOiBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIGVsLmhyZWYgPSB1cmw7XHJcbiAgICAgICAgdmFyIG91dCA9IHt9O1xyXG4gICAgICAgIHZhciBwcm9wcyA9IFtcclxuICAgICAgICAgICAgJ3VzZXJuYW1lJyxcclxuICAgICAgICAgICAgJ3Bhc3N3b3JkJyxcclxuICAgICAgICAgICAgJ2hvc3QnLFxyXG4gICAgICAgICAgICAnaG9zdG5hbWUnLFxyXG4gICAgICAgICAgICAncG9ydCcsXHJcbiAgICAgICAgICAgICdwcm90b2NvbCcsXHJcbiAgICAgICAgICAgICdvcmlnaW4nLFxyXG4gICAgICAgICAgICAncGF0aG5hbWUnLFxyXG4gICAgICAgICAgICAnc2VhcmNoJyxcclxuICAgICAgICAgICAgJ2hhc2gnLFxyXG4gICAgICAgIF07XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwcm9wc18xID0gcHJvcHM7IF9pIDwgcHJvcHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHByb3AgPSBwcm9wc18xW19pXTtcclxuICAgICAgICAgICAgb3V0W3Byb3BdID0gZWxbcHJvcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElFIDExIHBhdGhuYW1lIGhhbmRsaW5nIHdvcmthcm91bmRcclxuICAgICAgICAvLyAoSUUgb21pdHMgcHJlY2VlZGluZyAnLycsIHVubGlrZSBvdGhlciBicm93c2VycylcclxuICAgICAgICBpZiAoKG91dC5wYXRobmFtZSB8fCBvdXQucGF0aG5hbWUgPT09ICcnKSAmJlxyXG4gICAgICAgICAgICB0eXBlb2Ygb3V0LnBhdGhuYW1lID09PSAnc3RyaW5nJyAmJlxyXG4gICAgICAgICAgICBvdXQucGF0aG5hbWUuaW5kZXhPZignLycpICE9PSAwKSB7XHJcbiAgICAgICAgICAgIG91dC5wYXRobmFtZSA9ICcvJyArIG91dC5wYXRobmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dDtcclxuICAgIH0sXHJcbn07XHJcbnZhciBwYXJzZSA9IGlzUmVhY3ROYXRpdmVcclxuICAgID8gZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHlVcmwoKTsgfVxyXG4gICAgOiB0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0J1xyXG4gICAgICAgID8gdXJsUGFyc2VyLnBhcnNlXHJcbiAgICAgICAgOiBwYXJzZSQxO1xyXG5mdW5jdGlvbiBzZXRDb29raWUobmFtZSwgdmFsdWUsIGV4cGlyZXMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIGV4cGlyZXNTdHJpbmcgPSAnJztcclxuICAgICAgICAvLyBUT0RPOiBuZWVkIHRvIGtub3cgaWYgc2VjdXJlIHNlcnZlciBzaWRlXHJcbiAgICAgICAgaWYgKGV4cGlyZXMpIHtcclxuICAgICAgICAgICAgZXhwaXJlc1N0cmluZyA9ICc7IGV4cGlyZXM9JyArIGV4cGlyZXMudG9VVENTdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNlY3VyZSA9IGlzQnJvd3NlciA/IGxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6JyA6IHRydWU7XHJcbiAgICAgICAgZG9jdW1lbnQuY29va2llID1cclxuICAgICAgICAgICAgbmFtZSArXHJcbiAgICAgICAgICAgICAgICAnPScgK1xyXG4gICAgICAgICAgICAgICAgKHZhbHVlIHx8ICcnKSArXHJcbiAgICAgICAgICAgICAgICBleHBpcmVzU3RyaW5nICtcclxuICAgICAgICAgICAgICAgICc7IHBhdGg9LycgK1xyXG4gICAgICAgICAgICAgICAgXCI7IGRvbWFpbj1cIi5jb25jYXQoZ2V0VG9wTGV2ZWxEb21haW4obG9jYXRpb24uaG9zdG5hbWUpKSArXHJcbiAgICAgICAgICAgICAgICAoc2VjdXJlID8gJzsgc2VjdXJlOyBTYW1lU2l0ZT1Ob25lJyA6ICcnKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBzZXQgY29va2llJywgZXJyKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gKGRlY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5jb29raWUucmVwbGFjZShuZXcgUmVnRXhwKCcoPzooPzpefC4qOylcXFxccyonICtcclxuICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpLnJlcGxhY2UoL1tcXC1cXC5cXCtcXCpdL2csICdcXFxcJCYnKSArXHJcbiAgICAgICAgICAgICdcXFxccypcXFxcPVxcXFxzKihbXjtdKikuKiQpfF4uKiQnKSwgJyQxJykpIHx8IG51bGwpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IGdldCBjb29raWUnLCBlcnIpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNpemUob2JqZWN0KSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqZWN0KS5sZW5ndGg7XHJcbn1cclxuZnVuY3Rpb24gZmluZCh0YXJnZXQsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgbGlzdCA9IHRhcmdldDtcclxuICAgIC8vIE1ha2VzIHN1cmVzIGlzIGFsd2F5cyBoYXMgYW4gcG9zaXRpdmUgaW50ZWdlciBhcyBsZW5ndGguXHJcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XHJcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgZWxlbWVudCA9IGxpc3RbaV07XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrLmNhbGwodGhpc0FyZywgZWxlbWVudCwgaSwgbGlzdCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbnZhciBzZXNzaW9uU3RvcmFnZUtleSA9ICdidWlsZGVyU2Vzc2lvbklkJztcclxudmFyIGxvY2FsU3RvcmFnZUtleSA9ICdidWlsZGVyVmlzaXRvcklkJztcclxudmFyIGlzQnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICFpc1JlYWN0TmF0aXZlO1xyXG52YXIgaXNJZnJhbWUgPSBpc0Jyb3dzZXIgJiYgd2luZG93LnRvcCAhPT0gd2luZG93LnNlbGY7XHJcbmZ1bmN0aW9uIEJ1aWxkZXJDb21wb25lbnQoaW5mbykge1xyXG4gICAgaWYgKGluZm8gPT09IHZvaWQgMCkgeyBpbmZvID0ge307IH1cclxuICAgIHJldHVybiBCdWlsZGVyLkNvbXBvbmVudChpbmZvKTtcclxufVxyXG52YXIgQnVpbGRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJ1aWxkZXIoYXBpS2V5LCByZXF1ZXN0LCByZXNwb25zZSwgZm9yY2VOZXdJbnN0YW5jZSwgYXV0aFRva2VuLCBhcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgaWYgKGFwaUtleSA9PT0gdm9pZCAwKSB7IGFwaUtleSA9IG51bGw7IH1cclxuICAgICAgICBpZiAoZm9yY2VOZXdJbnN0YW5jZSA9PT0gdm9pZCAwKSB7IGZvcmNlTmV3SW5zdGFuY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIGlmIChhdXRoVG9rZW4gPT09IHZvaWQgMCkgeyBhdXRoVG9rZW4gPSBudWxsOyB9XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0O1xyXG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcclxuICAgICAgICB0aGlzLmV2ZW50c1F1ZXVlID0gW107XHJcbiAgICAgICAgdGhpcy50aHJvdHRsZWRDbGVhckV2ZW50c1F1ZXVlID0gdGhyb3R0bGUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5wcm9jZXNzRXZlbnRzUXVldWUoKTtcclxuICAgICAgICAgICAgLy8gRXh0ZW5kIHRoZSBzZXNzaW9uIGNvb2tpZVxyXG4gICAgICAgICAgICBfdGhpcy5zZXRDb29raWUoc2Vzc2lvblN0b3JhZ2VLZXksIF90aGlzLnNlc3Npb25JZCwgZGF0ZVBsdXNNaW51dGVzKDMwKSk7XHJcbiAgICAgICAgfSwgNSk7XHJcbiAgICAgICAgdGhpcy5lbnYgPSAncHJvZHVjdGlvbic7XHJcbiAgICAgICAgdGhpcy5zZXNzaW9uSWQgPSB0aGlzLmdldFNlc3Npb25JZCgpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0Q29udGVudCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jb250ZW50UGVyUmVxdWVzdCA9IDE7XHJcbiAgICAgICAgLy8gVE9ETzogbWFrZSBhcnJheSBvciBmdW5jdGlvblxyXG4gICAgICAgIHRoaXMuYWxsb3dDdXN0b21Gb250cyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jb29raWVzID0gbnVsbDtcclxuICAgICAgICAvLyBUT0RPOiBhcGkgb3B0aW9ucyBvYmplY3RcclxuICAgICAgICB0aGlzLmNhY2hlYnVzdCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVQYXJhbXMgPSAnJztcclxuICAgICAgICB0aGlzLm5vQ2FjaGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnByZXZpZXcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFwaVZlcnNpb24kID0gbmV3IEJlaGF2aW9yU3ViamVjdCh1bmRlZmluZWQpO1xyXG4gICAgICAgIHRoaXMuY2FuVHJhY2skID0gbmV3IEJlaGF2aW9yU3ViamVjdCghdGhpcy5icm93c2VyVHJhY2tpbmdEaXNhYmxlZCk7XHJcbiAgICAgICAgdGhpcy5hcGlLZXkkID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcclxuICAgICAgICB0aGlzLmF1dGhUb2tlbiQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpO1xyXG4gICAgICAgIHRoaXMudXNlckF0dHJpYnV0ZXNDaGFuZ2VkID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcclxuICAgICAgICB0aGlzLmVkaXRpbmdNb2RlJCA9IG5ldyBCZWhhdmlvclN1YmplY3QoaXNJZnJhbWUpO1xyXG4gICAgICAgIC8vIFRPRE86IGRlY29yYXRvciB0byBkbyB0aGlzIHN0dWZmIHdpdGggdGhlIGdldC9zZXQgKGhvdyBkbyB3aXRoIHR5cGluZyB0b28/IGNvbXBpbGVyPylcclxuICAgICAgICB0aGlzLmVkaXRpbmdNb2RlbCQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpO1xyXG4gICAgICAgIHRoaXMudXNlckFnZW50ID0gKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICdvYmplY3QnICYmIG5hdmlnYXRvci51c2VyQWdlbnQpIHx8ICcnO1xyXG4gICAgICAgIHRoaXMudHJhY2tpbmdIb29rcyA9IFtdO1xyXG4gICAgICAgIC8vIFNldCB0aGlzIHRvIGNvbnRyb2wgdGhlIHVzZXJJZFxyXG4gICAgICAgIC8vIFRPRE86IGFsbG93IGNoYW5naW5nIGl0IG1pZCBzZXNzaW9uIGFuZCB1cGRhdGluZyBleGlzdGluZyBkYXRhIHRvIGJlIGFzc29jaWF0ZWRcclxuICAgICAgICAvLyBlLmcuIGZvciB3aGVuIGEgdXNlciBuYXZpZ2F0ZXMgYW5kIHRoZW4gbG9ncyBpblxyXG4gICAgICAgIHRoaXMudmlzaXRvcklkID0gdGhpcy5nZXRWaXNpdG9ySWQoKTtcclxuICAgICAgICB0aGlzLmF1dG9UcmFjayA9ICFCdWlsZGVyLmlzQnJvd3NlclxyXG4gICAgICAgICAgICA/IGZhbHNlXHJcbiAgICAgICAgICAgIDogIXRoaXMuaXNEZXZlbG9wbWVudEVudiAmJlxyXG4gICAgICAgICAgICAgICAgIShCdWlsZGVyLmlzQnJvd3NlciAmJiBsb2NhdGlvbi5zZWFyY2guaW5kZXhPZignYnVpbGRlci5wcmV2aWV3PScpICE9PSAtMSk7XHJcbiAgICAgICAgdGhpcy50cmFja2luZ1VzZXJBdHRyaWJ1dGVzID0ge307XHJcbiAgICAgICAgdGhpcy5ibG9ja0NvbnRlbnRMb2FkaW5nID0gJyc7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnNCeUtleSA9IHt9O1xyXG4gICAgICAgIHRoaXMubm9FZGl0b3JVcGRhdGVzID0ge307XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZXMgPSB7fTtcclxuICAgICAgICB0aGlzLnF1ZXJ5T3B0aW9ucyA9IHt9O1xyXG4gICAgICAgIHRoaXMuZ2V0Q29udGVudFF1ZXVlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnByaW9yQ29udGVudFF1ZXVlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRlc3RDb29raWVQcmVmaXggPSAnYnVpbGRlci50ZXN0cyc7XHJcbiAgICAgICAgdGhpcy5jb29raWVRdWV1ZSA9IFtdO1xyXG4gICAgICAgIC8vIFRPRE86IHVzZSBhIHdpbmRvdyB2YXJpYWJsZSBmb3IgdGhpcyBwZXJoYXBzLCBlLmcuIGJjIHdlYmNvbXBvbmVudHMgbWF5IGJlIGxvYWRpbmcgYnVpbGRlciB0d2ljZVxyXG4gICAgICAgIC8vIHdpdGggaXQncyBhbmQgcmVhY3QgKHVzZSByb2xsdXAgYnVpbGQgdG8gZml4KVxyXG4gICAgICAgIGlmIChCdWlsZGVyLmlzQnJvd3NlciAmJiAhZm9yY2VOZXdJbnN0YW5jZSAmJiBCdWlsZGVyLnNpbmdsZXRvbkluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBCdWlsZGVyLnNpbmdsZXRvbkluc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0ICYmIHRoaXMucmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRVc2VyQWdlbnQodGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ3VzZXItYWdlbnQnXSB8fCAnJyk7XHJcbiAgICAgICAgICAgIHRoaXMuY29va2llcyA9IG5ldyBDb29raWVzKHRoaXMucmVxdWVzdCwgdGhpcy5yZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhcGlLZXkpIHtcclxuICAgICAgICAgICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IGFwaVZlcnNpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhdXRoVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBhdXRoVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5iaW5kTWVzc2FnZUxpc3RlbmVycygpO1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0VkaXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuYW5pbWF0b3JPcHRpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sICcqJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVE9ETzogcG9zdG1lc3NhZ2UgdG8gcGFyZW50IHRoZSBidWlsZGVyIGluZm8gZm9yIGV2ZXJ5IHBhY2thZ2VcclxuICAgICAgICAgICAgLy8gdHlwZTogJ2J1aWxkZXIuc2RrJywgZGF0YTogeyBuYW1lOiAnQGJ1aWxkZXIuaW8vcmVhY3QnLCB2ZXJzaW9uOiAnMC4xLjIzJyB9XHJcbiAgICAgICAgICAgIC8vICh3aW5kb3cgYXMgYW55KS5CVUlMREVSX1ZFUlNJT04gPSBCdWlsZGVyLlZFUlNJT047XHJcbiAgICAgICAgICAgIC8vIEVuc3VyZSBhbHdheXMgb25lIEJ1aWxkZXIgZ2xvYmFsIHNpbmdsZXRvblxyXG4gICAgICAgICAgICAvLyBUT0RPOiBzb21lIHBlb3BsZSB3b24ndCB3YW50IHRoaXMsIGUuZy4gcmFrdXRlblxyXG4gICAgICAgICAgICAvLyBNYXliZSBoaWRlIHRoaXMgYmVoaW5kIHN5bWJvbCBvciBvbiBkb2N1bWVudCwgZXRjXHJcbiAgICAgICAgICAgIC8vIGlmICgod2luZG93IGFzIGFueSkuQnVpbGRlcikge1xyXG4gICAgICAgICAgICAvLyAgIEJ1aWxkZXIuY29tcG9uZW50cyA9ICh3aW5kb3cgYXMgYW55KS5CdWlsZGVyLmNvbXBvbmVudHM7XHJcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgKHdpbmRvdyBhcyBhbnkpLkJ1aWxkZXIgPSBCdWlsZGVyO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc0lmcmFtZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VGcmFtZUxvYWRlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUT0RPOiBvbiBkZXN0cm95IGNsZWFyIHN1YnNjcmlwdGlvblxyXG4gICAgICAgIHRoaXMuY2FuVHJhY2skLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlc3Npb25TdG9yYWdlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShzZXNzaW9uU3RvcmFnZUtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oc2Vzc2lvblN0b3JhZ2VLZXksIF90aGlzLnNlc3Npb25JZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdTZXNzaW9uIHN0b3JhZ2UgZXJyb3InLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5ldmVudHNRdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy50aHJvdHRsZWRDbGVhckV2ZW50c1F1ZXVlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29va2llUXVldWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29va2llUXVldWUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRDb29raWUoaXRlbVswXSwgaXRlbVsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29va2llUXVldWUubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChpc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgLy8gVE9ETzogZGVmZXIgc28gc3ViY2xhc3MgY29uc3RydWN0b3IgcnVucyBhbmQgaW5qZWN0cyBsb2NhdGlvbiBzZXJ2aWNlXHJcbiAgICAgICAgICAgIHRoaXMuc2V0VGVzdHNGcm9tVXJsKCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGRvIHRoaXMgb24gZXZlcnkgcmVxdWVzdCBzZW5kP1xyXG4gICAgICAgICAgICB0aGlzLmdldE92ZXJyaWRlc0Zyb21RdWVyeVN0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEJ1aWxkZXIucmVnaXN0ZXIgPSBmdW5jdGlvbiAodHlwZSwgaW5mbykge1xyXG4gICAgICAgIC8vIFRPRE86IGFsbCBtdXN0IGhhdmUgbmFtZSBhbmQgY2FuJ3QgY29uZmxpY3Q/XHJcbiAgICAgICAgdmFyIHR5cGVMaXN0ID0gdGhpcy5yZWdpc3RyeVt0eXBlXTtcclxuICAgICAgICBpZiAoIXR5cGVMaXN0KSB7XHJcbiAgICAgICAgICAgIHR5cGVMaXN0ID0gdGhpcy5yZWdpc3RyeVt0eXBlXSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0eXBlTGlzdC5wdXNoKGluZm8pO1xyXG4gICAgICAgIGlmIChCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLnJlZ2lzdGVyJyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIGluZm86IGluZm8sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKG1lc3NhZ2UsICcqJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50ICE9PSB3aW5kb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2UobWVzc2FnZSwgJyonKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdDb3VsZCBub3QgcG9zdG1lc3NhZ2UnLCBlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVnaXN0cnlDaGFuZ2UubmV4dCh0aGlzLnJlZ2lzdHJ5KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnJlZ2lzdGVyRWRpdG9yID0gZnVuY3Rpb24gKGluZm8pIHtcclxuICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgd2luZG93LnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLnJlZ2lzdGVyRWRpdG9yJyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IG9taXQoaW5mbywgJ2NvbXBvbmVudCcpLFxyXG4gICAgICAgICAgICB9LCAnKicpO1xyXG4gICAgICAgICAgICB2YXIgaG9zdG5hbWUgPSBsb2NhdGlvbi5ob3N0bmFtZTtcclxuICAgICAgICAgICAgaWYgKCFCdWlsZGVyLmlzVHJ1c3RlZEhvc3QoaG9zdG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdCdWlsZGVyLnJlZ2lzdGVyRWRpdG9yKCkgY2FsbGVkIGluIHRoZSB3cm9uZyBlbnZpcm9ubWVudCEgWW91IGNhbm5vdCBsb2FkIGN1c3RvbSBlZGl0b3JzIGZyb20geW91ciBhcHAsIHRoZXkgbXVzdCBiZSBsb2FkZWQgdGhyb3VnaCB0aGUgQnVpbGRlci5pbyBhcHAgaXRzZWxmLiBGb2xsb3cgdGhlIHJlYWRtZSBoZXJlIGZvciBtb3JlIGRldGFpbHM6IGh0dHBzOi8vZ2l0aHViLmNvbS9idWlsZGVyaW8vYnVpbGRlci90cmVlL21hc3Rlci9wbHVnaW5zL2Nsb3VkaW5hcnkgb3IgY29udGFjdCBjaGF0IHVzIGluIG91ciBTcGVjdHJ1bSBjb21tdW5pdHkgZm9yIGhlbHA6IGh0dHBzOi8vc3BlY3RydW0uY2hhdC9idWlsZGVyJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lZGl0b3JzLnB1c2goaW5mbyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5yZWdpc3RlclBsdWdpbiA9IGZ1bmN0aW9uIChpbmZvKSB7XHJcbiAgICAgICAgdGhpcy5wbHVnaW5zLnB1c2goaW5mbyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5yZWdpc3RlckFjdGlvbiA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLmFjdGlvbnMucHVzaChhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucmVnaXN0ZXJUcnVzdGVkSG9zdCA9IGZ1bmN0aW9uIChob3N0KSB7XHJcbiAgICAgICAgdGhpcy50cnVzdGVkSG9zdHMucHVzaChob3N0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBjb250ZXh0IEB0eXBlIHtpbXBvcnQoJ2lzb2xhdGVkLXZtJykuQ29udGV4dH1cclxuICAgICAqIFVzZSB0aGlzIGZ1bmN0aW9uIHRvIGNvbnRyb2wgdGhlIGV4ZWN1dGlvbiBjb250ZXh0IG9mIGN1c3RvbSBjb2RlIG9uIHRoZSBzZXJ2ZXIuXHJcbiAgICAgKiBjb25zdCBpdm0gPSByZXF1aXJlKCdpc29sYXRlZC12bScpO1xyXG4gICAgICogY29uc3QgaXNvbGF0ZSA9IG5ldyBpdm0uSXNvbGF0ZSh7IG1lbW9yeUxpbWl0OiAxMjggfSk7XHJcbiAgICAgKiBjb25zdCBjb250ZXh0ID0gaXNvbGF0ZS5jcmVhdGVDb250ZXh0U3luYygpO1xyXG4gICAgICogQnVpbGRlci5zZXRTZXJ2ZXJDb250ZXh0KGNvbnRleHQpO1xyXG4gICAgICovXHJcbiAgICBCdWlsZGVyLnNldFNlcnZlckNvbnRleHQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuc2VydmVyQ29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5pc1RydXN0ZWRIb3N0ID0gZnVuY3Rpb24gKGhvc3RuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnRydXN0ZWRIb3N0cy5maW5kSW5kZXgoZnVuY3Rpb24gKHRydXN0ZWRIb3N0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVzdGVkSG9zdC5zdGFydHNXaXRoKCcqLicpXHJcbiAgICAgICAgICAgICAgICA/IGhvc3RuYW1lLmVuZHNXaXRoKHRydXN0ZWRIb3N0LnNsaWNlKDEpKVxyXG4gICAgICAgICAgICAgICAgOiB0cnVzdGVkSG9zdCA9PT0gaG9zdG5hbWU7XHJcbiAgICAgICAgfSkgPiAtMSk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5ydW5BY3Rpb24gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgLy8gVE9ET1xyXG4gICAgICAgIHZhciBhY3Rpb25PYmplY3QgPSB0eXBlb2YgYWN0aW9uID09PSAnc3RyaW5nJyA/IGZpbmQodGhpcy5hY3Rpb25zLCBmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gaXRlbS5uYW1lID09PSBhY3Rpb247IH0pIDogYWN0aW9uO1xyXG4gICAgICAgIGlmICghYWN0aW9uT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFjdGlvbiBub3QgZm91bmQ6IFwiLmNvbmNhdChhY3Rpb24pKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5maWVsZHMgPSBmdW5jdGlvbiAobmFtZSwgZmllbGRzKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLmZpZWxkcycsXHJcbiAgICAgICAgICAgIGRhdGE6IHsgbmFtZTogbmFtZSwgZmllbGRzOiBmaWVsZHMgfSxcclxuICAgICAgICB9LCAnKicpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGRlcHJlY2F0ZWRcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBVc2UgQnVpbGRlci5yZWdpc3RlcignZWRpdG9yLnNldHRpbmdzJywge30pIGluc3RlYWQuXHJcbiAgICAgKi9cclxuICAgIEJ1aWxkZXIuc2V0ID0gZnVuY3Rpb24gKHNldHRpbmdzKSB7XHJcbiAgICAgICAgQnVpbGRlci5yZWdpc3RlcignZWRpdG9yLnNldHRpbmdzJywgc2V0dGluZ3MpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIuaW1wb3J0ID0gZnVuY3Rpb24gKHBhY2thZ2VOYW1lKSB7XHJcbiAgICAgICAgaWYgKCFCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBzZXJ2ZXIgc2lkZSBzdXBwb3J0ICptYXliZSpcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdCdWlsZGVyLmltcG9ydCB1c2VkIG9uIHRoZSBzZXJ2ZXIgLSB0aGlzIHNob3VsZCBvbmx5IGJlIHVzZWQgaW4gdGhlIGJyb3dzZXInKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgU3lzdGVtID0gd2luZG93LlN5c3RlbTtcclxuICAgICAgICBpZiAoIVN5c3RlbSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1N5c3RlbS5qcyBub3QgYXZhaWxhYmxlLiBQbGVhc2UgaW5jbHVkZSBTeXN0ZW0uanMgd2hlbiB1c2luZyBCdWlsZGVyLmltcG9ydCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBTeXN0ZW0uaW1wb3J0KFwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9zeXN0ZW1qcy9cIi5jb25jYXQocGFja2FnZU5hbWUpKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlciwgXCJlZGl0aW5nUGFnZVwiLCB7XHJcbiAgICAgICAgLy8gdXNlQ2RuQXBpID0gZmFsc2U7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9lZGl0aW5nUGFnZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGVkaXRpbmdQYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VkaXRpbmdQYWdlID0gZWRpdGluZ1BhZ2U7XHJcbiAgICAgICAgICAgIGlmIChpc0Jyb3dzZXIgJiYgaXNJZnJhbWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlZGl0aW5nUGFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnYnVpbGRlci1lZGl0aW5nLXBhZ2UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnYnVpbGRlci1lZGl0aW5nLXBhZ2UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEJ1aWxkZXIucHJlcGFyZUNvbXBvbmVudFNwZWNUb1NlbmQgPSBmdW5jdGlvbiAoc3BlYykge1xyXG4gICAgICAgIHJldHVybiBfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbih7fSwgc3BlYyksIChzcGVjLmlucHV0cyAmJiB7XHJcbiAgICAgICAgICAgIGlucHV0czogc3BlYy5pbnB1dHMubWFwKGZ1bmN0aW9uIChpbnB1dCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogZG8gZm9yIG5leHRlZCBmaWVsZHMgdG9vXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBwcm9iYWJseSBqdXN0IGNvbnZlcnQgYWxsIGZ1bmN0aW9ucywgbm90IGp1c3RcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHB1dCB0aGlzIGluIGlucHV0IGhvb2tzOiB7IG9uQ2hhbmdlOiAuLi4sIHNob3dJZjogLi4uIH1cclxuICAgICAgICAgICAgICAgIHZhciBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZyA9IFsnb25DaGFuZ2UnLCAnc2hvd0lmJ107XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNUb0NvbnZlcnRGblRvU3RyaW5nXzEgPSBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZzsgX2kgPCBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZ18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZ18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXRba2V5XSAmJiB0eXBlb2YgaW5wdXRba2V5XSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm4gPSBpbnB1dFtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dCA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBpbnB1dCksIChfYSA9IHt9LCBfYVtrZXldID0gXCJyZXR1cm4gKFwiLmNvbmNhdChmbi50b1N0cmluZygpLCBcIikuYXBwbHkodGhpcywgYXJndW1lbnRzKVwiKSwgX2EpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pKSwgeyBob29rczogT2JqZWN0LmtleXMoc3BlYy5ob29rcyB8fCB7fSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHNwZWMuaG9va3MgJiYgc3BlYy5ob29rc1trZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtZW1vO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW1vW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lbW9ba2V5XSA9IFwicmV0dXJuIChcIi5jb25jYXQodmFsdWUudG9TdHJpbmcoKSwgXCIpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtbztcclxuICAgICAgICAgICAgfSwge30pLCBjbGFzczogdW5kZWZpbmVkIH0pO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucmVnaXN0ZXJCbG9jayA9IGZ1bmN0aW9uIChjb21wb25lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyQ29tcG9uZW50KGNvbXBvbmVudCwgb3B0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5yZWdpc3RlckNvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIHNwZWMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7IGNsYXNzOiBjb21wb25lbnQgfSwgY29tcG9uZW50LmJ1aWxkZXJPcHRpb25zKSwgb3B0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoc3BlYyk7XHJcbiAgICAgICAgdmFyIGVkaXRhYmxlID0gb3B0aW9ucy5tb2RlbHMgJiYgdGhpcy5zaW5nbGV0b25JbnN0YW5jZS5lZGl0aW5nTW9kZWxcclxuICAgICAgICAgICAgPyBpc0Jyb3dzZXIgJiYgb3B0aW9ucy5tb2RlbHMuaW5jbHVkZXModGhpcy5zaW5nbGV0b25JbnN0YW5jZS5lZGl0aW5nTW9kZWwpXHJcbiAgICAgICAgICAgIDogaXNCcm93c2VyO1xyXG4gICAgICAgIGlmIChlZGl0YWJsZSkge1xyXG4gICAgICAgICAgICB2YXIgc2VuZFNwZWMgPSB0aGlzLnByZXBhcmVDb21wb25lbnRTcGVjVG9TZW5kKHNwZWMpO1xyXG4gICAgICAgICAgICAoX2EgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIucmVnaXN0ZXJDb21wb25lbnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogc2VuZFNwZWMsXHJcbiAgICAgICAgICAgIH0sICcqJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIuYWRkQ29tcG9uZW50ID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50ID0gZmluZCh0aGlzLmNvbXBvbmVudHMsIGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtLm5hbWUgPT09IGNvbXBvbmVudC5uYW1lOyB9KTtcclxuICAgICAgICBpZiAoY3VycmVudCkge1xyXG4gICAgICAgICAgICAvLyBGSVhNRTogd2h5IGRvZXMgc29tZXRpbWVzIHdlIGdldCBhbiBleHRyYSBwb3N0IHdpdGhvdXQgY2xhc3MgLSBwcm9iYWJseVxyXG4gICAgICAgICAgICAvLyBmcm9tIHBvc3RNZXNzYWdlIGhhbmRsZXIgd3JvbmcgaW4gc29tZSBwbGFjZVxyXG4gICAgICAgICAgICBpZiAoY3VycmVudC5jbGFzcyAmJiAhY29tcG9uZW50LmNsYXNzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRzLnNwbGljZSh0aGlzLmNvbXBvbmVudHMuaW5kZXhPZihjdXJyZW50KSwgMSwgY29tcG9uZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFRPRE86IHN0eWxlIGd1aWRlLCBldGMgb2ZmIHRoaXMgc3lzdGVtIGFzIHdlbGw/XHJcbiAgICBCdWlsZGVyLmNvbXBvbmVudCA9IGZ1bmN0aW9uIChpbmZvKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoaW5mbyA9PT0gdm9pZCAwKSB7IGluZm8gPSB7fTsgfVxyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgdmFyIHNwZWMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgaW5mbyksIHsgY2xhc3M6IGNvbXBvbmVudCB9KTtcclxuICAgICAgICAgICAgaWYgKCFzcGVjLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHNwZWMubmFtZSA9IGNvbXBvbmVudC5uYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF90aGlzLmFkZENvbXBvbmVudChzcGVjKTtcclxuICAgICAgICAgICAgdmFyIHNlbmRTcGVjID0gX3RoaXMucHJlcGFyZUNvbXBvbmVudFNwZWNUb1NlbmQoc3BlYyk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IHNlcmlhbGl6ZSBjb21wb25lbnQgbmFtZSBhbmQgaW5wdXRzXHJcbiAgICAgICAgICAgIGlmIChpc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIucmVnaXN0ZXJDb21wb25lbnQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHNlbmRTcGVjLFxyXG4gICAgICAgICAgICAgICAgfSwgJyonKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIsIFwiQ29tcG9uZW50XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnByb2Nlc3NFdmVudHNRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZXZlbnRzUXVldWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMuZXZlbnRzUXVldWU7XHJcbiAgICAgICAgdGhpcy5ldmVudHNRdWV1ZSA9IFtdO1xyXG4gICAgICAgIHZhciBmdWxsVXNlckF0dHJpYnV0ZXMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgQnVpbGRlci5vdmVycmlkZVVzZXJBdHRyaWJ1dGVzKSwgdGhpcy50cmFja2luZ1VzZXJBdHRyaWJ1dGVzKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGV2ZW50c18xID0gZXZlbnRzOyBfaSA8IGV2ZW50c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZXZlbnRfMSA9IGV2ZW50c18xW19pXTtcclxuICAgICAgICAgICAgaWYgKCFldmVudF8xLmRhdGEubWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50XzEuZGF0YS5tZXRhZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghZXZlbnRfMS5kYXRhLm1ldGFkYXRhLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50XzEuZGF0YS5tZXRhZGF0YS51c2VyID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudF8xLmRhdGEubWV0YWRhdGEudXNlciwgZnVsbFVzZXJBdHRyaWJ1dGVzLCBldmVudF8xLmRhdGEubWV0YWRhdGEudXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xyXG4gICAgICAgIGdldEZldGNoKCkoXCJcIi5jb25jYXQoaG9zdCwgXCIvYXBpL3YxL3RyYWNrXCIpLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGV2ZW50czogZXZlbnRzIH0pLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBOb3QgdGhlIGVuZCBvZiB0aGUgd29ybGRcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlci5wcm90b3R5cGUsIFwiYnJvd3NlclRyYWNraW5nRGlzYWJsZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQnVpbGRlci5pc0Jyb3dzZXIgJiYgQm9vbGVhbih3aW5kb3cuYnVpbGRlck5vVHJhY2sgfHwgIW5hdmlnYXRvci5jb29raWVFbmFibGVkKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlci5wcm90b3R5cGUsIFwiY2FuVHJhY2tcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW5UcmFjayQudmFsdWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChjYW5UcmFjaykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYW5UcmFjayAhPT0gY2FuVHJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FuVHJhY2skLm5leHQoY2FuVHJhY2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImFwaVZlcnNpb25cIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcGlWZXJzaW9uJC52YWx1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGFwaVZlcnNpb24pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYXBpVmVyc2lvbiAhPT0gYXBpVmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcGlWZXJzaW9uJC5uZXh0KGFwaVZlcnNpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImVkaXRpbmdNb2RlXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRpdGluZ01vZGUkLnZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLmVkaXRpbmdNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdNb2RlJC5uZXh0KHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJlZGl0aW5nTW9kZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lZGl0aW5nTW9kZWwkLnZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLmVkaXRpbmdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0aW5nTW9kZWwkLm5leHQodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZmluZFBhcmVudEVsZW1lbnQgPSBmdW5jdGlvbiAodGFyZ2V0LCBjYWxsYmFjaywgY2hlY2tFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKGNoZWNrRWxlbWVudCA9PT0gdm9pZCAwKSB7IGNoZWNrRWxlbWVudCA9IHRydWU7IH1cclxuICAgICAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYXJlbnQgPSBjaGVja0VsZW1lbnQgPyB0YXJnZXQgOiB0YXJnZXQucGFyZW50RWxlbWVudDtcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGlmICghcGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IGNhbGxiYWNrKHBhcmVudCk7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSB3aGlsZSAoKHBhcmVudCA9IHBhcmVudC5wYXJlbnRFbGVtZW50KSk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZmluZEJ1aWxkZXJQYXJlbnQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZFBhcmVudEVsZW1lbnQodGFyZ2V0LCBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgdmFyIGlkID0gZWwuZ2V0QXR0cmlidXRlKCdidWlsZGVyLWlkJykgfHwgZWwuaWQ7XHJcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuKGlkICYmIGlkLmluZGV4T2YoJ2J1aWxkZXItJykgPT09IDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnNldFVzZXJBZ2VudCA9IGZ1bmN0aW9uICh1c2VyQWdlbnQpIHtcclxuICAgICAgICB0aGlzLnVzZXJBZ2VudCA9IHVzZXJBZ2VudCB8fCAnJztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFNldCBhIGhvb2sgdG8gbW9kaWZ5IGV2ZW50cyBiZWluZyB0cmFja2VkIGZyb20gYnVpbGRlciwgc3VjaCBhcyBpbXByZXNzaW9ucyBhbmQgY2xpY2tzXHJcbiAgICAgKlxyXG4gICAgICogRm9yIGV4YW1wbGUsIHRvIHRyYWNrIHRoZSBtb2RlbCBJRCBvZiBlYWNoIGV2ZW50IGFzc29jaWF0ZWQgd2l0aCBjb250ZW50IGZvciBxdWVyeWluZ1xyXG4gICAgICogYnkgbW9kZSwgeW91IGNhbiBkb1xyXG4gICAgICpcclxuICAgICAqICAgIGJ1aWxkZXIuc2V0VHJhY2tpbmdIb29rKChldmVudCwgY29udGV4dCkgPT4ge1xyXG4gICAgICogICAgICBpZiAoY29udGV4dC5jb250ZW50KSB7XHJcbiAgICAgKiAgICAgICAgZXZlbnQuZGF0YS5tZXRhZGF0YS5tb2RlbElkID0gY29udGV4dC5jb250ZW50Lm1vZGVsSWRcclxuICAgICAqICAgICAgfVxyXG4gICAgICogICAgfSlcclxuICAgICAqL1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuc2V0VHJhY2tpbmdIb29rID0gZnVuY3Rpb24gKGhvb2spIHtcclxuICAgICAgICB0aGlzLnRyYWNraW5nSG9va3MucHVzaChob29rKTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS50cmFjayA9IGZ1bmN0aW9uIChldmVudE5hbWUsIHByb3BlcnRpZXMsIGNvbnRleHQpIHtcclxuICAgICAgICBpZiAocHJvcGVydGllcyA9PT0gdm9pZCAwKSB7IHByb3BlcnRpZXMgPSB7fTsgfVxyXG4gICAgICAgIC8vIFRPRE86IHF1ZXVlIHVwIHRyYWNrIHJlcXVlc3RzIGFuZCBmaXJlIHRoZW0gb2ZmIHdoZW4gY2FuVHJhY2sgc2V0IHRvIHRydWUgLSBvdGhlcndpc2UgbWF5IGdldCBsb3RzIG9mIGNsaWNrcyB3aXRoIG5vIGltcHJlc3Npb25zXHJcbiAgICAgICAgaWYgKGlzSWZyYW1lIHx8ICFpc0Jyb3dzZXIgfHwgQnVpbGRlci5pc1ByZXZpZXdpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYXBpS2V5ID0gdGhpcy5hcGlLZXk7XHJcbiAgICAgICAgaWYgKCFhcGlLZXkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignQnVpbGRlciBpbnRlZ3JhdGlvbiBlcnJvcjogTG9va3MgbGlrZSB0aGUgQnVpbGRlciBTREsgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkIHByb3Blcmx5ICh5b3VyIEFQSSBrZXkgaGFzIG5vdCBiZWVuIHNldCkuIE1ha2Ugc3VyZSB5b3UgYXJlIGNhbGxpbmcgYGJ1aWxkZXIuaW5pdChcIsKrWU9VUi1BUEktS0VZwrtcIik7YCBhcyBlYXJseSBhcyBwb3NzaWJsZSBpbiB5b3VyIGFwcGxpY2F0aW9uXFwncyBjb2RlLicpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBldmVudERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgdHlwZTogZXZlbnROYW1lLFxyXG4gICAgICAgICAgICBkYXRhOiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgb21pdChwcm9wZXJ0aWVzLCAnbWV0YScpKSwgeyBtZXRhZGF0YTogX19hc3NpZ24oX19hc3NpZ24oeyBzZGtWZXJzaW9uOiBCdWlsZGVyLlZFUlNJT04sIHVybDogbG9jYXRpb24uaHJlZiB9LCBwcm9wZXJ0aWVzLm1ldGEpLCBwcm9wZXJ0aWVzLm1ldGFkYXRhKSwgb3duZXJJZDogYXBpS2V5LCB1c2VyQXR0cmlidXRlczogdGhpcy5nZXRVc2VyQXR0cmlidXRlcygpLCBzZXNzaW9uSWQ6IHRoaXMuc2Vzc2lvbklkLCB2aXNpdG9ySWQ6IHRoaXMudmlzaXRvcklkIH0pLFxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy50cmFja2luZ0hvb2tzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgaG9vayA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gaG9vayhldmVudERhdGEsIGNvbnRleHQgfHwge30pO1xyXG4gICAgICAgICAgICBpZiAocmV0dXJuVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50RGF0YSA9IHJldHVyblZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGJhdGNoIGV2ZW50c1xyXG4gICAgICAgIHRoaXMuZXZlbnRzUXVldWUucHVzaChldmVudERhdGEpO1xyXG4gICAgICAgIGlmICh0aGlzLmNhblRyYWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGhyb3R0bGVkQ2xlYXJFdmVudHNRdWV1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRTZXNzaW9uSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc2Vzc2lvbklkID0gbnVsbDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIgJiYgdHlwZW9mIHNlc3Npb25TdG9yYWdlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkID0gdGhpcy5nZXRDb29raWUoc2Vzc2lvblN0b3JhZ2VLZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnU2Vzc2lvbiBzdG9yYWdlIGVycm9yJywgZXJyKTtcclxuICAgICAgICAgICAgLy8gSXQncyBva1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXNlc3Npb25JZCkge1xyXG4gICAgICAgICAgICBzZXNzaW9uSWQgPSB1dWlkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEdpdmUgdGhlIGFwcCBhIHNlY29uZCB0byBzdGFydCB1cCBhbmQgc2V0IGNhblRyYWNrIHRvIGZhbHNlIGlmIG5lZWRlZFxyXG4gICAgICAgIGlmIChCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmNhblRyYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldENvb2tpZShzZXNzaW9uU3RvcmFnZUtleSwgc2Vzc2lvbklkLCBkYXRlUGx1c01pbnV0ZXMoMzApKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnQ29va2llIHNldHRpbmcgZXJyb3InLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlc3Npb25JZDtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRWaXNpdG9ySWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy52aXNpdG9ySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlzaXRvcklkO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdmlzaXRvcklkID0gbnVsbDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIgJiYgdHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGNvb2tpZSBpbnN0ZWFkP1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0obG9jYWxTdG9yYWdlS2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0xvY2FsIHN0b3JhZ2UgZXJyb3InLCBlcnIpO1xyXG4gICAgICAgICAgICAvLyBJdCdzIG9rXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdmlzaXRvcklkKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3JJZCA9IHV1aWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy52aXNpdG9ySWQgPSB2aXNpdG9ySWQ7XHJcbiAgICAgICAgLy8gR2l2ZSB0aGUgYXBwIGEgc2Vjb25kIHRvIHN0YXJ0IHVwIGFuZCBzZXQgY2FuVHJhY2sgdG8gZmFsc2UgaWYgbmVlZGVkXHJcbiAgICAgICAgaWYgKEJ1aWxkZXIuaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2FuVHJhY2sgJiYgdHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdmlzaXRvcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGxvY2FsU3RvcmFnZUtleSwgdmlzaXRvcklkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnU2Vzc2lvbiBzdG9yYWdlIGVycm9yJywgZXJyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2aXNpdG9ySWQ7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUudHJhY2tJbXByZXNzaW9uID0gZnVuY3Rpb24gKGNvbnRlbnRJZCwgdmFyaWF0aW9uSWQsIHByb3BlcnRpZXMsIGNvbnRleHQpIHtcclxuICAgICAgICBpZiAoaXNJZnJhbWUgfHwgIWlzQnJvd3NlciB8fCBCdWlsZGVyLmlzUHJldmlld2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRPRE86IHVzZSB0aGlzLnRyYWNrIG1ldGhvZFxyXG4gICAgICAgIHRoaXMudHJhY2soJ2ltcHJlc3Npb24nLCB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRJZDogY29udGVudElkLFxyXG4gICAgICAgICAgICB2YXJpYXRpb25JZDogdmFyaWF0aW9uSWQgIT09IGNvbnRlbnRJZCA/IHZhcmlhdGlvbklkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICBtZXRhZGF0YTogcHJvcGVydGllcyxcclxuICAgICAgICB9LCBjb250ZXh0KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS50cmFja0NvbnZlcnNpb24gPSBmdW5jdGlvbiAoYW1vdW50LCBjb250ZW50SWQsIHZhcmlhdGlvbklkLCBjdXN0b21Qcm9wZXJ0aWVzLCBjb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKGlzSWZyYW1lIHx8ICFpc0Jyb3dzZXIgfHwgQnVpbGRlci5pc1ByZXZpZXdpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWV0YSA9IHR5cGVvZiBjb250ZW50SWQgPT09ICdvYmplY3QnID8gY29udGVudElkIDogY3VzdG9tUHJvcGVydGllcztcclxuICAgICAgICB2YXIgdXNlQ29udGVudElkID0gdHlwZW9mIGNvbnRlbnRJZCA9PT0gJ3N0cmluZycgPyBjb250ZW50SWQgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy50cmFjaygnY29udmVyc2lvbicsIHsgYW1vdW50OiBhbW91bnQsIHZhcmlhdGlvbklkOiB2YXJpYXRpb25JZCwgbWV0YTogbWV0YSwgY29udGVudElkOiB1c2VDb250ZW50SWQgfSwgY29udGV4dCk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImlzRGV2ZWxvcG1lbnRFbnZcIiwge1xyXG4gICAgICAgIC8vIFRPRE86IHNldCB0aGlzIGZvciBRQVxyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBBdXRvbWF0aWMgZGV0ZXJtaW5pbmcgb2YgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnRcclxuICAgICAgICAgICAgcmV0dXJuIChCdWlsZGVyLmlzSWZyYW1lIHx8XHJcbiAgICAgICAgICAgICAgICAoQnVpbGRlci5pc0Jyb3dzZXIgJiYgKGxvY2F0aW9uLmhvc3RuYW1lID09PSAnbG9jYWxob3N0JyB8fCBsb2NhdGlvbi5wb3J0ICE9PSAnJykpIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudiAhPT0gJ3Byb2R1Y3Rpb24nKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS50cmFja0ludGVyYWN0aW9uID0gZnVuY3Rpb24gKGNvbnRlbnRJZCwgdmFyaWF0aW9uSWQsIGFscmVhZHlUcmFja2VkT25lLCBldmVudCwgY29udGV4dCkge1xyXG4gICAgICAgIGlmIChhbHJlYWR5VHJhY2tlZE9uZSA9PT0gdm9pZCAwKSB7IGFscmVhZHlUcmFja2VkT25lID0gZmFsc2U7IH1cclxuICAgICAgICBpZiAoaXNJZnJhbWUgfHwgIWlzQnJvd3NlciB8fCBCdWlsZGVyLmlzUHJldmlld2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0YXJnZXQgPSBldmVudCAmJiBldmVudC50YXJnZXQ7XHJcbiAgICAgICAgdmFyIHRhcmdldEJ1aWxkZXJFbGVtZW50ID0gdGFyZ2V0ICYmIHRoaXMuZmluZEJ1aWxkZXJQYXJlbnQodGFyZ2V0KTtcclxuICAgICAgICBmdW5jdGlvbiByb3VuZChudW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobnVtICogMTAwMCkgLyAxMDAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWV0YWRhdGEgPSB7fTtcclxuICAgICAgICBpZiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIGNsaWVudFggPSBldmVudC5jbGllbnRYLCBjbGllbnRZID0gZXZlbnQuY2xpZW50WTtcclxuICAgICAgICAgICAgaWYgKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldFJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeE9mZnNldCA9IGNsaWVudFggLSB0YXJnZXRSZWN0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgeU9mZnNldCA9IGNsaWVudFkgLSB0YXJnZXRSZWN0LnRvcDtcclxuICAgICAgICAgICAgICAgIHZhciB4UmF0aW8gPSByb3VuZCh4T2Zmc2V0IC8gdGFyZ2V0UmVjdC53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeVJhdGlvID0gcm91bmQoeU9mZnNldCAvIHRhcmdldFJlY3QuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLnRhcmdldE9mZnNldCA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB4UmF0aW8sXHJcbiAgICAgICAgICAgICAgICAgICAgeTogeVJhdGlvLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0QnVpbGRlckVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZWN0ID0gdGFyZ2V0QnVpbGRlckVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeE9mZnNldCA9IGNsaWVudFggLSB0YXJnZXRSZWN0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgeU9mZnNldCA9IGNsaWVudFkgLSB0YXJnZXRSZWN0LnRvcDtcclxuICAgICAgICAgICAgICAgIHZhciB4UmF0aW8gPSByb3VuZCh4T2Zmc2V0IC8gdGFyZ2V0UmVjdC53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeVJhdGlvID0gcm91bmQoeU9mZnNldCAvIHRhcmdldFJlY3QuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLmJ1aWxkZXJUYXJnZXRPZmZzZXQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogeFJhdGlvLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHlSYXRpbyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJ1aWxkZXJJZCA9IHRhcmdldEJ1aWxkZXJFbGVtZW50ICYmXHJcbiAgICAgICAgICAgICh0YXJnZXRCdWlsZGVyRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2J1aWxkZXItaWQnKSB8fCB0YXJnZXRCdWlsZGVyRWxlbWVudC5pZCk7XHJcbiAgICAgICAgaWYgKGJ1aWxkZXJJZCAmJiB0YXJnZXRCdWlsZGVyRWxlbWVudCkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5idWlsZGVyRWxlbWVudEluZGV4ID0gW10uc2xpY2VcclxuICAgICAgICAgICAgICAgIC5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYnVpbGRlcklkKSlcclxuICAgICAgICAgICAgICAgIC5pbmRleE9mKHRhcmdldEJ1aWxkZXJFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50cmFjaygnY2xpY2snLCB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRJZDogY29udGVudElkLFxyXG4gICAgICAgICAgICBtZXRhZGF0YTogbWV0YWRhdGEsXHJcbiAgICAgICAgICAgIHZhcmlhdGlvbklkOiB2YXJpYXRpb25JZCAhPT0gY29udGVudElkID8gdmFyaWF0aW9uSWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHVuaXF1ZTogIWFscmVhZHlUcmFja2VkT25lLFxyXG4gICAgICAgICAgICB0YXJnZXRCdWlsZGVyRWxlbWVudDogYnVpbGRlcklkIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICB9LCBjb250ZXh0KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5jb21wb25lbnQgPSBmdW5jdGlvbiAoaW5mbykge1xyXG4gICAgICAgIGlmIChpbmZvID09PSB2b2lkIDApIHsgaW5mbyA9IHt9OyB9XHJcbiAgICAgICAgcmV0dXJuIEJ1aWxkZXIuY29tcG9uZW50KGluZm8pO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJhcGlLZXlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcGlLZXkkLnZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBpS2V5JC5uZXh0KGtleSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImF1dGhUb2tlblwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhUb2tlbiQudmFsdWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICB0aGlzLmF1dGhUb2tlbiQubmV4dCh0b2tlbik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUubW9kaWZ5U2VhcmNoID0gZnVuY3Rpb24gKHNlYXJjaCkge1xyXG4gICAgICAgIHJldHVybiBzZWFyY2gucmVwbGFjZSgvKF58JnxcXD8pKGJ1aWxkZXJfLio/KT0vZ2ksIGZ1bmN0aW9uIChfbWF0Y2gsIGdyb3VwMSwgZ3JvdXAyKSB7IHJldHVybiBncm91cDEgKyBncm91cDIucmVwbGFjZSgvXy9nLCAnLicpICsgJz0nOyB9KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5zZXRUZXN0c0Zyb21VcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlYXJjaCA9IHRoaXMuZ2V0TG9jYXRpb24oKS5zZWFyY2g7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFF1ZXJ5U3RyaW5nLnBhcnNlRGVlcCh0aGlzLm1vZGlmeVNlYXJjaChzZWFyY2ggfHwgJycpLnN1YnN0cigxKSk7XHJcbiAgICAgICAgdmFyIHRlc3RzID0gcGFyYW1zLmJ1aWxkZXIgJiYgcGFyYW1zLmJ1aWxkZXIudGVzdHM7XHJcbiAgICAgICAgaWYgKHRlc3RzICYmIHR5cGVvZiB0ZXN0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRlc3RzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGVzdHMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVzdENvb2tpZShrZXksIHRlc3RzW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnJlc2V0T3ZlcnJpZGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFVnbHkgLSBwYXNzIGRvd24gaW5zdGFuY2VzIHBlciByZXF1ZXN0IGluc3RlYWQgdXNpbmcgcmVhY3QgY29udGV4dFxyXG4gICAgICAgIC8vIG9yIHVzZSBidWlsZGVyLmdldCgnZm9vJywgeyByZXEsIHJlcyB9KSBpbiByZWFjdC4uLi4uLi4uLi4uXHJcbiAgICAgICAgQnVpbGRlci5vdmVycmlkZVVzZXJBdHRyaWJ1dGVzID0ge307XHJcbiAgICAgICAgdGhpcy5jYWNoZWJ1c3QgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5vQ2FjaGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnByZXZpZXcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVkaXRpbmdNb2RlbCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZXMgPSB7fTtcclxuICAgICAgICB0aGlzLmVudiA9ICdwcm9kdWN0aW9uJztcclxuICAgICAgICB0aGlzLnVzZXJBZ2VudCA9ICcnO1xyXG4gICAgICAgIHRoaXMucmVxdWVzdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLnJlc3BvbnNlID0gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldE92ZXJyaWRlc0Zyb21RdWVyeVN0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbG9jYXRpb24gPSB0aGlzLmdldExvY2F0aW9uKCk7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFF1ZXJ5U3RyaW5nLnBhcnNlRGVlcCh0aGlzLm1vZGlmeVNlYXJjaChsb2NhdGlvbi5zZWFyY2ggfHwgJycpLnN1YnN0cigxKSk7XHJcbiAgICAgICAgdmFyIGJ1aWxkZXIgPSBwYXJhbXMuYnVpbGRlcjtcclxuICAgICAgICBpZiAoYnVpbGRlcikge1xyXG4gICAgICAgICAgICB2YXIgdXNlckF0dHJpYnV0ZXMgPSBidWlsZGVyLnVzZXJBdHRyaWJ1dGVzLCBvdmVycmlkZXMgPSBidWlsZGVyLm92ZXJyaWRlcywgZW52ID0gYnVpbGRlci5lbnY7IGJ1aWxkZXIuaG9zdDsgdmFyIGFwaSA9IGJ1aWxkZXIuYXBpLCBjYWNoZWJ1c3QgPSBidWlsZGVyLmNhY2hlYnVzdCwgbm9DYWNoZSA9IGJ1aWxkZXIubm9DYWNoZSwgcHJldmlldyA9IGJ1aWxkZXIucHJldmlldywgZWRpdGluZyA9IGJ1aWxkZXIuZWRpdGluZywgZnJhbWVFZGl0aW5nID0gYnVpbGRlci5mcmFtZUVkaXRpbmcsIG9wdGlvbnMgPSBidWlsZGVyLm9wdGlvbnMsIG92ZXJyaWRlUGFyYW1zID0gYnVpbGRlci5wYXJhbXM7XHJcbiAgICAgICAgICAgIGlmICh1c2VyQXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVc2VyQXR0cmlidXRlcyh1c2VyQXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIC8vIHBpY2tpbmcgb25seSBsb2NhbGUsIGluY2x1ZGVSZWZzLCBhbmQgZW5yaWNoIGZvciBub3dcclxuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlPcHRpb25zID0gX19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oe30sIChvcHRpb25zLmxvY2FsZSAmJiB7IGxvY2FsZTogb3B0aW9ucy5sb2NhbGUgfSkpLCAob3B0aW9ucy5pbmNsdWRlUmVmcyAmJiB7IGluY2x1ZGVSZWZzOiBvcHRpb25zLmluY2x1ZGVSZWZzIH0pKSwgKG9wdGlvbnMuZW5yaWNoICYmIHsgZW5yaWNoOiBvcHRpb25zLmVucmljaCB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG92ZXJyaWRlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vdmVycmlkZXMgPSBvdmVycmlkZXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHZhbGlkRW52TGlzdC5pbmRleE9mKGVudiB8fCBhcGkpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW52ID0gZW52IHx8IGFwaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0VkaXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlZGl0aW5nTW9kZWwgPSBmcmFtZUVkaXRpbmcgfHwgZWRpdGluZyB8fCBwcmV2aWV3O1xyXG4gICAgICAgICAgICAgICAgaWYgKGVkaXRpbmdNb2RlbCAmJiBlZGl0aW5nTW9kZWwgIT09ICd0cnVlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdGluZ01vZGVsID0gZWRpdGluZ01vZGVsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjYWNoZWJ1c3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVidXN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobm9DYWNoZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub0NhY2hlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocHJldmlldykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJyaWRlUGFyYW1zID0gb3ZlcnJpZGVQYXJhbXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUubWVzc2FnZUZyYW1lTG9hZGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICAoX2EgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICB0eXBlOiAnYnVpbGRlci5sb2FkZWQnLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdHJ1ZSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9LCAnKicpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmJpbmRNZXNzYWdlTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHBhcnNlKGV2ZW50Lm9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNSZXN0cmljdGVkID0gWydidWlsZGVyLnJlZ2lzdGVyJywgJ2J1aWxkZXIucmVnaXN0ZXJDb21wb25lbnQnXS5pbmRleE9mKChfYSA9IGV2ZW50LmRhdGEpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50eXBlKSA9PT0gLTE7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNUcnVzdGVkID0gdXJsLmhvc3RuYW1lICYmIEJ1aWxkZXIuaXNUcnVzdGVkSG9zdCh1cmwuaG9zdG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUmVzdHJpY3RlZCAmJiAhaXNUcnVzdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBldmVudC5kYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGRhdGEudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLnBpbmcnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2IgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLnBvbmcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgJyonKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIucmVnaXN0ZXInOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBwb3NzaWJseSBkbyB0aGlzIGZvciBhbGwuLi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5zb3VyY2UgPT09IHdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gb3B0aW9ucy50eXBlLCBpbmZvID0gb3B0aW9ucy5pbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogYWxsIG11c3QgaGF2ZSBuYW1lIGFuZCBjYW4ndCBjb25mbGljdD9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlTGlzdCA9IEJ1aWxkZXIucmVnaXN0cnlbdHlwZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXR5cGVMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUxpc3QgPSBCdWlsZGVyLnJlZ2lzdHJ5W3R5cGVdID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlTGlzdC5wdXNoKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5yZWdpc3RyeUNoYW5nZS5uZXh0KEJ1aWxkZXIucmVnaXN0cnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5zZXR0aW5nc0NoYW5nZSc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHBvc3NpYmx5IGRvIHRoaXMgZm9yIGFsbC4uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gd2luZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2V0dGluZ3MgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKEJ1aWxkZXIuc2V0dGluZ3MsIHNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ1aWxkZXIuc2V0dGluZ3NDaGFuZ2UubmV4dChCdWlsZGVyLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIucmVnaXN0ZXJFZGl0b3InOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBwb3NzaWJseSBkbyB0aGlzIGZvciBhbGwuLi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5zb3VyY2UgPT09IHdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9fMSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5mb18xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzQ29tcG9uZW50XzEgPSAhIWluZm9fMS5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdWlsZGVyLmVkaXRvcnMuZXZlcnkoZnVuY3Rpb24gKHRoaXNJbmZvLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvXzEubmFtZSA9PT0gdGhpc0luZm8ubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0luZm8uY29tcG9uZW50ICYmICFoYXNDb21wb25lbnRfMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5lZGl0b3JzW2luZGV4XSA9IHRoaXNJbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIudHJpZ2dlckFuaW1hdGlvbic6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ1aWxkZXIuYW5pbWF0b3IudHJpZ2dlckFuaW1hdGlvbihkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5jb250ZW50VXBkYXRlJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBkYXRhLmRhdGEua2V5IHx8IGRhdGEuZGF0YS5hbGlhcyB8fCBkYXRhLmRhdGEuZW50cnkgfHwgZGF0YS5kYXRhLm1vZGVsTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50RGF0YSA9IGRhdGEuZGF0YS5kYXRhOyAvLyBobW1tLi4uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfdGhpcy5vYnNlcnZlcnNCeUtleVtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyICYmICFfdGhpcy5ub0VkaXRvclVwZGF0ZXNba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoW2NvbnRlbnREYXRhXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5nZXRDb21wb25lbnRzJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYyA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuY29tcG9uZW50cycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogQnVpbGRlci5jb21wb25lbnRzLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gQnVpbGRlci5wcmVwYXJlQ29tcG9uZW50U3BlY1RvU2VuZChpdGVtKTsgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAnKicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIuZWRpdGluZ01vZGVsJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVkaXRpbmdNb2RlbCA9IGRhdGEuZGF0YS5tb2RlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLnJlZ2lzdGVyQ29tcG9uZW50JzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wb25lbnREYXRhID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5hZGRDb21wb25lbnQoY29tcG9uZW50RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5ibG9ja0NvbnRlbnRMb2FkaW5nJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5kYXRhLm1vZGVsID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmJsb2NrQ29udGVudExvYWRpbmcgPSBkYXRhLmRhdGEubW9kZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5lZGl0aW5nTW9kZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdGluZ01vZGUgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdGluZ01vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5lZGl0aW5nTW9kZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdidWlsZGVyLWVkaXRpbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVkaXRpbmdNb2RlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdidWlsZGVyLWVkaXRpbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLmVkaXRpbmdQYWdlTW9kZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdGluZ1BhZ2VNb2RlID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5lZGl0aW5nUGFnZSA9IGVkaXRpbmdQYWdlTW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLm92ZXJyaWRlVXNlckF0dHJpYnV0ZXMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJBdHRyaWJ1dGVzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduKEJ1aWxkZXIub3ZlcnJpZGVVc2VyQXR0cmlidXRlcywgdXNlckF0dHJpYnV0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hHZXRDb250ZW50UXVldWUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiByZWZldGNoIHRvb1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIub3ZlcnJpZGVUZXN0R3JvdXAnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9mID0gZGF0YS5kYXRhLCB2YXJpYXRpb25JZCA9IF9mLnZhcmlhdGlvbklkLCBjb250ZW50SWQgPSBfZi5jb250ZW50SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWF0aW9uSWQgJiYgY29udGVudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0VGVzdENvb2tpZShjb250ZW50SWQsIHZhcmlhdGlvbklkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mbHVzaEdldENvbnRlbnRRdWV1ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLmV2YWx1YXRlJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBkYXRhLmRhdGEudGV4dDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gZGF0YS5kYXRhLmFyZ3VtZW50cyB8fCBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZF8xID0gZGF0YS5kYXRhLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZ1bmN0aW9uLWNvbnN0cnVjdG9yLXdpdGgtc3RyaW5nLWFyZ3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IG5ldyBGdW5jdGlvbih0ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmbi5hcHBseShfdGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0b0Vycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2QgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYnVpbGRlci5ldmFsdWF0ZUVycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBpZDogaWRfMSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAnKicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0LnRoZW4gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZmluYWxSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuZXZhbHVhdGVSZXN1bHQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgaWQ6IGlkXzEsIHJlc3VsdDogZmluYWxSZXN1bHQgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sICcqJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2UgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuZXZhbHVhdGVSZXN1bHQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyByZXN1bHQ6IHJlc3VsdCwgaWQ6IGlkXzEgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgJyonKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJkZWZhdWx0Q2FuVHJhY2tcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQm9vbGVhbihCdWlsZGVyLmlzQnJvd3NlciAmJlxyXG4gICAgICAgICAgICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudC50cmltKCkgJiZcclxuICAgICAgICAgICAgICAgICFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9ib3R8Y3Jhd2xlcnxzcGlkZXJ8cm9ib3R8Y3Jhd2xpbmd8cHJlcmVuZGVyfGdvb2dsZXxiYWlkdXxiaW5nfG1zbnxkdWNrZHVja2JvdHx0ZW9tYXxzbHVycHx5YW5kZXh8cGhhbnRvbXxoZWFkbGVzc3xzZWxlbml1bXxwdXBwZXRlZXIvaSkgJiZcclxuICAgICAgICAgICAgICAgICF0aGlzLmJyb3dzZXJUcmFja2luZ0Rpc2FibGVkKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGFwaUtleSwgY2FuVHJhY2ssIHJlcSwgcmVzLCBhdXRoVG9rZW4sIGFwaVZlcnNpb24pIHtcclxuICAgICAgICBpZiAoY2FuVHJhY2sgPT09IHZvaWQgMCkgeyBjYW5UcmFjayA9IHRoaXMuZGVmYXVsdENhblRyYWNrOyB9XHJcbiAgICAgICAgaWYgKHJlcSkge1xyXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3QgPSByZXE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNwb25zZSA9IHJlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYW5UcmFjayA9IGNhblRyYWNrO1xyXG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xyXG4gICAgICAgIGlmIChhdXRoVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBhdXRoVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IGFwaVZlcnNpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJwcmV2aWV3aW5nTW9kZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2VhcmNoID0gdGhpcy5nZXRMb2NhdGlvbigpLnNlYXJjaDtcclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IFF1ZXJ5U3RyaW5nLnBhcnNlKChzZWFyY2ggfHwgJycpLnN1YnN0cigxKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJhbXNbJ2J1aWxkZXIucHJldmlldyddO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8vIFRPRE86IGFsbG93IGFkZGluZyBsb2NhdGlvbiBvYmplY3QgYXMgcHJvcGVydHkgYW5kL29yIGluIGNvbnN0cnVjdG9yXHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRMb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIHBhcnNlZExvY2F0aW9uID0ge307XHJcbiAgICAgICAgLy8gaW4gc3NyIG1vZGVcclxuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIHBhcnNlZExvY2F0aW9uID0gcGFyc2UoKF9hID0gdGhpcy5yZXF1ZXN0LnVybCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgbG9jYXRpb24gPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIC8vIGluIHRoZSBicm93c2VyXHJcbiAgICAgICAgICAgIHBhcnNlZExvY2F0aW9uID0gcGFyc2UobG9jYXRpb24uaHJlZik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElFMTEgYnVnIHdpdGggcGFyc2VkIHBhdGggYmVpbmcgZW1wdHkgc3RyaW5nXHJcbiAgICAgICAgLy8gY2F1c2VzIGlzc3VlcyB3aXRoIG91ciB1c2VyIHRhcmdldGluZ1xyXG4gICAgICAgIGlmIChwYXJzZWRMb2NhdGlvbi5wYXRobmFtZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgcGFyc2VkTG9jYXRpb24ucGF0aG5hbWUgPSAnLyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJzZWRMb2NhdGlvbjtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRVc2VyQXR0cmlidXRlcyA9IGZ1bmN0aW9uICh1c2VyQWdlbnQpIHtcclxuICAgICAgICBpZiAodXNlckFnZW50ID09PSB2b2lkIDApIHsgdXNlckFnZW50ID0gdGhpcy51c2VyQWdlbnQgfHwgJyc7IH1cclxuICAgICAgICB2YXIgaXNNb2JpbGUgPSB7XHJcbiAgICAgICAgICAgIEFuZHJvaWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIEJsYWNrQmVycnk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyQWdlbnQubWF0Y2goL0JsYWNrQmVycnkvaSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGlPUzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJBZ2VudC5tYXRjaCgvaVBob25lfGlQb2QvaSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIE9wZXJhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlckFnZW50Lm1hdGNoKC9PcGVyYSBNaW5pL2kpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBXaW5kb3dzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlckFnZW50Lm1hdGNoKC9JRU1vYmlsZS9pKSB8fCB1c2VyQWdlbnQubWF0Y2goL1dQRGVza3RvcC9pKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYW55OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGlzTW9iaWxlLkFuZHJvaWQoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTW9iaWxlLkJsYWNrQmVycnkoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTW9iaWxlLmlPUygpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgaXNNb2JpbGUuT3BlcmEoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTW9iaWxlLldpbmRvd3MoKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaXNUYWJsZXQgPSB1c2VyQWdlbnQubWF0Y2goL1RhYmxldHxpUGFkL2kpO1xyXG4gICAgICAgIHZhciB1cmwgPSB0aGlzLmdldExvY2F0aW9uKCk7XHJcbiAgICAgICAgcmV0dXJuIF9fYXNzaWduKHsgdXJsUGF0aDogdXJsLnBhdGhuYW1lLCBob3N0OiB1cmwuaG9zdCB8fCB1cmwuaG9zdG5hbWUsIFxyXG4gICAgICAgICAgICAvLyBUT0RPOiBtYXliZSBhbiBvcHRpb24gdG8gY2hvb3NlIHRvIHRhcmdldCBvZmYgb2YgbW9iaWxlL3RhYmxldC9kZXNrdG9wIG9yIGp1c3QgbW9iaWxlL2Rlc2t0b3BcclxuICAgICAgICAgICAgZGV2aWNlOiBpc1RhYmxldCA/ICd0YWJsZXQnIDogaXNNb2JpbGUuYW55KCkgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJyB9LCBCdWlsZGVyLm92ZXJyaWRlVXNlckF0dHJpYnV0ZXMpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnNldFVzZXJBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICBhc3NpZ24oQnVpbGRlci5vdmVycmlkZVVzZXJBdHRyaWJ1dGVzLCBvcHRpb25zKTtcclxuICAgICAgICB0aGlzLnVzZXJBdHRyaWJ1dGVzQ2hhbmdlZC5uZXh0KG9wdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU2V0IHVzZXIgYXR0cmlidXRlcyBqdXN0IGZvciB0cmFja2luZyBwdXJwb3Nlcy5cclxuICAgICAqXHJcbiAgICAgKiBEbyB0aGlzIHNvIHByb3BlcnRpZXMgZXhpc3Qgb24gZXZlbnQgb2JqZWN0cyBmb3IgcXVlcnlpbmcgaW5zaWdodHMsIGJ1dFxyXG4gICAgICogd29uJ3QgYWZmZWN0IHRhcmdldGluZ1xyXG4gICAgICpcclxuICAgICAqIFVzZSB0aGlzIHdoZW4geW91IHdhbnQgdG8gdHJhY2sgcHJvcGVydGllcyBidXQgZG9uJ3QgbmVlZCB0byB0YXJnZXQgb2ZmXHJcbiAgICAgKiBvZiB0aGVtIHRvIG9wdGltaXplIGNhY2hlIGVmZmljaWVuY3lcclxuICAgICAqL1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuc2V0VHJhY2tpbmdVc2VyQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgYXNzaWduKHRoaXMudHJhY2tpbmdVc2VyQXR0cmlidXRlcywgYXR0cmlidXRlcyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgb3B0aW9ucykge1xyXG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICBpZiAoIUJ1aWxkZXIuaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gbmV3IEJ1aWxkZXIob3B0aW9ucy5hcGlLZXkgfHwgdGhpcy5hcGlLZXksIG9wdGlvbnMucmVxLCBvcHRpb25zLnJlcywgdW5kZWZpbmVkLCBvcHRpb25zLmF1dGhUb2tlbiB8fCB0aGlzLmF1dGhUb2tlbiwgb3B0aW9ucy5hcGlWZXJzaW9uIHx8IHRoaXMuYXBpVmVyc2lvbik7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnNldFVzZXJBdHRyaWJ1dGVzKHRoaXMuZ2V0VXNlckF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBOT1RFOiBBbGwgdGhlc2UgYXJlIHdoZW4gLmluaXQgaXMgbm90IGNhbGxlZCBhbmQgdGhlIGN1c3RvbWVyXHJcbiAgICAgICAgICAgIC8vIGRpcmVjdGx5IGNhbGxzIC5nZXQgb24gdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiBCdWlsZGVyXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmFwaUtleSAmJiAhdGhpcy5hcGlLZXkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5ID0gb3B0aW9ucy5hcGlLZXk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYXV0aFRva2VuICYmICF0aGlzLmF1dGhUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBvcHRpb25zLmF1dGhUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5hcGlWZXJzaW9uICYmICF0aGlzLmFwaVZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IG9wdGlvbnMuYXBpVmVyc2lvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2UucXVldWVHZXRDb250ZW50KG1vZGVsTmFtZSwgb3B0aW9ucykubWFwKFxyXG4gICAgICAgIC8qIG1hcCggKi8gZnVuY3Rpb24gKG1hdGNoZXMpIHtcclxuICAgICAgICAgICAgdmFyIG1hdGNoID0gbWF0Y2hlcyAmJiBtYXRjaGVzWzBdO1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc1N0YXRpYykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtYXRjaERhdGEgPSBtYXRjaCAmJiBtYXRjaC5kYXRhO1xyXG4gICAgICAgICAgICBpZiAoIW1hdGNoRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBtYXRjaERhdGEuYmxvY2tzU3RyaW5nICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgbWF0Y2hEYXRhLmJsb2NrcyA9IEpTT04ucGFyc2UobWF0Y2hEYXRhLmJsb2Nrc1N0cmluZyk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgbWF0Y2hEYXRhLmJsb2Nrc1N0cmluZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogYWRkIGFiIHRlc3QgaW5mbyBoZXJlIGFuZCBvdGhlciBoaWdoIGxldmVsIHN0dWZmXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBtYXRjaERhdGEsXHJcbiAgICAgICAgICAgICAgICBpZDogbWF0Y2guaWQsXHJcbiAgICAgICAgICAgICAgICB2YXJpYXRpb25JZDogbWF0Y2gudGVzdFZhcmlhdGlvbklkIHx8IG1hdGNoLnZhcmlhdGlvbklkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICB0ZXN0VmFyaWF0aW9uSWQ6IG1hdGNoLnRlc3RWYXJpYXRpb25JZCB8fCBtYXRjaC52YXJpYXRpb25JZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgdGVzdFZhcmlhdGlvbk5hbWU6IG1hdGNoLnRlc3RWYXJpYXRpb25OYW1lIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBsYXN0VXBkYXRlZDogbWF0Y2gubGFzdFVwZGF0ZWQgfHwgbnVsbCxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyApO1xyXG4gICAgfTtcclxuICAgIC8vIFRPRE86IGVudHJ5IGlkIGluIG9wdGlvbnNcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnF1ZXVlR2V0Q29udGVudCA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICAgICAgLy8gVE9ETzogaWYgcXVlcnkgZG8gbW9kZWxOYW1lICsgcXVlcnlcclxuICAgICAgICB2YXIga2V5ID0gb3B0aW9ucy5rZXkgfHxcclxuICAgICAgICAgICAgb3B0aW9ucy5hbGlhcyB8fFxyXG4gICAgICAgICAgICAvLyBUT0RPOiBTREtzIG9ubHkgcGFzcyBlbnRyeSBrZXkgd2hlbiBnaXZlbiB0byB0aGVtLCBhbmQgbmV2ZXIgd2hlbiBlZGl0aW5nLi4uXHJcbiAgICAgICAgICAgIC8vIG9wdGlvbnMuZW50cnkgfHxcclxuICAgICAgICAgICAgLy8gVE9ETzogdGhpcyBpcyB1Z2x5IC0gaW5zdGVhZCBvZiBtdWx0aXBsZSBvZiBzYW1lIG1vZGVsIHdpdGggZGlmZmVyZW50IG9wdGlvbnMgYXJlIHNlbnRcclxuICAgICAgICAgICAgLy8gc2F5IHJlcXVpcmVzIGtleS9hbGlhcy4gT3IgaWYgbm90IHBlcmhhcHMgbWFrZSBhIHJlbGlhYmxlIGhhc2ggb2YgdGhlIG9wdGlvbnMgYW5kIHVzZSB0aGF0LlxyXG4gICAgICAgICAgICAvLyBUT0RPOiBzdG9yZSBsYXN0IHVzZXIgc3RhdGUgb24gbGFzdCByZXF1ZXN0IGFuZCBpZiB1c2VyIGF0dHJpYnV0ZXMgZGlmZmVyZW50IG5vd1xyXG4gICAgICAgICAgICAvLyBnaXZlIGEgd2FybmluZyB0aGF0IG5lZWQgdG8gdXNlIGtleXMgdG8gcmVxdWVzdCBuZXcgY29udGVudGVcclxuICAgICAgICAgICAgLy8gKG9wdGlvbnMgJiZcclxuICAgICAgICAgICAgLy8gICBPYmplY3Qua2V5cyhvcHRpb25zKS5maWx0ZXIoa2V5ID0+IGtleSAhPT0gJ21vZGVsJykubGVuZ3RoICYmXHJcbiAgICAgICAgICAgIC8vICAgSlNPTi5zdHJpbmdpZnkoeyBtb2RlbDogbW9kZWxOYW1lLCAuLi5vcHRpb25zLCBpbml0aWFsQ29udGVudDogdW5kZWZpbmVkIH0pKSB8fFxyXG4gICAgICAgICAgICBtb2RlbE5hbWU7XHJcbiAgICAgICAgdmFyIGlzRWRpdGluZ1RoaXNNb2RlbCA9IHRoaXMuZWRpdGluZ01vZGVsID09PSBtb2RlbE5hbWU7XHJcbiAgICAgICAgLy8gVE9ETzogaW5jbHVkZSBwYXJhbXMgaW4gdGhpcyBrZXkuLi4uLi4uLlxyXG4gICAgICAgIHZhciBjdXJyZW50T2JzZXJ2YWJsZSA9IHRoaXMub2JzZXJ2ZXJzQnlLZXlba2V5XTtcclxuICAgICAgICAvLyBpZiAob3B0aW9ucy5xdWVyeSAmJiBvcHRpb25zLnF1ZXJ5Ll9pZCkge1xyXG4gICAgICAgIC8vICAgdGhpcy5mbHVzaEdldENvbnRlbnRRdWV1ZShbb3B0aW9uc10pXHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIGlmICh0aGlzLmFwaUtleSA9PT0gJ0RFTU8nICYmICF0aGlzLm92ZXJyaWRlc1trZXldICYmICFvcHRpb25zLmluaXRpYWxDb250ZW50KSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuaW5pdGlhbENvbnRlbnQgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGluaXRpYWxDb250ZW50ID0gb3B0aW9ucy5pbml0aWFsQ29udGVudDtcclxuICAgICAgICAvLyBUT0RPOiByZWZyZXNoIG9wdGlvbiBpbiBvcHRpb25zXHJcbiAgICAgICAgaWYgKGN1cnJlbnRPYnNlcnZhYmxlICYmICghY3VycmVudE9ic2VydmFibGUudmFsdWUgfHwgb3B0aW9ucy5jYWNoZSkpIHtcclxuICAgICAgICAgICAgLy8gVE9ETzogdGVzdCBpZiB0aGlzIHJhbiwgb3RoZXJ3aXNlIG9uIDQwNCBzb21lIG9ic2VydmVycyBtYXkgbmV2ZXIgYmUgY2FsbGVkLi4uXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50T2JzZXJ2YWJsZS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgbmV4dFRpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHJldHVybiBhIG5ldyBvYnNlcnZhYmxlIGFuZCBvbmx5IHRoYXQgb25lIGZpcmVzIHN1YnNjcmliZXJzLCBkb24ndCByZWZpcmUgZm9yIGV4aXN0aW5nIG9uZXNcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T2JzZXJ2YWJsZS5uZXh0KGN1cnJlbnRPYnNlcnZhYmxlLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50T2JzZXJ2YWJsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzRWRpdGluZ1RoaXNNb2RlbCkge1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6ICdidWlsZGVyLnVwZGF0ZUNvbnRlbnQnLCBkYXRhOiB7IG9wdGlvbnM6IG9wdGlvbnMgfSB9LCAnKicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaW5pdGlhbENvbnRlbnQgLyogfHwgaXNFZGl0aW5nVGhpc01vZGVsICovKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5nZXRDb250ZW50UXVldWUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudFF1ZXVlID0gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5nZXRDb250ZW50UXVldWUucHVzaChfX2Fzc2lnbihfX2Fzc2lnbih7fSwgb3B0aW9ucyksIHsgbW9kZWw6IG1vZGVsTmFtZSwga2V5OiBrZXkgfSkpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nZXRDb250ZW50UXVldWUgJiYgdGhpcy5nZXRDb250ZW50UXVldWUubGVuZ3RoID49IHRoaXMuY29udGVudFBlclJlcXVlc3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBxdWV1ZV8xID0gdGhpcy5nZXRDb250ZW50UXVldWUuc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudFF1ZXVlID0gW107XHJcbiAgICAgICAgICAgICAgICBuZXh0VGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hHZXRDb250ZW50UXVldWUoZmFsc2UsIHF1ZXVlXzEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0VGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hHZXRDb250ZW50UXVldWUoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvYnNlcnZhYmxlID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyc0J5S2V5W2tleV0gPSBvYnNlcnZhYmxlO1xyXG4gICAgICAgIGlmIChvcHRpb25zLm5vRWRpdG9yVXBkYXRlcykge1xyXG4gICAgICAgICAgICB0aGlzLm5vRWRpdG9yVXBkYXRlc1trZXldID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluaXRpYWxDb250ZW50KSB7XHJcbiAgICAgICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IG5lZWQgdG8gdGVzdE1vZGlmeSB0aGlzIEkgdGhpbmsuLi4/XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLm5leHQoaW5pdGlhbENvbnRlbnQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmFibGU7XHJcbiAgICB9O1xyXG4gICAgLy8gdGhpcyBpcyBuZWVkZWQgdG8gc2F0aXNmeSB0aGUgQW5ndWxhciBTREssIHdoaWNoIHVzZWQgdG8gcmVseSBvbiB0aGUgbW9yZSBjb21wbGV4IHZlcnNpb24gb2YgYHJlcXVlc3RVcmxgLlxyXG4gICAgLy8gZXZlbiB0aG91Z2ggd2Ugb25seSB1c2UgYGZldGNoKClgIG5vdywgd2UgcHJlZmVyIHRvIGtlZXAgdGhlIG9sZCBiZWhhdmlvciBhbmQgdXNlIHRoZSBgZmV0Y2hgIHRoYXQgY29tZXMgZnJvbVxyXG4gICAgLy8gdGhlIGNvcmUgU0RLIGZvciBjb25zaXN0ZW5jeVxyXG4gICAgQnVpbGRlci5wcm90b3R5cGUucmVxdWVzdFVybCA9IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gZ2V0RmV0Y2goKSh1cmwsIF9fYXNzaWduKHsgbmV4dDogX19hc3NpZ24oeyByZXZhbGlkYXRlOiAxIH0sIG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5uZXh0KSB9LCBvcHRpb25zKSkudGhlbihmdW5jdGlvbiAocmVzKSB7IHJldHVybiByZXMuanNvbigpOyB9KTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlci5wcm90b3R5cGUsIFwiaG9zdFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5lbnYpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3FhJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2h0dHBzOi8vcWEuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0ZXN0JzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2h0dHBzOi8vYnVpbGRlci1pby10ZXN0LndlYi5hcHAnO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZmFzdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2Zhc3QuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbG91ZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2Nsb3VkLmJ1aWxkZXIuaW8nO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2RuMic6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2NkbjIuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjZG4tcWEnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnaHR0cHM6Ly9jZG4tcWEuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZXZlbG9wbWVudCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZXYnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnaHR0cDovL2xvY2FsaG9zdDo1MDAwJztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2Nkbi1wcm9kJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2h0dHBzOi8vY2RuLmJ1aWxkZXIuaW8nO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQnVpbGRlci5vdmVycmlkZUhvc3QgfHwgJ2h0dHBzOi8vY2RuLmJ1aWxkZXIuaW8nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZmx1c2hHZXRDb250ZW50UXVldWUgPSBmdW5jdGlvbiAodXNlUGFzdFF1ZXVlLCB1c2VRdWV1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHVzZVBhc3RRdWV1ZSA9PT0gdm9pZCAwKSB7IHVzZVBhc3RRdWV1ZSA9IGZhbHNlOyB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmFwaUtleSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGZXRjaGluZyBjb250ZW50IGZhaWxlZCwgZXhwZWN0ZWQgYXBpS2V5IHRvIGJlIGRlZmluZWQgaW5zdGVhZCBnb3Q6IFwiLmNvbmNhdCh0aGlzLmFwaUtleSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIGlmICghWyd2MScsICd2MyddLmluY2x1ZGVzKHRoaXMuYXBpVmVyc2lvbikpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYXBpVmVyc2lvbjogZXhwZWN0ZWQgJ3YxJyBvciAndjMnLCByZWNlaXZlZCAnXCIuY29uY2F0KHRoaXMuYXBpVmVyc2lvbiwgXCInXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hcGlWZXJzaW9uID0gREVGQVVMVF9BUElfVkVSU0lPTjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF1c2VQYXN0UXVldWUgJiYgIXRoaXMuZ2V0Q29udGVudFF1ZXVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHF1ZXVlID0gdXNlUXVldWUgfHwgKHVzZVBhc3RRdWV1ZSA/IHRoaXMucHJpb3JDb250ZW50UXVldWUgOiB0aGlzLmdldENvbnRlbnRRdWV1ZSkgfHwgW107XHJcbiAgICAgICAgLy8gVE9ETzogZG8gdGhpcyBvbiBldmVyeSByZXF1ZXN0IHNlbmQ/XHJcbiAgICAgICAgdGhpcy5nZXRPdmVycmlkZXNGcm9tUXVlcnlTdHJpbmcoKTtcclxuICAgICAgICB2YXIgcXVlcnlQYXJhbXMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7IFxyXG4gICAgICAgICAgICAvLyBUT0RPOiB3YXkgdG8gZm9yY2UgYSByZXF1ZXN0IHRvIGJlIGluIGEgc2VwYXJhdGUgcXVldWUuIG9yIGp1c3QgbG93ZXIgcXVldWUgbGltaXQgdG8gYmUgMSBieSBkZWZhdWx0XHJcbiAgICAgICAgICAgIG9taXQ6IHF1ZXVlWzBdLm9taXQgfHwgJ21ldGEuY29tcG9uZW50c1VzZWQnLCBhcGlLZXk6IHRoaXMuYXBpS2V5IH0sIHF1ZXVlWzBdLm9wdGlvbnMpLCB0aGlzLnF1ZXJ5T3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHF1ZXVlWzBdLmxvY2FsZSkge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtcy5sb2NhbGUgPSBxdWV1ZVswXS5sb2NhbGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChxdWV1ZVswXS5maWVsZHMpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMuZmllbGRzID0gcXVldWVbMF0uZmllbGRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocXVldWVbMF0uZm9ybWF0KSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmZvcm1hdCA9IHF1ZXVlWzBdLmZvcm1hdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCdub1RyYXZlcnNlJyBpbiBxdWV1ZVswXSkge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtcy5ub1RyYXZlcnNlID0gcXVldWVbMF0ubm9UcmF2ZXJzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCdpbmNsdWRlVW5wdWJsaXNoZWQnIGluIHF1ZXVlWzBdKSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmluY2x1ZGVVbnB1Ymxpc2hlZCA9IHF1ZXVlWzBdLmluY2x1ZGVVbnB1Ymxpc2hlZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHF1ZXVlWzBdLnNvcnQpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMuc29ydCA9IHF1ZXVlWzBdLnNvcnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYWdlUXVlcnlQYXJhbXMgPSB0eXBlb2YgbG9jYXRpb24gIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgID8gUXVlcnlTdHJpbmcucGFyc2VEZWVwKGxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkpXHJcbiAgICAgICAgICAgIDoge307IC8vIFRPRE86IFdIQVQgYWJvdXQgU1NSICh0aGlzLnJlcXVlc3QpID9cclxuICAgICAgICB2YXIgdXNlckF0dHJpYnV0ZXMgPSBcclxuICAgICAgICAvLyBGSVhNRTogSEFDSzogb25seSBjaGVja3MgZmlyc3QgaW4gcXVldWUgZm9yIHVzZXIgYXR0cmlidXRlcyBvdmVycmlkZXMsIHNob3VsZCBjaGVjayBhbGxcclxuICAgICAgICAvLyBUT0RPOiBtZXJnZSB1c2VyIGF0dHJpYnV0ZXMgcHJvdmlkZWQgaGVyZSB3aXRoIGRlZmF1bHRzIGFuZCBjdXJyZW50IHVzZXIgYXR0aXJpYnV0ZXMgKD8pXHJcbiAgICAgICAgcXVldWUgJiYgcXVldWVbMF0udXNlckF0dHJpYnV0ZXNcclxuICAgICAgICAgICAgPyBxdWV1ZVswXS51c2VyQXR0cmlidXRlc1xyXG4gICAgICAgICAgICA6IHRoaXMudGFyZ2V0Q29udGVudFxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLmdldFVzZXJBdHRyaWJ1dGVzKClcclxuICAgICAgICAgICAgICAgIDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybFBhdGg6IHRoaXMuZ2V0TG9jYXRpb24oKS5wYXRobmFtZSxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxVcmxRdWV1ZUl0ZW0gPSBxdWV1ZS5maW5kKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiAhIWl0ZW0uaW5jbHVkZVVybDsgfSk7XHJcbiAgICAgICAgaWYgKGZ1bGxVcmxRdWV1ZUl0ZW0pIHtcclxuICAgICAgICAgICAgdmFyIGxvY2F0aW9uXzEgPSB0aGlzLmdldExvY2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmIChsb2NhdGlvbl8xLm9yaWdpbikge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMudXJsID0gXCJcIi5jb25jYXQobG9jYXRpb25fMS5vcmlnaW4pLmNvbmNhdChsb2NhdGlvbl8xLnBhdGhuYW1lKS5jb25jYXQobG9jYXRpb25fMS5zZWFyY2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB1cmxRdWV1ZUl0ZW0gPSB1c2VRdWV1ZSA9PT0gbnVsbCB8fCB1c2VRdWV1ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlUXVldWUuZmluZChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gaXRlbS51cmw7IH0pO1xyXG4gICAgICAgIGlmICh1cmxRdWV1ZUl0ZW0gPT09IG51bGwgfHwgdXJsUXVldWVJdGVtID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1cmxRdWV1ZUl0ZW0udXJsKSB7XHJcbiAgICAgICAgICAgIHVzZXJBdHRyaWJ1dGVzLnVybFBhdGggPSB1cmxRdWV1ZUl0ZW0udXJsLnNwbGl0KCc/JylbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRPRE86IG1lcmdlIGluIHRoZSBhdHRyaWJ1dGUgZnJvbSBxdWVyeSBzdHJpbmcgb25lc1xyXG4gICAgICAgIC8vIFRPRE86IG1ha2UgdGhpcyBhbiBvcHRpb24gcGVyIGNvbXBvbmVudC9yZXF1ZXN0XHJcbiAgICAgICAgcXVlcnlQYXJhbXMudXNlckF0dHJpYnV0ZXMgPSB1c2VyQXR0cmlidXRlcztcclxuICAgICAgICBpZiAoIXVzZVBhc3RRdWV1ZSAmJiAhdXNlUXVldWUpIHtcclxuICAgICAgICAgICAgdGhpcy5wcmlvckNvbnRlbnRRdWV1ZSA9IHF1ZXVlO1xyXG4gICAgICAgICAgICB0aGlzLmdldENvbnRlbnRRdWV1ZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjYWNoZWJ1c3QgPSB0aGlzLmNhY2hlYnVzdCB8fFxyXG4gICAgICAgICAgICBpc0lmcmFtZSB8fFxyXG4gICAgICAgICAgICBwYWdlUXVlcnlQYXJhbXMuY2FjaGVidXN0IHx8XHJcbiAgICAgICAgICAgIHBhZ2VRdWVyeVBhcmFtc1snYnVpbGRlci5jYWNoZWJ1c3QnXTtcclxuICAgICAgICBpZiAoY2FjaGVidXN0IHx8IHRoaXMuZW52ICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMuY2FjaGVidXN0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKEJ1aWxkZXIuaXNFZGl0aW5nKSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmlzRWRpdGluZyA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm5vQ2FjaGUgfHwgdGhpcy5lbnYgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtcy5ub0NhY2hlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNpemUodGhpcy5vdmVycmlkZXMpKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLm92ZXJyaWRlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3ZlcnJpZGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1tcIm92ZXJyaWRlcy5cIi5jb25jYXQoa2V5KV0gPSB0aGlzLm92ZXJyaWRlc1trZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcXVldWVfMiA9IHF1ZXVlOyBfaSA8IHF1ZXVlXzIubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gcXVldWVfMltfaV07XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMuZm9ybWF0ID0gb3B0aW9ucy5mb3JtYXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIG1lIGFuZCBtYWtlIHBlcm1vZGVsXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXRpYykge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMuc3RhdGljID0gb3B0aW9ucy5zdGF0aWM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuY2FjaGVidXN0KSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5jYWNoZWJ1c3QgPSBvcHRpb25zLmNhY2hlYnVzdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXNQb3NpdGl2ZU51bWJlcihvcHRpb25zLmNhY2hlU2Vjb25kcykpIHtcclxuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmNhY2hlU2Vjb25kcyA9IG9wdGlvbnMuY2FjaGVTZWNvbmRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpc1Bvc2l0aXZlTnVtYmVyKG9wdGlvbnMuc3RhbGVDYWNoZVNlY29uZHMpKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5zdGFsZUNhY2hlU2Vjb25kcyA9IG9wdGlvbnMuc3RhbGVDYWNoZVNlY29uZHM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBbXHJcbiAgICAgICAgICAgICAgICAncHJlcmVuZGVyJyxcclxuICAgICAgICAgICAgICAgICdleHRyYWN0Q3NzJyxcclxuICAgICAgICAgICAgICAgICdsaW1pdCcsXHJcbiAgICAgICAgICAgICAgICAnb2Zmc2V0JyxcclxuICAgICAgICAgICAgICAgICdxdWVyeScsXHJcbiAgICAgICAgICAgICAgICAncHJldmlldycsXHJcbiAgICAgICAgICAgICAgICAnbW9kZWwnLFxyXG4gICAgICAgICAgICAgICAgJ2VudHJ5JyxcclxuICAgICAgICAgICAgICAgICdyZXYnLFxyXG4gICAgICAgICAgICAgICAgJ3N0YXRpYycsXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgcHJvcGVydGllc18xID0gcHJvcGVydGllczsgX2EgPCBwcm9wZXJ0aWVzXzEubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gcHJvcGVydGllc18xW19hXTtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9wdGlvbnNba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMub3B0aW9ucyA9IHF1ZXJ5UGFyYW1zLm9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMub3B0aW9uc1tvcHRpb25zLmtleV0gPSBxdWVyeVBhcmFtcy5vcHRpb25zW29wdGlvbnMua2V5XSB8fCB7fTtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5vcHRpb25zW29wdGlvbnMua2V5XVtrZXldID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnByZXZpZXcpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMucHJldmlldyA9ICd0cnVlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGhhc1BhcmFtcyA9IE9iamVjdC5rZXlzKHF1ZXJ5UGFyYW1zKS5sZW5ndGggPiAwO1xyXG4gICAgICAgIC8vIFRPRE86IG9wdGlvbiB0byBmb3JjZSBkZXYgb3IgcWEgYXBpIGhlcmVcclxuICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcclxuICAgICAgICB2YXIga2V5TmFtZXMgPSBxdWV1ZS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChpdGVtLmtleSk7IH0pLmpvaW4oJywnKTtcclxuICAgICAgICBpZiAodGhpcy5vdmVycmlkZVBhcmFtcykge1xyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gb21pdChRdWVyeVN0cmluZy5wYXJzZSh0aGlzLm92ZXJyaWRlUGFyYW1zKSwgJ2FwaUtleScpO1xyXG4gICAgICAgICAgICBhc3NpZ24ocXVlcnlQYXJhbXMsIHBhcmFtcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBxdWVyeVN0ciA9IFF1ZXJ5U3RyaW5nLnN0cmluZ2lmeURlZXAocXVlcnlQYXJhbXMpO1xyXG4gICAgICAgIHZhciBmb3JtYXQgPSBxdWVyeVBhcmFtcy5mb3JtYXQ7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RPcHRpb25zID0geyBoZWFkZXJzOiB7fSwgbmV4dDogeyByZXZhbGlkYXRlOiAxIH0gfTtcclxuICAgICAgICBpZiAodGhpcy5hdXRoVG9rZW4pIHtcclxuICAgICAgICAgICAgcmVxdWVzdE9wdGlvbnMuaGVhZGVycyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzKSwgeyBBdXRob3JpemF0aW9uOiBcIkJlYXJlciBcIi5jb25jYXQodGhpcy5hdXRoVG9rZW4pIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZm4gPSBmb3JtYXQgPT09ICdzb2xpZCcgfHwgZm9ybWF0ID09PSAncmVhY3QnID8gJ2NvZGVnZW4nIDogJ3F1ZXJ5JztcclxuICAgICAgICAvLyBOT1RFOiB0aGlzIGlzIGEgaGFjayB0byBnZXQgYXJvdW5kIHRoZSBmYWN0IHRoYXQgdGhlIGNvZGVnZW4gZW5kcG9pbnQgaXMgbm90IHlldCBhdmFpbGFibGUgaW4gdjNcclxuICAgICAgICB2YXIgYXBpVmVyc2lvbkJhc2VkT25GbiA9IGZuID09PSAncXVlcnknID8gdGhpcy5hcGlWZXJzaW9uIDogJ3YxJztcclxuICAgICAgICB2YXIgdXJsID0gXCJcIi5jb25jYXQoaG9zdCwgXCIvYXBpL1wiKS5jb25jYXQoYXBpVmVyc2lvbkJhc2VkT25GbiwgXCIvXCIpLmNvbmNhdChmbiwgXCIvXCIpLmNvbmNhdCh0aGlzLmFwaUtleSwgXCIvXCIpLmNvbmNhdChrZXlOYW1lcykgK1xyXG4gICAgICAgICAgICAocXVlcnlQYXJhbXMgJiYgaGFzUGFyYW1zID8gXCI/XCIuY29uY2F0KHF1ZXJ5U3RyKSA6ICcnKTtcclxuICAgICAgICB2YXIgcHJvbWlzZSA9IGdldEZldGNoKCkodXJsLCByZXF1ZXN0T3B0aW9ucylcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykgeyByZXR1cm4gcmVzLmpzb24oKTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHF1ZXVlXzMgPSBxdWV1ZTsgX2kgPCBxdWV1ZV8zLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBxdWV1ZV8zW19pXTtcclxuICAgICAgICAgICAgICAgIHZhciBrZXlOYW1lID0gb3B0aW9ucy5rZXk7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlbCA9PT0gX3RoaXMuYmxvY2tDb250ZW50TG9hZGluZyAmJiAhb3B0aW9ucy5ub0VkaXRvclVwZGF0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBpc0VkaXRpbmdUaGlzTW9kZWwgPSBfdGhpcy5lZGl0aW5nTW9kZWwgPT09IG9wdGlvbnMubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNFZGl0aW5nVGhpc01vZGVsICYmIEJ1aWxkZXIuaXNFZGl0aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogJ2J1aWxkZXIudXBkYXRlQ29udGVudCcsIGRhdGE6IHsgb3B0aW9uczogb3B0aW9ucyB9IH0sICcqJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIG9ic2VydmVyID0gX3RoaXMub2JzZXJ2ZXJzQnlLZXlba2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIW9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByZXN1bHRba2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICB2YXIgc29ydGVkID0gZGF0YTsgLy8gc29ydEJ5KGRhdGEsIGl0ZW0gPT4gaXRlbS5wcmlvcml0eSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXN0TW9kaWZpZWRSZXN1bHRzID0gQnVpbGRlci5pc1NlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNvcnRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IF90aGlzLnByb2Nlc3NSZXN1bHRzRm9yVGVzdHMoc29ydGVkKTtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHRlc3RNb2RpZmllZFJlc3VsdHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaCA9IF90aGlzLmdldExvY2F0aW9uKCkuc2VhcmNoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgoc2VhcmNoIHx8ICcnKS5pbmNsdWRlcygnYnVpbGRlci5wcmV2aWV3PScgKyBvcHRpb25zLm1vZGVsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJldmlld0RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ3ByZXZpZXcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1ByZXZpZXcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoW3ByZXZpZXdEYXRhXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoW10pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHF1ZXVlXzQgPSBxdWV1ZTsgX2kgPCBxdWV1ZV80Lmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBxdWV1ZV80W19pXTtcclxuICAgICAgICAgICAgICAgIHZhciBvYnNlcnZlciA9IF90aGlzLm9ic2VydmVyc0J5S2V5W29wdGlvbnMua2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICghb2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUucHJvY2Vzc1Jlc3VsdHNGb3JUZXN0cyA9IGZ1bmN0aW9uIChyZXN1bHRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIG1hcHBlZFJlc3VsdHMgPSByZXN1bHRzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoIWl0ZW0udmFyaWF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGNvb2tpZVZhbHVlID0gX3RoaXMuZ2V0VGVzdENvb2tpZShpdGVtLmlkKTtcclxuICAgICAgICAgICAgdmFyIGNvb2tpZVZhcmlhdGlvbiA9IGNvb2tpZVZhbHVlID09PSBpdGVtLmlkID8gaXRlbSA6IGl0ZW0udmFyaWF0aW9uc1tjb29raWVWYWx1ZV07XHJcbiAgICAgICAgICAgIGlmIChjb29raWVWYXJpYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgaXRlbSksIHsgZGF0YTogY29va2llVmFyaWF0aW9uLmRhdGEsIHZhcmlhdGlvbklkOiBjb29raWVWYWx1ZSwgdGVzdFZhcmlhdGlvbklkOiBjb29raWVWYWx1ZSwgdGVzdFZhcmlhdGlvbk5hbWU6IGNvb2tpZVZhcmlhdGlvbi5uYW1lIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5jYW5UcmFjayAmJiBpdGVtLnZhcmlhdGlvbnMgJiYgc2l6ZShpdGVtLnZhcmlhdGlvbnMpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmFuZG9tID0gTWF0aC5yYW5kb20oKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGlkIGluIGl0ZW0udmFyaWF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYXRpb24gPSBpdGVtLnZhcmlhdGlvbnNbaWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXN0UmF0aW8gPSB2YXJpYXRpb24udGVzdFJhdGlvO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gKz0gdGVzdFJhdGlvO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyYW5kb20gPCBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFRlc3RDb29raWUoaXRlbS5pZCwgdmFyaWF0aW9uLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhcmlhdGlvbk5hbWUgPSB2YXJpYXRpb24ubmFtZSB8fCAodmFyaWF0aW9uLmlkID09PSBpdGVtLmlkID8gJ0RlZmF1bHQgdmFyaWF0aW9uJyA6ICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKHt9LCBpdGVtKSwgeyBkYXRhOiB2YXJpYXRpb24uZGF0YSwgdmFyaWF0aW9uSWQ6IHZhcmlhdGlvbi5pZCwgdGVzdFZhcmlhdGlvbklkOiB2YXJpYXRpb24uaWQsIHZhcmlhdGlvbk5hbWU6IHZhcmlhdGlvbk5hbWUsIHRlc3RWYXJpYXRpb25OYW1lOiB2YXJpYXRpb25OYW1lIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF90aGlzLnNldFRlc3RDb29raWUoaXRlbS5pZCwgaXRlbS5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKHt9LCBpdGVtKSwgeyB2YXJpYXRpb25JZDogaXRlbS5pZCB9KSwgKGl0ZW0udmFyaWF0aW9ucyAmJlxyXG4gICAgICAgICAgICAgICAgc2l6ZShpdGVtLnZhcmlhdGlvbnMpICYmIHtcclxuICAgICAgICAgICAgICAgIHRlc3RWYXJpYXRpb25JZDogaXRlbS5pZCxcclxuICAgICAgICAgICAgICAgIHRlc3RWYXJpYXRpb25OYW1lOiAnRGVmYXVsdCB2YXJpYXRpb24nLFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGlzSWZyYW1lKSB7XHJcbiAgICAgICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7IHR5cGU6ICdidWlsZGVyLmNvbnRlbnRSZXN1bHRzJywgZGF0YTogeyByZXN1bHRzOiBtYXBwZWRSZXN1bHRzIH0gfSwgJyonKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1hcHBlZFJlc3VsdHM7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZ2V0VGVzdENvb2tpZSA9IGZ1bmN0aW9uIChjb250ZW50SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRDb29raWUoXCJcIi5jb25jYXQodGhpcy50ZXN0Q29va2llUHJlZml4LCBcIi5cIikuY29uY2F0KGNvbnRlbnRJZCkpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnNldFRlc3RDb29raWUgPSBmdW5jdGlvbiAoY29udGVudElkLCB2YXJpYXRpb25JZCkge1xyXG4gICAgICAgIGlmICghdGhpcy5jYW5UcmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmNvb2tpZVF1ZXVlLnB1c2goW2NvbnRlbnRJZCwgdmFyaWF0aW9uSWRdKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAzMCBkYXlzIGZyb20gbm93XHJcbiAgICAgICAgdmFyIGZ1dHVyZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgZnV0dXJlLnNldERhdGUoZnV0dXJlLmdldERhdGUoKSArIDMwKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRDb29raWUoXCJcIi5jb25jYXQodGhpcy50ZXN0Q29va2llUHJlZml4LCBcIi5cIikuY29uY2F0KGNvbnRlbnRJZCksIHZhcmlhdGlvbklkLCBmdXR1cmUpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldENvb2tpZSA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29va2llcykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb29raWVzLmdldChuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEJ1aWxkZXIuaXNCcm93c2VyICYmIGdldENvb2tpZShuYW1lKTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5zZXRDb29raWUgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIGV4cGlyZXMpIHtcclxuICAgICAgICBpZiAodGhpcy5jb29raWVzICYmICEoQnVpbGRlci5pc1NlcnZlciAmJiBCdWlsZGVyLmlzU3RhdGljKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb29raWVzLnNldChuYW1lLCB2YWx1ZSwge1xyXG4gICAgICAgICAgICAgICAgZXhwaXJlczogZXhwaXJlcyxcclxuICAgICAgICAgICAgICAgIHNlY3VyZTogdGhpcy5nZXRMb2NhdGlvbigpLnByb3RvY29sID09PSAnaHR0cHM6JyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBCdWlsZGVyLmlzQnJvd3NlciAmJiBzZXRDb29raWUobmFtZSwgdmFsdWUsIGV4cGlyZXMpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldENvbnRlbnQgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cclxuICAgICAgICBpZiAoIXRoaXMuYXBpS2V5KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZldGNoaW5nIGNvbnRlbnQgZnJvbSBtb2RlbCBcIi5jb25jYXQobW9kZWxOYW1lLCBcIiBmYWlsZWQsIGV4cGVjdGVkIGFwaUtleSB0byBiZSBkZWZpbmVkIGluc3RlYWQgZ290OiBcIikuY29uY2F0KHRoaXMuYXBpS2V5KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXVlR2V0Q29udGVudChtb2RlbE5hbWUsIG9wdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxyXG4gICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICBpbnN0YW5jZSA9IG5ldyBCdWlsZGVyKG9wdGlvbnMuYXBpS2V5IHx8IHRoaXMuYXBpS2V5LCBvcHRpb25zLnJlcSwgb3B0aW9ucy5yZXMsIGZhbHNlLCBvcHRpb25zLmF1dGhUb2tlbiB8fCB0aGlzLmF1dGhUb2tlbiwgb3B0aW9ucy5hcGlWZXJzaW9uIHx8IHRoaXMuYXBpVmVyc2lvbik7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnNldFVzZXJBdHRyaWJ1dGVzKHRoaXMuZ2V0VXNlckF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBOT1RFOiBBbGwgdGhlc2UgYXJlIHdoZW4gLmluaXQgaXMgbm90IGNhbGxlZCBhbmQgdGhlIGN1c3RvbWVyXHJcbiAgICAgICAgICAgIC8vIGRpcmVjdGx5IGNhbGxzIC5nZXQgb24gdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiBCdWlsZGVyXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmFwaUtleSAmJiAhdGhpcy5hcGlLZXkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5ID0gb3B0aW9ucy5hcGlLZXk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYXV0aFRva2VuICYmICF0aGlzLmF1dGhUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBvcHRpb25zLmF1dGhUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5hcGlWZXJzaW9uICYmICF0aGlzLmFwaVZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IG9wdGlvbnMuYXBpVmVyc2lvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTZXQgbm9UcmF2ZXJzZT10cnVlIGlmIE5PVCBhbHJlYWR5IHBhc3NlZCBieSB1c2VyLCBmb3IgcXVlcnkgcGVyZm9ybWFuY2VcclxuICAgICAgICBpZiAoISgnbm9UcmF2ZXJzZScgaW4gb3B0aW9ucykpIHtcclxuICAgICAgICAgICAgb3B0aW9ucy5ub1RyYXZlcnNlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlXHJcbiAgICAgICAgICAgIC5nZXRDb250ZW50KG1vZGVsTmFtZSwgX19hc3NpZ24oX19hc3NpZ24oeyBsaW1pdDogMzAgfSwgb3B0aW9ucyksIHsga2V5OiBvcHRpb25zLmtleSB8fFxyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSB0aGUga2V5IGluY2x1ZGUgYWxsIG9wdGlvbnMsIHNvIHdlIGRvbid0IHJldXNlIGNhY2hlIGZvciB0aGUgc2FtZSBjb250ZW50IGZldGNoZWRcclxuICAgICAgICAgICAgICAgIC8vIHdpdGggZGlmZmVyZW50IG9wdGlvbnNcclxuICAgICAgICAgICAgICAgIEJ1aWxkZXIuaXNCcm93c2VyXHJcbiAgICAgICAgICAgICAgICA/IFwiXCIuY29uY2F0KG1vZGVsTmFtZSwgXCI6XCIpLmNvbmNhdChoYXNoKG9taXQob3B0aW9ucywgJ2luaXRpYWxDb250ZW50JywgJ3JlcScsICdyZXMnKSkpXHJcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCB9KSlcclxuICAgICAgICAgICAgLnByb21pc2UoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIEBkZXByZWNhdGVkLiBUaGlzIGlzIGJ1Z2d5LCBhbmQgYWx3YXlzIGJlaGluZCBieSBhIHZlcnNpb24uXHJcbiAgICAgKi9cclxuICAgIEJ1aWxkZXIuVkVSU0lPTiA9IHZlcnNpb247XHJcbiAgICBCdWlsZGVyLmNvbXBvbmVudHMgPSBbXTtcclxuICAgIC8qKlxyXG4gICAgICogTWFrZXMgaXQgc28gdGhhdCBhL2IgdGVzdHMgZ2VuZXJhdGUgY29kZSBsaWtlIHtAbGlua1xyXG4gICAgICogaHR0cHM6Ly93d3cuYnVpbGRlci5pby9ibG9nL2hpZ2gtcGVyZm9ybWFuY2Utbm8tY29kZSNfX25leHQ6fjp0ZXh0PVN0YXRpYyUyMGdlbmVyYXRlZCUyMEElMkZCJTIwdGVzdGluZ31cclxuICAgICAqIGluc3RlYWQgb2YgdGhlIG9sZCB3YXkgd2hlcmUgd2UgcmVuZGVyIG9ubHkgb25lIHRlc3QgZ3JvdXAgYXQgYSB0aW1lIG9uIHRoZVxyXG4gICAgICogc2VydmVyLiBUaGlzIGlzIHRoZSBwcmVmZXJyZWQvYmV0dGVyIHdheSBub3QgYW5kIHdlIHNob3VsZCB1bHRpbWF0ZWx5IG1ha2UgaXRcclxuICAgICAqIHRoZSBkZWZhdWx0XHJcbiAgICAgKi9cclxuICAgIEJ1aWxkZXIuaXNTdGF0aWMgPSB0cnVlO1xyXG4gICAgQnVpbGRlci5hbmltYXRvciA9IG5ldyBBbmltYXRvcigpO1xyXG4gICAgQnVpbGRlci5uZXh0VGljayA9IG5leHRUaWNrO1xyXG4gICAgQnVpbGRlci50aHJvdHRsZSA9IHRocm90dGxlO1xyXG4gICAgQnVpbGRlci5lZGl0b3JzID0gW107XHJcbiAgICBCdWlsZGVyLnRydXN0ZWRIb3N0cyA9IFtcclxuICAgICAgICAnKi5iZXRhLmJ1aWxkZXIuaW8nLFxyXG4gICAgICAgICdiZXRhLmJ1aWxkZXIuaW8nLFxyXG4gICAgICAgICdidWlsZGVyLmlvJyxcclxuICAgICAgICAnbG9jYWxob3N0JyxcclxuICAgICAgICAncWEuYnVpbGRlci5pbycsXHJcbiAgICBdO1xyXG4gICAgQnVpbGRlci5wbHVnaW5zID0gW107XHJcbiAgICBCdWlsZGVyLmFjdGlvbnMgPSBbXTtcclxuICAgIEJ1aWxkZXIucmVnaXN0cnkgPSB7fTtcclxuICAgIEJ1aWxkZXIucmVnaXN0cnlDaGFuZ2UgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KHt9KTtcclxuICAgIEJ1aWxkZXIuX2VkaXRpbmdQYWdlID0gZmFsc2U7XHJcbiAgICBCdWlsZGVyLmlzSWZyYW1lID0gaXNJZnJhbWU7XHJcbiAgICBCdWlsZGVyLmlzQnJvd3NlciA9IGlzQnJvd3NlcjtcclxuICAgIEJ1aWxkZXIuaXNSZWFjdE5hdGl2ZSA9IGlzUmVhY3ROYXRpdmU7XHJcbiAgICBCdWlsZGVyLmlzU2VydmVyID0gIWlzQnJvd3NlciAmJiAhaXNSZWFjdE5hdGl2ZTtcclxuICAgIEJ1aWxkZXIucHJldmlld2luZ01vZGVsID0gQnVpbGRlci5pc0Jyb3dzZXIgJiYgZ2V0UXVlcnlQYXJhbShsb2NhdGlvbi5ocmVmLCAnYnVpbGRlci5wcmV2aWV3Jyk7XHJcbiAgICBCdWlsZGVyLnNldHRpbmdzID0ge307XHJcbiAgICBCdWlsZGVyLnNldHRpbmdzQ2hhbmdlID0gbmV3IEJlaGF2aW9yU3ViamVjdCh7fSk7XHJcbiAgICAvLyBUT0RPOiB0aGlzIGlzIHF1aWNrIGFuZCBkaXJ0eSwgZG8gYmV0dGVyIGltcGxlbWVudGF0aW9uIGxhdGVyLiBBbHNvIGNhbiBiZSB1bnJlbGlhYmxlXHJcbiAgICAvLyBpZiBwYWdlIDMwMXMgZXRjLiBVc2UgYSBxdWVyeSBwYXJhbSBpbnN0ZWFkPyBhbHNvIGNvdWxkIGhhdmUgaXNzdWVzIHdpdGggcmVkaXJlY3RzLiBJbmplY3RpbmcgdmFyIGNvdWxkXHJcbiAgICAvLyB3b3JrIGJ1dCBpcyBhc3luYy4uLlxyXG4gICAgQnVpbGRlci5pc0VkaXRpbmcgPSBCb29sZWFuKGlzSWZyYW1lICYmXHJcbiAgICAgICAgKChkb2N1bWVudC5yZWZlcnJlciAmJiBkb2N1bWVudC5yZWZlcnJlci5tYXRjaCgvYnVpbGRlclxcLmlvfGxvY2FsaG9zdDoxMjM0LykpIHx8XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKCdidWlsZGVyLmZyYW1lRWRpdGluZz0nKSAhPT0gLTEpKTtcclxuICAgIEJ1aWxkZXIuaXNQcmV2aWV3aW5nID0gQm9vbGVhbihpc0Jyb3dzZXIgJiZcclxuICAgICAgICAobG9jYXRpb24uc2VhcmNoLmluZGV4T2YoJ2J1aWxkZXIucHJldmlldz0nKSAhPT0gLTEgfHxcclxuICAgICAgICAgICAgbG9jYXRpb24uc2VhcmNoLmluZGV4T2YoJ2J1aWxkZXIuZnJhbWVFZGl0aW5nPScpICE9PSAtMSkpO1xyXG4gICAgQnVpbGRlci5pc1JlYWN0ID0gZmFsc2U7XHJcbiAgICBCdWlsZGVyLm92ZXJyaWRlVXNlckF0dHJpYnV0ZXMgPSB7fTtcclxuICAgIHJldHVybiBCdWlsZGVyO1xyXG59KCkpO1xuXG52YXIgYnVpbGRlciA9IG5ldyBCdWlsZGVyKG51bGwsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0cnVlKTtcclxuQnVpbGRlci5zaW5nbGV0b25JbnN0YW5jZSA9IGJ1aWxkZXI7XG5cbmV4cG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgQnVpbGRlciwgQnVpbGRlckNvbXBvbmVudCwgU3Vic2NyaXB0aW9uLCBidWlsZGVyLCBpc0Jyb3dzZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@builder.io/sdk/dist/index.esm.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/@builder.io/sdk/dist/index.esm.js":
/*!********************************************************!*\
  !*** ./node_modules/@builder.io/sdk/dist/index.esm.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BehaviorSubject: () => (/* binding */ BehaviorSubject),\n/* harmony export */   Builder: () => (/* binding */ Builder),\n/* harmony export */   BuilderComponent: () => (/* binding */ BuilderComponent),\n/* harmony export */   Subscription: () => (/* binding */ Subscription),\n/* harmony export */   builder: () => (/* binding */ builder),\n/* harmony export */   isBrowser: () => (/* binding */ isBrowser)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ \"(rsc)/./node_modules/tslib/tslib.es6.js\");\n/* harmony import */ var hash_sum__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! hash-sum */ \"(rsc)/./node_modules/hash-sum/hash-sum.js\");\n/* harmony import */ var hash_sum__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(hash_sum__WEBPACK_IMPORTED_MODULE_0__);\n\n\n\n(function () {\n  if (typeof window === 'undefined' || typeof window.CustomEvent === 'function') return false;\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: null };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n\n  window.CustomEvent = CustomEvent;\n})();\n\nvar isSafari = typeof window !== 'undefined' &&\r\n    /^((?!chrome|android).)*safari/i.test(window.navigator.userAgent);\r\nvar isClient = typeof window !== 'undefined';\r\n// TODO: queue all of these in a debounceNextTick\r\nfunction nextTick(fn) {\r\n    // if (typeof process !== 'undefined' && process.nextTick) {\r\n    //   console.log('process.nextTick?');\r\n    //   process.nextTick(fn);\r\n    //   return;\r\n    // }\r\n    // FIXME: fix the real safari issue of this randomly not working\r\n    if (!isClient || isSafari || typeof MutationObserver === 'undefined') {\r\n        setTimeout(fn);\r\n        return;\r\n    }\r\n    var called = 0;\r\n    var observer = new MutationObserver(function () { return fn(); });\r\n    var element = document.createTextNode('');\r\n    observer.observe(element, {\r\n        characterData: true,\r\n    });\r\n    // tslint:disable-next-line\r\n    element.data = String((called = ++called));\r\n}\n\nvar PROPERTY_NAME_DENY_LIST = Object.freeze(['__proto__', 'prototype', 'constructor']);\r\n// TODO: unit tests\r\nvar QueryString = /** @class */ (function () {\r\n    function QueryString() {\r\n    }\r\n    QueryString.parseDeep = function (queryString) {\r\n        var obj = this.parse(queryString);\r\n        return this.deepen(obj);\r\n    };\r\n    QueryString.stringifyDeep = function (obj) {\r\n        var map = this.flatten(obj);\r\n        return this.stringify(map);\r\n    };\r\n    QueryString.parse = function (queryString) {\r\n        var query = {};\r\n        var pairs = (queryString[0] === '?' ? queryString.substr(1) : queryString).split('&');\r\n        for (var i = 0; i < pairs.length; i++) {\r\n            var pair = pairs[i].split('=');\r\n            // TODO: node support?\r\n            try {\r\n                query[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');\r\n            }\r\n            catch (error) {\r\n                // Ignore malformed URI components\r\n            }\r\n        }\r\n        return query;\r\n    };\r\n    QueryString.stringify = function (map) {\r\n        var str = '';\r\n        for (var key in map) {\r\n            if (map.hasOwnProperty(key)) {\r\n                var value = map[key];\r\n                if (str) {\r\n                    str += '&';\r\n                }\r\n                str += encodeURIComponent(key) + '=' + encodeURIComponent(value);\r\n            }\r\n        }\r\n        return str;\r\n    };\r\n    QueryString.deepen = function (map) {\r\n        // FIXME; Should be type Tree = Record<string, string | Tree>\r\n        // requires a typescript upgrade.\r\n        var output = {};\r\n        for (var k in map) {\r\n            var t = output;\r\n            var parts = k.split('.');\r\n            var key = parts.pop();\r\n            for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\r\n                var part = parts_1[_i];\r\n                assertAllowedPropertyName(part);\r\n                t = t[part] = t[part] || {};\r\n            }\r\n            t[key] = map[k];\r\n        }\r\n        return output;\r\n    };\r\n    QueryString.flatten = function (obj, _current, _res) {\r\n        if (_res === void 0) { _res = {}; }\r\n        for (var key in obj) {\r\n            var value = obj[key];\r\n            var newKey = _current ? _current + '.' + key : key;\r\n            if (value && typeof value === 'object') {\r\n                this.flatten(value, newKey, _res);\r\n            }\r\n            else {\r\n                _res[newKey] = value;\r\n            }\r\n        }\r\n        return _res;\r\n    };\r\n    return QueryString;\r\n}());\r\nfunction assertAllowedPropertyName(name) {\r\n    if (PROPERTY_NAME_DENY_LIST.indexOf(name) >= 0)\r\n        throw new Error(\"Property name \\\"\".concat(name, \"\\\" is not allowed\"));\r\n}\n\nvar version = \"2.2.2\";\n\nvar Subscription = /** @class */ (function () {\r\n    function Subscription(listeners, listener) {\r\n        this.listeners = listeners;\r\n        this.listener = listener;\r\n        this.unsubscribed = false;\r\n        this.otherSubscriptions = [];\r\n    }\r\n    Object.defineProperty(Subscription.prototype, \"closed\", {\r\n        get: function () {\r\n            return this.unsubscribed;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Subscription.prototype.add = function (subscription) {\r\n        this.otherSubscriptions.push(subscription);\r\n    };\r\n    Subscription.prototype.unsubscribe = function () {\r\n        if (this.unsubscribed) {\r\n            return;\r\n        }\r\n        if (this.listener && this.listeners) {\r\n            var index = this.listeners.indexOf(this.listener);\r\n            if (index > -1) {\r\n                this.listeners.splice(index, 1);\r\n            }\r\n        }\r\n        this.otherSubscriptions.forEach(function (sub) { return sub.unsubscribe(); });\r\n        this.unsubscribed = true;\r\n    };\r\n    return Subscription;\r\n}());\r\n// TODO: follow minimal basic spec: https://github.com/tc39/proposal-observable\r\nvar BehaviorSubject = /** @class */ (function () {\r\n    function BehaviorSubject(value) {\r\n        var _this = this;\r\n        this.value = value;\r\n        this.listeners = [];\r\n        this.errorListeners = [];\r\n        this.then = function () {\r\n            var _a;\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return (_a = _this.toPromise()).then.apply(_a, args);\r\n        };\r\n    }\r\n    BehaviorSubject.prototype.next = function (value) {\r\n        this.value = value;\r\n        for (var _i = 0, _a = this.listeners; _i < _a.length; _i++) {\r\n            var listener = _a[_i];\r\n            listener(value);\r\n        }\r\n    };\r\n    // TODO: implement this as PIPE instead\r\n    BehaviorSubject.prototype.map = function (fn) {\r\n        var newSubject = new BehaviorSubject(fn(this.value));\r\n        // TODO: on destroy delete these\r\n        this.subscribe(function (val) {\r\n            newSubject.next(fn(val));\r\n        });\r\n        this.catch(function (err) {\r\n            newSubject.error(err);\r\n        });\r\n        return newSubject;\r\n    };\r\n    BehaviorSubject.prototype.catch = function (errorListener) {\r\n        this.errorListeners.push(errorListener);\r\n        return new Subscription(this.errorListeners, errorListener);\r\n    };\r\n    BehaviorSubject.prototype.error = function (error) {\r\n        for (var _i = 0, _a = this.errorListeners; _i < _a.length; _i++) {\r\n            var listener = _a[_i];\r\n            listener(error);\r\n        }\r\n    };\r\n    BehaviorSubject.prototype.subscribe = function (listener, errorListener) {\r\n        this.listeners.push(listener);\r\n        if (errorListener) {\r\n            this.errorListeners.push(errorListener);\r\n        }\r\n        return new Subscription(this.listeners, listener);\r\n    };\r\n    BehaviorSubject.prototype.toPromise = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var subscription = _this.subscribe(function (value) {\r\n                resolve(value);\r\n                subscription.unsubscribe();\r\n            }, function (err) {\r\n                reject(err);\r\n                subscription.unsubscribe();\r\n            });\r\n        });\r\n    };\r\n    BehaviorSubject.prototype.promise = function () {\r\n        return this.toPromise();\r\n    };\r\n    return BehaviorSubject;\r\n}());\n\nvar State = {\r\n    Pending: 'Pending',\r\n    Fulfilled: 'Fulfilled',\r\n    Rejected: 'Rejected',\r\n};\r\nfunction isFunction(val) {\r\n    return val && typeof val === 'function';\r\n}\r\nfunction isObject(val) {\r\n    return val && typeof val === 'object';\r\n}\r\nvar TinyPromise = /** @class */ (function () {\r\n    function TinyPromise(executor) {\r\n        this._state = State.Pending;\r\n        this._handlers = [];\r\n        this._value = null;\r\n        executor(this._resolve.bind(this), this._reject.bind(this));\r\n    }\r\n    TinyPromise.prototype._resolve = function (x) {\r\n        var _this = this;\r\n        if (x instanceof TinyPromise) {\r\n            x.then(this._resolve.bind(this), this._reject.bind(this));\r\n        }\r\n        else if (isObject(x) || isFunction(x)) {\r\n            var called_1 = false;\r\n            try {\r\n                var thenable = x.then;\r\n                if (isFunction(thenable)) {\r\n                    thenable.call(x, function (result) {\r\n                        if (!called_1)\r\n                            _this._resolve(result);\r\n                        called_1 = true;\r\n                        return undefined;\r\n                    }, function (error) {\r\n                        if (!called_1)\r\n                            _this._reject(error);\r\n                        called_1 = true;\r\n                        return undefined;\r\n                    });\r\n                }\r\n                else {\r\n                    this._fulfill(x);\r\n                }\r\n            }\r\n            catch (ex) {\r\n                if (!called_1) {\r\n                    this._reject(ex);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this._fulfill(x);\r\n        }\r\n    };\r\n    TinyPromise.prototype._fulfill = function (result) {\r\n        var _this = this;\r\n        this._state = State.Fulfilled;\r\n        this._value = result;\r\n        this._handlers.forEach(function (handler) { return _this._callHandler(handler); });\r\n    };\r\n    TinyPromise.prototype._reject = function (error) {\r\n        var _this = this;\r\n        this._state = State.Rejected;\r\n        this._value = error;\r\n        this._handlers.forEach(function (handler) { return _this._callHandler(handler); });\r\n    };\r\n    TinyPromise.prototype._isPending = function () {\r\n        return this._state === State.Pending;\r\n    };\r\n    TinyPromise.prototype._isFulfilled = function () {\r\n        return this._state === State.Fulfilled;\r\n    };\r\n    TinyPromise.prototype._isRejected = function () {\r\n        return this._state === State.Rejected;\r\n    };\r\n    TinyPromise.prototype._addHandler = function (onFulfilled, onRejected) {\r\n        this._handlers.push({\r\n            onFulfilled: onFulfilled,\r\n            onRejected: onRejected,\r\n        });\r\n    };\r\n    TinyPromise.prototype._callHandler = function (handler) {\r\n        if (this._isFulfilled() && isFunction(handler.onFulfilled)) {\r\n            handler.onFulfilled(this._value);\r\n        }\r\n        else if (this._isRejected() && isFunction(handler.onRejected)) {\r\n            handler.onRejected(this._value);\r\n        }\r\n    };\r\n    TinyPromise.prototype.then = function (onFulfilled, onRejected) {\r\n        var _this = this;\r\n        switch (this._state) {\r\n            case State.Pending: {\r\n                return new TinyPromise(function (resolve, reject) {\r\n                    _this._addHandler(function (value) {\r\n                        nextTick(function () {\r\n                            try {\r\n                                if (isFunction(onFulfilled)) {\r\n                                    resolve(onFulfilled(value));\r\n                                }\r\n                                else {\r\n                                    resolve(value);\r\n                                }\r\n                            }\r\n                            catch (ex) {\r\n                                reject(ex);\r\n                            }\r\n                        });\r\n                    }, function (error) {\r\n                        nextTick(function () {\r\n                            try {\r\n                                if (isFunction(onRejected)) {\r\n                                    resolve(onRejected(error));\r\n                                }\r\n                                else {\r\n                                    reject(error);\r\n                                }\r\n                            }\r\n                            catch (ex) {\r\n                                reject(ex);\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n            case State.Fulfilled: {\r\n                return new TinyPromise(function (resolve, reject) {\r\n                    nextTick(function () {\r\n                        try {\r\n                            if (isFunction(onFulfilled)) {\r\n                                resolve(onFulfilled(_this._value));\r\n                            }\r\n                            else {\r\n                                resolve(_this._value);\r\n                            }\r\n                        }\r\n                        catch (ex) {\r\n                            reject(ex);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n            case State.Rejected: {\r\n                return new TinyPromise(function (resolve, reject) {\r\n                    nextTick(function () {\r\n                        try {\r\n                            if (isFunction(onRejected)) {\r\n                                resolve(onRejected(_this._value));\r\n                            }\r\n                            else {\r\n                                reject(_this._value);\r\n                            }\r\n                        }\r\n                        catch (ex) {\r\n                            reject(ex);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    };\r\n    return TinyPromise;\r\n}());\r\nvar Promise$1 = (typeof Promise !== 'undefined' ? Promise : TinyPromise);\n\n// Webpack workaround to conditionally require certain external modules\r\n// only on the server and not bundle them on the client\r\nvar serverOnlyRequire;\r\ntry {\r\n    // tslint:disable-next-line:no-eval\r\n    serverOnlyRequire = eval('require');\r\n}\r\ncatch (err) {\r\n    // all good\r\n    serverOnlyRequire = (function () { return null; });\r\n}\r\nvar serverOnlyRequire$1 = serverOnlyRequire;\n\nfunction promiseResolve(value) {\r\n    return new Promise$1(function (resolve) { return resolve(value); });\r\n}\r\n// Adapted from https://raw.githubusercontent.com/developit/unfetch/master/src/index.mjs\r\nfunction tinyFetch(url, options) {\r\n    if (options === void 0) { options = {}; }\r\n    return new Promise$1(function (resolve, reject) {\r\n        var request = new XMLHttpRequest();\r\n        request.open(options.method || 'get', url, true);\r\n        if (options.headers) {\r\n            for (var i in options.headers) {\r\n                request.setRequestHeader(i, options.headers[i]);\r\n            }\r\n        }\r\n        request.withCredentials = options.credentials === 'include';\r\n        request.onload = function () {\r\n            resolve(response());\r\n        };\r\n        request.onerror = reject;\r\n        request.send(options.body);\r\n        function response() {\r\n            var keys = [];\r\n            var all = [];\r\n            var headers = {};\r\n            var header = undefined;\r\n            request\r\n                .getAllResponseHeaders()\r\n                .replace(/^(.*?):[^\\S\\n]*([\\s\\S]*?)$/gm, function (_match, _key, value) {\r\n                var key = _key;\r\n                keys.push((key = key.toLowerCase()));\r\n                all.push([key, value]);\r\n                header = headers[key];\r\n                headers[key] = header ? \"\".concat(header, \",\").concat(value) : value;\r\n                return '';\r\n            });\r\n            return {\r\n                ok: ((request.status / 100) | 0) === 2,\r\n                status: request.status,\r\n                statusText: request.statusText,\r\n                url: request.responseURL,\r\n                clone: response,\r\n                text: function () { return promiseResolve(request.responseText); },\r\n                json: function () { return promiseResolve(request.responseText).then(JSON.parse); },\r\n                blob: function () { return promiseResolve(new Blob([request.response])); },\r\n                headers: {\r\n                    keys: function () { return keys; },\r\n                    entries: function () { return all; },\r\n                    get: function (n) { return headers[n.toLowerCase()]; },\r\n                    has: function (n) { return n.toLowerCase() in headers; },\r\n                },\r\n            };\r\n        }\r\n    });\r\n}\r\nfunction getFetch() {\r\n    // If fetch is defined, in the browser, via polyfill, or in a Cloudflare worker, use it.\r\n    var _fetch = undefined;\r\n    if (globalThis.fetch) {\r\n        _fetch !== null && _fetch !== void 0 ? _fetch : (_fetch = globalThis.fetch);\r\n    }\r\n    else if (typeof window === 'undefined') {\r\n        // If fetch is not defined, in a Node.js environment, use node-fetch.\r\n        try {\r\n            // node-fetch@^3 is ESM only, and will throw error on require.\r\n            _fetch !== null && _fetch !== void 0 ? _fetch : (_fetch = serverOnlyRequire$1('node-fetch'));\r\n        }\r\n        catch (e) {\r\n            // If node-fetch is not installed, use tiny-fetch.\r\n            console.warn('node-fetch is not installed. consider polyfilling fetch or installing node-fetch.');\r\n            console.warn(e);\r\n        }\r\n    }\r\n    // Otherwise, use tiny-fetch.\r\n    return _fetch !== null && _fetch !== void 0 ? _fetch : tinyFetch;\r\n}\n\nfunction assign(target) {\r\n    var to = Object(target);\r\n    for (var index = 1; index < arguments.length; index++) {\r\n        var nextSource = arguments[index];\r\n        if (nextSource != null) {\r\n            // Skip over if undefined or null\r\n            for (var nextKey in nextSource) {\r\n                // Avoid bugs when hasOwnProperty is shadowed\r\n                if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n                    to[nextKey] = nextSource[nextKey];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return to;\r\n}\n\nfunction throttle(func, wait, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var context;\r\n    var args;\r\n    var result;\r\n    var timeout = null;\r\n    var previous = 0;\r\n    var later = function () {\r\n        previous = options.leading === false ? 0 : Date.now();\r\n        timeout = null;\r\n        result = func.apply(context, args);\r\n        if (!timeout)\r\n            context = args = null;\r\n    };\r\n    return function () {\r\n        var now = Date.now();\r\n        if (!previous && options.leading === false)\r\n            previous = now;\r\n        var remaining = wait - (now - previous);\r\n        context = this;\r\n        args = arguments;\r\n        if (remaining <= 0 || remaining > wait) {\r\n            if (timeout) {\r\n                clearTimeout(timeout);\r\n                timeout = null;\r\n            }\r\n            previous = now;\r\n            result = func.apply(context, args);\r\n            if (!timeout)\r\n                context = args = null;\r\n        }\r\n        else if (!timeout && options.trailing !== false) {\r\n            timeout = setTimeout(later, remaining);\r\n        }\r\n        return result;\r\n    };\r\n}\n\nvar camelCaseToKebabCase = function (str) {\r\n    return str ? str.replace(/([A-Z])/g, function (g) { return \"-\".concat(g[0].toLowerCase()); }) : '';\r\n};\r\nvar Animator = /** @class */ (function () {\r\n    function Animator() {\r\n    }\r\n    Animator.prototype.bindAnimations = function (animations) {\r\n        for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {\r\n            var animation = animations_1[_i];\r\n            switch (animation.trigger) {\r\n                case 'pageLoad':\r\n                    this.triggerAnimation(animation);\r\n                    break;\r\n                case 'hover':\r\n                    this.bindHoverAnimation(animation);\r\n                    break;\r\n                case 'scrollInView':\r\n                    this.bindScrollInViewAnimation(animation);\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n    Animator.prototype.warnElementNotPresent = function (id) {\r\n        console.warn(\"Cannot animate element: element with ID \".concat(id, \" not found!\"));\r\n    };\r\n    Animator.prototype.augmentAnimation = function (animation, element) {\r\n        var stylesUsed = this.getAllStylesUsed(animation);\r\n        var computedStyle = getComputedStyle(element);\r\n        // const computedStyle = getComputedStyle(element);\r\n        // // FIXME: this will break if original load is in one reponsive size then resize to another hmmm\r\n        // Need to use transform instead of left since left can change on screen sizes\r\n        var firstStyles = animation.steps[0].styles;\r\n        var lastStyles = animation.steps[animation.steps.length - 1].styles;\r\n        var bothStyles = [firstStyles, lastStyles];\r\n        // FIXME: this won't work as expected for augmented animations - may need the editor itself to manage this\r\n        for (var _i = 0, bothStyles_1 = bothStyles; _i < bothStyles_1.length; _i++) {\r\n            var styles = bothStyles_1[_i];\r\n            for (var _a = 0, stylesUsed_1 = stylesUsed; _a < stylesUsed_1.length; _a++) {\r\n                var style = stylesUsed_1[_a];\r\n                if (!(style in styles)) {\r\n                    styles[style] = computedStyle[style];\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Animator.prototype.getAllStylesUsed = function (animation) {\r\n        var properties = [];\r\n        for (var _i = 0, _a = animation.steps; _i < _a.length; _i++) {\r\n            var step = _a[_i];\r\n            for (var key in step.styles) {\r\n                if (properties.indexOf(key) === -1) {\r\n                    properties.push(key);\r\n                }\r\n            }\r\n        }\r\n        return properties;\r\n    };\r\n    Animator.prototype.triggerAnimation = function (animation) {\r\n        var _this = this;\r\n        // TODO: do for ALL elements\r\n        var elements = Array.prototype.slice.call(document.getElementsByClassName(animation.elementId || animation.id || ''));\r\n        if (!elements.length) {\r\n            this.warnElementNotPresent(animation.elementId || animation.id || '');\r\n            return;\r\n        }\r\n        Array.from(elements).forEach(function (element) {\r\n            _this.augmentAnimation(animation, element);\r\n            // TODO: do this properly, may have other animations of different properties\r\n            // TODO: only override the properties\r\n            // TODO: if there is an entrance and hover animation, the transition duration will get effed\r\n            // element.setAttribute('style', '');\r\n            // const styledUsed = this.getAllStylesUsed(animation);\r\n            element.style.transition = 'none';\r\n            element.style.transitionDelay = '0';\r\n            assign(element.style, animation.steps[0].styles);\r\n            // TODO: queue/batch these timeouts\r\n            // TODO: only include properties explicitly set in the animation\r\n            // using Object.keys(styles)\r\n            setTimeout(function () {\r\n                element.style.transition = \"all \".concat(animation.duration, \"s \").concat(camelCaseToKebabCase(animation.easing));\r\n                if (animation.delay) {\r\n                    element.style.transitionDelay = animation.delay + 's';\r\n                }\r\n                assign(element.style, animation.steps[1].styles);\r\n                // TODO: maybe remove/reset transitoin property after animation duration\r\n                // TODO: queue timers\r\n                setTimeout(function () {\r\n                    // TODO: what if has other transition (reset back to what it was)\r\n                    element.style.transition = '';\r\n                    element.style.transitionDelay = '';\r\n                }, (animation.delay || 0) * 1000 + animation.duration * 1000 + 100);\r\n            });\r\n        });\r\n    };\r\n    Animator.prototype.bindHoverAnimation = function (animation) {\r\n        var _this = this;\r\n        // TODO: is it multiple binding when editing...?\r\n        // TODO: unbind on element remove\r\n        // TODO: apply to ALL elements\r\n        var elements = Array.prototype.slice.call(document.getElementsByClassName(animation.elementId || animation.id || ''));\r\n        if (!elements.length) {\r\n            this.warnElementNotPresent(animation.elementId || animation.id || '');\r\n            return;\r\n        }\r\n        Array.from(elements).forEach(function (element) {\r\n            _this.augmentAnimation(animation, element);\r\n            var defaultState = animation.steps[0].styles;\r\n            var hoverState = animation.steps[1].styles;\r\n            function attachDefaultState() {\r\n                assign(element.style, defaultState);\r\n            }\r\n            function attachHoverState() {\r\n                assign(element.style, hoverState);\r\n            }\r\n            attachDefaultState();\r\n            element.addEventListener('mouseenter', attachHoverState);\r\n            element.addEventListener('mouseleave', attachDefaultState);\r\n            // TODO: queue/batch these timeouts\r\n            setTimeout(function () {\r\n                element.style.transition = \"all \".concat(animation.duration, \"s \").concat(camelCaseToKebabCase(animation.easing));\r\n                if (animation.delay) {\r\n                    element.style.transitionDelay = animation.delay + 's';\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // TODO: unbind on element remove\r\n    Animator.prototype.bindScrollInViewAnimation = function (animation) {\r\n        var _this = this;\r\n        // TODO: apply to ALL matching elements\r\n        var elements = Array.prototype.slice.call(document.getElementsByClassName(animation.elementId || animation.id || ''));\r\n        if (!elements.length) {\r\n            this.warnElementNotPresent(animation.elementId || animation.id || '');\r\n            return;\r\n        }\r\n        // TODO: if server side rendered and scrolled into view don't animate...\r\n        Array.from(elements).forEach(function (element) {\r\n            _this.augmentAnimation(animation, element);\r\n            var triggered = false;\r\n            var pendingAnimation = false;\r\n            function immediateOnScroll() {\r\n                if (!triggered && isScrolledIntoView(element)) {\r\n                    triggered = true;\r\n                    pendingAnimation = true;\r\n                    setTimeout(function () {\r\n                        assign(element.style, animation.steps[1].styles);\r\n                        if (!animation.repeat) {\r\n                            document.removeEventListener('scroll', onScroll);\r\n                        }\r\n                        setTimeout(function () {\r\n                            pendingAnimation = false;\r\n                            if (!animation.repeat) {\r\n                                element.style.transition = '';\r\n                                element.style.transitionDelay = '';\r\n                            }\r\n                        }, (animation.duration + (animation.delay || 0)) * 1000 + 100);\r\n                    });\r\n                }\r\n                else if (animation.repeat &&\r\n                    triggered &&\r\n                    !pendingAnimation &&\r\n                    !isScrolledIntoView(element)) {\r\n                    // we want to repeat the animation every time the the element is out of view and back again\r\n                    triggered = false;\r\n                    assign(element.style, animation.steps[0].styles);\r\n                }\r\n            }\r\n            // TODO: roll all of these in one for more efficiency of checking all the rects\r\n            var onScroll = throttle(immediateOnScroll, 200, { leading: false });\r\n            // TODO: fully in view or partially\r\n            function isScrolledIntoView(elem) {\r\n                var rect = elem.getBoundingClientRect();\r\n                var windowHeight = window.innerHeight;\r\n                var thresholdPercent = (animation.thresholdPercent || 0) / 100;\r\n                var threshold = thresholdPercent * windowHeight;\r\n                // TODO: partial in view? or what if element is larger than screen itself\r\n                return (rect.bottom > threshold && rect.top < windowHeight - threshold // Element is peeking top or bottom\r\n                // (rect.top > 0 && rect.bottom < window.innerHeight) || // element fits within the screen and is fully on screen (not hanging off at all)\r\n                // (rect.top < 0 && rect.bottom > window.innerHeight) // element is larger than the screen and hangs over the top and bottom\r\n                );\r\n            }\r\n            var defaultState = animation.steps[0].styles;\r\n            function attachDefaultState() {\r\n                assign(element.style, defaultState);\r\n            }\r\n            attachDefaultState();\r\n            // TODO: queue/batch these timeouts!\r\n            setTimeout(function () {\r\n                element.style.transition = \"all \".concat(animation.duration, \"s \").concat(camelCaseToKebabCase(animation.easing));\r\n                if (animation.delay) {\r\n                    element.style.transitionDelay = animation.delay + 's';\r\n                }\r\n            });\r\n            // TODO: one listener for everything\r\n            document.addEventListener('scroll', onScroll, { capture: true, passive: true });\r\n            // Do an initial check\r\n            immediateOnScroll();\r\n        });\r\n    };\r\n    return Animator;\r\n}());\n\n/**\r\n * Only gets one level up from hostname\r\n * wwww.example.com -> example.com\r\n * www.example.co.uk -> example.co.uk\r\n */\r\nfunction getTopLevelDomain(host) {\r\n    var parts = host.split('.');\r\n    if (parts.length > 2) {\r\n        return parts.slice(1).join('.');\r\n    }\r\n    return host;\r\n}\n\n/**\r\n * RegExp to match field-content in RFC 7230 sec 3.2\r\n *\r\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\r\n * field-vchar   = VCHAR / obs-text\r\n * obs-text      = %x80-FF\r\n */\r\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\r\nvar Cookies = /** @class */ (function () {\r\n    function Cookies(request, response) {\r\n        this.request = request;\r\n        this.response = response;\r\n    }\r\n    Cookies.prototype.get = function (name) {\r\n        var header = this.request.headers['cookie'];\r\n        if (!header) {\r\n            return;\r\n        }\r\n        var match = header.match(getPattern(name));\r\n        if (!match) {\r\n            return;\r\n        }\r\n        var value = match[1];\r\n        return value;\r\n    };\r\n    Cookies.prototype.set = function (name, value, opts) {\r\n        var res = this.response;\r\n        var req = this.request;\r\n        var headers = res.getHeader('Set-Cookie') || [];\r\n        // TODO: just make this always true\r\n        var secure = this.secure !== undefined\r\n            ? !!this.secure\r\n            : req.protocol === 'https' || req.connection.encrypted;\r\n        var cookie = new Cookie(name, value, opts);\r\n        if (typeof headers === 'string') {\r\n            headers = [headers];\r\n        }\r\n        if (!secure && opts && opts.secure) {\r\n            throw new Error('Cannot send secure cookie over unencrypted connection');\r\n        }\r\n        cookie.secure = secure;\r\n        if (opts && 'secure' in opts) {\r\n            cookie.secure = !!opts.secure;\r\n        }\r\n        cookie.domain = req.headers.host && getTopLevelDomain(req.headers.host);\r\n        pushCookie(headers, cookie);\r\n        var setHeader = res.setHeader;\r\n        setHeader.call(res, 'Set-Cookie', headers);\r\n        return this;\r\n    };\r\n    return Cookies;\r\n}());\r\nvar Cookie = /** @class */ (function () {\r\n    function Cookie(name, value, attrs) {\r\n        this.path = '/';\r\n        this.domain = undefined;\r\n        this.httpOnly = true;\r\n        this.sameSite = false;\r\n        this.secure = false;\r\n        this.overwrite = false;\r\n        this.name = '';\r\n        this.value = '';\r\n        if (!fieldContentRegExp.test(name)) {\r\n            throw new TypeError('argument name is invalid');\r\n        }\r\n        if (value && !fieldContentRegExp.test(value)) {\r\n            throw new TypeError('argument value is invalid');\r\n        }\r\n        if (!value) {\r\n            this.expires = new Date(0);\r\n        }\r\n        this.name = name;\r\n        this.value = value || '';\r\n        if (attrs.expires) {\r\n            this.expires = attrs.expires;\r\n        }\r\n        if (attrs.secure) {\r\n            this.secure = attrs.secure;\r\n        }\r\n    }\r\n    Cookie.prototype.toString = function () {\r\n        return \"\".concat(this.name, \"=\").concat(this.value);\r\n    };\r\n    Cookie.prototype.toHeader = function () {\r\n        var header = this.toString();\r\n        if (this.maxAge) {\r\n            this.expires = new Date(Date.now() + this.maxAge);\r\n        }\r\n        if (this.path) {\r\n            header += \"; path=\".concat(this.path);\r\n        }\r\n        if (this.expires) {\r\n            header += \"; expires=\".concat(this.expires.toUTCString());\r\n        }\r\n        if (this.domain) {\r\n            header += \"; domain=\".concat(this.domain);\r\n        }\r\n        // TODO: samesite=none by default (?)\r\n        header += \"; SameSite=\".concat(this.sameSite === true ? 'strict' : 'None');\r\n        // TODO: On by default\r\n        if (this.secure) {\r\n            header += '; secure';\r\n        }\r\n        if (this.httpOnly) {\r\n            header += '; httponly';\r\n        }\r\n        return header;\r\n    };\r\n    return Cookie;\r\n}());\r\nfunction getPattern(name) {\r\n    return new RegExp(\"(?:^|;) *\".concat(name.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&'), \"=([^;]*)\"));\r\n}\r\nfunction pushCookie(headers, cookie) {\r\n    if (cookie.overwrite) {\r\n        for (var i = headers.length - 1; i >= 0; i--) {\r\n            if (headers[i].indexOf(\"\".concat(cookie.name, \"=\")) === 0) {\r\n                headers.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    headers.push(cookie.toHeader());\r\n}\n\nfunction omit(obj) {\r\n    var values = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        values[_i - 1] = arguments[_i];\r\n    }\r\n    var newObject = Object.assign({}, obj);\r\n    for (var _a = 0, values_1 = values; _a < values_1.length; _a++) {\r\n        var key = values_1[_a];\r\n        delete newObject[key];\r\n    }\r\n    return newObject;\r\n}\n\n/**\r\n * @credit https://stackoverflow.com/a/2117523\r\n */\r\nfunction uuidv4() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n        var r = (Math.random() * 16) | 0, v = c == 'x' ? r : (r & 0x3) | 0x8;\r\n        return v.toString(16);\r\n    });\r\n}\r\n/**\r\n * Slightly cleaner and smaller UUIDs\r\n */\r\nfunction uuid() {\r\n    return uuidv4().replace(/-/g, '');\r\n}\n\nfunction emptyUrl() {\r\n    return {\r\n        query: null,\r\n        port: null,\r\n        auth: null,\r\n        hash: null,\r\n        host: null,\r\n        hostname: null,\r\n        href: null,\r\n        path: null,\r\n        pathname: null,\r\n        protocol: null,\r\n        search: null,\r\n        slashes: null,\r\n    };\r\n}\r\n// Replacement for `url.parse` using `URL` global object that works with relative paths.\r\n// Assumptions: this function operates in a NodeJS environment.\r\nfunction parse$1(url) {\r\n    var _a;\r\n    var out = emptyUrl();\r\n    var u;\r\n    var pathOnly = url === '' || url[0] === '/';\r\n    if (pathOnly) {\r\n        u = new URL(url, 'http://0.0.0.0/');\r\n        out.href = u.href;\r\n        out.href = (_a = out.href) === null || _a === void 0 ? void 0 : _a.slice(14); // remove 'http://0.0.0.0/'\r\n    }\r\n    else {\r\n        u = new URL(url);\r\n        out.href = u.href;\r\n        out.port = u.port === '' ? null : u.port;\r\n        out.hash = u.hash === '' ? null : u.hash;\r\n        out.host = u.host;\r\n        out.hostname = u.hostname;\r\n        out.href = u.href;\r\n        out.pathname = u.pathname;\r\n        out.protocol = u.protocol;\r\n        out.slashes = url[u.protocol.length] === '/'; // check if the mimetype is proceeded by a slash\r\n    }\r\n    out.search = u.search;\r\n    out.query = u.search.slice(1); // remove '?'\r\n    out.path = \"\".concat(u.pathname).concat(u.search);\r\n    out.pathname = u.pathname;\r\n    return out;\r\n}\n\n/**\r\n * Safe conversion to error type. Intended to be used in catch blocks where the\r\n *  value is not guaranteed to be an error.\r\n *\r\n *  @example\r\n *  try {\r\n *    throw new Error('Something went wrong')\r\n *  }\r\n *  catch (err: unknown) {\r\n *    const error: Error = toError(err)\r\n *  }\r\n */\r\nfunction toError(err) {\r\n    if (err instanceof Error)\r\n        return err;\r\n    return new Error(String(err));\r\n}\n\nvar DEFAULT_API_VERSION = 'v3';\n\nfunction datePlusMinutes(minutes) {\r\n    if (minutes === void 0) { minutes = 30; }\r\n    return new Date(Date.now() + minutes * 60000);\r\n}\r\nvar isPositiveNumber = function (thing) {\r\n    return typeof thing === 'number' && !isNaN(thing) && thing >= 0;\r\n};\r\nvar isReactNative = typeof navigator === 'object' && navigator.product === 'ReactNative';\r\nvar validEnvList = [\r\n    'production',\r\n    'qa',\r\n    'test',\r\n    'development',\r\n    'dev',\r\n    'cdn-qa',\r\n    'cloud',\r\n    'fast',\r\n    'cdn2',\r\n    'cdn-prod',\r\n];\r\nfunction getQueryParam(url, variable) {\r\n    var query = url.split('?')[1] || '';\r\n    var vars = query.split('&');\r\n    for (var i = 0; i < vars.length; i++) {\r\n        var pair = vars[i].split('=');\r\n        if (decodeURIComponent(pair[0]) === variable) {\r\n            return decodeURIComponent(pair[1]);\r\n        }\r\n    }\r\n    return null;\r\n}\r\nvar urlParser = {\r\n    parse: function (url) {\r\n        var el = document.createElement('a');\r\n        el.href = url;\r\n        var out = {};\r\n        var props = [\r\n            'username',\r\n            'password',\r\n            'host',\r\n            'hostname',\r\n            'port',\r\n            'protocol',\r\n            'origin',\r\n            'pathname',\r\n            'search',\r\n            'hash',\r\n        ];\r\n        for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\r\n            var prop = props_1[_i];\r\n            out[prop] = el[prop];\r\n        }\r\n        // IE 11 pathname handling workaround\r\n        // (IE omits preceeding '/', unlike other browsers)\r\n        if ((out.pathname || out.pathname === '') &&\r\n            typeof out.pathname === 'string' &&\r\n            out.pathname.indexOf('/') !== 0) {\r\n            out.pathname = '/' + out.pathname;\r\n        }\r\n        return out;\r\n    },\r\n};\r\nvar parse = isReactNative\r\n    ? function () { return emptyUrl(); }\r\n    : typeof window === 'object'\r\n        ? urlParser.parse\r\n        : parse$1;\r\nfunction setCookie(name, value, expires) {\r\n    try {\r\n        var expiresString = '';\r\n        // TODO: need to know if secure server side\r\n        if (expires) {\r\n            expiresString = '; expires=' + expires.toUTCString();\r\n        }\r\n        var secure = isBrowser ? location.protocol === 'https:' : true;\r\n        document.cookie =\r\n            name +\r\n                '=' +\r\n                (value || '') +\r\n                expiresString +\r\n                '; path=/' +\r\n                \"; domain=\".concat(getTopLevelDomain(location.hostname)) +\r\n                (secure ? '; secure; SameSite=None' : '');\r\n    }\r\n    catch (err) {\r\n        console.warn('Could not set cookie', err);\r\n    }\r\n}\r\nfunction getCookie(name) {\r\n    try {\r\n        return (decodeURIComponent(document.cookie.replace(new RegExp('(?:(?:^|.*;)\\\\s*' +\r\n            encodeURIComponent(name).replace(/[\\-\\.\\+\\*]/g, '\\\\$&') +\r\n            '\\\\s*\\\\=\\\\s*([^;]*).*$)|^.*$'), '$1')) || null);\r\n    }\r\n    catch (err) {\r\n        console.warn('Could not get cookie', err);\r\n    }\r\n}\r\nfunction size(object) {\r\n    return Object.keys(object).length;\r\n}\r\nfunction find(target, callback) {\r\n    var list = target;\r\n    // Makes sures is always has an positive integer as length.\r\n    var length = list.length >>> 0;\r\n    var thisArg = arguments[1];\r\n    for (var i = 0; i < length; i++) {\r\n        var element = list[i];\r\n        if (callback.call(thisArg, element, i, list)) {\r\n            return element;\r\n        }\r\n    }\r\n}\r\nvar sessionStorageKey = 'builderSessionId';\r\nvar localStorageKey = 'builderVisitorId';\r\nvar isBrowser = typeof window !== 'undefined' && !isReactNative;\r\nvar isIframe = isBrowser && window.top !== window.self;\r\nfunction BuilderComponent(info) {\r\n    if (info === void 0) { info = {}; }\r\n    return Builder.Component(info);\r\n}\r\nvar Builder = /** @class */ (function () {\r\n    function Builder(apiKey, request, response, forceNewInstance, authToken, apiVersion) {\r\n        if (apiKey === void 0) { apiKey = null; }\r\n        if (forceNewInstance === void 0) { forceNewInstance = false; }\r\n        if (authToken === void 0) { authToken = null; }\r\n        var _this = this;\r\n        this.request = request;\r\n        this.response = response;\r\n        this.eventsQueue = [];\r\n        this.throttledClearEventsQueue = throttle(function () {\r\n            _this.processEventsQueue();\r\n            // Extend the session cookie\r\n            _this.setCookie(sessionStorageKey, _this.sessionId, datePlusMinutes(30));\r\n        }, 5);\r\n        this.env = 'production';\r\n        this.sessionId = this.getSessionId();\r\n        this.targetContent = true;\r\n        this.contentPerRequest = 1;\r\n        // TODO: make array or function\r\n        this.allowCustomFonts = true;\r\n        this.cookies = null;\r\n        // TODO: api options object\r\n        this.cachebust = false;\r\n        this.overrideParams = '';\r\n        this.noCache = false;\r\n        this.preview = false;\r\n        this.apiVersion$ = new BehaviorSubject(undefined);\r\n        this.canTrack$ = new BehaviorSubject(!this.browserTrackingDisabled);\r\n        this.apiKey$ = new BehaviorSubject(null);\r\n        this.authToken$ = new BehaviorSubject(null);\r\n        this.userAttributesChanged = new BehaviorSubject(null);\r\n        this.editingMode$ = new BehaviorSubject(isIframe);\r\n        // TODO: decorator to do this stuff with the get/set (how do with typing too? compiler?)\r\n        this.editingModel$ = new BehaviorSubject(null);\r\n        this.userAgent = (typeof navigator === 'object' && navigator.userAgent) || '';\r\n        this.trackingHooks = [];\r\n        // Set this to control the userId\r\n        // TODO: allow changing it mid session and updating existing data to be associated\r\n        // e.g. for when a user navigates and then logs in\r\n        this.visitorId = this.getVisitorId();\r\n        this.autoTrack = !Builder.isBrowser\r\n            ? false\r\n            : !this.isDevelopmentEnv &&\r\n                !(Builder.isBrowser && location.search.indexOf('builder.preview=') !== -1);\r\n        this.trackingUserAttributes = {};\r\n        this.blockContentLoading = '';\r\n        this.observersByKey = {};\r\n        this.noEditorUpdates = {};\r\n        this.overrides = {};\r\n        this.queryOptions = {};\r\n        this.getContentQueue = null;\r\n        this.priorContentQueue = null;\r\n        this.testCookiePrefix = 'builder.tests';\r\n        this.cookieQueue = [];\r\n        // TODO: use a window variable for this perhaps, e.g. bc webcomponents may be loading builder twice\r\n        // with it's and react (use rollup build to fix)\r\n        if (Builder.isBrowser && !forceNewInstance && Builder.singletonInstance) {\r\n            return Builder.singletonInstance;\r\n        }\r\n        if (this.request && this.response) {\r\n            this.setUserAgent(this.request.headers['user-agent'] || '');\r\n            this.cookies = new Cookies(this.request, this.response);\r\n        }\r\n        if (apiKey) {\r\n            this.apiKey = apiKey;\r\n        }\r\n        if (apiVersion) {\r\n            this.apiVersion = apiVersion;\r\n        }\r\n        if (authToken) {\r\n            this.authToken = authToken;\r\n        }\r\n        if (isBrowser) {\r\n            this.bindMessageListeners();\r\n            if (Builder.isEditing) {\r\n                parent.postMessage({\r\n                    type: 'builder.animatorOptions',\r\n                    data: {\r\n                        options: {\r\n                            version: 2,\r\n                        },\r\n                    },\r\n                }, '*');\r\n            }\r\n            // TODO: postmessage to parent the builder info for every package\r\n            // type: 'builder.sdk', data: { name: '@builder.io/react', version: '0.1.23' }\r\n            // (window as any).BUILDER_VERSION = Builder.VERSION;\r\n            // Ensure always one Builder global singleton\r\n            // TODO: some people won't want this, e.g. rakuten\r\n            // Maybe hide this behind symbol or on document, etc\r\n            // if ((window as any).Builder) {\r\n            //   Builder.components = (window as any).Builder.components;\r\n            // } else {\r\n            //   (window as any).Builder = Builder;\r\n            // }\r\n        }\r\n        if (isIframe) {\r\n            this.messageFrameLoaded();\r\n        }\r\n        // TODO: on destroy clear subscription\r\n        this.canTrack$.subscribe(function (value) {\r\n            if (value) {\r\n                if (typeof sessionStorage !== 'undefined') {\r\n                    try {\r\n                        if (!sessionStorage.getItem(sessionStorageKey)) {\r\n                            sessionStorage.setItem(sessionStorageKey, _this.sessionId);\r\n                        }\r\n                    }\r\n                    catch (err) {\r\n                        console.debug('Session storage error', err);\r\n                    }\r\n                }\r\n                if (_this.eventsQueue.length) {\r\n                    _this.throttledClearEventsQueue();\r\n                }\r\n                if (_this.cookieQueue.length) {\r\n                    _this.cookieQueue.forEach(function (item) {\r\n                        _this.setCookie(item[0], item[1]);\r\n                    });\r\n                    _this.cookieQueue.length = 0;\r\n                }\r\n            }\r\n        });\r\n        if (isBrowser) {\r\n            // TODO: defer so subclass constructor runs and injects location service\r\n            this.setTestsFromUrl();\r\n            // TODO: do this on every request send?\r\n            this.getOverridesFromQueryString();\r\n        }\r\n    }\r\n    Builder.register = function (type, info) {\r\n        // TODO: all must have name and can't conflict?\r\n        var typeList = this.registry[type];\r\n        if (!typeList) {\r\n            typeList = this.registry[type] = [];\r\n        }\r\n        typeList.push(info);\r\n        if (Builder.isBrowser) {\r\n            var message = {\r\n                type: 'builder.register',\r\n                data: {\r\n                    type: type,\r\n                    info: info,\r\n                },\r\n            };\r\n            try {\r\n                parent.postMessage(message, '*');\r\n                if (parent !== window) {\r\n                    window.postMessage(message, '*');\r\n                }\r\n            }\r\n            catch (err) {\r\n                console.debug('Could not postmessage', err);\r\n            }\r\n        }\r\n        this.registryChange.next(this.registry);\r\n    };\r\n    Builder.registerEditor = function (info) {\r\n        if (Builder.isBrowser) {\r\n            window.postMessage({\r\n                type: 'builder.registerEditor',\r\n                data: omit(info, 'component'),\r\n            }, '*');\r\n            var hostname = location.hostname;\r\n            if (!Builder.isTrustedHost(hostname)) {\r\n                console.error('Builder.registerEditor() called in the wrong environment! You cannot load custom editors from your app, they must be loaded through the Builder.io app itself. Follow the readme here for more details: https://github.com/builderio/builder/tree/master/plugins/cloudinary or contact chat us in our Spectrum community for help: https://spectrum.chat/builder');\r\n            }\r\n        }\r\n        this.editors.push(info);\r\n    };\r\n    Builder.registerPlugin = function (info) {\r\n        this.plugins.push(info);\r\n    };\r\n    Builder.registerAction = function (action) {\r\n        this.actions.push(action);\r\n    };\r\n    Builder.registerTrustedHost = function (host) {\r\n        this.trustedHosts.push(host);\r\n    };\r\n    /**\r\n     * @param context @type {import('isolated-vm').Context}\r\n     * Use this function to control the execution context of custom code on the server.\r\n     * const ivm = require('isolated-vm');\r\n     * const isolate = new ivm.Isolate({ memoryLimit: 128 });\r\n     * const context = isolate.createContextSync();\r\n     * Builder.setServerContext(context);\r\n     */\r\n    Builder.setServerContext = function (context) {\r\n        this.serverContext = context;\r\n    };\r\n    Builder.isTrustedHost = function (hostname) {\r\n        return (this.trustedHosts.findIndex(function (trustedHost) {\r\n            return trustedHost.startsWith('*.')\r\n                ? hostname.endsWith(trustedHost.slice(1))\r\n                : trustedHost === hostname;\r\n        }) > -1);\r\n    };\r\n    Builder.runAction = function (action) {\r\n        // TODO\r\n        var actionObject = typeof action === 'string' ? find(this.actions, function (item) { return item.name === action; }) : action;\r\n        if (!actionObject) {\r\n            throw new Error(\"Action not found: \".concat(action));\r\n        }\r\n    };\r\n    Builder.fields = function (name, fields) {\r\n        var _a;\r\n        (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n            type: 'builder.fields',\r\n            data: { name: name, fields: fields },\r\n        }, '*');\r\n    };\r\n    /**\r\n     * @deprecated\r\n     * @hidden\r\n     *\r\n     * Use Builder.register('editor.settings', {}) instead.\r\n     */\r\n    Builder.set = function (settings) {\r\n        Builder.register('editor.settings', settings);\r\n    };\r\n    Builder.import = function (packageName) {\r\n        if (!Builder.isBrowser) {\r\n            // TODO: server side support *maybe*\r\n            console.warn('Builder.import used on the server - this should only be used in the browser');\r\n            return;\r\n        }\r\n        var System = window.System;\r\n        if (!System) {\r\n            console.warn('System.js not available. Please include System.js when using Builder.import');\r\n            return;\r\n        }\r\n        return System.import(\"https://cdn.builder.io/systemjs/\".concat(packageName));\r\n    };\r\n    Object.defineProperty(Builder, \"editingPage\", {\r\n        // useCdnApi = false;\r\n        get: function () {\r\n            return this._editingPage;\r\n        },\r\n        set: function (editingPage) {\r\n            this._editingPage = editingPage;\r\n            if (isBrowser && isIframe) {\r\n                if (editingPage) {\r\n                    document.body.classList.add('builder-editing-page');\r\n                }\r\n                else {\r\n                    document.body.classList.remove('builder-editing-page');\r\n                }\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prepareComponentSpecToSend = function (spec) {\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, spec), (spec.inputs && {\r\n            inputs: spec.inputs.map(function (input) {\r\n                var _a;\r\n                // TODO: do for nexted fields too\r\n                // TODO: probably just convert all functions, not just\r\n                // TODO: put this in input hooks: { onChange: ..., showIf: ... }\r\n                var keysToConvertFnToString = ['onChange', 'showIf'];\r\n                for (var _i = 0, keysToConvertFnToString_1 = keysToConvertFnToString; _i < keysToConvertFnToString_1.length; _i++) {\r\n                    var key = keysToConvertFnToString_1[_i];\r\n                    if (input[key] && typeof input[key] === 'function') {\r\n                        var fn = input[key];\r\n                        input = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, input), (_a = {}, _a[key] = \"return (\".concat(fn.toString(), \").apply(this, arguments)\"), _a));\r\n                    }\r\n                }\r\n                return input;\r\n            }),\r\n        })), { hooks: Object.keys(spec.hooks || {}).reduce(function (memo, key) {\r\n                var value = spec.hooks && spec.hooks[key];\r\n                if (!value) {\r\n                    return memo;\r\n                }\r\n                if (typeof value === 'string') {\r\n                    memo[key] = value;\r\n                }\r\n                else {\r\n                    memo[key] = \"return (\".concat(value.toString(), \").apply(this, arguments)\");\r\n                }\r\n                return memo;\r\n            }, {}), class: undefined });\r\n    };\r\n    Builder.registerBlock = function (component, options) {\r\n        this.registerComponent(component, options);\r\n    };\r\n    Builder.registerComponent = function (component, options) {\r\n        var _a;\r\n        var spec = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ class: component }, component.builderOptions), options);\r\n        this.addComponent(spec);\r\n        var editable = options.models && this.singletonInstance.editingModel\r\n            ? isBrowser && options.models.includes(this.singletonInstance.editingModel)\r\n            : isBrowser;\r\n        if (editable) {\r\n            var sendSpec = this.prepareComponentSpecToSend(spec);\r\n            (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n                type: 'builder.registerComponent',\r\n                data: sendSpec,\r\n            }, '*');\r\n        }\r\n    };\r\n    Builder.addComponent = function (component) {\r\n        var current = find(this.components, function (item) { return item.name === component.name; });\r\n        if (current) {\r\n            // FIXME: why does sometimes we get an extra post without class - probably\r\n            // from postMessage handler wrong in some place\r\n            if (current.class && !component.class) {\r\n                return;\r\n            }\r\n            this.components.splice(this.components.indexOf(current), 1, component);\r\n        }\r\n        else {\r\n            this.components.push(component);\r\n        }\r\n    };\r\n    // TODO: style guide, etc off this system as well?\r\n    Builder.component = function (info) {\r\n        var _this = this;\r\n        if (info === void 0) { info = {}; }\r\n        return function (component) {\r\n            var _a;\r\n            var spec = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, info), { class: component });\r\n            if (!spec.name) {\r\n                spec.name = component.name;\r\n            }\r\n            _this.addComponent(spec);\r\n            var sendSpec = _this.prepareComponentSpecToSend(spec);\r\n            // TODO: serialize component name and inputs\r\n            if (isBrowser) {\r\n                (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n                    type: 'builder.registerComponent',\r\n                    data: sendSpec,\r\n                }, '*');\r\n            }\r\n            return component;\r\n        };\r\n    };\r\n    Object.defineProperty(Builder, \"Component\", {\r\n        get: function () {\r\n            return this.component;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.processEventsQueue = function () {\r\n        if (!this.eventsQueue.length) {\r\n            return;\r\n        }\r\n        var events = this.eventsQueue;\r\n        this.eventsQueue = [];\r\n        var fullUserAttributes = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, Builder.overrideUserAttributes), this.trackingUserAttributes);\r\n        for (var _i = 0, events_1 = events; _i < events_1.length; _i++) {\r\n            var event_1 = events_1[_i];\r\n            if (!event_1.data.metadata) {\r\n                event_1.data.metadata = {};\r\n            }\r\n            if (!event_1.data.metadata.user) {\r\n                event_1.data.metadata.user = {};\r\n            }\r\n            Object.assign(event_1.data.metadata.user, fullUserAttributes, event_1.data.metadata.user);\r\n        }\r\n        var host = this.host;\r\n        getFetch()(\"\".concat(host, \"/api/v1/track\"), {\r\n            method: 'POST',\r\n            body: JSON.stringify({ events: events }),\r\n            headers: {\r\n                'content-type': 'application/json',\r\n            },\r\n            mode: 'cors',\r\n        }).catch(function () {\r\n            // Not the end of the world\r\n        });\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"browserTrackingDisabled\", {\r\n        get: function () {\r\n            return Builder.isBrowser && Boolean(window.builderNoTrack || !navigator.cookieEnabled);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"canTrack\", {\r\n        get: function () {\r\n            return this.canTrack$.value;\r\n        },\r\n        set: function (canTrack) {\r\n            if (this.canTrack !== canTrack) {\r\n                this.canTrack$.next(canTrack);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"apiVersion\", {\r\n        get: function () {\r\n            return this.apiVersion$.value;\r\n        },\r\n        set: function (apiVersion) {\r\n            if (this.apiVersion !== apiVersion) {\r\n                this.apiVersion$.next(apiVersion);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"editingMode\", {\r\n        get: function () {\r\n            return this.editingMode$.value;\r\n        },\r\n        set: function (value) {\r\n            if (value !== this.editingMode) {\r\n                this.editingMode$.next(value);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"editingModel\", {\r\n        get: function () {\r\n            return this.editingModel$.value;\r\n        },\r\n        set: function (value) {\r\n            if (value !== this.editingModel) {\r\n                this.editingModel$.next(value);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.findParentElement = function (target, callback, checkElement) {\r\n        if (checkElement === void 0) { checkElement = true; }\r\n        if (!(target instanceof HTMLElement)) {\r\n            return null;\r\n        }\r\n        var parent = checkElement ? target : target.parentElement;\r\n        do {\r\n            if (!parent) {\r\n                return null;\r\n            }\r\n            var matches = callback(parent);\r\n            if (matches) {\r\n                return parent;\r\n            }\r\n        } while ((parent = parent.parentElement));\r\n        return null;\r\n    };\r\n    Builder.prototype.findBuilderParent = function (target) {\r\n        return this.findParentElement(target, function (el) {\r\n            var id = el.getAttribute('builder-id') || el.id;\r\n            return Boolean(id && id.indexOf('builder-') === 0);\r\n        });\r\n    };\r\n    Builder.prototype.setUserAgent = function (userAgent) {\r\n        this.userAgent = userAgent || '';\r\n    };\r\n    /**\r\n     * Set a hook to modify events being tracked from builder, such as impressions and clicks\r\n     *\r\n     * For example, to track the model ID of each event associated with content for querying\r\n     * by mode, you can do\r\n     *\r\n     *    builder.setTrackingHook((event, context) => {\r\n     *      if (context.content) {\r\n     *        event.data.metadata.modelId = context.content.modelId\r\n     *      }\r\n     *    })\r\n     */\r\n    Builder.prototype.setTrackingHook = function (hook) {\r\n        this.trackingHooks.push(hook);\r\n    };\r\n    Builder.prototype.track = function (eventName, properties, context) {\r\n        if (properties === void 0) { properties = {}; }\r\n        // TODO: queue up track requests and fire them off when canTrack set to true - otherwise may get lots of clicks with no impressions\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        var apiKey = this.apiKey;\r\n        if (!apiKey) {\r\n            console.error('Builder integration error: Looks like the Builder SDK has not been initialized properly (your API key has not been set). Make sure you are calling `builder.init(\"YOUR-API-KEY\");` as early as possible in your application\\'s code.');\r\n            return;\r\n        }\r\n        var eventData = JSON.parse(JSON.stringify({\r\n            type: eventName,\r\n            data: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, omit(properties, 'meta')), { metadata: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ sdkVersion: Builder.VERSION, url: location.href }, properties.meta), properties.metadata), ownerId: apiKey, userAttributes: this.getUserAttributes(), sessionId: this.sessionId, visitorId: this.visitorId }),\r\n        }));\r\n        for (var _i = 0, _a = this.trackingHooks; _i < _a.length; _i++) {\r\n            var hook = _a[_i];\r\n            var returnValue = hook(eventData, context || {});\r\n            if (returnValue) {\r\n                eventData = returnValue;\r\n            }\r\n        }\r\n        // batch events\r\n        this.eventsQueue.push(eventData);\r\n        if (this.canTrack) {\r\n            this.throttledClearEventsQueue();\r\n        }\r\n    };\r\n    Builder.prototype.getSessionId = function () {\r\n        var _this = this;\r\n        var sessionId = null;\r\n        try {\r\n            if (Builder.isBrowser && typeof sessionStorage !== 'undefined') {\r\n                sessionId = this.getCookie(sessionStorageKey);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.debug('Session storage error', err);\r\n            // It's ok\r\n        }\r\n        if (!sessionId) {\r\n            sessionId = uuid();\r\n        }\r\n        // Give the app a second to start up and set canTrack to false if needed\r\n        if (Builder.isBrowser) {\r\n            setTimeout(function () {\r\n                try {\r\n                    if (_this.canTrack) {\r\n                        _this.setCookie(sessionStorageKey, sessionId, datePlusMinutes(30));\r\n                    }\r\n                }\r\n                catch (err) {\r\n                    console.debug('Cookie setting error', err);\r\n                }\r\n            });\r\n        }\r\n        return sessionId;\r\n    };\r\n    Builder.prototype.getVisitorId = function () {\r\n        var _this = this;\r\n        if (this.visitorId) {\r\n            return this.visitorId;\r\n        }\r\n        var visitorId = null;\r\n        try {\r\n            if (Builder.isBrowser && typeof localStorage !== 'undefined') {\r\n                // TODO: cookie instead?\r\n                visitorId = localStorage.getItem(localStorageKey);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.debug('Local storage error', err);\r\n            // It's ok\r\n        }\r\n        if (!visitorId) {\r\n            visitorId = uuid();\r\n        }\r\n        this.visitorId = visitorId;\r\n        // Give the app a second to start up and set canTrack to false if needed\r\n        if (Builder.isBrowser) {\r\n            setTimeout(function () {\r\n                try {\r\n                    if (_this.canTrack && typeof localStorage !== 'undefined' && visitorId) {\r\n                        localStorage.setItem(localStorageKey, visitorId);\r\n                    }\r\n                }\r\n                catch (err) {\r\n                    console.debug('Session storage error', err);\r\n                }\r\n            });\r\n        }\r\n        return visitorId;\r\n    };\r\n    Builder.prototype.trackImpression = function (contentId, variationId, properties, context) {\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        // TODO: use this.track method\r\n        this.track('impression', {\r\n            contentId: contentId,\r\n            variationId: variationId !== contentId ? variationId : undefined,\r\n            metadata: properties,\r\n        }, context);\r\n    };\r\n    Builder.prototype.trackConversion = function (amount, contentId, variationId, customProperties, context) {\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        var meta = typeof contentId === 'object' ? contentId : customProperties;\r\n        var useContentId = typeof contentId === 'string' ? contentId : undefined;\r\n        this.track('conversion', { amount: amount, variationId: variationId, meta: meta, contentId: useContentId }, context);\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"isDevelopmentEnv\", {\r\n        // TODO: set this for QA\r\n        get: function () {\r\n            // Automatic determining of development environment\r\n            return (Builder.isIframe ||\r\n                (Builder.isBrowser && (location.hostname === 'localhost' || location.port !== '')) ||\r\n                this.env !== 'production');\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.trackInteraction = function (contentId, variationId, alreadyTrackedOne, event, context) {\r\n        if (alreadyTrackedOne === void 0) { alreadyTrackedOne = false; }\r\n        if (isIframe || !isBrowser || Builder.isPreviewing) {\r\n            return;\r\n        }\r\n        var target = event && event.target;\r\n        var targetBuilderElement = target && this.findBuilderParent(target);\r\n        function round(num) {\r\n            return Math.round(num * 1000) / 1000;\r\n        }\r\n        var metadata = {};\r\n        if (event) {\r\n            var clientX = event.clientX, clientY = event.clientY;\r\n            if (target) {\r\n                var targetRect = target.getBoundingClientRect();\r\n                var xOffset = clientX - targetRect.left;\r\n                var yOffset = clientY - targetRect.top;\r\n                var xRatio = round(xOffset / targetRect.width);\r\n                var yRatio = round(yOffset / targetRect.height);\r\n                metadata.targetOffset = {\r\n                    x: xRatio,\r\n                    y: yRatio,\r\n                };\r\n            }\r\n            if (targetBuilderElement) {\r\n                var targetRect = targetBuilderElement.getBoundingClientRect();\r\n                var xOffset = clientX - targetRect.left;\r\n                var yOffset = clientY - targetRect.top;\r\n                var xRatio = round(xOffset / targetRect.width);\r\n                var yRatio = round(yOffset / targetRect.height);\r\n                metadata.builderTargetOffset = {\r\n                    x: xRatio,\r\n                    y: yRatio,\r\n                };\r\n            }\r\n        }\r\n        var builderId = targetBuilderElement &&\r\n            (targetBuilderElement.getAttribute('builder-id') || targetBuilderElement.id);\r\n        if (builderId && targetBuilderElement) {\r\n            metadata.builderElementIndex = [].slice\r\n                .call(document.getElementsByClassName(builderId))\r\n                .indexOf(targetBuilderElement);\r\n        }\r\n        this.track('click', {\r\n            contentId: contentId,\r\n            metadata: metadata,\r\n            variationId: variationId !== contentId ? variationId : undefined,\r\n            unique: !alreadyTrackedOne,\r\n            targetBuilderElement: builderId || undefined,\r\n        }, context);\r\n    };\r\n    Builder.prototype.component = function (info) {\r\n        if (info === void 0) { info = {}; }\r\n        return Builder.component(info);\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"apiKey\", {\r\n        get: function () {\r\n            return this.apiKey$.value;\r\n        },\r\n        set: function (key) {\r\n            this.apiKey$.next(key);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Builder.prototype, \"authToken\", {\r\n        get: function () {\r\n            return this.authToken$.value;\r\n        },\r\n        set: function (token) {\r\n            this.authToken$.next(token);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.modifySearch = function (search) {\r\n        return search.replace(/(^|&|\\?)(builder_.*?)=/gi, function (_match, group1, group2) { return group1 + group2.replace(/_/g, '.') + '='; });\r\n    };\r\n    Builder.prototype.setTestsFromUrl = function () {\r\n        var search = this.getLocation().search;\r\n        var params = QueryString.parseDeep(this.modifySearch(search || '').substr(1));\r\n        var tests = params.builder && params.builder.tests;\r\n        if (tests && typeof tests === 'object') {\r\n            for (var key in tests) {\r\n                if (tests.hasOwnProperty(key)) {\r\n                    this.setTestCookie(key, tests[key]);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Builder.prototype.resetOverrides = function () {\r\n        // Ugly - pass down instances per request instead using react context\r\n        // or use builder.get('foo', { req, res }) in react...........\r\n        Builder.overrideUserAttributes = {};\r\n        this.cachebust = false;\r\n        this.noCache = false;\r\n        this.preview = false;\r\n        this.editingModel = null;\r\n        this.overrides = {};\r\n        this.env = 'production';\r\n        this.userAgent = '';\r\n        this.request = undefined;\r\n        this.response = undefined;\r\n    };\r\n    Builder.prototype.getOverridesFromQueryString = function () {\r\n        var location = this.getLocation();\r\n        var params = QueryString.parseDeep(this.modifySearch(location.search || '').substr(1));\r\n        var builder = params.builder;\r\n        if (builder) {\r\n            var userAttributes = builder.userAttributes, overrides = builder.overrides, env = builder.env; builder.host; var api = builder.api, cachebust = builder.cachebust, noCache = builder.noCache, preview = builder.preview, editing = builder.editing, frameEditing = builder.frameEditing, options = builder.options, overrideParams = builder.params;\r\n            if (userAttributes) {\r\n                this.setUserAttributes(userAttributes);\r\n            }\r\n            if (options) {\r\n                // picking only locale, includeRefs, and enrich for now\r\n                this.queryOptions = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, (options.locale && { locale: options.locale })), (options.includeRefs && { includeRefs: options.includeRefs })), (options.enrich && { enrich: options.enrich }));\r\n            }\r\n            if (overrides) {\r\n                this.overrides = overrides;\r\n            }\r\n            if (validEnvList.indexOf(env || api) > -1) {\r\n                this.env = env || api;\r\n            }\r\n            if (Builder.isEditing) {\r\n                var editingModel = frameEditing || editing || preview;\r\n                if (editingModel && editingModel !== 'true') {\r\n                    this.editingModel = editingModel;\r\n                }\r\n            }\r\n            if (cachebust) {\r\n                this.cachebust = true;\r\n            }\r\n            if (noCache) {\r\n                this.noCache = true;\r\n            }\r\n            if (preview) {\r\n                this.preview = true;\r\n            }\r\n            if (params) {\r\n                this.overrideParams = overrideParams;\r\n            }\r\n        }\r\n    };\r\n    Builder.prototype.messageFrameLoaded = function () {\r\n        var _a;\r\n        (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n            type: 'builder.loaded',\r\n            data: {\r\n                value: true,\r\n            },\r\n        }, '*');\r\n    };\r\n    Builder.prototype.bindMessageListeners = function () {\r\n        var _this = this;\r\n        if (isBrowser) {\r\n            addEventListener('message', function (event) {\r\n                var _a, _b, _c, _d, _e;\r\n                var url = parse(event.origin);\r\n                var isRestricted = ['builder.register', 'builder.registerComponent'].indexOf((_a = event.data) === null || _a === void 0 ? void 0 : _a.type) === -1;\r\n                var isTrusted = url.hostname && Builder.isTrustedHost(url.hostname);\r\n                if (isRestricted && !isTrusted) {\r\n                    return;\r\n                }\r\n                var data = event.data;\r\n                if (data) {\r\n                    switch (data.type) {\r\n                        case 'builder.ping': {\r\n                            (_b = window.parent) === null || _b === void 0 ? void 0 : _b.postMessage({\r\n                                type: 'builder.pong',\r\n                                data: {},\r\n                            }, '*');\r\n                            break;\r\n                        }\r\n                        case 'builder.register': {\r\n                            // TODO: possibly do this for all...\r\n                            if (event.source === window) {\r\n                                break;\r\n                            }\r\n                            var options = data.data;\r\n                            if (!options) {\r\n                                break;\r\n                            }\r\n                            var type = options.type, info = options.info;\r\n                            // TODO: all must have name and can't conflict?\r\n                            var typeList = Builder.registry[type];\r\n                            if (!typeList) {\r\n                                typeList = Builder.registry[type] = [];\r\n                            }\r\n                            typeList.push(info);\r\n                            Builder.registryChange.next(Builder.registry);\r\n                            break;\r\n                        }\r\n                        case 'builder.settingsChange': {\r\n                            // TODO: possibly do this for all...\r\n                            if (event.source === window) {\r\n                                break;\r\n                            }\r\n                            var settings = data.data;\r\n                            if (!settings) {\r\n                                break;\r\n                            }\r\n                            Object.assign(Builder.settings, settings);\r\n                            Builder.settingsChange.next(Builder.settings);\r\n                            break;\r\n                        }\r\n                        case 'builder.registerEditor': {\r\n                            // TODO: possibly do this for all...\r\n                            if (event.source === window) {\r\n                                break;\r\n                            }\r\n                            var info_1 = data.data;\r\n                            if (!info_1) {\r\n                                break;\r\n                            }\r\n                            var hasComponent_1 = !!info_1.component;\r\n                            Builder.editors.every(function (thisInfo, index) {\r\n                                if (info_1.name === thisInfo.name) {\r\n                                    if (thisInfo.component && !hasComponent_1) {\r\n                                        return false;\r\n                                    }\r\n                                    else {\r\n                                        Builder.editors[index] = thisInfo;\r\n                                    }\r\n                                    return false;\r\n                                }\r\n                                return true;\r\n                            });\r\n                            break;\r\n                        }\r\n                        case 'builder.triggerAnimation': {\r\n                            Builder.animator.triggerAnimation(data.data);\r\n                            break;\r\n                        }\r\n                        case 'builder.contentUpdate':\r\n                            var key = data.data.key || data.data.alias || data.data.entry || data.data.modelName;\r\n                            var contentData = data.data.data; // hmmm...\r\n                            var observer = _this.observersByKey[key];\r\n                            if (observer && !_this.noEditorUpdates[key]) {\r\n                                observer.next([contentData]);\r\n                            }\r\n                            break;\r\n                        case 'builder.getComponents':\r\n                            (_c = window.parent) === null || _c === void 0 ? void 0 : _c.postMessage({\r\n                                type: 'builder.components',\r\n                                data: Builder.components.map(function (item) { return Builder.prepareComponentSpecToSend(item); }),\r\n                            }, '*');\r\n                            break;\r\n                        case 'builder.editingModel':\r\n                            _this.editingModel = data.data.model;\r\n                            break;\r\n                        case 'builder.registerComponent':\r\n                            var componentData = data.data;\r\n                            Builder.addComponent(componentData);\r\n                            break;\r\n                        case 'builder.blockContentLoading':\r\n                            if (typeof data.data.model === 'string') {\r\n                                _this.blockContentLoading = data.data.model;\r\n                            }\r\n                            break;\r\n                        case 'builder.editingMode':\r\n                            var editingMode = data.data;\r\n                            if (editingMode) {\r\n                                _this.editingMode = true;\r\n                                document.body.classList.add('builder-editing');\r\n                            }\r\n                            else {\r\n                                _this.editingMode = false;\r\n                                document.body.classList.remove('builder-editing');\r\n                            }\r\n                            break;\r\n                        case 'builder.editingPageMode':\r\n                            var editingPageMode = data.data;\r\n                            Builder.editingPage = editingPageMode;\r\n                            break;\r\n                        case 'builder.overrideUserAttributes':\r\n                            var userAttributes = data.data;\r\n                            assign(Builder.overrideUserAttributes, userAttributes);\r\n                            _this.flushGetContentQueue(true);\r\n                            // TODO: refetch too\r\n                            break;\r\n                        case 'builder.overrideTestGroup':\r\n                            var _f = data.data, variationId = _f.variationId, contentId = _f.contentId;\r\n                            if (variationId && contentId) {\r\n                                _this.setTestCookie(contentId, variationId);\r\n                                _this.flushGetContentQueue(true);\r\n                            }\r\n                            break;\r\n                        case 'builder.evaluate': {\r\n                            var text = data.data.text;\r\n                            var args = data.data.arguments || [];\r\n                            var id_1 = data.data.id;\r\n                            // tslint:disable-next-line:no-function-constructor-with-string-args\r\n                            var fn = new Function(text);\r\n                            var result = void 0;\r\n                            var error = null;\r\n                            try {\r\n                                result = fn.apply(_this, args);\r\n                            }\r\n                            catch (err) {\r\n                                error = toError(err);\r\n                            }\r\n                            if (error) {\r\n                                (_d = window.parent) === null || _d === void 0 ? void 0 : _d.postMessage({\r\n                                    type: 'builder.evaluateError',\r\n                                    data: { id: id_1, error: error.message },\r\n                                }, '*');\r\n                            }\r\n                            else {\r\n                                if (result && typeof result.then === 'function') {\r\n                                    result\r\n                                        .then(function (finalResult) {\r\n                                        var _a;\r\n                                        (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({\r\n                                            type: 'builder.evaluateResult',\r\n                                            data: { id: id_1, result: finalResult },\r\n                                        }, '*');\r\n                                    })\r\n                                        .catch(console.error);\r\n                                }\r\n                                else {\r\n                                    (_e = window.parent) === null || _e === void 0 ? void 0 : _e.postMessage({\r\n                                        type: 'builder.evaluateResult',\r\n                                        data: { result: result, id: id_1 },\r\n                                    }, '*');\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"defaultCanTrack\", {\r\n        get: function () {\r\n            return Boolean(Builder.isBrowser &&\r\n                navigator.userAgent.trim() &&\r\n                !navigator.userAgent.match(/bot|crawler|spider|robot|crawling|prerender|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex|phantom|headless|selenium|puppeteer/i) &&\r\n                !this.browserTrackingDisabled);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.init = function (apiKey, canTrack, req, res, authToken, apiVersion) {\r\n        if (canTrack === void 0) { canTrack = this.defaultCanTrack; }\r\n        if (req) {\r\n            this.request = req;\r\n        }\r\n        if (res) {\r\n            this.response = res;\r\n        }\r\n        this.canTrack = canTrack;\r\n        this.apiKey = apiKey;\r\n        if (authToken) {\r\n            this.authToken = authToken;\r\n        }\r\n        if (apiVersion) {\r\n            this.apiVersion = apiVersion;\r\n        }\r\n        return this;\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"previewingModel\", {\r\n        get: function () {\r\n            var search = this.getLocation().search;\r\n            var params = QueryString.parse((search || '').substr(1));\r\n            return params['builder.preview'];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    // TODO: allow adding location object as property and/or in constructor\r\n    Builder.prototype.getLocation = function () {\r\n        var _a;\r\n        var parsedLocation = {};\r\n        // in ssr mode\r\n        if (this.request) {\r\n            parsedLocation = parse((_a = this.request.url) !== null && _a !== void 0 ? _a : '');\r\n        }\r\n        else if (typeof location === 'object') {\r\n            // in the browser\r\n            parsedLocation = parse(location.href);\r\n        }\r\n        // IE11 bug with parsed path being empty string\r\n        // causes issues with our user targeting\r\n        if (parsedLocation.pathname === '') {\r\n            parsedLocation.pathname = '/';\r\n        }\r\n        return parsedLocation;\r\n    };\r\n    Builder.prototype.getUserAttributes = function (userAgent) {\r\n        if (userAgent === void 0) { userAgent = this.userAgent || ''; }\r\n        var isMobile = {\r\n            Android: function () {\r\n                return userAgent.match(/Android/i);\r\n            },\r\n            BlackBerry: function () {\r\n                return userAgent.match(/BlackBerry/i);\r\n            },\r\n            iOS: function () {\r\n                return userAgent.match(/iPhone|iPod/i);\r\n            },\r\n            Opera: function () {\r\n                return userAgent.match(/Opera Mini/i);\r\n            },\r\n            Windows: function () {\r\n                return userAgent.match(/IEMobile/i) || userAgent.match(/WPDesktop/i);\r\n            },\r\n            any: function () {\r\n                return (isMobile.Android() ||\r\n                    isMobile.BlackBerry() ||\r\n                    isMobile.iOS() ||\r\n                    isMobile.Opera() ||\r\n                    isMobile.Windows());\r\n            },\r\n        };\r\n        var isTablet = userAgent.match(/Tablet|iPad/i);\r\n        var url = this.getLocation();\r\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ urlPath: url.pathname, host: url.host || url.hostname, \r\n            // TODO: maybe an option to choose to target off of mobile/tablet/desktop or just mobile/desktop\r\n            device: isTablet ? 'tablet' : isMobile.any() ? 'mobile' : 'desktop' }, Builder.overrideUserAttributes);\r\n    };\r\n    Builder.prototype.setUserAttributes = function (options) {\r\n        assign(Builder.overrideUserAttributes, options);\r\n        this.userAttributesChanged.next(options);\r\n    };\r\n    /**\r\n     * Set user attributes just for tracking purposes.\r\n     *\r\n     * Do this so properties exist on event objects for querying insights, but\r\n     * won't affect targeting\r\n     *\r\n     * Use this when you want to track properties but don't need to target off\r\n     * of them to optimize cache efficiency\r\n     */\r\n    Builder.prototype.setTrackingUserAttributes = function (attributes) {\r\n        assign(this.trackingUserAttributes, attributes);\r\n    };\r\n    Builder.prototype.get = function (modelName, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var instance = this;\r\n        if (!Builder.isBrowser) {\r\n            instance = new Builder(options.apiKey || this.apiKey, options.req, options.res, undefined, options.authToken || this.authToken, options.apiVersion || this.apiVersion);\r\n            instance.setUserAttributes(this.getUserAttributes());\r\n        }\r\n        else {\r\n            // NOTE: All these are when .init is not called and the customer\r\n            // directly calls .get on the singleton instance of Builder\r\n            if (options.apiKey && !this.apiKey) {\r\n                this.apiKey = options.apiKey;\r\n            }\r\n            if (options.authToken && !this.authToken) {\r\n                this.authToken = options.authToken;\r\n            }\r\n            if (options.apiVersion && !this.apiVersion) {\r\n                this.apiVersion = options.apiVersion;\r\n            }\r\n        }\r\n        return instance.queueGetContent(modelName, options).map(\r\n        /* map( */ function (matches) {\r\n            var match = matches && matches[0];\r\n            if (Builder.isStatic) {\r\n                return match;\r\n            }\r\n            var matchData = match && match.data;\r\n            if (!matchData) {\r\n                return null;\r\n            }\r\n            if (typeof matchData.blocksString !== 'undefined') {\r\n                matchData.blocks = JSON.parse(matchData.blocksString);\r\n                delete matchData.blocksString;\r\n            }\r\n            return {\r\n                // TODO: add ab test info here and other high level stuff\r\n                data: matchData,\r\n                id: match.id,\r\n                variationId: match.testVariationId || match.variationId || null,\r\n                testVariationId: match.testVariationId || match.variationId || null,\r\n                testVariationName: match.testVariationName || null,\r\n                lastUpdated: match.lastUpdated || null,\r\n            };\r\n        });\r\n        // );\r\n    };\r\n    // TODO: entry id in options\r\n    Builder.prototype.queueGetContent = function (modelName, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        // TODO: if query do modelName + query\r\n        var key = options.key ||\r\n            options.alias ||\r\n            // TODO: SDKs only pass entry key when given to them, and never when editing...\r\n            // options.entry ||\r\n            // TODO: this is ugly - instead of multiple of same model with different options are sent\r\n            // say requires key/alias. Or if not perhaps make a reliable hash of the options and use that.\r\n            // TODO: store last user state on last request and if user attributes different now\r\n            // give a warning that need to use keys to request new contente\r\n            // (options &&\r\n            //   Object.keys(options).filter(key => key !== 'model').length &&\r\n            //   JSON.stringify({ model: modelName, ...options, initialContent: undefined })) ||\r\n            modelName;\r\n        var isEditingThisModel = this.editingModel === modelName;\r\n        // TODO: include params in this key........\r\n        var currentObservable = this.observersByKey[key];\r\n        // if (options.query && options.query._id) {\r\n        //   this.flushGetContentQueue([options])\r\n        // }\r\n        if (this.apiKey === 'DEMO' && !this.overrides[key] && !options.initialContent) {\r\n            options.initialContent = [];\r\n        }\r\n        var initialContent = options.initialContent;\r\n        // TODO: refresh option in options\r\n        if (currentObservable && (!currentObservable.value || options.cache)) {\r\n            // TODO: test if this ran, otherwise on 404 some observers may never be called...\r\n            if (currentObservable.value) {\r\n                nextTick(function () {\r\n                    // TODO: return a new observable and only that one fires subscribers, don't refire for existing ones\r\n                    currentObservable.next(currentObservable.value);\r\n                });\r\n            }\r\n            return currentObservable;\r\n        }\r\n        if (isEditingThisModel) {\r\n            if (Builder.isBrowser) {\r\n                parent.postMessage({ type: 'builder.updateContent', data: { options: options } }, '*');\r\n            }\r\n        }\r\n        if (!initialContent /* || isEditingThisModel */) {\r\n            if (!this.getContentQueue) {\r\n                this.getContentQueue = [];\r\n            }\r\n            this.getContentQueue.push((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, options), { model: modelName, key: key }));\r\n            if (this.getContentQueue && this.getContentQueue.length >= this.contentPerRequest) {\r\n                var queue_1 = this.getContentQueue.slice();\r\n                this.getContentQueue = [];\r\n                nextTick(function () {\r\n                    _this.flushGetContentQueue(false, queue_1);\r\n                });\r\n            }\r\n            else {\r\n                nextTick(function () {\r\n                    _this.flushGetContentQueue();\r\n                });\r\n            }\r\n        }\r\n        var observable = new BehaviorSubject(null);\r\n        this.observersByKey[key] = observable;\r\n        if (options.noEditorUpdates) {\r\n            this.noEditorUpdates[key] = true;\r\n        }\r\n        if (initialContent) {\r\n            nextTick(function () {\r\n                // TODO: need to testModify this I think...?\r\n                observable.next(initialContent);\r\n            });\r\n        }\r\n        return observable;\r\n    };\r\n    // this is needed to satisfy the Angular SDK, which used to rely on the more complex version of `requestUrl`.\r\n    // even though we only use `fetch()` now, we prefer to keep the old behavior and use the `fetch` that comes from\r\n    // the core SDK for consistency\r\n    Builder.prototype.requestUrl = function (url, options) {\r\n        return getFetch()(url, (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ next: (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ revalidate: 1 }, options === null || options === void 0 ? void 0 : options.next) }, options)).then(function (res) { return res.json(); });\r\n    };\r\n    Object.defineProperty(Builder.prototype, \"host\", {\r\n        get: function () {\r\n            switch (this.env) {\r\n                case 'qa':\r\n                    return 'https://qa.builder.io';\r\n                case 'test':\r\n                    return 'https://builder-io-test.web.app';\r\n                case 'fast':\r\n                    return 'https://fast.builder.io';\r\n                case 'cloud':\r\n                    return 'https://cloud.builder.io';\r\n                case 'cdn2':\r\n                    return 'https://cdn2.builder.io';\r\n                case 'cdn-qa':\r\n                    return 'https://cdn-qa.builder.io';\r\n                case 'development':\r\n                case 'dev':\r\n                    return 'http://localhost:5000';\r\n                case 'cdn-prod':\r\n                    return 'https://cdn.builder.io';\r\n                default:\r\n                    return Builder.overrideHost || 'https://cdn.builder.io';\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Builder.prototype.flushGetContentQueue = function (usePastQueue, useQueue) {\r\n        var _this = this;\r\n        if (usePastQueue === void 0) { usePastQueue = false; }\r\n        if (!this.apiKey) {\r\n            throw new Error(\"Fetching content failed, expected apiKey to be defined instead got: \".concat(this.apiKey));\r\n        }\r\n        if (this.apiVersion) {\r\n            if (!['v1', 'v3'].includes(this.apiVersion)) {\r\n                throw new Error(\"Invalid apiVersion: expected 'v1' or 'v3', received '\".concat(this.apiVersion, \"'\"));\r\n            }\r\n        }\r\n        else {\r\n            this.apiVersion = DEFAULT_API_VERSION;\r\n        }\r\n        if (!usePastQueue && !this.getContentQueue) {\r\n            return;\r\n        }\r\n        var queue = useQueue || (usePastQueue ? this.priorContentQueue : this.getContentQueue) || [];\r\n        // TODO: do this on every request send?\r\n        this.getOverridesFromQueryString();\r\n        var queryParams = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ \r\n            // TODO: way to force a request to be in a separate queue. or just lower queue limit to be 1 by default\r\n            omit: queue[0].omit || 'meta.componentsUsed', apiKey: this.apiKey }, queue[0].options), this.queryOptions);\r\n        if (queue[0].locale) {\r\n            queryParams.locale = queue[0].locale;\r\n        }\r\n        if (queue[0].fields) {\r\n            queryParams.fields = queue[0].fields;\r\n        }\r\n        if (queue[0].format) {\r\n            queryParams.format = queue[0].format;\r\n        }\r\n        if ('noTraverse' in queue[0]) {\r\n            queryParams.noTraverse = queue[0].noTraverse;\r\n        }\r\n        if ('includeUnpublished' in queue[0]) {\r\n            queryParams.includeUnpublished = queue[0].includeUnpublished;\r\n        }\r\n        if (queue[0].sort) {\r\n            queryParams.sort = queue[0].sort;\r\n        }\r\n        var pageQueryParams = typeof location !== 'undefined'\r\n            ? QueryString.parseDeep(location.search.substr(1))\r\n            : {}; // TODO: WHAT about SSR (this.request) ?\r\n        var userAttributes = \r\n        // FIXME: HACK: only checks first in queue for user attributes overrides, should check all\r\n        // TODO: merge user attributes provided here with defaults and current user attiributes (?)\r\n        queue && queue[0].userAttributes\r\n            ? queue[0].userAttributes\r\n            : this.targetContent\r\n                ? this.getUserAttributes()\r\n                : {\r\n                    urlPath: this.getLocation().pathname,\r\n                };\r\n        var fullUrlQueueItem = queue.find(function (item) { return !!item.includeUrl; });\r\n        if (fullUrlQueueItem) {\r\n            var location_1 = this.getLocation();\r\n            if (location_1.origin) {\r\n                queryParams.url = \"\".concat(location_1.origin).concat(location_1.pathname).concat(location_1.search);\r\n            }\r\n        }\r\n        var urlQueueItem = useQueue === null || useQueue === void 0 ? void 0 : useQueue.find(function (item) { return item.url; });\r\n        if (urlQueueItem === null || urlQueueItem === void 0 ? void 0 : urlQueueItem.url) {\r\n            userAttributes.urlPath = urlQueueItem.url.split('?')[0];\r\n        }\r\n        // TODO: merge in the attribute from query string ones\r\n        // TODO: make this an option per component/request\r\n        queryParams.userAttributes = userAttributes;\r\n        if (!usePastQueue && !useQueue) {\r\n            this.priorContentQueue = queue;\r\n            this.getContentQueue = null;\r\n        }\r\n        var cachebust = this.cachebust ||\r\n            isIframe ||\r\n            pageQueryParams.cachebust ||\r\n            pageQueryParams['builder.cachebust'];\r\n        if (cachebust || this.env !== 'production') {\r\n            queryParams.cachebust = true;\r\n        }\r\n        if (Builder.isEditing) {\r\n            queryParams.isEditing = true;\r\n        }\r\n        if (this.noCache || this.env !== 'production') {\r\n            queryParams.noCache = true;\r\n        }\r\n        if (size(this.overrides)) {\r\n            for (var key in this.overrides) {\r\n                if (this.overrides.hasOwnProperty(key)) {\r\n                    queryParams[\"overrides.\".concat(key)] = this.overrides[key];\r\n                }\r\n            }\r\n        }\r\n        for (var _i = 0, queue_2 = queue; _i < queue_2.length; _i++) {\r\n            var options = queue_2[_i];\r\n            if (options.format) {\r\n                queryParams.format = options.format;\r\n            }\r\n            // TODO: remove me and make permodel\r\n            if (options.static) {\r\n                queryParams.static = options.static;\r\n            }\r\n            if (options.cachebust) {\r\n                queryParams.cachebust = options.cachebust;\r\n            }\r\n            if (isPositiveNumber(options.cacheSeconds)) {\r\n                queryParams.cacheSeconds = options.cacheSeconds;\r\n            }\r\n            if (isPositiveNumber(options.staleCacheSeconds)) {\r\n                queryParams.staleCacheSeconds = options.staleCacheSeconds;\r\n            }\r\n            var properties = [\r\n                'prerender',\r\n                'extractCss',\r\n                'limit',\r\n                'offset',\r\n                'query',\r\n                'preview',\r\n                'model',\r\n                'entry',\r\n                'rev',\r\n                'static',\r\n            ];\r\n            for (var _a = 0, properties_1 = properties; _a < properties_1.length; _a++) {\r\n                var key = properties_1[_a];\r\n                var value = options[key];\r\n                if (value !== undefined) {\r\n                    queryParams.options = queryParams.options || {};\r\n                    queryParams.options[options.key] = queryParams.options[options.key] || {};\r\n                    queryParams.options[options.key][key] = JSON.stringify(value);\r\n                }\r\n            }\r\n        }\r\n        if (this.preview) {\r\n            queryParams.preview = 'true';\r\n        }\r\n        var hasParams = Object.keys(queryParams).length > 0;\r\n        // TODO: option to force dev or qa api here\r\n        var host = this.host;\r\n        var keyNames = queue.map(function (item) { return encodeURIComponent(item.key); }).join(',');\r\n        if (this.overrideParams) {\r\n            var params = omit(QueryString.parse(this.overrideParams), 'apiKey');\r\n            assign(queryParams, params);\r\n        }\r\n        var queryStr = QueryString.stringifyDeep(queryParams);\r\n        var format = queryParams.format;\r\n        var requestOptions = { headers: {}, next: { revalidate: 1 } };\r\n        if (this.authToken) {\r\n            requestOptions.headers = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, requestOptions.headers), { Authorization: \"Bearer \".concat(this.authToken) });\r\n        }\r\n        var fn = format === 'solid' || format === 'react' ? 'codegen' : 'query';\r\n        // NOTE: this is a hack to get around the fact that the codegen endpoint is not yet available in v3\r\n        var apiVersionBasedOnFn = fn === 'query' ? this.apiVersion : 'v1';\r\n        var url = \"\".concat(host, \"/api/\").concat(apiVersionBasedOnFn, \"/\").concat(fn, \"/\").concat(this.apiKey, \"/\").concat(keyNames) +\r\n            (queryParams && hasParams ? \"?\".concat(queryStr) : '');\r\n        var promise = getFetch()(url, requestOptions)\r\n            .then(function (res) { return res.json(); })\r\n            .then(function (result) {\r\n            for (var _i = 0, queue_3 = queue; _i < queue_3.length; _i++) {\r\n                var options = queue_3[_i];\r\n                var keyName = options.key;\r\n                if (options.model === _this.blockContentLoading && !options.noEditorUpdates) {\r\n                    continue;\r\n                }\r\n                var isEditingThisModel = _this.editingModel === options.model;\r\n                if (isEditingThisModel && Builder.isEditing) {\r\n                    parent.postMessage({ type: 'builder.updateContent', data: { options: options } }, '*');\r\n                    // return;\r\n                }\r\n                var observer = _this.observersByKey[keyName];\r\n                if (!observer) {\r\n                    return;\r\n                }\r\n                var data = result[keyName];\r\n                var sorted = data; // sortBy(data, item => item.priority);\r\n                if (data) {\r\n                    var testModifiedResults = Builder.isServer\r\n                        ? sorted\r\n                        : _this.processResultsForTests(sorted);\r\n                    observer.next(testModifiedResults);\r\n                }\r\n                else {\r\n                    var search = _this.getLocation().search;\r\n                    if ((search || '').includes('builder.preview=' + options.model)) {\r\n                        var previewData = {\r\n                            id: 'preview',\r\n                            name: 'Preview',\r\n                            data: {},\r\n                        };\r\n                        observer.next([previewData]);\r\n                    }\r\n                    observer.next([]);\r\n                }\r\n            }\r\n        }, function (err) {\r\n            for (var _i = 0, queue_4 = queue; _i < queue_4.length; _i++) {\r\n                var options = queue_4[_i];\r\n                var observer = _this.observersByKey[options.key];\r\n                if (!observer) {\r\n                    return;\r\n                }\r\n                observer.error(err);\r\n            }\r\n        });\r\n        return promise;\r\n    };\r\n    Builder.prototype.processResultsForTests = function (results) {\r\n        var _this = this;\r\n        var _a;\r\n        var mappedResults = results.map(function (item) {\r\n            if (!item.variations) {\r\n                return item;\r\n            }\r\n            var cookieValue = _this.getTestCookie(item.id);\r\n            var cookieVariation = cookieValue === item.id ? item : item.variations[cookieValue];\r\n            if (cookieVariation) {\r\n                return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, item), { data: cookieVariation.data, variationId: cookieValue, testVariationId: cookieValue, testVariationName: cookieVariation.name });\r\n            }\r\n            if (_this.canTrack && item.variations && size(item.variations)) {\r\n                var n = 0;\r\n                var random = Math.random();\r\n                for (var id in item.variations) {\r\n                    var variation = item.variations[id];\r\n                    var testRatio = variation.testRatio;\r\n                    n += testRatio;\r\n                    if (random < n) {\r\n                        _this.setTestCookie(item.id, variation.id);\r\n                        var variationName = variation.name || (variation.id === item.id ? 'Default variation' : '');\r\n                        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, item), { data: variation.data, variationId: variation.id, testVariationId: variation.id, variationName: variationName, testVariationName: variationName });\r\n                    }\r\n                }\r\n                _this.setTestCookie(item.id, item.id);\r\n            }\r\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, item), { variationId: item.id }), (item.variations &&\r\n                size(item.variations) && {\r\n                testVariationId: item.id,\r\n                testVariationName: 'Default variation',\r\n            }));\r\n        });\r\n        if (isIframe) {\r\n            (_a = window.parent) === null || _a === void 0 ? void 0 : _a.postMessage({ type: 'builder.contentResults', data: { results: mappedResults } }, '*');\r\n        }\r\n        return mappedResults;\r\n    };\r\n    Builder.prototype.getTestCookie = function (contentId) {\r\n        return this.getCookie(\"\".concat(this.testCookiePrefix, \".\").concat(contentId));\r\n    };\r\n    Builder.prototype.setTestCookie = function (contentId, variationId) {\r\n        if (!this.canTrack) {\r\n            this.cookieQueue.push([contentId, variationId]);\r\n            return;\r\n        }\r\n        // 30 days from now\r\n        var future = new Date();\r\n        future.setDate(future.getDate() + 30);\r\n        return this.setCookie(\"\".concat(this.testCookiePrefix, \".\").concat(contentId), variationId, future);\r\n    };\r\n    Builder.prototype.getCookie = function (name) {\r\n        if (this.cookies) {\r\n            return this.cookies.get(name);\r\n        }\r\n        return Builder.isBrowser && getCookie(name);\r\n    };\r\n    Builder.prototype.setCookie = function (name, value, expires) {\r\n        if (this.cookies && !(Builder.isServer && Builder.isStatic)) {\r\n            return this.cookies.set(name, value, {\r\n                expires: expires,\r\n                secure: this.getLocation().protocol === 'https:',\r\n            });\r\n        }\r\n        return Builder.isBrowser && setCookie(name, value, expires);\r\n    };\r\n    Builder.prototype.getContent = function (modelName, options) {\r\n        if (options === void 0) { options = {}; }\r\n        if (!this.apiKey) {\r\n            throw new Error(\"Fetching content from model \".concat(modelName, \" failed, expected apiKey to be defined instead got: \").concat(this.apiKey));\r\n        }\r\n        return this.queueGetContent(modelName, options);\r\n    };\r\n    Builder.prototype.getAll = function (modelName, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var instance = this;\r\n        if (!Builder.isBrowser) {\r\n            instance = new Builder(options.apiKey || this.apiKey, options.req, options.res, false, options.authToken || this.authToken, options.apiVersion || this.apiVersion);\r\n            instance.setUserAttributes(this.getUserAttributes());\r\n        }\r\n        else {\r\n            // NOTE: All these are when .init is not called and the customer\r\n            // directly calls .get on the singleton instance of Builder\r\n            if (options.apiKey && !this.apiKey) {\r\n                this.apiKey = options.apiKey;\r\n            }\r\n            if (options.authToken && !this.authToken) {\r\n                this.authToken = options.authToken;\r\n            }\r\n            if (options.apiVersion && !this.apiVersion) {\r\n                this.apiVersion = options.apiVersion;\r\n            }\r\n        }\r\n        // Set noTraverse=true if NOT already passed by user, for query performance\r\n        if (!('noTraverse' in options)) {\r\n            options.noTraverse = true;\r\n        }\r\n        return instance\r\n            .getContent(modelName, (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ limit: 30 }, options), { key: options.key ||\r\n                // Make the key include all options, so we don't reuse cache for the same content fetched\r\n                // with different options\r\n                Builder.isBrowser\r\n                ? \"\".concat(modelName, \":\").concat(hash_sum__WEBPACK_IMPORTED_MODULE_0___default()(omit(options, 'initialContent', 'req', 'res')))\r\n                : undefined }))\r\n            .promise();\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @deprecated. This is buggy, and always behind by a version.\r\n     */\r\n    Builder.VERSION = version;\r\n    Builder.components = [];\r\n    /**\r\n     * Makes it so that a/b tests generate code like {@link\r\n     * https://www.builder.io/blog/high-performance-no-code#__next:~:text=Static%20generated%20A%2FB%20testing}\r\n     * instead of the old way where we render only one test group at a time on the\r\n     * server. This is the preferred/better way not and we should ultimately make it\r\n     * the default\r\n     */\r\n    Builder.isStatic = true;\r\n    Builder.animator = new Animator();\r\n    Builder.nextTick = nextTick;\r\n    Builder.throttle = throttle;\r\n    Builder.editors = [];\r\n    Builder.trustedHosts = [\r\n        '*.beta.builder.io',\r\n        'beta.builder.io',\r\n        'builder.io',\r\n        'localhost',\r\n        'qa.builder.io',\r\n    ];\r\n    Builder.plugins = [];\r\n    Builder.actions = [];\r\n    Builder.registry = {};\r\n    Builder.registryChange = new BehaviorSubject({});\r\n    Builder._editingPage = false;\r\n    Builder.isIframe = isIframe;\r\n    Builder.isBrowser = isBrowser;\r\n    Builder.isReactNative = isReactNative;\r\n    Builder.isServer = !isBrowser && !isReactNative;\r\n    Builder.previewingModel = Builder.isBrowser && getQueryParam(location.href, 'builder.preview');\r\n    Builder.settings = {};\r\n    Builder.settingsChange = new BehaviorSubject({});\r\n    // TODO: this is quick and dirty, do better implementation later. Also can be unreliable\r\n    // if page 301s etc. Use a query param instead? also could have issues with redirects. Injecting var could\r\n    // work but is async...\r\n    Builder.isEditing = Boolean(isIframe &&\r\n        ((document.referrer && document.referrer.match(/builder\\.io|localhost:1234/)) ||\r\n            location.search.indexOf('builder.frameEditing=') !== -1));\r\n    Builder.isPreviewing = Boolean(isBrowser &&\r\n        (location.search.indexOf('builder.preview=') !== -1 ||\r\n            location.search.indexOf('builder.frameEditing=') !== -1));\r\n    Builder.isReact = false;\r\n    Builder.overrideUserAttributes = {};\r\n    return Builder;\r\n}());\n\nvar builder = new Builder(null, undefined, undefined, true);\r\nBuilder.singletonInstance = builder;\n\n\n//# sourceMappingURL=index.esm.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGJ1aWxkZXIuaW8vc2RrL2Rpc3QvaW5kZXguZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFpQztBQUNMOztBQUU1QjtBQUNBOztBQUVBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxjQUFjO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxxQkFBcUI7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsMkJBQTJCO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qix1QkFBdUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsZ0JBQWdCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsZ0JBQWdCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELHFDQUFxQztBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELHFDQUFxQztBQUN6RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxjQUFjO0FBQ3JEO0FBQ0E7O0FBRUE7QUFDQSw4Q0FBOEMsd0JBQXdCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsOENBQThDO0FBQ2xGLG9DQUFvQywrREFBK0Q7QUFDbkcsb0NBQW9DLHNEQUFzRDtBQUMxRjtBQUNBLHdDQUF3QyxjQUFjO0FBQ3RELDJDQUEyQyxhQUFhO0FBQ3hELHdDQUF3QyxrQ0FBa0M7QUFDMUUsd0NBQXdDLG9DQUFvQztBQUM1RSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esd0JBQXdCLDBCQUEwQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esd0RBQXdELHdDQUF3QztBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELDBCQUEwQjtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0QsMEJBQTBCO0FBQzlFO0FBQ0Esd0RBQXdELDBCQUEwQjtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsZ0JBQWdCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELGdCQUFnQjtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsNERBQTRELDhCQUE4QjtBQUMxRjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsNkJBQTZCLGlDQUFpQyxtQ0FBbUM7QUFDakc7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLFFBQVE7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHFCQUFxQix1QkFBdUI7QUFDNUM7QUFDQTtBQUNBLG9DQUFvQztBQUNwQyx3Q0FBd0Msc0JBQXNCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNGQUFzRjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsaUJBQWlCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxxQkFBcUI7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsbUJBQW1CO0FBQ25CLDZCQUE2QixRQUFRO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0ZBQWtGO0FBQ2xGO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFlBQVk7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQywyQ0FBMkM7QUFDM0Msb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBLHlDQUF5QyxrQkFBa0I7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSw2RkFBNkYsOEJBQThCO0FBQzNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsNEJBQTRCO0FBQ2hELFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZUFBZSwrQ0FBUSxDQUFDLCtDQUFRLENBQUMsK0NBQVEsR0FBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBLHNGQUFzRix1Q0FBdUM7QUFDN0g7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLCtDQUFRLENBQUMsK0NBQVEsR0FBRyxrQkFBa0I7QUFDdEU7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVMsTUFBTSxtQ0FBbUM7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsSUFBSSxxQkFBcUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLCtDQUFRLENBQUMsK0NBQVEsR0FBRyxrQkFBa0I7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxzQ0FBc0M7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQSx1QkFBdUIsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHLFdBQVcsa0JBQWtCO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLCtDQUFRLENBQUMsK0NBQVEsR0FBRztBQUNyRCw0Q0FBNEMsc0JBQXNCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxnQkFBZ0I7QUFDbkQ7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhNQUE4TTtBQUM5TTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsK0JBQStCLFVBQVUsK0NBQVEsQ0FBQywrQ0FBUSxHQUFHLGlEQUFpRCwySkFBMko7QUFDL1MsU0FBUztBQUNULGtEQUFrRCxnQkFBZ0I7QUFDbEU7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywrRUFBK0U7QUFDbEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsOEZBQThGLGtEQUFrRDtBQUNoSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsVUFBVTtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJHQUEyRyxjQUFjO0FBQ3pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsK0NBQVEsQ0FBQywrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsdUJBQXVCLHdCQUF3Qiw4QkFBOEIsa0NBQWtDLHlCQUF5Qix3QkFBd0I7QUFDak87QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEMsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtFQUErRSxrREFBa0Q7QUFDakksNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGdDQUFnQztBQUM1RSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCwrQkFBK0I7QUFDbkYseUNBQXlDO0FBQ3pDLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELDBCQUEwQjtBQUMxRSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlLCtDQUFRLEdBQUc7QUFDMUI7QUFDQSxpRkFBaUY7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHlEQUF5RDtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx1Q0FBdUMsb0JBQW9CO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQywrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsY0FBYyw0QkFBNEI7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLCtDQUFRLEdBQUcsTUFBTSwrQ0FBUSxHQUFHLGVBQWUsbUVBQW1FLGtDQUFrQyxvQkFBb0I7QUFDbk07QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLCtDQUFRLENBQUMsK0NBQVE7QUFDM0M7QUFDQSwrRUFBK0U7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCwyQkFBMkI7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0dBQStHLGtCQUFrQjtBQUNqSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMscUJBQXFCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsMEJBQTBCO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxzQ0FBc0M7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLFdBQVcsVUFBVTtBQUNwRDtBQUNBLHFDQUFxQywrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsNkJBQTZCLGlEQUFpRDtBQUN2STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxvQkFBb0I7QUFDdkQ7QUFDQSw4Q0FBOEMscUJBQXFCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHVDQUF1QyxvQkFBb0I7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCw4Q0FBOEMscUJBQXFCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsV0FBVyw2SEFBNkg7QUFDbkw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsV0FBVyxnSkFBZ0o7QUFDOU07QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsK0NBQVEsQ0FBQywrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsV0FBVyxzQkFBc0I7QUFDakY7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBLHVGQUF1Rix3Q0FBd0MsMEJBQTBCO0FBQ3pKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywrQ0FBUSxDQUFDLCtDQUFRLEdBQUcsV0FBVyxjQUFjO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCwrQ0FBSTtBQUN2RCw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBOztBQUV3RjtBQUN4RiIsInNvdXJjZXMiOlsid2VicGFjazovL2J1aWxkZXItYXBwLy4vbm9kZV9tb2R1bGVzL0BidWlsZGVyLmlvL3Nkay9kaXN0L2luZGV4LmVzbS5qcz84MTdhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF9fYXNzaWduIH0gZnJvbSAndHNsaWInO1xuaW1wb3J0IGhhc2ggZnJvbSAnaGFzaC1zdW0nO1xuXG4oZnVuY3Rpb24gKCkge1xuICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIGZhbHNlO1xuXG4gIGZ1bmN0aW9uIEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMpIHtcbiAgICBwYXJhbXMgPSBwYXJhbXMgfHwgeyBidWJibGVzOiBmYWxzZSwgY2FuY2VsYWJsZTogZmFsc2UsIGRldGFpbDogbnVsbCB9O1xuICAgIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBldnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwpO1xuICAgIHJldHVybiBldnQ7XG4gIH1cblxuICB3aW5kb3cuQ3VzdG9tRXZlbnQgPSBDdXN0b21FdmVudDtcbn0pKCk7XG5cbnZhciBpc1NhZmFyaSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcclxudmFyIGlzQ2xpZW50ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XHJcbi8vIFRPRE86IHF1ZXVlIGFsbCBvZiB0aGVzZSBpbiBhIGRlYm91bmNlTmV4dFRpY2tcclxuZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcclxuICAgIC8vIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5uZXh0VGljaykge1xyXG4gICAgLy8gICBjb25zb2xlLmxvZygncHJvY2Vzcy5uZXh0VGljaz8nKTtcclxuICAgIC8vICAgcHJvY2Vzcy5uZXh0VGljayhmbik7XHJcbiAgICAvLyAgIHJldHVybjtcclxuICAgIC8vIH1cclxuICAgIC8vIEZJWE1FOiBmaXggdGhlIHJlYWwgc2FmYXJpIGlzc3VlIG9mIHRoaXMgcmFuZG9tbHkgbm90IHdvcmtpbmdcclxuICAgIGlmICghaXNDbGllbnQgfHwgaXNTYWZhcmkgfHwgdHlwZW9mIE11dGF0aW9uT2JzZXJ2ZXIgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgc2V0VGltZW91dChmbik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIGNhbGxlZCA9IDA7XHJcbiAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAoKSB7IHJldHVybiBmbigpOyB9KTtcclxuICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpO1xyXG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50LCB7XHJcbiAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSxcclxuICAgIH0pO1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXHJcbiAgICBlbGVtZW50LmRhdGEgPSBTdHJpbmcoKGNhbGxlZCA9ICsrY2FsbGVkKSk7XHJcbn1cblxudmFyIFBST1BFUlRZX05BTUVfREVOWV9MSVNUID0gT2JqZWN0LmZyZWV6ZShbJ19fcHJvdG9fXycsICdwcm90b3R5cGUnLCAnY29uc3RydWN0b3InXSk7XHJcbi8vIFRPRE86IHVuaXQgdGVzdHNcclxudmFyIFF1ZXJ5U3RyaW5nID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlTdHJpbmcoKSB7XHJcbiAgICB9XHJcbiAgICBRdWVyeVN0cmluZy5wYXJzZURlZXAgPSBmdW5jdGlvbiAocXVlcnlTdHJpbmcpIHtcclxuICAgICAgICB2YXIgb2JqID0gdGhpcy5wYXJzZShxdWVyeVN0cmluZyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVlcGVuKG9iaik7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTdHJpbmcuc3RyaW5naWZ5RGVlcCA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICB2YXIgbWFwID0gdGhpcy5mbGF0dGVuKG9iaik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RyaW5naWZ5KG1hcCk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTdHJpbmcucGFyc2UgPSBmdW5jdGlvbiAocXVlcnlTdHJpbmcpIHtcclxuICAgICAgICB2YXIgcXVlcnkgPSB7fTtcclxuICAgICAgICB2YXIgcGFpcnMgPSAocXVlcnlTdHJpbmdbMF0gPT09ICc/JyA/IHF1ZXJ5U3RyaW5nLnN1YnN0cigxKSA6IHF1ZXJ5U3RyaW5nKS5zcGxpdCgnJicpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFpcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBub2RlIHN1cHBvcnQ/XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVtkZWNvZGVVUklDb21wb25lbnQocGFpclswXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMV0gfHwgJycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIG1hbGZvcm1lZCBVUkkgY29tcG9uZW50c1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBxdWVyeTtcclxuICAgIH07XHJcbiAgICBRdWVyeVN0cmluZy5zdHJpbmdpZnkgPSBmdW5jdGlvbiAobWFwKSB7XHJcbiAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBtYXApIHtcclxuICAgICAgICAgICAgaWYgKG1hcC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBtYXBba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChzdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJyYnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3RyICs9IGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U3RyaW5nLmRlZXBlbiA9IGZ1bmN0aW9uIChtYXApIHtcclxuICAgICAgICAvLyBGSVhNRTsgU2hvdWxkIGJlIHR5cGUgVHJlZSA9IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IFRyZWU+XHJcbiAgICAgICAgLy8gcmVxdWlyZXMgYSB0eXBlc2NyaXB0IHVwZ3JhZGUuXHJcbiAgICAgICAgdmFyIG91dHB1dCA9IHt9O1xyXG4gICAgICAgIGZvciAodmFyIGsgaW4gbWFwKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gb3V0cHV0O1xyXG4gICAgICAgICAgICB2YXIgcGFydHMgPSBrLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBwYXJ0cy5wb3AoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwYXJ0c18xID0gcGFydHM7IF9pIDwgcGFydHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gcGFydHNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICBhc3NlcnRBbGxvd2VkUHJvcGVydHlOYW1lKHBhcnQpO1xyXG4gICAgICAgICAgICAgICAgdCA9IHRbcGFydF0gPSB0W3BhcnRdIHx8IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRba2V5XSA9IG1hcFtrXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcclxuICAgIH07XHJcbiAgICBRdWVyeVN0cmluZy5mbGF0dGVuID0gZnVuY3Rpb24gKG9iaiwgX2N1cnJlbnQsIF9yZXMpIHtcclxuICAgICAgICBpZiAoX3JlcyA9PT0gdm9pZCAwKSB7IF9yZXMgPSB7fTsgfVxyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gb2JqW2tleV07XHJcbiAgICAgICAgICAgIHZhciBuZXdLZXkgPSBfY3VycmVudCA/IF9jdXJyZW50ICsgJy4nICsga2V5IDoga2V5O1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mbGF0dGVuKHZhbHVlLCBuZXdLZXksIF9yZXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3Jlc1tuZXdLZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIF9yZXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5U3RyaW5nO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBhc3NlcnRBbGxvd2VkUHJvcGVydHlOYW1lKG5hbWUpIHtcclxuICAgIGlmIChQUk9QRVJUWV9OQU1FX0RFTllfTElTVC5pbmRleE9mKG5hbWUpID49IDApXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgbmFtZSBcXFwiXCIuY29uY2F0KG5hbWUsIFwiXFxcIiBpcyBub3QgYWxsb3dlZFwiKSk7XHJcbn1cblxudmFyIHZlcnNpb24gPSBcIjIuMi4yXCI7XG5cbnZhciBTdWJzY3JpcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTdWJzY3JpcHRpb24obGlzdGVuZXJzLCBsaXN0ZW5lcikge1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gbGlzdGVuZXJzO1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXIgPSBsaXN0ZW5lcjtcclxuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub3RoZXJTdWJzY3JpcHRpb25zID0gW107XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3Vic2NyaXB0aW9uLnByb3RvdHlwZSwgXCJjbG9zZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy51bnN1YnNjcmliZWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5vdGhlclN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xyXG4gICAgfTtcclxuICAgIFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudW5zdWJzY3JpYmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXIgJiYgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5saXN0ZW5lcnMuaW5kZXhPZih0aGlzLmxpc3RlbmVyKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vdGhlclN1YnNjcmlwdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoc3ViKSB7IHJldHVybiBzdWIudW5zdWJzY3JpYmUoKTsgfSk7XHJcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZWQgPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTdWJzY3JpcHRpb247XHJcbn0oKSk7XHJcbi8vIFRPRE86IGZvbGxvdyBtaW5pbWFsIGJhc2ljIHNwZWM6IGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLW9ic2VydmFibGVcclxudmFyIEJlaGF2aW9yU3ViamVjdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJlaGF2aW9yU3ViamVjdCh2YWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5lcnJvckxpc3RlbmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMudGhlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAoX2EgPSBfdGhpcy50b1Byb21pc2UoKSkudGhlbi5hcHBseShfYSwgYXJncyk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5saXN0ZW5lcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF9hW19pXTtcclxuICAgICAgICAgICAgbGlzdGVuZXIodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBUT0RPOiBpbXBsZW1lbnQgdGhpcyBhcyBQSVBFIGluc3RlYWRcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgdmFyIG5ld1N1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KGZuKHRoaXMudmFsdWUpKTtcclxuICAgICAgICAvLyBUT0RPOiBvbiBkZXN0cm95IGRlbGV0ZSB0aGVzZVxyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgbmV3U3ViamVjdC5uZXh0KGZuKHZhbCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBuZXdTdWJqZWN0LmVycm9yKGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld1N1YmplY3Q7XHJcbiAgICB9O1xyXG4gICAgQmVoYXZpb3JTdWJqZWN0LnByb3RvdHlwZS5jYXRjaCA9IGZ1bmN0aW9uIChlcnJvckxpc3RlbmVyKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvckxpc3RlbmVycy5wdXNoKGVycm9yTGlzdGVuZXIpO1xyXG4gICAgICAgIHJldHVybiBuZXcgU3Vic2NyaXB0aW9uKHRoaXMuZXJyb3JMaXN0ZW5lcnMsIGVycm9yTGlzdGVuZXIpO1xyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5lcnJvckxpc3RlbmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBsaXN0ZW5lcihlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKGxpc3RlbmVyLCBlcnJvckxpc3RlbmVyKSB7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XHJcbiAgICAgICAgaWYgKGVycm9yTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckxpc3RlbmVycy5wdXNoKGVycm9yTGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFN1YnNjcmlwdGlvbih0aGlzLmxpc3RlbmVycywgbGlzdGVuZXIpO1xyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUudG9Qcm9taXNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUucHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50b1Byb21pc2UoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQmVoYXZpb3JTdWJqZWN0O1xyXG59KCkpO1xuXG52YXIgU3RhdGUgPSB7XHJcbiAgICBQZW5kaW5nOiAnUGVuZGluZycsXHJcbiAgICBGdWxmaWxsZWQ6ICdGdWxmaWxsZWQnLFxyXG4gICAgUmVqZWN0ZWQ6ICdSZWplY3RlZCcsXHJcbn07XHJcbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsKSB7XHJcbiAgICByZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbic7XHJcbn1cclxuZnVuY3Rpb24gaXNPYmplY3QodmFsKSB7XHJcbiAgICByZXR1cm4gdmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnO1xyXG59XHJcbnZhciBUaW55UHJvbWlzZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRpbnlQcm9taXNlKGV4ZWN1dG9yKSB7XHJcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBTdGF0ZS5QZW5kaW5nO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xyXG4gICAgICAgIGV4ZWN1dG9yKHRoaXMuX3Jlc29sdmUuYmluZCh0aGlzKSwgdGhpcy5fcmVqZWN0LmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgVGlueVByb21pc2UucHJvdG90eXBlLl9yZXNvbHZlID0gZnVuY3Rpb24gKHgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh4IGluc3RhbmNlb2YgVGlueVByb21pc2UpIHtcclxuICAgICAgICAgICAgeC50aGVuKHRoaXMuX3Jlc29sdmUuYmluZCh0aGlzKSwgdGhpcy5fcmVqZWN0LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpc09iamVjdCh4KSB8fCBpc0Z1bmN0aW9uKHgpKSB7XHJcbiAgICAgICAgICAgIHZhciBjYWxsZWRfMSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRoZW5hYmxlID0geC50aGVuO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24odGhlbmFibGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbmFibGUuY2FsbCh4LCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2FsbGVkXzEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsZWRfMSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY2FsbGVkXzEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGVkXzEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZnVsZmlsbCh4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY2FsbGVkXzEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWplY3QoZXgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9mdWxmaWxsKHgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2Z1bGZpbGwgPSBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zdGF0ZSA9IFN0YXRlLkZ1bGZpbGxlZDtcclxuICAgICAgICB0aGlzLl92YWx1ZSA9IHJlc3VsdDtcclxuICAgICAgICB0aGlzLl9oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoYW5kbGVyKSB7IHJldHVybiBfdGhpcy5fY2FsbEhhbmRsZXIoaGFuZGxlcik7IH0pO1xyXG4gICAgfTtcclxuICAgIFRpbnlQcm9taXNlLnByb3RvdHlwZS5fcmVqZWN0ID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zdGF0ZSA9IFN0YXRlLlJlamVjdGVkO1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlID0gZXJyb3I7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAoaGFuZGxlcikgeyByZXR1cm4gX3RoaXMuX2NhbGxIYW5kbGVyKGhhbmRsZXIpOyB9KTtcclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2lzUGVuZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGUgPT09IFN0YXRlLlBlbmRpbmc7XHJcbiAgICB9O1xyXG4gICAgVGlueVByb21pc2UucHJvdG90eXBlLl9pc0Z1bGZpbGxlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGUgPT09IFN0YXRlLkZ1bGZpbGxlZDtcclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2lzUmVqZWN0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlID09PSBTdGF0ZS5SZWplY3RlZDtcclxuICAgIH07XHJcbiAgICBUaW55UHJvbWlzZS5wcm90b3R5cGUuX2FkZEhhbmRsZXIgPSBmdW5jdGlvbiAob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKHtcclxuICAgICAgICAgICAgb25GdWxmaWxsZWQ6IG9uRnVsZmlsbGVkLFxyXG4gICAgICAgICAgICBvblJlamVjdGVkOiBvblJlamVjdGVkLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRpbnlQcm9taXNlLnByb3RvdHlwZS5fY2FsbEhhbmRsZXIgPSBmdW5jdGlvbiAoaGFuZGxlcikge1xyXG4gICAgICAgIGlmICh0aGlzLl9pc0Z1bGZpbGxlZCgpICYmIGlzRnVuY3Rpb24oaGFuZGxlci5vbkZ1bGZpbGxlZCkpIHtcclxuICAgICAgICAgICAgaGFuZGxlci5vbkZ1bGZpbGxlZCh0aGlzLl92YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2lzUmVqZWN0ZWQoKSAmJiBpc0Z1bmN0aW9uKGhhbmRsZXIub25SZWplY3RlZCkpIHtcclxuICAgICAgICAgICAgaGFuZGxlci5vblJlamVjdGVkKHRoaXMuX3ZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVGlueVByb21pc2UucHJvdG90eXBlLnRoZW4gPSBmdW5jdGlvbiAob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5fc3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5QZW5kaW5nOiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbnlQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYWRkSGFuZGxlcihmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFRpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbihvbkZ1bGZpbGxlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvbkZ1bGZpbGxlZCh2YWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24ob25SZWplY3RlZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvblJlamVjdGVkKGVycm9yKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChleCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBTdGF0ZS5GdWxmaWxsZWQ6IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGlueVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG9uRnVsZmlsbGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob25GdWxmaWxsZWQoX3RoaXMuX3ZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzLl92YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIFN0YXRlLlJlamVjdGVkOiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbnlQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0VGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNGdW5jdGlvbihvblJlamVjdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob25SZWplY3RlZChfdGhpcy5fdmFsdWUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChfdGhpcy5fdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRpbnlQcm9taXNlO1xyXG59KCkpO1xyXG52YXIgUHJvbWlzZSQxID0gKHR5cGVvZiBQcm9taXNlICE9PSAndW5kZWZpbmVkJyA/IFByb21pc2UgOiBUaW55UHJvbWlzZSk7XG5cbi8vIFdlYnBhY2sgd29ya2Fyb3VuZCB0byBjb25kaXRpb25hbGx5IHJlcXVpcmUgY2VydGFpbiBleHRlcm5hbCBtb2R1bGVzXHJcbi8vIG9ubHkgb24gdGhlIHNlcnZlciBhbmQgbm90IGJ1bmRsZSB0aGVtIG9uIHRoZSBjbGllbnRcclxudmFyIHNlcnZlck9ubHlSZXF1aXJlO1xyXG50cnkge1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWV2YWxcclxuICAgIHNlcnZlck9ubHlSZXF1aXJlID0gZXZhbCgncmVxdWlyZScpO1xyXG59XHJcbmNhdGNoIChlcnIpIHtcclxuICAgIC8vIGFsbCBnb29kXHJcbiAgICBzZXJ2ZXJPbmx5UmVxdWlyZSA9IChmdW5jdGlvbiAoKSB7IHJldHVybiBudWxsOyB9KTtcclxufVxyXG52YXIgc2VydmVyT25seVJlcXVpcmUkMSA9IHNlcnZlck9ubHlSZXF1aXJlO1xuXG5mdW5jdGlvbiBwcm9taXNlUmVzb2x2ZSh2YWx1ZSkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlJDEoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmV0dXJuIHJlc29sdmUodmFsdWUpOyB9KTtcclxufVxyXG4vLyBBZGFwdGVkIGZyb20gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2RldmVsb3BpdC91bmZldGNoL21hc3Rlci9zcmMvaW5kZXgubWpzXHJcbmZ1bmN0aW9uIHRpbnlGZXRjaCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UkMShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICByZXF1ZXN0Lm9wZW4ob3B0aW9ucy5tZXRob2QgfHwgJ2dldCcsIHVybCwgdHJ1ZSk7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuaGVhZGVycykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIG9wdGlvbnMuaGVhZGVycykge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKGksIG9wdGlvbnMuaGVhZGVyc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmVxdWVzdC53aXRoQ3JlZGVudGlhbHMgPSBvcHRpb25zLmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZSc7XHJcbiAgICAgICAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UoKSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSByZWplY3Q7XHJcbiAgICAgICAgcmVxdWVzdC5zZW5kKG9wdGlvbnMuYm9keSk7XHJcbiAgICAgICAgZnVuY3Rpb24gcmVzcG9uc2UoKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgICAgIHZhciBhbGwgPSBbXTtcclxuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSB7fTtcclxuICAgICAgICAgICAgdmFyIGhlYWRlciA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgcmVxdWVzdFxyXG4gICAgICAgICAgICAgICAgLmdldEFsbFJlc3BvbnNlSGVhZGVycygpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXiguKj8pOlteXFxTXFxuXSooW1xcc1xcU10qPykkL2dtLCBmdW5jdGlvbiAoX21hdGNoLCBfa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IF9rZXk7XHJcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2goKGtleSA9IGtleS50b0xvd2VyQ2FzZSgpKSk7XHJcbiAgICAgICAgICAgICAgICBhbGwucHVzaChba2V5LCB2YWx1ZV0pO1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyID0gaGVhZGVyc1trZXldO1xyXG4gICAgICAgICAgICAgICAgaGVhZGVyc1trZXldID0gaGVhZGVyID8gXCJcIi5jb25jYXQoaGVhZGVyLCBcIixcIikuY29uY2F0KHZhbHVlKSA6IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG9rOiAoKHJlcXVlc3Quc3RhdHVzIC8gMTAwKSB8IDApID09PSAyLFxyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiByZXF1ZXN0LnN0YXR1cyxcclxuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHJlcXVlc3Quc3RhdHVzVGV4dCxcclxuICAgICAgICAgICAgICAgIHVybDogcmVxdWVzdC5yZXNwb25zZVVSTCxcclxuICAgICAgICAgICAgICAgIGNsb25lOiByZXNwb25zZSxcclxuICAgICAgICAgICAgICAgIHRleHQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHByb21pc2VSZXNvbHZlKHJlcXVlc3QucmVzcG9uc2VUZXh0KTsgfSxcclxuICAgICAgICAgICAgICAgIGpzb246IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHByb21pc2VSZXNvbHZlKHJlcXVlc3QucmVzcG9uc2VUZXh0KS50aGVuKEpTT04ucGFyc2UpOyB9LFxyXG4gICAgICAgICAgICAgICAgYmxvYjogZnVuY3Rpb24gKCkgeyByZXR1cm4gcHJvbWlzZVJlc29sdmUobmV3IEJsb2IoW3JlcXVlc3QucmVzcG9uc2VdKSk7IH0sXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5czogZnVuY3Rpb24gKCkgeyByZXR1cm4ga2V5czsgfSxcclxuICAgICAgICAgICAgICAgICAgICBlbnRyaWVzOiBmdW5jdGlvbiAoKSB7IHJldHVybiBhbGw7IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAobikgeyByZXR1cm4gaGVhZGVyc1tuLnRvTG93ZXJDYXNlKCldOyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGhhczogZnVuY3Rpb24gKG4pIHsgcmV0dXJuIG4udG9Mb3dlckNhc2UoKSBpbiBoZWFkZXJzOyB9LFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBnZXRGZXRjaCgpIHtcclxuICAgIC8vIElmIGZldGNoIGlzIGRlZmluZWQsIGluIHRoZSBicm93c2VyLCB2aWEgcG9seWZpbGwsIG9yIGluIGEgQ2xvdWRmbGFyZSB3b3JrZXIsIHVzZSBpdC5cclxuICAgIHZhciBfZmV0Y2ggPSB1bmRlZmluZWQ7XHJcbiAgICBpZiAoZ2xvYmFsVGhpcy5mZXRjaCkge1xyXG4gICAgICAgIF9mZXRjaCAhPT0gbnVsbCAmJiBfZmV0Y2ggIT09IHZvaWQgMCA/IF9mZXRjaCA6IChfZmV0Y2ggPSBnbG9iYWxUaGlzLmZldGNoKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgLy8gSWYgZmV0Y2ggaXMgbm90IGRlZmluZWQsIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudCwgdXNlIG5vZGUtZmV0Y2guXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gbm9kZS1mZXRjaEBeMyBpcyBFU00gb25seSwgYW5kIHdpbGwgdGhyb3cgZXJyb3Igb24gcmVxdWlyZS5cclxuICAgICAgICAgICAgX2ZldGNoICE9PSBudWxsICYmIF9mZXRjaCAhPT0gdm9pZCAwID8gX2ZldGNoIDogKF9mZXRjaCA9IHNlcnZlck9ubHlSZXF1aXJlJDEoJ25vZGUtZmV0Y2gnKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIElmIG5vZGUtZmV0Y2ggaXMgbm90IGluc3RhbGxlZCwgdXNlIHRpbnktZmV0Y2guXHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybignbm9kZS1mZXRjaCBpcyBub3QgaW5zdGFsbGVkLiBjb25zaWRlciBwb2x5ZmlsbGluZyBmZXRjaCBvciBpbnN0YWxsaW5nIG5vZGUtZmV0Y2guJyk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBPdGhlcndpc2UsIHVzZSB0aW55LWZldGNoLlxyXG4gICAgcmV0dXJuIF9mZXRjaCAhPT0gbnVsbCAmJiBfZmV0Y2ggIT09IHZvaWQgMCA/IF9mZXRjaCA6IHRpbnlGZXRjaDtcclxufVxuXG5mdW5jdGlvbiBhc3NpZ24odGFyZ2V0KSB7XHJcbiAgICB2YXIgdG8gPSBPYmplY3QodGFyZ2V0KTtcclxuICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBhcmd1bWVudHMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgdmFyIG5leHRTb3VyY2UgPSBhcmd1bWVudHNbaW5kZXhdO1xyXG4gICAgICAgIGlmIChuZXh0U291cmNlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgLy8gU2tpcCBvdmVyIGlmIHVuZGVmaW5lZCBvciBudWxsXHJcbiAgICAgICAgICAgIGZvciAodmFyIG5leHRLZXkgaW4gbmV4dFNvdXJjZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gQXZvaWQgYnVncyB3aGVuIGhhc093blByb3BlcnR5IGlzIHNoYWRvd2VkXHJcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5leHRTb3VyY2UsIG5leHRLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9bbmV4dEtleV0gPSBuZXh0U291cmNlW25leHRLZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRvO1xyXG59XG5cbmZ1bmN0aW9uIHRocm90dGxlKGZ1bmMsIHdhaXQsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICB2YXIgY29udGV4dDtcclxuICAgIHZhciBhcmdzO1xyXG4gICAgdmFyIHJlc3VsdDtcclxuICAgIHZhciB0aW1lb3V0ID0gbnVsbDtcclxuICAgIHZhciBwcmV2aW91cyA9IDA7XHJcbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcHJldmlvdXMgPSBvcHRpb25zLmxlYWRpbmcgPT09IGZhbHNlID8gMCA6IERhdGUubm93KCk7XHJcbiAgICAgICAgdGltZW91dCA9IG51bGw7XHJcbiAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgICAgICBpZiAoIXRpbWVvdXQpXHJcbiAgICAgICAgICAgIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGlmICghcHJldmlvdXMgJiYgb3B0aW9ucy5sZWFkaW5nID09PSBmYWxzZSlcclxuICAgICAgICAgICAgcHJldmlvdXMgPSBub3c7XHJcbiAgICAgICAgdmFyIHJlbWFpbmluZyA9IHdhaXQgLSAobm93IC0gcHJldmlvdXMpO1xyXG4gICAgICAgIGNvbnRleHQgPSB0aGlzO1xyXG4gICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgaWYgKHJlbWFpbmluZyA8PSAwIHx8IHJlbWFpbmluZyA+IHdhaXQpIHtcclxuICAgICAgICAgICAgaWYgKHRpbWVvdXQpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcclxuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHByZXZpb3VzID0gbm93O1xyXG4gICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG4gICAgICAgICAgICBpZiAoIXRpbWVvdXQpXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gYXJncyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCF0aW1lb3V0ICYmIG9wdGlvbnMudHJhaWxpbmcgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCByZW1haW5pbmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxufVxuXG52YXIgY2FtZWxDYXNlVG9LZWJhYkNhc2UgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICByZXR1cm4gc3RyID8gc3RyLnJlcGxhY2UoLyhbQS1aXSkvZywgZnVuY3Rpb24gKGcpIHsgcmV0dXJuIFwiLVwiLmNvbmNhdChnWzBdLnRvTG93ZXJDYXNlKCkpOyB9KSA6ICcnO1xyXG59O1xyXG52YXIgQW5pbWF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBbmltYXRvcigpIHtcclxuICAgIH1cclxuICAgIEFuaW1hdG9yLnByb3RvdHlwZS5iaW5kQW5pbWF0aW9ucyA9IGZ1bmN0aW9uIChhbmltYXRpb25zKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhbmltYXRpb25zXzEgPSBhbmltYXRpb25zOyBfaSA8IGFuaW1hdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IGFuaW1hdGlvbnNfMVtfaV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAoYW5pbWF0aW9uLnRyaWdnZXIpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3BhZ2VMb2FkJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXJBbmltYXRpb24oYW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2hvdmVyJzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRIb3ZlckFuaW1hdGlvbihhbmltYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnc2Nyb2xsSW5WaWV3JzpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRTY3JvbGxJblZpZXdBbmltYXRpb24oYW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBbmltYXRvci5wcm90b3R5cGUud2FybkVsZW1lbnROb3RQcmVzZW50ID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwiQ2Fubm90IGFuaW1hdGUgZWxlbWVudDogZWxlbWVudCB3aXRoIElEIFwiLmNvbmNhdChpZCwgXCIgbm90IGZvdW5kIVwiKSk7XHJcbiAgICB9O1xyXG4gICAgQW5pbWF0b3IucHJvdG90eXBlLmF1Z21lbnRBbmltYXRpb24gPSBmdW5jdGlvbiAoYW5pbWF0aW9uLCBlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIHN0eWxlc1VzZWQgPSB0aGlzLmdldEFsbFN0eWxlc1VzZWQoYW5pbWF0aW9uKTtcclxuICAgICAgICB2YXIgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XHJcbiAgICAgICAgLy8gY29uc3QgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XHJcbiAgICAgICAgLy8gLy8gRklYTUU6IHRoaXMgd2lsbCBicmVhayBpZiBvcmlnaW5hbCBsb2FkIGlzIGluIG9uZSByZXBvbnNpdmUgc2l6ZSB0aGVuIHJlc2l6ZSB0byBhbm90aGVyIGhtbW1cclxuICAgICAgICAvLyBOZWVkIHRvIHVzZSB0cmFuc2Zvcm0gaW5zdGVhZCBvZiBsZWZ0IHNpbmNlIGxlZnQgY2FuIGNoYW5nZSBvbiBzY3JlZW4gc2l6ZXNcclxuICAgICAgICB2YXIgZmlyc3RTdHlsZXMgPSBhbmltYXRpb24uc3RlcHNbMF0uc3R5bGVzO1xyXG4gICAgICAgIHZhciBsYXN0U3R5bGVzID0gYW5pbWF0aW9uLnN0ZXBzW2FuaW1hdGlvbi5zdGVwcy5sZW5ndGggLSAxXS5zdHlsZXM7XHJcbiAgICAgICAgdmFyIGJvdGhTdHlsZXMgPSBbZmlyc3RTdHlsZXMsIGxhc3RTdHlsZXNdO1xyXG4gICAgICAgIC8vIEZJWE1FOiB0aGlzIHdvbid0IHdvcmsgYXMgZXhwZWN0ZWQgZm9yIGF1Z21lbnRlZCBhbmltYXRpb25zIC0gbWF5IG5lZWQgdGhlIGVkaXRvciBpdHNlbGYgdG8gbWFuYWdlIHRoaXNcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGJvdGhTdHlsZXNfMSA9IGJvdGhTdHlsZXM7IF9pIDwgYm90aFN0eWxlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgc3R5bGVzID0gYm90aFN0eWxlc18xW19pXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBzdHlsZXNVc2VkXzEgPSBzdHlsZXNVc2VkOyBfYSA8IHN0eWxlc1VzZWRfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHN0eWxlc1VzZWRfMVtfYV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIShzdHlsZSBpbiBzdHlsZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzW3N0eWxlXSA9IGNvbXB1dGVkU3R5bGVbc3R5bGVdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFuaW1hdG9yLnByb3RvdHlwZS5nZXRBbGxTdHlsZXNVc2VkID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xyXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGFuaW1hdGlvbi5zdGVwczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHN0ZXAgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzdGVwLnN0eWxlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaW5kZXhPZihrZXkpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwcm9wZXJ0aWVzO1xyXG4gICAgfTtcclxuICAgIEFuaW1hdG9yLnByb3RvdHlwZS50cmlnZ2VyQW5pbWF0aW9uID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gVE9ETzogZG8gZm9yIEFMTCBlbGVtZW50c1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYW5pbWF0aW9uLmVsZW1lbnRJZCB8fCBhbmltYXRpb24uaWQgfHwgJycpKTtcclxuICAgICAgICBpZiAoIWVsZW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndhcm5FbGVtZW50Tm90UHJlc2VudChhbmltYXRpb24uZWxlbWVudElkIHx8IGFuaW1hdGlvbi5pZCB8fCAnJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hdWdtZW50QW5pbWF0aW9uKGFuaW1hdGlvbiwgZWxlbWVudCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGRvIHRoaXMgcHJvcGVybHksIG1heSBoYXZlIG90aGVyIGFuaW1hdGlvbnMgb2YgZGlmZmVyZW50IHByb3BlcnRpZXNcclxuICAgICAgICAgICAgLy8gVE9ETzogb25seSBvdmVycmlkZSB0aGUgcHJvcGVydGllc1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBpZiB0aGVyZSBpcyBhbiBlbnRyYW5jZSBhbmQgaG92ZXIgYW5pbWF0aW9uLCB0aGUgdHJhbnNpdGlvbiBkdXJhdGlvbiB3aWxsIGdldCBlZmZlZFxyXG4gICAgICAgICAgICAvLyBlbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnJyk7XHJcbiAgICAgICAgICAgIC8vIGNvbnN0IHN0eWxlZFVzZWQgPSB0aGlzLmdldEFsbFN0eWxlc1VzZWQoYW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJ25vbmUnO1xyXG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcwJztcclxuICAgICAgICAgICAgYXNzaWduKGVsZW1lbnQuc3R5bGUsIGFuaW1hdGlvbi5zdGVwc1swXS5zdHlsZXMpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBxdWV1ZS9iYXRjaCB0aGVzZSB0aW1lb3V0c1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBvbmx5IGluY2x1ZGUgcHJvcGVydGllcyBleHBsaWNpdGx5IHNldCBpbiB0aGUgYW5pbWF0aW9uXHJcbiAgICAgICAgICAgIC8vIHVzaW5nIE9iamVjdC5rZXlzKHN0eWxlcylcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSBcImFsbCBcIi5jb25jYXQoYW5pbWF0aW9uLmR1cmF0aW9uLCBcInMgXCIpLmNvbmNhdChjYW1lbENhc2VUb0tlYmFiQ2FzZShhbmltYXRpb24uZWFzaW5nKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uLmRlbGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSBhbmltYXRpb24uZGVsYXkgKyAncyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhc3NpZ24oZWxlbWVudC5zdHlsZSwgYW5pbWF0aW9uLnN0ZXBzWzFdLnN0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBtYXliZSByZW1vdmUvcmVzZXQgdHJhbnNpdG9pbiBwcm9wZXJ0eSBhZnRlciBhbmltYXRpb24gZHVyYXRpb25cclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHF1ZXVlIHRpbWVyc1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogd2hhdCBpZiBoYXMgb3RoZXIgdHJhbnNpdGlvbiAocmVzZXQgYmFjayB0byB3aGF0IGl0IHdhcylcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb24gPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfSwgKGFuaW1hdGlvbi5kZWxheSB8fCAwKSAqIDEwMDAgKyBhbmltYXRpb24uZHVyYXRpb24gKiAxMDAwICsgMTAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgQW5pbWF0b3IucHJvdG90eXBlLmJpbmRIb3ZlckFuaW1hdGlvbiA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFRPRE86IGlzIGl0IG11bHRpcGxlIGJpbmRpbmcgd2hlbiBlZGl0aW5nLi4uP1xyXG4gICAgICAgIC8vIFRPRE86IHVuYmluZCBvbiBlbGVtZW50IHJlbW92ZVxyXG4gICAgICAgIC8vIFRPRE86IGFwcGx5IHRvIEFMTCBlbGVtZW50c1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYW5pbWF0aW9uLmVsZW1lbnRJZCB8fCBhbmltYXRpb24uaWQgfHwgJycpKTtcclxuICAgICAgICBpZiAoIWVsZW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndhcm5FbGVtZW50Tm90UHJlc2VudChhbmltYXRpb24uZWxlbWVudElkIHx8IGFuaW1hdGlvbi5pZCB8fCAnJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hdWdtZW50QW5pbWF0aW9uKGFuaW1hdGlvbiwgZWxlbWVudCk7XHJcbiAgICAgICAgICAgIHZhciBkZWZhdWx0U3RhdGUgPSBhbmltYXRpb24uc3RlcHNbMF0uc3R5bGVzO1xyXG4gICAgICAgICAgICB2YXIgaG92ZXJTdGF0ZSA9IGFuaW1hdGlvbi5zdGVwc1sxXS5zdHlsZXM7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaERlZmF1bHRTdGF0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGFzc2lnbihlbGVtZW50LnN0eWxlLCBkZWZhdWx0U3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGF0dGFjaEhvdmVyU3RhdGUoKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NpZ24oZWxlbWVudC5zdHlsZSwgaG92ZXJTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYXR0YWNoRGVmYXVsdFN0YXRlKCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGF0dGFjaEhvdmVyU3RhdGUpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBhdHRhY2hEZWZhdWx0U3RhdGUpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBxdWV1ZS9iYXRjaCB0aGVzZSB0aW1lb3V0c1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9IFwiYWxsIFwiLmNvbmNhdChhbmltYXRpb24uZHVyYXRpb24sIFwicyBcIikuY29uY2F0KGNhbWVsQ2FzZVRvS2ViYWJDYXNlKGFuaW1hdGlvbi5lYXNpbmcpKTtcclxuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24uZGVsYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9IGFuaW1hdGlvbi5kZWxheSArICdzJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gVE9ETzogdW5iaW5kIG9uIGVsZW1lbnQgcmVtb3ZlXHJcbiAgICBBbmltYXRvci5wcm90b3R5cGUuYmluZFNjcm9sbEluVmlld0FuaW1hdGlvbiA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFRPRE86IGFwcGx5IHRvIEFMTCBtYXRjaGluZyBlbGVtZW50c1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYW5pbWF0aW9uLmVsZW1lbnRJZCB8fCBhbmltYXRpb24uaWQgfHwgJycpKTtcclxuICAgICAgICBpZiAoIWVsZW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLndhcm5FbGVtZW50Tm90UHJlc2VudChhbmltYXRpb24uZWxlbWVudElkIHx8IGFuaW1hdGlvbi5pZCB8fCAnJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVE9ETzogaWYgc2VydmVyIHNpZGUgcmVuZGVyZWQgYW5kIHNjcm9sbGVkIGludG8gdmlldyBkb24ndCBhbmltYXRlLi4uXHJcbiAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hdWdtZW50QW5pbWF0aW9uKGFuaW1hdGlvbiwgZWxlbWVudCk7XHJcbiAgICAgICAgICAgIHZhciB0cmlnZ2VyZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIHBlbmRpbmdBbmltYXRpb24gPSBmYWxzZTtcclxuICAgICAgICAgICAgZnVuY3Rpb24gaW1tZWRpYXRlT25TY3JvbGwoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRyaWdnZXJlZCAmJiBpc1Njcm9sbGVkSW50b1ZpZXcoZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdBbmltYXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ24oZWxlbWVudC5zdHlsZSwgYW5pbWF0aW9uLnN0ZXBzWzFdLnN0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYW5pbWF0aW9uLnJlcGVhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgb25TY3JvbGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ0FuaW1hdGlvbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbmltYXRpb24ucmVwZWF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgKGFuaW1hdGlvbi5kdXJhdGlvbiArIChhbmltYXRpb24uZGVsYXkgfHwgMCkpICogMTAwMCArIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhbmltYXRpb24ucmVwZWF0ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcmVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIXBlbmRpbmdBbmltYXRpb24gJiZcclxuICAgICAgICAgICAgICAgICAgICAhaXNTY3JvbGxlZEludG9WaWV3KGVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2Ugd2FudCB0byByZXBlYXQgdGhlIGFuaW1hdGlvbiBldmVyeSB0aW1lIHRoZSB0aGUgZWxlbWVudCBpcyBvdXQgb2YgdmlldyBhbmQgYmFjayBhZ2FpblxyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2lnbihlbGVtZW50LnN0eWxlLCBhbmltYXRpb24uc3RlcHNbMF0uc3R5bGVzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBUT0RPOiByb2xsIGFsbCBvZiB0aGVzZSBpbiBvbmUgZm9yIG1vcmUgZWZmaWNpZW5jeSBvZiBjaGVja2luZyBhbGwgdGhlIHJlY3RzXHJcbiAgICAgICAgICAgIHZhciBvblNjcm9sbCA9IHRocm90dGxlKGltbWVkaWF0ZU9uU2Nyb2xsLCAyMDAsIHsgbGVhZGluZzogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGZ1bGx5IGluIHZpZXcgb3IgcGFydGlhbGx5XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGlzU2Nyb2xsZWRJbnRvVmlldyhlbGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVjdCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2luZG93SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgdmFyIHRocmVzaG9sZFBlcmNlbnQgPSAoYW5pbWF0aW9uLnRocmVzaG9sZFBlcmNlbnQgfHwgMCkgLyAxMDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGhyZXNob2xkID0gdGhyZXNob2xkUGVyY2VudCAqIHdpbmRvd0hlaWdodDtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHBhcnRpYWwgaW4gdmlldz8gb3Igd2hhdCBpZiBlbGVtZW50IGlzIGxhcmdlciB0aGFuIHNjcmVlbiBpdHNlbGZcclxuICAgICAgICAgICAgICAgIHJldHVybiAocmVjdC5ib3R0b20gPiB0aHJlc2hvbGQgJiYgcmVjdC50b3AgPCB3aW5kb3dIZWlnaHQgLSB0aHJlc2hvbGQgLy8gRWxlbWVudCBpcyBwZWVraW5nIHRvcCBvciBib3R0b21cclxuICAgICAgICAgICAgICAgIC8vIChyZWN0LnRvcCA+IDAgJiYgcmVjdC5ib3R0b20gPCB3aW5kb3cuaW5uZXJIZWlnaHQpIHx8IC8vIGVsZW1lbnQgZml0cyB3aXRoaW4gdGhlIHNjcmVlbiBhbmQgaXMgZnVsbHkgb24gc2NyZWVuIChub3QgaGFuZ2luZyBvZmYgYXQgYWxsKVxyXG4gICAgICAgICAgICAgICAgLy8gKHJlY3QudG9wIDwgMCAmJiByZWN0LmJvdHRvbSA+IHdpbmRvdy5pbm5lckhlaWdodCkgLy8gZWxlbWVudCBpcyBsYXJnZXIgdGhhbiB0aGUgc2NyZWVuIGFuZCBoYW5ncyBvdmVyIHRoZSB0b3AgYW5kIGJvdHRvbVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZGVmYXVsdFN0YXRlID0gYW5pbWF0aW9uLnN0ZXBzWzBdLnN0eWxlcztcclxuICAgICAgICAgICAgZnVuY3Rpb24gYXR0YWNoRGVmYXVsdFN0YXRlKCkge1xyXG4gICAgICAgICAgICAgICAgYXNzaWduKGVsZW1lbnQuc3R5bGUsIGRlZmF1bHRTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYXR0YWNoRGVmYXVsdFN0YXRlKCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IHF1ZXVlL2JhdGNoIHRoZXNlIHRpbWVvdXRzIVxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9IFwiYWxsIFwiLmNvbmNhdChhbmltYXRpb24uZHVyYXRpb24sIFwicyBcIikuY29uY2F0KGNhbWVsQ2FzZVRvS2ViYWJDYXNlKGFuaW1hdGlvbi5lYXNpbmcpKTtcclxuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24uZGVsYXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9IGFuaW1hdGlvbi5kZWxheSArICdzJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IG9uZSBsaXN0ZW5lciBmb3IgZXZlcnl0aGluZ1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBvblNjcm9sbCwgeyBjYXB0dXJlOiB0cnVlLCBwYXNzaXZlOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAvLyBEbyBhbiBpbml0aWFsIGNoZWNrXHJcbiAgICAgICAgICAgIGltbWVkaWF0ZU9uU2Nyb2xsKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFuaW1hdG9yO1xyXG59KCkpO1xuXG4vKipcclxuICogT25seSBnZXRzIG9uZSBsZXZlbCB1cCBmcm9tIGhvc3RuYW1lXHJcbiAqIHd3d3cuZXhhbXBsZS5jb20gLT4gZXhhbXBsZS5jb21cclxuICogd3d3LmV4YW1wbGUuY28udWsgLT4gZXhhbXBsZS5jby51a1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0VG9wTGV2ZWxEb21haW4oaG9zdCkge1xyXG4gICAgdmFyIHBhcnRzID0gaG9zdC5zcGxpdCgnLicpO1xyXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA+IDIpIHtcclxuICAgICAgICByZXR1cm4gcGFydHMuc2xpY2UoMSkuam9pbignLicpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhvc3Q7XHJcbn1cblxuLyoqXHJcbiAqIFJlZ0V4cCB0byBtYXRjaCBmaWVsZC1jb250ZW50IGluIFJGQyA3MjMwIHNlYyAzLjJcclxuICpcclxuICogZmllbGQtY29udGVudCA9IGZpZWxkLXZjaGFyIFsgMSooIFNQIC8gSFRBQiApIGZpZWxkLXZjaGFyIF1cclxuICogZmllbGQtdmNoYXIgICA9IFZDSEFSIC8gb2JzLXRleHRcclxuICogb2JzLXRleHQgICAgICA9ICV4ODAtRkZcclxuICovXHJcbnZhciBmaWVsZENvbnRlbnRSZWdFeHAgPSAvXltcXHUwMDA5XFx1MDAyMC1cXHUwMDdlXFx1MDA4MC1cXHUwMGZmXSskLztcclxudmFyIENvb2tpZXMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDb29raWVzKHJlcXVlc3QsIHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDtcclxuICAgICAgICB0aGlzLnJlc3BvbnNlID0gcmVzcG9uc2U7XHJcbiAgICB9XHJcbiAgICBDb29raWVzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHZhciBoZWFkZXIgPSB0aGlzLnJlcXVlc3QuaGVhZGVyc1snY29va2llJ107XHJcbiAgICAgICAgaWYgKCFoZWFkZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWF0Y2ggPSBoZWFkZXIubWF0Y2goZ2V0UGF0dGVybihuYW1lKSk7XHJcbiAgICAgICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB2YWx1ZSA9IG1hdGNoWzFdO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH07XHJcbiAgICBDb29raWVzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIG9wdHMpIHtcclxuICAgICAgICB2YXIgcmVzID0gdGhpcy5yZXNwb25zZTtcclxuICAgICAgICB2YXIgcmVxID0gdGhpcy5yZXF1ZXN0O1xyXG4gICAgICAgIHZhciBoZWFkZXJzID0gcmVzLmdldEhlYWRlcignU2V0LUNvb2tpZScpIHx8IFtdO1xyXG4gICAgICAgIC8vIFRPRE86IGp1c3QgbWFrZSB0aGlzIGFsd2F5cyB0cnVlXHJcbiAgICAgICAgdmFyIHNlY3VyZSA9IHRoaXMuc2VjdXJlICE9PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgPyAhIXRoaXMuc2VjdXJlXHJcbiAgICAgICAgICAgIDogcmVxLnByb3RvY29sID09PSAnaHR0cHMnIHx8IHJlcS5jb25uZWN0aW9uLmVuY3J5cHRlZDtcclxuICAgICAgICB2YXIgY29va2llID0gbmV3IENvb2tpZShuYW1lLCB2YWx1ZSwgb3B0cyk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBoZWFkZXJzID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBoZWFkZXJzID0gW2hlYWRlcnNdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXNlY3VyZSAmJiBvcHRzICYmIG9wdHMuc2VjdXJlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IHNlbmQgc2VjdXJlIGNvb2tpZSBvdmVyIHVuZW5jcnlwdGVkIGNvbm5lY3Rpb24nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29va2llLnNlY3VyZSA9IHNlY3VyZTtcclxuICAgICAgICBpZiAob3B0cyAmJiAnc2VjdXJlJyBpbiBvcHRzKSB7XHJcbiAgICAgICAgICAgIGNvb2tpZS5zZWN1cmUgPSAhIW9wdHMuc2VjdXJlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb29raWUuZG9tYWluID0gcmVxLmhlYWRlcnMuaG9zdCAmJiBnZXRUb3BMZXZlbERvbWFpbihyZXEuaGVhZGVycy5ob3N0KTtcclxuICAgICAgICBwdXNoQ29va2llKGhlYWRlcnMsIGNvb2tpZSk7XHJcbiAgICAgICAgdmFyIHNldEhlYWRlciA9IHJlcy5zZXRIZWFkZXI7XHJcbiAgICAgICAgc2V0SGVhZGVyLmNhbGwocmVzLCAnU2V0LUNvb2tpZScsIGhlYWRlcnMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb29raWVzO1xyXG59KCkpO1xyXG52YXIgQ29va2llID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ29va2llKG5hbWUsIHZhbHVlLCBhdHRycykge1xyXG4gICAgICAgIHRoaXMucGF0aCA9ICcvJztcclxuICAgICAgICB0aGlzLmRvbWFpbiA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLmh0dHBPbmx5ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnNhbWVTaXRlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZWN1cmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm92ZXJ3cml0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICcnO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSAnJztcclxuICAgICAgICBpZiAoIWZpZWxkQ29udGVudFJlZ0V4cC50ZXN0KG5hbWUpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2FyZ3VtZW50IG5hbWUgaXMgaW52YWxpZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsdWUgJiYgIWZpZWxkQ29udGVudFJlZ0V4cC50ZXN0KHZhbHVlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdhcmd1bWVudCB2YWx1ZSBpcyBpbnZhbGlkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5leHBpcmVzID0gbmV3IERhdGUoMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlIHx8ICcnO1xyXG4gICAgICAgIGlmIChhdHRycy5leHBpcmVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXhwaXJlcyA9IGF0dHJzLmV4cGlyZXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhdHRycy5zZWN1cmUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWN1cmUgPSBhdHRycy5zZWN1cmU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgQ29va2llLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCJcIi5jb25jYXQodGhpcy5uYW1lLCBcIj1cIikuY29uY2F0KHRoaXMudmFsdWUpO1xyXG4gICAgfTtcclxuICAgIENvb2tpZS5wcm90b3R5cGUudG9IZWFkZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGhlYWRlciA9IHRoaXMudG9TdHJpbmcoKTtcclxuICAgICAgICBpZiAodGhpcy5tYXhBZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5leHBpcmVzID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIHRoaXMubWF4QWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGF0aCkge1xyXG4gICAgICAgICAgICBoZWFkZXIgKz0gXCI7IHBhdGg9XCIuY29uY2F0KHRoaXMucGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmV4cGlyZXMpIHtcclxuICAgICAgICAgICAgaGVhZGVyICs9IFwiOyBleHBpcmVzPVwiLmNvbmNhdCh0aGlzLmV4cGlyZXMudG9VVENTdHJpbmcoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmRvbWFpbikge1xyXG4gICAgICAgICAgICBoZWFkZXIgKz0gXCI7IGRvbWFpbj1cIi5jb25jYXQodGhpcy5kb21haW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUT0RPOiBzYW1lc2l0ZT1ub25lIGJ5IGRlZmF1bHQgKD8pXHJcbiAgICAgICAgaGVhZGVyICs9IFwiOyBTYW1lU2l0ZT1cIi5jb25jYXQodGhpcy5zYW1lU2l0ZSA9PT0gdHJ1ZSA/ICdzdHJpY3QnIDogJ05vbmUnKTtcclxuICAgICAgICAvLyBUT0RPOiBPbiBieSBkZWZhdWx0XHJcbiAgICAgICAgaWYgKHRoaXMuc2VjdXJlKSB7XHJcbiAgICAgICAgICAgIGhlYWRlciArPSAnOyBzZWN1cmUnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5odHRwT25seSkge1xyXG4gICAgICAgICAgICBoZWFkZXIgKz0gJzsgaHR0cG9ubHknO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGVhZGVyO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb29raWU7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGdldFBhdHRlcm4obmFtZSkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoXCIoPzpefDspICpcIi5jb25jYXQobmFtZS5yZXBsYWNlKC9bLVtcXF17fSgpKis/LixcXFxcXiR8I1xcc10vZywgJ1xcXFwkJicpLCBcIj0oW147XSopXCIpKTtcclxufVxyXG5mdW5jdGlvbiBwdXNoQ29va2llKGhlYWRlcnMsIGNvb2tpZSkge1xyXG4gICAgaWYgKGNvb2tpZS5vdmVyd3JpdGUpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gaGVhZGVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBpZiAoaGVhZGVyc1tpXS5pbmRleE9mKFwiXCIuY29uY2F0KGNvb2tpZS5uYW1lLCBcIj1cIikpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGhlYWRlcnMucHVzaChjb29raWUudG9IZWFkZXIoKSk7XHJcbn1cblxuZnVuY3Rpb24gb21pdChvYmopIHtcclxuICAgIHZhciB2YWx1ZXMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFsdWVzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgdmFyIG5ld09iamVjdCA9IE9iamVjdC5hc3NpZ24oe30sIG9iaik7XHJcbiAgICBmb3IgKHZhciBfYSA9IDAsIHZhbHVlc18xID0gdmFsdWVzOyBfYSA8IHZhbHVlc18xLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgIHZhciBrZXkgPSB2YWx1ZXNfMVtfYV07XHJcbiAgICAgICAgZGVsZXRlIG5ld09iamVjdFtrZXldO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ld09iamVjdDtcclxufVxuXG4vKipcclxuICogQGNyZWRpdCBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjExNzUyM1xyXG4gKi9cclxuZnVuY3Rpb24gdXVpZHY0KCkge1xyXG4gICAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICB2YXIgciA9IChNYXRoLnJhbmRvbSgpICogMTYpIHwgMCwgdiA9IGMgPT0gJ3gnID8gciA6IChyICYgMHgzKSB8IDB4ODtcclxuICAgICAgICByZXR1cm4gdi50b1N0cmluZygxNik7XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICogU2xpZ2h0bHkgY2xlYW5lciBhbmQgc21hbGxlciBVVUlEc1xyXG4gKi9cclxuZnVuY3Rpb24gdXVpZCgpIHtcclxuICAgIHJldHVybiB1dWlkdjQoKS5yZXBsYWNlKC8tL2csICcnKTtcclxufVxuXG5mdW5jdGlvbiBlbXB0eVVybCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcXVlcnk6IG51bGwsXHJcbiAgICAgICAgcG9ydDogbnVsbCxcclxuICAgICAgICBhdXRoOiBudWxsLFxyXG4gICAgICAgIGhhc2g6IG51bGwsXHJcbiAgICAgICAgaG9zdDogbnVsbCxcclxuICAgICAgICBob3N0bmFtZTogbnVsbCxcclxuICAgICAgICBocmVmOiBudWxsLFxyXG4gICAgICAgIHBhdGg6IG51bGwsXHJcbiAgICAgICAgcGF0aG5hbWU6IG51bGwsXHJcbiAgICAgICAgcHJvdG9jb2w6IG51bGwsXHJcbiAgICAgICAgc2VhcmNoOiBudWxsLFxyXG4gICAgICAgIHNsYXNoZXM6IG51bGwsXHJcbiAgICB9O1xyXG59XHJcbi8vIFJlcGxhY2VtZW50IGZvciBgdXJsLnBhcnNlYCB1c2luZyBgVVJMYCBnbG9iYWwgb2JqZWN0IHRoYXQgd29ya3Mgd2l0aCByZWxhdGl2ZSBwYXRocy5cclxuLy8gQXNzdW1wdGlvbnM6IHRoaXMgZnVuY3Rpb24gb3BlcmF0ZXMgaW4gYSBOb2RlSlMgZW52aXJvbm1lbnQuXHJcbmZ1bmN0aW9uIHBhcnNlJDEodXJsKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICB2YXIgb3V0ID0gZW1wdHlVcmwoKTtcclxuICAgIHZhciB1O1xyXG4gICAgdmFyIHBhdGhPbmx5ID0gdXJsID09PSAnJyB8fCB1cmxbMF0gPT09ICcvJztcclxuICAgIGlmIChwYXRoT25seSkge1xyXG4gICAgICAgIHUgPSBuZXcgVVJMKHVybCwgJ2h0dHA6Ly8wLjAuMC4wLycpO1xyXG4gICAgICAgIG91dC5ocmVmID0gdS5ocmVmO1xyXG4gICAgICAgIG91dC5ocmVmID0gKF9hID0gb3V0LmhyZWYpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zbGljZSgxNCk7IC8vIHJlbW92ZSAnaHR0cDovLzAuMC4wLjAvJ1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdSA9IG5ldyBVUkwodXJsKTtcclxuICAgICAgICBvdXQuaHJlZiA9IHUuaHJlZjtcclxuICAgICAgICBvdXQucG9ydCA9IHUucG9ydCA9PT0gJycgPyBudWxsIDogdS5wb3J0O1xyXG4gICAgICAgIG91dC5oYXNoID0gdS5oYXNoID09PSAnJyA/IG51bGwgOiB1Lmhhc2g7XHJcbiAgICAgICAgb3V0Lmhvc3QgPSB1Lmhvc3Q7XHJcbiAgICAgICAgb3V0Lmhvc3RuYW1lID0gdS5ob3N0bmFtZTtcclxuICAgICAgICBvdXQuaHJlZiA9IHUuaHJlZjtcclxuICAgICAgICBvdXQucGF0aG5hbWUgPSB1LnBhdGhuYW1lO1xyXG4gICAgICAgIG91dC5wcm90b2NvbCA9IHUucHJvdG9jb2w7XHJcbiAgICAgICAgb3V0LnNsYXNoZXMgPSB1cmxbdS5wcm90b2NvbC5sZW5ndGhdID09PSAnLyc7IC8vIGNoZWNrIGlmIHRoZSBtaW1ldHlwZSBpcyBwcm9jZWVkZWQgYnkgYSBzbGFzaFxyXG4gICAgfVxyXG4gICAgb3V0LnNlYXJjaCA9IHUuc2VhcmNoO1xyXG4gICAgb3V0LnF1ZXJ5ID0gdS5zZWFyY2guc2xpY2UoMSk7IC8vIHJlbW92ZSAnPydcclxuICAgIG91dC5wYXRoID0gXCJcIi5jb25jYXQodS5wYXRobmFtZSkuY29uY2F0KHUuc2VhcmNoKTtcclxuICAgIG91dC5wYXRobmFtZSA9IHUucGF0aG5hbWU7XHJcbiAgICByZXR1cm4gb3V0O1xyXG59XG5cbi8qKlxyXG4gKiBTYWZlIGNvbnZlcnNpb24gdG8gZXJyb3IgdHlwZS4gSW50ZW5kZWQgdG8gYmUgdXNlZCBpbiBjYXRjaCBibG9ja3Mgd2hlcmUgdGhlXHJcbiAqICB2YWx1ZSBpcyBub3QgZ3VhcmFudGVlZCB0byBiZSBhbiBlcnJvci5cclxuICpcclxuICogIEBleGFtcGxlXHJcbiAqICB0cnkge1xyXG4gKiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NvbWV0aGluZyB3ZW50IHdyb25nJylcclxuICogIH1cclxuICogIGNhdGNoIChlcnI6IHVua25vd24pIHtcclxuICogICAgY29uc3QgZXJyb3I6IEVycm9yID0gdG9FcnJvcihlcnIpXHJcbiAqICB9XHJcbiAqL1xyXG5mdW5jdGlvbiB0b0Vycm9yKGVycikge1xyXG4gICAgaWYgKGVyciBpbnN0YW5jZW9mIEVycm9yKVxyXG4gICAgICAgIHJldHVybiBlcnI7XHJcbiAgICByZXR1cm4gbmV3IEVycm9yKFN0cmluZyhlcnIpKTtcclxufVxuXG52YXIgREVGQVVMVF9BUElfVkVSU0lPTiA9ICd2Myc7XG5cbmZ1bmN0aW9uIGRhdGVQbHVzTWludXRlcyhtaW51dGVzKSB7XHJcbiAgICBpZiAobWludXRlcyA9PT0gdm9pZCAwKSB7IG1pbnV0ZXMgPSAzMDsgfVxyXG4gICAgcmV0dXJuIG5ldyBEYXRlKERhdGUubm93KCkgKyBtaW51dGVzICogNjAwMDApO1xyXG59XHJcbnZhciBpc1Bvc2l0aXZlTnVtYmVyID0gZnVuY3Rpb24gKHRoaW5nKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHRoaW5nID09PSAnbnVtYmVyJyAmJiAhaXNOYU4odGhpbmcpICYmIHRoaW5nID49IDA7XHJcbn07XHJcbnZhciBpc1JlYWN0TmF0aXZlID0gdHlwZW9mIG5hdmlnYXRvciA9PT0gJ29iamVjdCcgJiYgbmF2aWdhdG9yLnByb2R1Y3QgPT09ICdSZWFjdE5hdGl2ZSc7XHJcbnZhciB2YWxpZEVudkxpc3QgPSBbXHJcbiAgICAncHJvZHVjdGlvbicsXHJcbiAgICAncWEnLFxyXG4gICAgJ3Rlc3QnLFxyXG4gICAgJ2RldmVsb3BtZW50JyxcclxuICAgICdkZXYnLFxyXG4gICAgJ2Nkbi1xYScsXHJcbiAgICAnY2xvdWQnLFxyXG4gICAgJ2Zhc3QnLFxyXG4gICAgJ2NkbjInLFxyXG4gICAgJ2Nkbi1wcm9kJyxcclxuXTtcclxuZnVuY3Rpb24gZ2V0UXVlcnlQYXJhbSh1cmwsIHZhcmlhYmxlKSB7XHJcbiAgICB2YXIgcXVlcnkgPSB1cmwuc3BsaXQoJz8nKVsxXSB8fCAnJztcclxuICAgIHZhciB2YXJzID0gcXVlcnkuc3BsaXQoJyYnKTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBwYWlyID0gdmFyc1tpXS5zcGxpdCgnPScpO1xyXG4gICAgICAgIGlmIChkZWNvZGVVUklDb21wb25lbnQocGFpclswXSkgPT09IHZhcmlhYmxlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocGFpclsxXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxudmFyIHVybFBhcnNlciA9IHtcclxuICAgIHBhcnNlOiBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIGVsLmhyZWYgPSB1cmw7XHJcbiAgICAgICAgdmFyIG91dCA9IHt9O1xyXG4gICAgICAgIHZhciBwcm9wcyA9IFtcclxuICAgICAgICAgICAgJ3VzZXJuYW1lJyxcclxuICAgICAgICAgICAgJ3Bhc3N3b3JkJyxcclxuICAgICAgICAgICAgJ2hvc3QnLFxyXG4gICAgICAgICAgICAnaG9zdG5hbWUnLFxyXG4gICAgICAgICAgICAncG9ydCcsXHJcbiAgICAgICAgICAgICdwcm90b2NvbCcsXHJcbiAgICAgICAgICAgICdvcmlnaW4nLFxyXG4gICAgICAgICAgICAncGF0aG5hbWUnLFxyXG4gICAgICAgICAgICAnc2VhcmNoJyxcclxuICAgICAgICAgICAgJ2hhc2gnLFxyXG4gICAgICAgIF07XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwcm9wc18xID0gcHJvcHM7IF9pIDwgcHJvcHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHByb3AgPSBwcm9wc18xW19pXTtcclxuICAgICAgICAgICAgb3V0W3Byb3BdID0gZWxbcHJvcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElFIDExIHBhdGhuYW1lIGhhbmRsaW5nIHdvcmthcm91bmRcclxuICAgICAgICAvLyAoSUUgb21pdHMgcHJlY2VlZGluZyAnLycsIHVubGlrZSBvdGhlciBicm93c2VycylcclxuICAgICAgICBpZiAoKG91dC5wYXRobmFtZSB8fCBvdXQucGF0aG5hbWUgPT09ICcnKSAmJlxyXG4gICAgICAgICAgICB0eXBlb2Ygb3V0LnBhdGhuYW1lID09PSAnc3RyaW5nJyAmJlxyXG4gICAgICAgICAgICBvdXQucGF0aG5hbWUuaW5kZXhPZignLycpICE9PSAwKSB7XHJcbiAgICAgICAgICAgIG91dC5wYXRobmFtZSA9ICcvJyArIG91dC5wYXRobmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dDtcclxuICAgIH0sXHJcbn07XHJcbnZhciBwYXJzZSA9IGlzUmVhY3ROYXRpdmVcclxuICAgID8gZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHlVcmwoKTsgfVxyXG4gICAgOiB0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0J1xyXG4gICAgICAgID8gdXJsUGFyc2VyLnBhcnNlXHJcbiAgICAgICAgOiBwYXJzZSQxO1xyXG5mdW5jdGlvbiBzZXRDb29raWUobmFtZSwgdmFsdWUsIGV4cGlyZXMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIGV4cGlyZXNTdHJpbmcgPSAnJztcclxuICAgICAgICAvLyBUT0RPOiBuZWVkIHRvIGtub3cgaWYgc2VjdXJlIHNlcnZlciBzaWRlXHJcbiAgICAgICAgaWYgKGV4cGlyZXMpIHtcclxuICAgICAgICAgICAgZXhwaXJlc1N0cmluZyA9ICc7IGV4cGlyZXM9JyArIGV4cGlyZXMudG9VVENTdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNlY3VyZSA9IGlzQnJvd3NlciA/IGxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6JyA6IHRydWU7XHJcbiAgICAgICAgZG9jdW1lbnQuY29va2llID1cclxuICAgICAgICAgICAgbmFtZSArXHJcbiAgICAgICAgICAgICAgICAnPScgK1xyXG4gICAgICAgICAgICAgICAgKHZhbHVlIHx8ICcnKSArXHJcbiAgICAgICAgICAgICAgICBleHBpcmVzU3RyaW5nICtcclxuICAgICAgICAgICAgICAgICc7IHBhdGg9LycgK1xyXG4gICAgICAgICAgICAgICAgXCI7IGRvbWFpbj1cIi5jb25jYXQoZ2V0VG9wTGV2ZWxEb21haW4obG9jYXRpb24uaG9zdG5hbWUpKSArXHJcbiAgICAgICAgICAgICAgICAoc2VjdXJlID8gJzsgc2VjdXJlOyBTYW1lU2l0ZT1Ob25lJyA6ICcnKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oJ0NvdWxkIG5vdCBzZXQgY29va2llJywgZXJyKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRDb29raWUobmFtZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gKGRlY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5jb29raWUucmVwbGFjZShuZXcgUmVnRXhwKCcoPzooPzpefC4qOylcXFxccyonICtcclxuICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpLnJlcGxhY2UoL1tcXC1cXC5cXCtcXCpdL2csICdcXFxcJCYnKSArXHJcbiAgICAgICAgICAgICdcXFxccypcXFxcPVxcXFxzKihbXjtdKikuKiQpfF4uKiQnKSwgJyQxJykpIHx8IG51bGwpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IGdldCBjb29raWUnLCBlcnIpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNpemUob2JqZWN0KSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqZWN0KS5sZW5ndGg7XHJcbn1cclxuZnVuY3Rpb24gZmluZCh0YXJnZXQsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgbGlzdCA9IHRhcmdldDtcclxuICAgIC8vIE1ha2VzIHN1cmVzIGlzIGFsd2F5cyBoYXMgYW4gcG9zaXRpdmUgaW50ZWdlciBhcyBsZW5ndGguXHJcbiAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGggPj4+IDA7XHJcbiAgICB2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgZWxlbWVudCA9IGxpc3RbaV07XHJcbiAgICAgICAgaWYgKGNhbGxiYWNrLmNhbGwodGhpc0FyZywgZWxlbWVudCwgaSwgbGlzdCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbnZhciBzZXNzaW9uU3RvcmFnZUtleSA9ICdidWlsZGVyU2Vzc2lvbklkJztcclxudmFyIGxvY2FsU3RvcmFnZUtleSA9ICdidWlsZGVyVmlzaXRvcklkJztcclxudmFyIGlzQnJvd3NlciA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICFpc1JlYWN0TmF0aXZlO1xyXG52YXIgaXNJZnJhbWUgPSBpc0Jyb3dzZXIgJiYgd2luZG93LnRvcCAhPT0gd2luZG93LnNlbGY7XHJcbmZ1bmN0aW9uIEJ1aWxkZXJDb21wb25lbnQoaW5mbykge1xyXG4gICAgaWYgKGluZm8gPT09IHZvaWQgMCkgeyBpbmZvID0ge307IH1cclxuICAgIHJldHVybiBCdWlsZGVyLkNvbXBvbmVudChpbmZvKTtcclxufVxyXG52YXIgQnVpbGRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJ1aWxkZXIoYXBpS2V5LCByZXF1ZXN0LCByZXNwb25zZSwgZm9yY2VOZXdJbnN0YW5jZSwgYXV0aFRva2VuLCBhcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgaWYgKGFwaUtleSA9PT0gdm9pZCAwKSB7IGFwaUtleSA9IG51bGw7IH1cclxuICAgICAgICBpZiAoZm9yY2VOZXdJbnN0YW5jZSA9PT0gdm9pZCAwKSB7IGZvcmNlTmV3SW5zdGFuY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIGlmIChhdXRoVG9rZW4gPT09IHZvaWQgMCkgeyBhdXRoVG9rZW4gPSBudWxsOyB9XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0O1xyXG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcclxuICAgICAgICB0aGlzLmV2ZW50c1F1ZXVlID0gW107XHJcbiAgICAgICAgdGhpcy50aHJvdHRsZWRDbGVhckV2ZW50c1F1ZXVlID0gdGhyb3R0bGUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5wcm9jZXNzRXZlbnRzUXVldWUoKTtcclxuICAgICAgICAgICAgLy8gRXh0ZW5kIHRoZSBzZXNzaW9uIGNvb2tpZVxyXG4gICAgICAgICAgICBfdGhpcy5zZXRDb29raWUoc2Vzc2lvblN0b3JhZ2VLZXksIF90aGlzLnNlc3Npb25JZCwgZGF0ZVBsdXNNaW51dGVzKDMwKSk7XHJcbiAgICAgICAgfSwgNSk7XHJcbiAgICAgICAgdGhpcy5lbnYgPSAncHJvZHVjdGlvbic7XHJcbiAgICAgICAgdGhpcy5zZXNzaW9uSWQgPSB0aGlzLmdldFNlc3Npb25JZCgpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0Q29udGVudCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jb250ZW50UGVyUmVxdWVzdCA9IDE7XHJcbiAgICAgICAgLy8gVE9ETzogbWFrZSBhcnJheSBvciBmdW5jdGlvblxyXG4gICAgICAgIHRoaXMuYWxsb3dDdXN0b21Gb250cyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jb29raWVzID0gbnVsbDtcclxuICAgICAgICAvLyBUT0RPOiBhcGkgb3B0aW9ucyBvYmplY3RcclxuICAgICAgICB0aGlzLmNhY2hlYnVzdCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVQYXJhbXMgPSAnJztcclxuICAgICAgICB0aGlzLm5vQ2FjaGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnByZXZpZXcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFwaVZlcnNpb24kID0gbmV3IEJlaGF2aW9yU3ViamVjdCh1bmRlZmluZWQpO1xyXG4gICAgICAgIHRoaXMuY2FuVHJhY2skID0gbmV3IEJlaGF2aW9yU3ViamVjdCghdGhpcy5icm93c2VyVHJhY2tpbmdEaXNhYmxlZCk7XHJcbiAgICAgICAgdGhpcy5hcGlLZXkkID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcclxuICAgICAgICB0aGlzLmF1dGhUb2tlbiQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpO1xyXG4gICAgICAgIHRoaXMudXNlckF0dHJpYnV0ZXNDaGFuZ2VkID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcclxuICAgICAgICB0aGlzLmVkaXRpbmdNb2RlJCA9IG5ldyBCZWhhdmlvclN1YmplY3QoaXNJZnJhbWUpO1xyXG4gICAgICAgIC8vIFRPRE86IGRlY29yYXRvciB0byBkbyB0aGlzIHN0dWZmIHdpdGggdGhlIGdldC9zZXQgKGhvdyBkbyB3aXRoIHR5cGluZyB0b28/IGNvbXBpbGVyPylcclxuICAgICAgICB0aGlzLmVkaXRpbmdNb2RlbCQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpO1xyXG4gICAgICAgIHRoaXMudXNlckFnZW50ID0gKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICdvYmplY3QnICYmIG5hdmlnYXRvci51c2VyQWdlbnQpIHx8ICcnO1xyXG4gICAgICAgIHRoaXMudHJhY2tpbmdIb29rcyA9IFtdO1xyXG4gICAgICAgIC8vIFNldCB0aGlzIHRvIGNvbnRyb2wgdGhlIHVzZXJJZFxyXG4gICAgICAgIC8vIFRPRE86IGFsbG93IGNoYW5naW5nIGl0IG1pZCBzZXNzaW9uIGFuZCB1cGRhdGluZyBleGlzdGluZyBkYXRhIHRvIGJlIGFzc29jaWF0ZWRcclxuICAgICAgICAvLyBlLmcuIGZvciB3aGVuIGEgdXNlciBuYXZpZ2F0ZXMgYW5kIHRoZW4gbG9ncyBpblxyXG4gICAgICAgIHRoaXMudmlzaXRvcklkID0gdGhpcy5nZXRWaXNpdG9ySWQoKTtcclxuICAgICAgICB0aGlzLmF1dG9UcmFjayA9ICFCdWlsZGVyLmlzQnJvd3NlclxyXG4gICAgICAgICAgICA/IGZhbHNlXHJcbiAgICAgICAgICAgIDogIXRoaXMuaXNEZXZlbG9wbWVudEVudiAmJlxyXG4gICAgICAgICAgICAgICAgIShCdWlsZGVyLmlzQnJvd3NlciAmJiBsb2NhdGlvbi5zZWFyY2guaW5kZXhPZignYnVpbGRlci5wcmV2aWV3PScpICE9PSAtMSk7XHJcbiAgICAgICAgdGhpcy50cmFja2luZ1VzZXJBdHRyaWJ1dGVzID0ge307XHJcbiAgICAgICAgdGhpcy5ibG9ja0NvbnRlbnRMb2FkaW5nID0gJyc7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnNCeUtleSA9IHt9O1xyXG4gICAgICAgIHRoaXMubm9FZGl0b3JVcGRhdGVzID0ge307XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZXMgPSB7fTtcclxuICAgICAgICB0aGlzLnF1ZXJ5T3B0aW9ucyA9IHt9O1xyXG4gICAgICAgIHRoaXMuZ2V0Q29udGVudFF1ZXVlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnByaW9yQ29udGVudFF1ZXVlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRlc3RDb29raWVQcmVmaXggPSAnYnVpbGRlci50ZXN0cyc7XHJcbiAgICAgICAgdGhpcy5jb29raWVRdWV1ZSA9IFtdO1xyXG4gICAgICAgIC8vIFRPRE86IHVzZSBhIHdpbmRvdyB2YXJpYWJsZSBmb3IgdGhpcyBwZXJoYXBzLCBlLmcuIGJjIHdlYmNvbXBvbmVudHMgbWF5IGJlIGxvYWRpbmcgYnVpbGRlciB0d2ljZVxyXG4gICAgICAgIC8vIHdpdGggaXQncyBhbmQgcmVhY3QgKHVzZSByb2xsdXAgYnVpbGQgdG8gZml4KVxyXG4gICAgICAgIGlmIChCdWlsZGVyLmlzQnJvd3NlciAmJiAhZm9yY2VOZXdJbnN0YW5jZSAmJiBCdWlsZGVyLnNpbmdsZXRvbkluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBCdWlsZGVyLnNpbmdsZXRvbkluc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0ICYmIHRoaXMucmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRVc2VyQWdlbnQodGhpcy5yZXF1ZXN0LmhlYWRlcnNbJ3VzZXItYWdlbnQnXSB8fCAnJyk7XHJcbiAgICAgICAgICAgIHRoaXMuY29va2llcyA9IG5ldyBDb29raWVzKHRoaXMucmVxdWVzdCwgdGhpcy5yZXNwb25zZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhcGlLZXkpIHtcclxuICAgICAgICAgICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IGFwaVZlcnNpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhdXRoVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBhdXRoVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5iaW5kTWVzc2FnZUxpc3RlbmVycygpO1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0VkaXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuYW5pbWF0b3JPcHRpb25zJyxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0sICcqJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVE9ETzogcG9zdG1lc3NhZ2UgdG8gcGFyZW50IHRoZSBidWlsZGVyIGluZm8gZm9yIGV2ZXJ5IHBhY2thZ2VcclxuICAgICAgICAgICAgLy8gdHlwZTogJ2J1aWxkZXIuc2RrJywgZGF0YTogeyBuYW1lOiAnQGJ1aWxkZXIuaW8vcmVhY3QnLCB2ZXJzaW9uOiAnMC4xLjIzJyB9XHJcbiAgICAgICAgICAgIC8vICh3aW5kb3cgYXMgYW55KS5CVUlMREVSX1ZFUlNJT04gPSBCdWlsZGVyLlZFUlNJT047XHJcbiAgICAgICAgICAgIC8vIEVuc3VyZSBhbHdheXMgb25lIEJ1aWxkZXIgZ2xvYmFsIHNpbmdsZXRvblxyXG4gICAgICAgICAgICAvLyBUT0RPOiBzb21lIHBlb3BsZSB3b24ndCB3YW50IHRoaXMsIGUuZy4gcmFrdXRlblxyXG4gICAgICAgICAgICAvLyBNYXliZSBoaWRlIHRoaXMgYmVoaW5kIHN5bWJvbCBvciBvbiBkb2N1bWVudCwgZXRjXHJcbiAgICAgICAgICAgIC8vIGlmICgod2luZG93IGFzIGFueSkuQnVpbGRlcikge1xyXG4gICAgICAgICAgICAvLyAgIEJ1aWxkZXIuY29tcG9uZW50cyA9ICh3aW5kb3cgYXMgYW55KS5CdWlsZGVyLmNvbXBvbmVudHM7XHJcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vICAgKHdpbmRvdyBhcyBhbnkpLkJ1aWxkZXIgPSBCdWlsZGVyO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc0lmcmFtZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VGcmFtZUxvYWRlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUT0RPOiBvbiBkZXN0cm95IGNsZWFyIHN1YnNjcmlwdGlvblxyXG4gICAgICAgIHRoaXMuY2FuVHJhY2skLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlc3Npb25TdG9yYWdlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShzZXNzaW9uU3RvcmFnZUtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oc2Vzc2lvblN0b3JhZ2VLZXksIF90aGlzLnNlc3Npb25JZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdTZXNzaW9uIHN0b3JhZ2UgZXJyb3InLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5ldmVudHNRdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy50aHJvdHRsZWRDbGVhckV2ZW50c1F1ZXVlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29va2llUXVldWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29va2llUXVldWUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRDb29raWUoaXRlbVswXSwgaXRlbVsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29va2llUXVldWUubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChpc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgLy8gVE9ETzogZGVmZXIgc28gc3ViY2xhc3MgY29uc3RydWN0b3IgcnVucyBhbmQgaW5qZWN0cyBsb2NhdGlvbiBzZXJ2aWNlXHJcbiAgICAgICAgICAgIHRoaXMuc2V0VGVzdHNGcm9tVXJsKCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGRvIHRoaXMgb24gZXZlcnkgcmVxdWVzdCBzZW5kP1xyXG4gICAgICAgICAgICB0aGlzLmdldE92ZXJyaWRlc0Zyb21RdWVyeVN0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIEJ1aWxkZXIucmVnaXN0ZXIgPSBmdW5jdGlvbiAodHlwZSwgaW5mbykge1xyXG4gICAgICAgIC8vIFRPRE86IGFsbCBtdXN0IGhhdmUgbmFtZSBhbmQgY2FuJ3QgY29uZmxpY3Q/XHJcbiAgICAgICAgdmFyIHR5cGVMaXN0ID0gdGhpcy5yZWdpc3RyeVt0eXBlXTtcclxuICAgICAgICBpZiAoIXR5cGVMaXN0KSB7XHJcbiAgICAgICAgICAgIHR5cGVMaXN0ID0gdGhpcy5yZWdpc3RyeVt0eXBlXSA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0eXBlTGlzdC5wdXNoKGluZm8pO1xyXG4gICAgICAgIGlmIChCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLnJlZ2lzdGVyJyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIGluZm86IGluZm8sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKG1lc3NhZ2UsICcqJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50ICE9PSB3aW5kb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2UobWVzc2FnZSwgJyonKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdDb3VsZCBub3QgcG9zdG1lc3NhZ2UnLCBlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVnaXN0cnlDaGFuZ2UubmV4dCh0aGlzLnJlZ2lzdHJ5KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnJlZ2lzdGVyRWRpdG9yID0gZnVuY3Rpb24gKGluZm8pIHtcclxuICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgd2luZG93LnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLnJlZ2lzdGVyRWRpdG9yJyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IG9taXQoaW5mbywgJ2NvbXBvbmVudCcpLFxyXG4gICAgICAgICAgICB9LCAnKicpO1xyXG4gICAgICAgICAgICB2YXIgaG9zdG5hbWUgPSBsb2NhdGlvbi5ob3N0bmFtZTtcclxuICAgICAgICAgICAgaWYgKCFCdWlsZGVyLmlzVHJ1c3RlZEhvc3QoaG9zdG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdCdWlsZGVyLnJlZ2lzdGVyRWRpdG9yKCkgY2FsbGVkIGluIHRoZSB3cm9uZyBlbnZpcm9ubWVudCEgWW91IGNhbm5vdCBsb2FkIGN1c3RvbSBlZGl0b3JzIGZyb20geW91ciBhcHAsIHRoZXkgbXVzdCBiZSBsb2FkZWQgdGhyb3VnaCB0aGUgQnVpbGRlci5pbyBhcHAgaXRzZWxmLiBGb2xsb3cgdGhlIHJlYWRtZSBoZXJlIGZvciBtb3JlIGRldGFpbHM6IGh0dHBzOi8vZ2l0aHViLmNvbS9idWlsZGVyaW8vYnVpbGRlci90cmVlL21hc3Rlci9wbHVnaW5zL2Nsb3VkaW5hcnkgb3IgY29udGFjdCBjaGF0IHVzIGluIG91ciBTcGVjdHJ1bSBjb21tdW5pdHkgZm9yIGhlbHA6IGh0dHBzOi8vc3BlY3RydW0uY2hhdC9idWlsZGVyJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lZGl0b3JzLnB1c2goaW5mbyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5yZWdpc3RlclBsdWdpbiA9IGZ1bmN0aW9uIChpbmZvKSB7XHJcbiAgICAgICAgdGhpcy5wbHVnaW5zLnB1c2goaW5mbyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5yZWdpc3RlckFjdGlvbiA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICB0aGlzLmFjdGlvbnMucHVzaChhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucmVnaXN0ZXJUcnVzdGVkSG9zdCA9IGZ1bmN0aW9uIChob3N0KSB7XHJcbiAgICAgICAgdGhpcy50cnVzdGVkSG9zdHMucHVzaChob3N0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBjb250ZXh0IEB0eXBlIHtpbXBvcnQoJ2lzb2xhdGVkLXZtJykuQ29udGV4dH1cclxuICAgICAqIFVzZSB0aGlzIGZ1bmN0aW9uIHRvIGNvbnRyb2wgdGhlIGV4ZWN1dGlvbiBjb250ZXh0IG9mIGN1c3RvbSBjb2RlIG9uIHRoZSBzZXJ2ZXIuXHJcbiAgICAgKiBjb25zdCBpdm0gPSByZXF1aXJlKCdpc29sYXRlZC12bScpO1xyXG4gICAgICogY29uc3QgaXNvbGF0ZSA9IG5ldyBpdm0uSXNvbGF0ZSh7IG1lbW9yeUxpbWl0OiAxMjggfSk7XHJcbiAgICAgKiBjb25zdCBjb250ZXh0ID0gaXNvbGF0ZS5jcmVhdGVDb250ZXh0U3luYygpO1xyXG4gICAgICogQnVpbGRlci5zZXRTZXJ2ZXJDb250ZXh0KGNvbnRleHQpO1xyXG4gICAgICovXHJcbiAgICBCdWlsZGVyLnNldFNlcnZlckNvbnRleHQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuc2VydmVyQ29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5pc1RydXN0ZWRIb3N0ID0gZnVuY3Rpb24gKGhvc3RuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnRydXN0ZWRIb3N0cy5maW5kSW5kZXgoZnVuY3Rpb24gKHRydXN0ZWRIb3N0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVzdGVkSG9zdC5zdGFydHNXaXRoKCcqLicpXHJcbiAgICAgICAgICAgICAgICA/IGhvc3RuYW1lLmVuZHNXaXRoKHRydXN0ZWRIb3N0LnNsaWNlKDEpKVxyXG4gICAgICAgICAgICAgICAgOiB0cnVzdGVkSG9zdCA9PT0gaG9zdG5hbWU7XHJcbiAgICAgICAgfSkgPiAtMSk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5ydW5BY3Rpb24gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgLy8gVE9ET1xyXG4gICAgICAgIHZhciBhY3Rpb25PYmplY3QgPSB0eXBlb2YgYWN0aW9uID09PSAnc3RyaW5nJyA/IGZpbmQodGhpcy5hY3Rpb25zLCBmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gaXRlbS5uYW1lID09PSBhY3Rpb247IH0pIDogYWN0aW9uO1xyXG4gICAgICAgIGlmICghYWN0aW9uT2JqZWN0KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFjdGlvbiBub3QgZm91bmQ6IFwiLmNvbmNhdChhY3Rpb24pKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5maWVsZHMgPSBmdW5jdGlvbiAobmFtZSwgZmllbGRzKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLmZpZWxkcycsXHJcbiAgICAgICAgICAgIGRhdGE6IHsgbmFtZTogbmFtZSwgZmllbGRzOiBmaWVsZHMgfSxcclxuICAgICAgICB9LCAnKicpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGRlcHJlY2F0ZWRcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBVc2UgQnVpbGRlci5yZWdpc3RlcignZWRpdG9yLnNldHRpbmdzJywge30pIGluc3RlYWQuXHJcbiAgICAgKi9cclxuICAgIEJ1aWxkZXIuc2V0ID0gZnVuY3Rpb24gKHNldHRpbmdzKSB7XHJcbiAgICAgICAgQnVpbGRlci5yZWdpc3RlcignZWRpdG9yLnNldHRpbmdzJywgc2V0dGluZ3MpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIuaW1wb3J0ID0gZnVuY3Rpb24gKHBhY2thZ2VOYW1lKSB7XHJcbiAgICAgICAgaWYgKCFCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBzZXJ2ZXIgc2lkZSBzdXBwb3J0ICptYXliZSpcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdCdWlsZGVyLmltcG9ydCB1c2VkIG9uIHRoZSBzZXJ2ZXIgLSB0aGlzIHNob3VsZCBvbmx5IGJlIHVzZWQgaW4gdGhlIGJyb3dzZXInKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgU3lzdGVtID0gd2luZG93LlN5c3RlbTtcclxuICAgICAgICBpZiAoIVN5c3RlbSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1N5c3RlbS5qcyBub3QgYXZhaWxhYmxlLiBQbGVhc2UgaW5jbHVkZSBTeXN0ZW0uanMgd2hlbiB1c2luZyBCdWlsZGVyLmltcG9ydCcpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBTeXN0ZW0uaW1wb3J0KFwiaHR0cHM6Ly9jZG4uYnVpbGRlci5pby9zeXN0ZW1qcy9cIi5jb25jYXQocGFja2FnZU5hbWUpKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlciwgXCJlZGl0aW5nUGFnZVwiLCB7XHJcbiAgICAgICAgLy8gdXNlQ2RuQXBpID0gZmFsc2U7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9lZGl0aW5nUGFnZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGVkaXRpbmdQYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2VkaXRpbmdQYWdlID0gZWRpdGluZ1BhZ2U7XHJcbiAgICAgICAgICAgIGlmIChpc0Jyb3dzZXIgJiYgaXNJZnJhbWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlZGl0aW5nUGFnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnYnVpbGRlci1lZGl0aW5nLXBhZ2UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnYnVpbGRlci1lZGl0aW5nLXBhZ2UnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEJ1aWxkZXIucHJlcGFyZUNvbXBvbmVudFNwZWNUb1NlbmQgPSBmdW5jdGlvbiAoc3BlYykge1xyXG4gICAgICAgIHJldHVybiBfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbih7fSwgc3BlYyksIChzcGVjLmlucHV0cyAmJiB7XHJcbiAgICAgICAgICAgIGlucHV0czogc3BlYy5pbnB1dHMubWFwKGZ1bmN0aW9uIChpbnB1dCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogZG8gZm9yIG5leHRlZCBmaWVsZHMgdG9vXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBwcm9iYWJseSBqdXN0IGNvbnZlcnQgYWxsIGZ1bmN0aW9ucywgbm90IGp1c3RcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHB1dCB0aGlzIGluIGlucHV0IGhvb2tzOiB7IG9uQ2hhbmdlOiAuLi4sIHNob3dJZjogLi4uIH1cclxuICAgICAgICAgICAgICAgIHZhciBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZyA9IFsnb25DaGFuZ2UnLCAnc2hvd0lmJ107XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNUb0NvbnZlcnRGblRvU3RyaW5nXzEgPSBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZzsgX2kgPCBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZ18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzVG9Db252ZXJ0Rm5Ub1N0cmluZ18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXRba2V5XSAmJiB0eXBlb2YgaW5wdXRba2V5XSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm4gPSBpbnB1dFtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dCA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBpbnB1dCksIChfYSA9IHt9LCBfYVtrZXldID0gXCJyZXR1cm4gKFwiLmNvbmNhdChmbi50b1N0cmluZygpLCBcIikuYXBwbHkodGhpcywgYXJndW1lbnRzKVwiKSwgX2EpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pKSwgeyBob29rczogT2JqZWN0LmtleXMoc3BlYy5ob29rcyB8fCB7fSkucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHNwZWMuaG9va3MgJiYgc3BlYy5ob29rc1trZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtZW1vO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZW1vW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lbW9ba2V5XSA9IFwicmV0dXJuIChcIi5jb25jYXQodmFsdWUudG9TdHJpbmcoKSwgXCIpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtbztcclxuICAgICAgICAgICAgfSwge30pLCBjbGFzczogdW5kZWZpbmVkIH0pO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucmVnaXN0ZXJCbG9jayA9IGZ1bmN0aW9uIChjb21wb25lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyQ29tcG9uZW50KGNvbXBvbmVudCwgb3B0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5yZWdpc3RlckNvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIHNwZWMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7IGNsYXNzOiBjb21wb25lbnQgfSwgY29tcG9uZW50LmJ1aWxkZXJPcHRpb25zKSwgb3B0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoc3BlYyk7XHJcbiAgICAgICAgdmFyIGVkaXRhYmxlID0gb3B0aW9ucy5tb2RlbHMgJiYgdGhpcy5zaW5nbGV0b25JbnN0YW5jZS5lZGl0aW5nTW9kZWxcclxuICAgICAgICAgICAgPyBpc0Jyb3dzZXIgJiYgb3B0aW9ucy5tb2RlbHMuaW5jbHVkZXModGhpcy5zaW5nbGV0b25JbnN0YW5jZS5lZGl0aW5nTW9kZWwpXHJcbiAgICAgICAgICAgIDogaXNCcm93c2VyO1xyXG4gICAgICAgIGlmIChlZGl0YWJsZSkge1xyXG4gICAgICAgICAgICB2YXIgc2VuZFNwZWMgPSB0aGlzLnByZXBhcmVDb21wb25lbnRTcGVjVG9TZW5kKHNwZWMpO1xyXG4gICAgICAgICAgICAoX2EgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIucmVnaXN0ZXJDb21wb25lbnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogc2VuZFNwZWMsXHJcbiAgICAgICAgICAgIH0sICcqJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIuYWRkQ29tcG9uZW50ID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50ID0gZmluZCh0aGlzLmNvbXBvbmVudHMsIGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtLm5hbWUgPT09IGNvbXBvbmVudC5uYW1lOyB9KTtcclxuICAgICAgICBpZiAoY3VycmVudCkge1xyXG4gICAgICAgICAgICAvLyBGSVhNRTogd2h5IGRvZXMgc29tZXRpbWVzIHdlIGdldCBhbiBleHRyYSBwb3N0IHdpdGhvdXQgY2xhc3MgLSBwcm9iYWJseVxyXG4gICAgICAgICAgICAvLyBmcm9tIHBvc3RNZXNzYWdlIGhhbmRsZXIgd3JvbmcgaW4gc29tZSBwbGFjZVxyXG4gICAgICAgICAgICBpZiAoY3VycmVudC5jbGFzcyAmJiAhY29tcG9uZW50LmNsYXNzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRzLnNwbGljZSh0aGlzLmNvbXBvbmVudHMuaW5kZXhPZihjdXJyZW50KSwgMSwgY29tcG9uZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFRPRE86IHN0eWxlIGd1aWRlLCBldGMgb2ZmIHRoaXMgc3lzdGVtIGFzIHdlbGw/XHJcbiAgICBCdWlsZGVyLmNvbXBvbmVudCA9IGZ1bmN0aW9uIChpbmZvKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoaW5mbyA9PT0gdm9pZCAwKSB7IGluZm8gPSB7fTsgfVxyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgdmFyIHNwZWMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgaW5mbyksIHsgY2xhc3M6IGNvbXBvbmVudCB9KTtcclxuICAgICAgICAgICAgaWYgKCFzcGVjLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHNwZWMubmFtZSA9IGNvbXBvbmVudC5uYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF90aGlzLmFkZENvbXBvbmVudChzcGVjKTtcclxuICAgICAgICAgICAgdmFyIHNlbmRTcGVjID0gX3RoaXMucHJlcGFyZUNvbXBvbmVudFNwZWNUb1NlbmQoc3BlYyk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IHNlcmlhbGl6ZSBjb21wb25lbnQgbmFtZSBhbmQgaW5wdXRzXHJcbiAgICAgICAgICAgIGlmIChpc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIucmVnaXN0ZXJDb21wb25lbnQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHNlbmRTcGVjLFxyXG4gICAgICAgICAgICAgICAgfSwgJyonKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIsIFwiQ29tcG9uZW50XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnByb2Nlc3NFdmVudHNRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZXZlbnRzUXVldWUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMuZXZlbnRzUXVldWU7XHJcbiAgICAgICAgdGhpcy5ldmVudHNRdWV1ZSA9IFtdO1xyXG4gICAgICAgIHZhciBmdWxsVXNlckF0dHJpYnV0ZXMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgQnVpbGRlci5vdmVycmlkZVVzZXJBdHRyaWJ1dGVzKSwgdGhpcy50cmFja2luZ1VzZXJBdHRyaWJ1dGVzKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGV2ZW50c18xID0gZXZlbnRzOyBfaSA8IGV2ZW50c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZXZlbnRfMSA9IGV2ZW50c18xW19pXTtcclxuICAgICAgICAgICAgaWYgKCFldmVudF8xLmRhdGEubWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50XzEuZGF0YS5tZXRhZGF0YSA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghZXZlbnRfMS5kYXRhLm1ldGFkYXRhLnVzZXIpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50XzEuZGF0YS5tZXRhZGF0YS51c2VyID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudF8xLmRhdGEubWV0YWRhdGEudXNlciwgZnVsbFVzZXJBdHRyaWJ1dGVzLCBldmVudF8xLmRhdGEubWV0YWRhdGEudXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBob3N0ID0gdGhpcy5ob3N0O1xyXG4gICAgICAgIGdldEZldGNoKCkoXCJcIi5jb25jYXQoaG9zdCwgXCIvYXBpL3YxL3RyYWNrXCIpLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGV2ZW50czogZXZlbnRzIH0pLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBOb3QgdGhlIGVuZCBvZiB0aGUgd29ybGRcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlci5wcm90b3R5cGUsIFwiYnJvd3NlclRyYWNraW5nRGlzYWJsZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQnVpbGRlci5pc0Jyb3dzZXIgJiYgQm9vbGVhbih3aW5kb3cuYnVpbGRlck5vVHJhY2sgfHwgIW5hdmlnYXRvci5jb29raWVFbmFibGVkKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlci5wcm90b3R5cGUsIFwiY2FuVHJhY2tcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW5UcmFjayQudmFsdWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChjYW5UcmFjaykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYW5UcmFjayAhPT0gY2FuVHJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FuVHJhY2skLm5leHQoY2FuVHJhY2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImFwaVZlcnNpb25cIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcGlWZXJzaW9uJC52YWx1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGFwaVZlcnNpb24pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYXBpVmVyc2lvbiAhPT0gYXBpVmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcGlWZXJzaW9uJC5uZXh0KGFwaVZlcnNpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImVkaXRpbmdNb2RlXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRpdGluZ01vZGUkLnZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLmVkaXRpbmdNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRpbmdNb2RlJC5uZXh0KHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJlZGl0aW5nTW9kZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5lZGl0aW5nTW9kZWwkLnZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLmVkaXRpbmdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0aW5nTW9kZWwkLm5leHQodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZmluZFBhcmVudEVsZW1lbnQgPSBmdW5jdGlvbiAodGFyZ2V0LCBjYWxsYmFjaywgY2hlY2tFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKGNoZWNrRWxlbWVudCA9PT0gdm9pZCAwKSB7IGNoZWNrRWxlbWVudCA9IHRydWU7IH1cclxuICAgICAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYXJlbnQgPSBjaGVja0VsZW1lbnQgPyB0YXJnZXQgOiB0YXJnZXQucGFyZW50RWxlbWVudDtcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGlmICghcGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IGNhbGxiYWNrKHBhcmVudCk7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSB3aGlsZSAoKHBhcmVudCA9IHBhcmVudC5wYXJlbnRFbGVtZW50KSk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZmluZEJ1aWxkZXJQYXJlbnQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZFBhcmVudEVsZW1lbnQodGFyZ2V0LCBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgdmFyIGlkID0gZWwuZ2V0QXR0cmlidXRlKCdidWlsZGVyLWlkJykgfHwgZWwuaWQ7XHJcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuKGlkICYmIGlkLmluZGV4T2YoJ2J1aWxkZXItJykgPT09IDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnNldFVzZXJBZ2VudCA9IGZ1bmN0aW9uICh1c2VyQWdlbnQpIHtcclxuICAgICAgICB0aGlzLnVzZXJBZ2VudCA9IHVzZXJBZ2VudCB8fCAnJztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFNldCBhIGhvb2sgdG8gbW9kaWZ5IGV2ZW50cyBiZWluZyB0cmFja2VkIGZyb20gYnVpbGRlciwgc3VjaCBhcyBpbXByZXNzaW9ucyBhbmQgY2xpY2tzXHJcbiAgICAgKlxyXG4gICAgICogRm9yIGV4YW1wbGUsIHRvIHRyYWNrIHRoZSBtb2RlbCBJRCBvZiBlYWNoIGV2ZW50IGFzc29jaWF0ZWQgd2l0aCBjb250ZW50IGZvciBxdWVyeWluZ1xyXG4gICAgICogYnkgbW9kZSwgeW91IGNhbiBkb1xyXG4gICAgICpcclxuICAgICAqICAgIGJ1aWxkZXIuc2V0VHJhY2tpbmdIb29rKChldmVudCwgY29udGV4dCkgPT4ge1xyXG4gICAgICogICAgICBpZiAoY29udGV4dC5jb250ZW50KSB7XHJcbiAgICAgKiAgICAgICAgZXZlbnQuZGF0YS5tZXRhZGF0YS5tb2RlbElkID0gY29udGV4dC5jb250ZW50Lm1vZGVsSWRcclxuICAgICAqICAgICAgfVxyXG4gICAgICogICAgfSlcclxuICAgICAqL1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuc2V0VHJhY2tpbmdIb29rID0gZnVuY3Rpb24gKGhvb2spIHtcclxuICAgICAgICB0aGlzLnRyYWNraW5nSG9va3MucHVzaChob29rKTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS50cmFjayA9IGZ1bmN0aW9uIChldmVudE5hbWUsIHByb3BlcnRpZXMsIGNvbnRleHQpIHtcclxuICAgICAgICBpZiAocHJvcGVydGllcyA9PT0gdm9pZCAwKSB7IHByb3BlcnRpZXMgPSB7fTsgfVxyXG4gICAgICAgIC8vIFRPRE86IHF1ZXVlIHVwIHRyYWNrIHJlcXVlc3RzIGFuZCBmaXJlIHRoZW0gb2ZmIHdoZW4gY2FuVHJhY2sgc2V0IHRvIHRydWUgLSBvdGhlcndpc2UgbWF5IGdldCBsb3RzIG9mIGNsaWNrcyB3aXRoIG5vIGltcHJlc3Npb25zXHJcbiAgICAgICAgaWYgKGlzSWZyYW1lIHx8ICFpc0Jyb3dzZXIgfHwgQnVpbGRlci5pc1ByZXZpZXdpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYXBpS2V5ID0gdGhpcy5hcGlLZXk7XHJcbiAgICAgICAgaWYgKCFhcGlLZXkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignQnVpbGRlciBpbnRlZ3JhdGlvbiBlcnJvcjogTG9va3MgbGlrZSB0aGUgQnVpbGRlciBTREsgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkIHByb3Blcmx5ICh5b3VyIEFQSSBrZXkgaGFzIG5vdCBiZWVuIHNldCkuIE1ha2Ugc3VyZSB5b3UgYXJlIGNhbGxpbmcgYGJ1aWxkZXIuaW5pdChcIsKrWU9VUi1BUEktS0VZwrtcIik7YCBhcyBlYXJseSBhcyBwb3NzaWJsZSBpbiB5b3VyIGFwcGxpY2F0aW9uXFwncyBjb2RlLicpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBldmVudERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgdHlwZTogZXZlbnROYW1lLFxyXG4gICAgICAgICAgICBkYXRhOiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgb21pdChwcm9wZXJ0aWVzLCAnbWV0YScpKSwgeyBtZXRhZGF0YTogX19hc3NpZ24oX19hc3NpZ24oeyBzZGtWZXJzaW9uOiBCdWlsZGVyLlZFUlNJT04sIHVybDogbG9jYXRpb24uaHJlZiB9LCBwcm9wZXJ0aWVzLm1ldGEpLCBwcm9wZXJ0aWVzLm1ldGFkYXRhKSwgb3duZXJJZDogYXBpS2V5LCB1c2VyQXR0cmlidXRlczogdGhpcy5nZXRVc2VyQXR0cmlidXRlcygpLCBzZXNzaW9uSWQ6IHRoaXMuc2Vzc2lvbklkLCB2aXNpdG9ySWQ6IHRoaXMudmlzaXRvcklkIH0pLFxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy50cmFja2luZ0hvb2tzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgaG9vayA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIHJldHVyblZhbHVlID0gaG9vayhldmVudERhdGEsIGNvbnRleHQgfHwge30pO1xyXG4gICAgICAgICAgICBpZiAocmV0dXJuVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50RGF0YSA9IHJldHVyblZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGJhdGNoIGV2ZW50c1xyXG4gICAgICAgIHRoaXMuZXZlbnRzUXVldWUucHVzaChldmVudERhdGEpO1xyXG4gICAgICAgIGlmICh0aGlzLmNhblRyYWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGhyb3R0bGVkQ2xlYXJFdmVudHNRdWV1ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRTZXNzaW9uSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc2Vzc2lvbklkID0gbnVsbDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIgJiYgdHlwZW9mIHNlc3Npb25TdG9yYWdlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkID0gdGhpcy5nZXRDb29raWUoc2Vzc2lvblN0b3JhZ2VLZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnU2Vzc2lvbiBzdG9yYWdlIGVycm9yJywgZXJyKTtcclxuICAgICAgICAgICAgLy8gSXQncyBva1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXNlc3Npb25JZCkge1xyXG4gICAgICAgICAgICBzZXNzaW9uSWQgPSB1dWlkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEdpdmUgdGhlIGFwcCBhIHNlY29uZCB0byBzdGFydCB1cCBhbmQgc2V0IGNhblRyYWNrIHRvIGZhbHNlIGlmIG5lZWRlZFxyXG4gICAgICAgIGlmIChCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmNhblRyYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldENvb2tpZShzZXNzaW9uU3RvcmFnZUtleSwgc2Vzc2lvbklkLCBkYXRlUGx1c01pbnV0ZXMoMzApKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnQ29va2llIHNldHRpbmcgZXJyb3InLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNlc3Npb25JZDtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRWaXNpdG9ySWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy52aXNpdG9ySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlzaXRvcklkO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdmlzaXRvcklkID0gbnVsbDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIgJiYgdHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGNvb2tpZSBpbnN0ZWFkP1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0obG9jYWxTdG9yYWdlS2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0xvY2FsIHN0b3JhZ2UgZXJyb3InLCBlcnIpO1xyXG4gICAgICAgICAgICAvLyBJdCdzIG9rXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdmlzaXRvcklkKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3JJZCA9IHV1aWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy52aXNpdG9ySWQgPSB2aXNpdG9ySWQ7XHJcbiAgICAgICAgLy8gR2l2ZSB0aGUgYXBwIGEgc2Vjb25kIHRvIHN0YXJ0IHVwIGFuZCBzZXQgY2FuVHJhY2sgdG8gZmFsc2UgaWYgbmVlZGVkXHJcbiAgICAgICAgaWYgKEJ1aWxkZXIuaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2FuVHJhY2sgJiYgdHlwZW9mIGxvY2FsU3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdmlzaXRvcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGxvY2FsU3RvcmFnZUtleSwgdmlzaXRvcklkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnU2Vzc2lvbiBzdG9yYWdlIGVycm9yJywgZXJyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2aXNpdG9ySWQ7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUudHJhY2tJbXByZXNzaW9uID0gZnVuY3Rpb24gKGNvbnRlbnRJZCwgdmFyaWF0aW9uSWQsIHByb3BlcnRpZXMsIGNvbnRleHQpIHtcclxuICAgICAgICBpZiAoaXNJZnJhbWUgfHwgIWlzQnJvd3NlciB8fCBCdWlsZGVyLmlzUHJldmlld2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRPRE86IHVzZSB0aGlzLnRyYWNrIG1ldGhvZFxyXG4gICAgICAgIHRoaXMudHJhY2soJ2ltcHJlc3Npb24nLCB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRJZDogY29udGVudElkLFxyXG4gICAgICAgICAgICB2YXJpYXRpb25JZDogdmFyaWF0aW9uSWQgIT09IGNvbnRlbnRJZCA/IHZhcmlhdGlvbklkIDogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICBtZXRhZGF0YTogcHJvcGVydGllcyxcclxuICAgICAgICB9LCBjb250ZXh0KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS50cmFja0NvbnZlcnNpb24gPSBmdW5jdGlvbiAoYW1vdW50LCBjb250ZW50SWQsIHZhcmlhdGlvbklkLCBjdXN0b21Qcm9wZXJ0aWVzLCBjb250ZXh0KSB7XHJcbiAgICAgICAgaWYgKGlzSWZyYW1lIHx8ICFpc0Jyb3dzZXIgfHwgQnVpbGRlci5pc1ByZXZpZXdpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWV0YSA9IHR5cGVvZiBjb250ZW50SWQgPT09ICdvYmplY3QnID8gY29udGVudElkIDogY3VzdG9tUHJvcGVydGllcztcclxuICAgICAgICB2YXIgdXNlQ29udGVudElkID0gdHlwZW9mIGNvbnRlbnRJZCA9PT0gJ3N0cmluZycgPyBjb250ZW50SWQgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy50cmFjaygnY29udmVyc2lvbicsIHsgYW1vdW50OiBhbW91bnQsIHZhcmlhdGlvbklkOiB2YXJpYXRpb25JZCwgbWV0YTogbWV0YSwgY29udGVudElkOiB1c2VDb250ZW50SWQgfSwgY29udGV4dCk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImlzRGV2ZWxvcG1lbnRFbnZcIiwge1xyXG4gICAgICAgIC8vIFRPRE86IHNldCB0aGlzIGZvciBRQVxyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBBdXRvbWF0aWMgZGV0ZXJtaW5pbmcgb2YgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnRcclxuICAgICAgICAgICAgcmV0dXJuIChCdWlsZGVyLmlzSWZyYW1lIHx8XHJcbiAgICAgICAgICAgICAgICAoQnVpbGRlci5pc0Jyb3dzZXIgJiYgKGxvY2F0aW9uLmhvc3RuYW1lID09PSAnbG9jYWxob3N0JyB8fCBsb2NhdGlvbi5wb3J0ICE9PSAnJykpIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudiAhPT0gJ3Byb2R1Y3Rpb24nKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS50cmFja0ludGVyYWN0aW9uID0gZnVuY3Rpb24gKGNvbnRlbnRJZCwgdmFyaWF0aW9uSWQsIGFscmVhZHlUcmFja2VkT25lLCBldmVudCwgY29udGV4dCkge1xyXG4gICAgICAgIGlmIChhbHJlYWR5VHJhY2tlZE9uZSA9PT0gdm9pZCAwKSB7IGFscmVhZHlUcmFja2VkT25lID0gZmFsc2U7IH1cclxuICAgICAgICBpZiAoaXNJZnJhbWUgfHwgIWlzQnJvd3NlciB8fCBCdWlsZGVyLmlzUHJldmlld2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0YXJnZXQgPSBldmVudCAmJiBldmVudC50YXJnZXQ7XHJcbiAgICAgICAgdmFyIHRhcmdldEJ1aWxkZXJFbGVtZW50ID0gdGFyZ2V0ICYmIHRoaXMuZmluZEJ1aWxkZXJQYXJlbnQodGFyZ2V0KTtcclxuICAgICAgICBmdW5jdGlvbiByb3VuZChudW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQobnVtICogMTAwMCkgLyAxMDAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbWV0YWRhdGEgPSB7fTtcclxuICAgICAgICBpZiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgdmFyIGNsaWVudFggPSBldmVudC5jbGllbnRYLCBjbGllbnRZID0gZXZlbnQuY2xpZW50WTtcclxuICAgICAgICAgICAgaWYgKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldFJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeE9mZnNldCA9IGNsaWVudFggLSB0YXJnZXRSZWN0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgeU9mZnNldCA9IGNsaWVudFkgLSB0YXJnZXRSZWN0LnRvcDtcclxuICAgICAgICAgICAgICAgIHZhciB4UmF0aW8gPSByb3VuZCh4T2Zmc2V0IC8gdGFyZ2V0UmVjdC53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeVJhdGlvID0gcm91bmQoeU9mZnNldCAvIHRhcmdldFJlY3QuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLnRhcmdldE9mZnNldCA9IHtcclxuICAgICAgICAgICAgICAgICAgICB4OiB4UmF0aW8sXHJcbiAgICAgICAgICAgICAgICAgICAgeTogeVJhdGlvLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0QnVpbGRlckVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZWN0ID0gdGFyZ2V0QnVpbGRlckVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeE9mZnNldCA9IGNsaWVudFggLSB0YXJnZXRSZWN0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgeU9mZnNldCA9IGNsaWVudFkgLSB0YXJnZXRSZWN0LnRvcDtcclxuICAgICAgICAgICAgICAgIHZhciB4UmF0aW8gPSByb3VuZCh4T2Zmc2V0IC8gdGFyZ2V0UmVjdC53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgeVJhdGlvID0gcm91bmQoeU9mZnNldCAvIHRhcmdldFJlY3QuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLmJ1aWxkZXJUYXJnZXRPZmZzZXQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogeFJhdGlvLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHlSYXRpbyxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJ1aWxkZXJJZCA9IHRhcmdldEJ1aWxkZXJFbGVtZW50ICYmXHJcbiAgICAgICAgICAgICh0YXJnZXRCdWlsZGVyRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2J1aWxkZXItaWQnKSB8fCB0YXJnZXRCdWlsZGVyRWxlbWVudC5pZCk7XHJcbiAgICAgICAgaWYgKGJ1aWxkZXJJZCAmJiB0YXJnZXRCdWlsZGVyRWxlbWVudCkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5idWlsZGVyRWxlbWVudEluZGV4ID0gW10uc2xpY2VcclxuICAgICAgICAgICAgICAgIC5jYWxsKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYnVpbGRlcklkKSlcclxuICAgICAgICAgICAgICAgIC5pbmRleE9mKHRhcmdldEJ1aWxkZXJFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50cmFjaygnY2xpY2snLCB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRJZDogY29udGVudElkLFxyXG4gICAgICAgICAgICBtZXRhZGF0YTogbWV0YWRhdGEsXHJcbiAgICAgICAgICAgIHZhcmlhdGlvbklkOiB2YXJpYXRpb25JZCAhPT0gY29udGVudElkID8gdmFyaWF0aW9uSWQgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHVuaXF1ZTogIWFscmVhZHlUcmFja2VkT25lLFxyXG4gICAgICAgICAgICB0YXJnZXRCdWlsZGVyRWxlbWVudDogYnVpbGRlcklkIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICB9LCBjb250ZXh0KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5jb21wb25lbnQgPSBmdW5jdGlvbiAoaW5mbykge1xyXG4gICAgICAgIGlmIChpbmZvID09PSB2b2lkIDApIHsgaW5mbyA9IHt9OyB9XHJcbiAgICAgICAgcmV0dXJuIEJ1aWxkZXIuY29tcG9uZW50KGluZm8pO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJhcGlLZXlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcGlLZXkkLnZhbHVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBpS2V5JC5uZXh0KGtleSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1aWxkZXIucHJvdG90eXBlLCBcImF1dGhUb2tlblwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhUb2tlbiQudmFsdWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICB0aGlzLmF1dGhUb2tlbiQubmV4dCh0b2tlbik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUubW9kaWZ5U2VhcmNoID0gZnVuY3Rpb24gKHNlYXJjaCkge1xyXG4gICAgICAgIHJldHVybiBzZWFyY2gucmVwbGFjZSgvKF58JnxcXD8pKGJ1aWxkZXJfLio/KT0vZ2ksIGZ1bmN0aW9uIChfbWF0Y2gsIGdyb3VwMSwgZ3JvdXAyKSB7IHJldHVybiBncm91cDEgKyBncm91cDIucmVwbGFjZSgvXy9nLCAnLicpICsgJz0nOyB9KTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5zZXRUZXN0c0Zyb21VcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNlYXJjaCA9IHRoaXMuZ2V0TG9jYXRpb24oKS5zZWFyY2g7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFF1ZXJ5U3RyaW5nLnBhcnNlRGVlcCh0aGlzLm1vZGlmeVNlYXJjaChzZWFyY2ggfHwgJycpLnN1YnN0cigxKSk7XHJcbiAgICAgICAgdmFyIHRlc3RzID0gcGFyYW1zLmJ1aWxkZXIgJiYgcGFyYW1zLmJ1aWxkZXIudGVzdHM7XHJcbiAgICAgICAgaWYgKHRlc3RzICYmIHR5cGVvZiB0ZXN0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRlc3RzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGVzdHMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVzdENvb2tpZShrZXksIHRlc3RzW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnJlc2V0T3ZlcnJpZGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFVnbHkgLSBwYXNzIGRvd24gaW5zdGFuY2VzIHBlciByZXF1ZXN0IGluc3RlYWQgdXNpbmcgcmVhY3QgY29udGV4dFxyXG4gICAgICAgIC8vIG9yIHVzZSBidWlsZGVyLmdldCgnZm9vJywgeyByZXEsIHJlcyB9KSBpbiByZWFjdC4uLi4uLi4uLi4uXHJcbiAgICAgICAgQnVpbGRlci5vdmVycmlkZVVzZXJBdHRyaWJ1dGVzID0ge307XHJcbiAgICAgICAgdGhpcy5jYWNoZWJ1c3QgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5vQ2FjaGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnByZXZpZXcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVkaXRpbmdNb2RlbCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZXMgPSB7fTtcclxuICAgICAgICB0aGlzLmVudiA9ICdwcm9kdWN0aW9uJztcclxuICAgICAgICB0aGlzLnVzZXJBZ2VudCA9ICcnO1xyXG4gICAgICAgIHRoaXMucmVxdWVzdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLnJlc3BvbnNlID0gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldE92ZXJyaWRlc0Zyb21RdWVyeVN0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbG9jYXRpb24gPSB0aGlzLmdldExvY2F0aW9uKCk7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFF1ZXJ5U3RyaW5nLnBhcnNlRGVlcCh0aGlzLm1vZGlmeVNlYXJjaChsb2NhdGlvbi5zZWFyY2ggfHwgJycpLnN1YnN0cigxKSk7XHJcbiAgICAgICAgdmFyIGJ1aWxkZXIgPSBwYXJhbXMuYnVpbGRlcjtcclxuICAgICAgICBpZiAoYnVpbGRlcikge1xyXG4gICAgICAgICAgICB2YXIgdXNlckF0dHJpYnV0ZXMgPSBidWlsZGVyLnVzZXJBdHRyaWJ1dGVzLCBvdmVycmlkZXMgPSBidWlsZGVyLm92ZXJyaWRlcywgZW52ID0gYnVpbGRlci5lbnY7IGJ1aWxkZXIuaG9zdDsgdmFyIGFwaSA9IGJ1aWxkZXIuYXBpLCBjYWNoZWJ1c3QgPSBidWlsZGVyLmNhY2hlYnVzdCwgbm9DYWNoZSA9IGJ1aWxkZXIubm9DYWNoZSwgcHJldmlldyA9IGJ1aWxkZXIucHJldmlldywgZWRpdGluZyA9IGJ1aWxkZXIuZWRpdGluZywgZnJhbWVFZGl0aW5nID0gYnVpbGRlci5mcmFtZUVkaXRpbmcsIG9wdGlvbnMgPSBidWlsZGVyLm9wdGlvbnMsIG92ZXJyaWRlUGFyYW1zID0gYnVpbGRlci5wYXJhbXM7XHJcbiAgICAgICAgICAgIGlmICh1c2VyQXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVc2VyQXR0cmlidXRlcyh1c2VyQXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIC8vIHBpY2tpbmcgb25seSBsb2NhbGUsIGluY2x1ZGVSZWZzLCBhbmQgZW5yaWNoIGZvciBub3dcclxuICAgICAgICAgICAgICAgIHRoaXMucXVlcnlPcHRpb25zID0gX19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oe30sIChvcHRpb25zLmxvY2FsZSAmJiB7IGxvY2FsZTogb3B0aW9ucy5sb2NhbGUgfSkpLCAob3B0aW9ucy5pbmNsdWRlUmVmcyAmJiB7IGluY2x1ZGVSZWZzOiBvcHRpb25zLmluY2x1ZGVSZWZzIH0pKSwgKG9wdGlvbnMuZW5yaWNoICYmIHsgZW5yaWNoOiBvcHRpb25zLmVucmljaCB9KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG92ZXJyaWRlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vdmVycmlkZXMgPSBvdmVycmlkZXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHZhbGlkRW52TGlzdC5pbmRleE9mKGVudiB8fCBhcGkpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW52ID0gZW52IHx8IGFwaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0VkaXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlZGl0aW5nTW9kZWwgPSBmcmFtZUVkaXRpbmcgfHwgZWRpdGluZyB8fCBwcmV2aWV3O1xyXG4gICAgICAgICAgICAgICAgaWYgKGVkaXRpbmdNb2RlbCAmJiBlZGl0aW5nTW9kZWwgIT09ICd0cnVlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdGluZ01vZGVsID0gZWRpdGluZ01vZGVsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjYWNoZWJ1c3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVidXN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobm9DYWNoZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub0NhY2hlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocHJldmlldykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJyaWRlUGFyYW1zID0gb3ZlcnJpZGVQYXJhbXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUubWVzc2FnZUZyYW1lTG9hZGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICAoX2EgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICB0eXBlOiAnYnVpbGRlci5sb2FkZWQnLFxyXG4gICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogdHJ1ZSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9LCAnKicpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmJpbmRNZXNzYWdlTGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHBhcnNlKGV2ZW50Lm9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNSZXN0cmljdGVkID0gWydidWlsZGVyLnJlZ2lzdGVyJywgJ2J1aWxkZXIucmVnaXN0ZXJDb21wb25lbnQnXS5pbmRleE9mKChfYSA9IGV2ZW50LmRhdGEpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50eXBlKSA9PT0gLTE7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNUcnVzdGVkID0gdXJsLmhvc3RuYW1lICYmIEJ1aWxkZXIuaXNUcnVzdGVkSG9zdCh1cmwuaG9zdG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUmVzdHJpY3RlZCAmJiAhaXNUcnVzdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBldmVudC5kYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGRhdGEudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLnBpbmcnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2IgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidWlsZGVyLnBvbmcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHt9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgJyonKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIucmVnaXN0ZXInOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBwb3NzaWJseSBkbyB0aGlzIGZvciBhbGwuLi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5zb3VyY2UgPT09IHdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gb3B0aW9ucy50eXBlLCBpbmZvID0gb3B0aW9ucy5pbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogYWxsIG11c3QgaGF2ZSBuYW1lIGFuZCBjYW4ndCBjb25mbGljdD9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlTGlzdCA9IEJ1aWxkZXIucmVnaXN0cnlbdHlwZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXR5cGVMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUxpc3QgPSBCdWlsZGVyLnJlZ2lzdHJ5W3R5cGVdID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlTGlzdC5wdXNoKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5yZWdpc3RyeUNoYW5nZS5uZXh0KEJ1aWxkZXIucmVnaXN0cnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5zZXR0aW5nc0NoYW5nZSc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHBvc3NpYmx5IGRvIHRoaXMgZm9yIGFsbC4uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gd2luZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2V0dGluZ3MgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKEJ1aWxkZXIuc2V0dGluZ3MsIHNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ1aWxkZXIuc2V0dGluZ3NDaGFuZ2UubmV4dChCdWlsZGVyLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIucmVnaXN0ZXJFZGl0b3InOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBwb3NzaWJseSBkbyB0aGlzIGZvciBhbGwuLi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5zb3VyY2UgPT09IHdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9fMSA9IGRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5mb18xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzQ29tcG9uZW50XzEgPSAhIWluZm9fMS5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCdWlsZGVyLmVkaXRvcnMuZXZlcnkoZnVuY3Rpb24gKHRoaXNJbmZvLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvXzEubmFtZSA9PT0gdGhpc0luZm8ubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc0luZm8uY29tcG9uZW50ICYmICFoYXNDb21wb25lbnRfMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5lZGl0b3JzW2luZGV4XSA9IHRoaXNJbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIudHJpZ2dlckFuaW1hdGlvbic6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJ1aWxkZXIuYW5pbWF0b3IudHJpZ2dlckFuaW1hdGlvbihkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5jb250ZW50VXBkYXRlJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBkYXRhLmRhdGEua2V5IHx8IGRhdGEuZGF0YS5hbGlhcyB8fCBkYXRhLmRhdGEuZW50cnkgfHwgZGF0YS5kYXRhLm1vZGVsTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50RGF0YSA9IGRhdGEuZGF0YS5kYXRhOyAvLyBobW1tLi4uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfdGhpcy5vYnNlcnZlcnNCeUtleVtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyICYmICFfdGhpcy5ub0VkaXRvclVwZGF0ZXNba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoW2NvbnRlbnREYXRhXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5nZXRDb21wb25lbnRzJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYyA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuY29tcG9uZW50cycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogQnVpbGRlci5jb21wb25lbnRzLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gQnVpbGRlci5wcmVwYXJlQ29tcG9uZW50U3BlY1RvU2VuZChpdGVtKTsgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAnKicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIuZWRpdGluZ01vZGVsJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVkaXRpbmdNb2RlbCA9IGRhdGEuZGF0YS5tb2RlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLnJlZ2lzdGVyQ29tcG9uZW50JzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wb25lbnREYXRhID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5hZGRDb21wb25lbnQoY29tcG9uZW50RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5ibG9ja0NvbnRlbnRMb2FkaW5nJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YS5kYXRhLm1vZGVsID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmJsb2NrQ29udGVudExvYWRpbmcgPSBkYXRhLmRhdGEubW9kZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRlci5lZGl0aW5nTW9kZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdGluZ01vZGUgPSBkYXRhLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdGluZ01vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5lZGl0aW5nTW9kZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdidWlsZGVyLWVkaXRpbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVkaXRpbmdNb2RlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdidWlsZGVyLWVkaXRpbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLmVkaXRpbmdQYWdlTW9kZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdGluZ1BhZ2VNb2RlID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQnVpbGRlci5lZGl0aW5nUGFnZSA9IGVkaXRpbmdQYWdlTW9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLm92ZXJyaWRlVXNlckF0dHJpYnV0ZXMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJBdHRyaWJ1dGVzID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduKEJ1aWxkZXIub3ZlcnJpZGVVc2VyQXR0cmlidXRlcywgdXNlckF0dHJpYnV0ZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hHZXRDb250ZW50UXVldWUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiByZWZldGNoIHRvb1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkZXIub3ZlcnJpZGVUZXN0R3JvdXAnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9mID0gZGF0YS5kYXRhLCB2YXJpYXRpb25JZCA9IF9mLnZhcmlhdGlvbklkLCBjb250ZW50SWQgPSBfZi5jb250ZW50SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWF0aW9uSWQgJiYgY29udGVudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0VGVzdENvb2tpZShjb250ZW50SWQsIHZhcmlhdGlvbklkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mbHVzaEdldENvbnRlbnRRdWV1ZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZGVyLmV2YWx1YXRlJzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSBkYXRhLmRhdGEudGV4dDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gZGF0YS5kYXRhLmFyZ3VtZW50cyB8fCBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZF8xID0gZGF0YS5kYXRhLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZ1bmN0aW9uLWNvbnN0cnVjdG9yLXdpdGgtc3RyaW5nLWFyZ3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IG5ldyBGdW5jdGlvbih0ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmbi5hcHBseShfdGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0b0Vycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2QgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYnVpbGRlci5ldmFsdWF0ZUVycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBpZDogaWRfMSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAnKicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0LnRoZW4gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZmluYWxSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuZXZhbHVhdGVSZXN1bHQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsgaWQ6IGlkXzEsIHJlc3VsdDogZmluYWxSZXN1bHQgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sICcqJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2UgPSB3aW5kb3cucGFyZW50KSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1aWxkZXIuZXZhbHVhdGVSZXN1bHQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyByZXN1bHQ6IHJlc3VsdCwgaWQ6IGlkXzEgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgJyonKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJkZWZhdWx0Q2FuVHJhY2tcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQm9vbGVhbihCdWlsZGVyLmlzQnJvd3NlciAmJlxyXG4gICAgICAgICAgICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudC50cmltKCkgJiZcclxuICAgICAgICAgICAgICAgICFuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9ib3R8Y3Jhd2xlcnxzcGlkZXJ8cm9ib3R8Y3Jhd2xpbmd8cHJlcmVuZGVyfGdvb2dsZXxiYWlkdXxiaW5nfG1zbnxkdWNrZHVja2JvdHx0ZW9tYXxzbHVycHx5YW5kZXh8cGhhbnRvbXxoZWFkbGVzc3xzZWxlbml1bXxwdXBwZXRlZXIvaSkgJiZcclxuICAgICAgICAgICAgICAgICF0aGlzLmJyb3dzZXJUcmFja2luZ0Rpc2FibGVkKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGFwaUtleSwgY2FuVHJhY2ssIHJlcSwgcmVzLCBhdXRoVG9rZW4sIGFwaVZlcnNpb24pIHtcclxuICAgICAgICBpZiAoY2FuVHJhY2sgPT09IHZvaWQgMCkgeyBjYW5UcmFjayA9IHRoaXMuZGVmYXVsdENhblRyYWNrOyB9XHJcbiAgICAgICAgaWYgKHJlcSkge1xyXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3QgPSByZXE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNwb25zZSA9IHJlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYW5UcmFjayA9IGNhblRyYWNrO1xyXG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xyXG4gICAgICAgIGlmIChhdXRoVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBhdXRoVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IGFwaVZlcnNpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdWlsZGVyLnByb3RvdHlwZSwgXCJwcmV2aWV3aW5nTW9kZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2VhcmNoID0gdGhpcy5nZXRMb2NhdGlvbigpLnNlYXJjaDtcclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IFF1ZXJ5U3RyaW5nLnBhcnNlKChzZWFyY2ggfHwgJycpLnN1YnN0cigxKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXJhbXNbJ2J1aWxkZXIucHJldmlldyddO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8vIFRPRE86IGFsbG93IGFkZGluZyBsb2NhdGlvbiBvYmplY3QgYXMgcHJvcGVydHkgYW5kL29yIGluIGNvbnN0cnVjdG9yXHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRMb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIHBhcnNlZExvY2F0aW9uID0ge307XHJcbiAgICAgICAgLy8gaW4gc3NyIG1vZGVcclxuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIHBhcnNlZExvY2F0aW9uID0gcGFyc2UoKF9hID0gdGhpcy5yZXF1ZXN0LnVybCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgbG9jYXRpb24gPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIC8vIGluIHRoZSBicm93c2VyXHJcbiAgICAgICAgICAgIHBhcnNlZExvY2F0aW9uID0gcGFyc2UobG9jYXRpb24uaHJlZik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElFMTEgYnVnIHdpdGggcGFyc2VkIHBhdGggYmVpbmcgZW1wdHkgc3RyaW5nXHJcbiAgICAgICAgLy8gY2F1c2VzIGlzc3VlcyB3aXRoIG91ciB1c2VyIHRhcmdldGluZ1xyXG4gICAgICAgIGlmIChwYXJzZWRMb2NhdGlvbi5wYXRobmFtZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgcGFyc2VkTG9jYXRpb24ucGF0aG5hbWUgPSAnLyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJzZWRMb2NhdGlvbjtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5nZXRVc2VyQXR0cmlidXRlcyA9IGZ1bmN0aW9uICh1c2VyQWdlbnQpIHtcclxuICAgICAgICBpZiAodXNlckFnZW50ID09PSB2b2lkIDApIHsgdXNlckFnZW50ID0gdGhpcy51c2VyQWdlbnQgfHwgJyc7IH1cclxuICAgICAgICB2YXIgaXNNb2JpbGUgPSB7XHJcbiAgICAgICAgICAgIEFuZHJvaWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIEJsYWNrQmVycnk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyQWdlbnQubWF0Y2goL0JsYWNrQmVycnkvaSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGlPUzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJBZ2VudC5tYXRjaCgvaVBob25lfGlQb2QvaSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIE9wZXJhOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlckFnZW50Lm1hdGNoKC9PcGVyYSBNaW5pL2kpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBXaW5kb3dzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlckFnZW50Lm1hdGNoKC9JRU1vYmlsZS9pKSB8fCB1c2VyQWdlbnQubWF0Y2goL1dQRGVza3RvcC9pKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYW55OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKGlzTW9iaWxlLkFuZHJvaWQoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTW9iaWxlLkJsYWNrQmVycnkoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTW9iaWxlLmlPUygpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgaXNNb2JpbGUuT3BlcmEoKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTW9iaWxlLldpbmRvd3MoKSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgaXNUYWJsZXQgPSB1c2VyQWdlbnQubWF0Y2goL1RhYmxldHxpUGFkL2kpO1xyXG4gICAgICAgIHZhciB1cmwgPSB0aGlzLmdldExvY2F0aW9uKCk7XHJcbiAgICAgICAgcmV0dXJuIF9fYXNzaWduKHsgdXJsUGF0aDogdXJsLnBhdGhuYW1lLCBob3N0OiB1cmwuaG9zdCB8fCB1cmwuaG9zdG5hbWUsIFxyXG4gICAgICAgICAgICAvLyBUT0RPOiBtYXliZSBhbiBvcHRpb24gdG8gY2hvb3NlIHRvIHRhcmdldCBvZmYgb2YgbW9iaWxlL3RhYmxldC9kZXNrdG9wIG9yIGp1c3QgbW9iaWxlL2Rlc2t0b3BcclxuICAgICAgICAgICAgZGV2aWNlOiBpc1RhYmxldCA/ICd0YWJsZXQnIDogaXNNb2JpbGUuYW55KCkgPyAnbW9iaWxlJyA6ICdkZXNrdG9wJyB9LCBCdWlsZGVyLm92ZXJyaWRlVXNlckF0dHJpYnV0ZXMpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnNldFVzZXJBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICBhc3NpZ24oQnVpbGRlci5vdmVycmlkZVVzZXJBdHRyaWJ1dGVzLCBvcHRpb25zKTtcclxuICAgICAgICB0aGlzLnVzZXJBdHRyaWJ1dGVzQ2hhbmdlZC5uZXh0KG9wdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU2V0IHVzZXIgYXR0cmlidXRlcyBqdXN0IGZvciB0cmFja2luZyBwdXJwb3Nlcy5cclxuICAgICAqXHJcbiAgICAgKiBEbyB0aGlzIHNvIHByb3BlcnRpZXMgZXhpc3Qgb24gZXZlbnQgb2JqZWN0cyBmb3IgcXVlcnlpbmcgaW5zaWdodHMsIGJ1dFxyXG4gICAgICogd29uJ3QgYWZmZWN0IHRhcmdldGluZ1xyXG4gICAgICpcclxuICAgICAqIFVzZSB0aGlzIHdoZW4geW91IHdhbnQgdG8gdHJhY2sgcHJvcGVydGllcyBidXQgZG9uJ3QgbmVlZCB0byB0YXJnZXQgb2ZmXHJcbiAgICAgKiBvZiB0aGVtIHRvIG9wdGltaXplIGNhY2hlIGVmZmljaWVuY3lcclxuICAgICAqL1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuc2V0VHJhY2tpbmdVc2VyQXR0cmlidXRlcyA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgYXNzaWduKHRoaXMudHJhY2tpbmdVc2VyQXR0cmlidXRlcywgYXR0cmlidXRlcyk7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgb3B0aW9ucykge1xyXG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICBpZiAoIUJ1aWxkZXIuaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gbmV3IEJ1aWxkZXIob3B0aW9ucy5hcGlLZXkgfHwgdGhpcy5hcGlLZXksIG9wdGlvbnMucmVxLCBvcHRpb25zLnJlcywgdW5kZWZpbmVkLCBvcHRpb25zLmF1dGhUb2tlbiB8fCB0aGlzLmF1dGhUb2tlbiwgb3B0aW9ucy5hcGlWZXJzaW9uIHx8IHRoaXMuYXBpVmVyc2lvbik7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnNldFVzZXJBdHRyaWJ1dGVzKHRoaXMuZ2V0VXNlckF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBOT1RFOiBBbGwgdGhlc2UgYXJlIHdoZW4gLmluaXQgaXMgbm90IGNhbGxlZCBhbmQgdGhlIGN1c3RvbWVyXHJcbiAgICAgICAgICAgIC8vIGRpcmVjdGx5IGNhbGxzIC5nZXQgb24gdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiBCdWlsZGVyXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmFwaUtleSAmJiAhdGhpcy5hcGlLZXkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5ID0gb3B0aW9ucy5hcGlLZXk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYXV0aFRva2VuICYmICF0aGlzLmF1dGhUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBvcHRpb25zLmF1dGhUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5hcGlWZXJzaW9uICYmICF0aGlzLmFwaVZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IG9wdGlvbnMuYXBpVmVyc2lvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2UucXVldWVHZXRDb250ZW50KG1vZGVsTmFtZSwgb3B0aW9ucykubWFwKFxyXG4gICAgICAgIC8qIG1hcCggKi8gZnVuY3Rpb24gKG1hdGNoZXMpIHtcclxuICAgICAgICAgICAgdmFyIG1hdGNoID0gbWF0Y2hlcyAmJiBtYXRjaGVzWzBdO1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc1N0YXRpYykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBtYXRjaERhdGEgPSBtYXRjaCAmJiBtYXRjaC5kYXRhO1xyXG4gICAgICAgICAgICBpZiAoIW1hdGNoRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBtYXRjaERhdGEuYmxvY2tzU3RyaW5nICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgbWF0Y2hEYXRhLmJsb2NrcyA9IEpTT04ucGFyc2UobWF0Y2hEYXRhLmJsb2Nrc1N0cmluZyk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgbWF0Y2hEYXRhLmJsb2Nrc1N0cmluZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogYWRkIGFiIHRlc3QgaW5mbyBoZXJlIGFuZCBvdGhlciBoaWdoIGxldmVsIHN0dWZmXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBtYXRjaERhdGEsXHJcbiAgICAgICAgICAgICAgICBpZDogbWF0Y2guaWQsXHJcbiAgICAgICAgICAgICAgICB2YXJpYXRpb25JZDogbWF0Y2gudGVzdFZhcmlhdGlvbklkIHx8IG1hdGNoLnZhcmlhdGlvbklkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICB0ZXN0VmFyaWF0aW9uSWQ6IG1hdGNoLnRlc3RWYXJpYXRpb25JZCB8fCBtYXRjaC52YXJpYXRpb25JZCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgdGVzdFZhcmlhdGlvbk5hbWU6IG1hdGNoLnRlc3RWYXJpYXRpb25OYW1lIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBsYXN0VXBkYXRlZDogbWF0Y2gubGFzdFVwZGF0ZWQgfHwgbnVsbCxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyApO1xyXG4gICAgfTtcclxuICAgIC8vIFRPRE86IGVudHJ5IGlkIGluIG9wdGlvbnNcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnF1ZXVlR2V0Q29udGVudCA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHsgb3B0aW9ucyA9IHt9OyB9XHJcbiAgICAgICAgLy8gVE9ETzogaWYgcXVlcnkgZG8gbW9kZWxOYW1lICsgcXVlcnlcclxuICAgICAgICB2YXIga2V5ID0gb3B0aW9ucy5rZXkgfHxcclxuICAgICAgICAgICAgb3B0aW9ucy5hbGlhcyB8fFxyXG4gICAgICAgICAgICAvLyBUT0RPOiBTREtzIG9ubHkgcGFzcyBlbnRyeSBrZXkgd2hlbiBnaXZlbiB0byB0aGVtLCBhbmQgbmV2ZXIgd2hlbiBlZGl0aW5nLi4uXHJcbiAgICAgICAgICAgIC8vIG9wdGlvbnMuZW50cnkgfHxcclxuICAgICAgICAgICAgLy8gVE9ETzogdGhpcyBpcyB1Z2x5IC0gaW5zdGVhZCBvZiBtdWx0aXBsZSBvZiBzYW1lIG1vZGVsIHdpdGggZGlmZmVyZW50IG9wdGlvbnMgYXJlIHNlbnRcclxuICAgICAgICAgICAgLy8gc2F5IHJlcXVpcmVzIGtleS9hbGlhcy4gT3IgaWYgbm90IHBlcmhhcHMgbWFrZSBhIHJlbGlhYmxlIGhhc2ggb2YgdGhlIG9wdGlvbnMgYW5kIHVzZSB0aGF0LlxyXG4gICAgICAgICAgICAvLyBUT0RPOiBzdG9yZSBsYXN0IHVzZXIgc3RhdGUgb24gbGFzdCByZXF1ZXN0IGFuZCBpZiB1c2VyIGF0dHJpYnV0ZXMgZGlmZmVyZW50IG5vd1xyXG4gICAgICAgICAgICAvLyBnaXZlIGEgd2FybmluZyB0aGF0IG5lZWQgdG8gdXNlIGtleXMgdG8gcmVxdWVzdCBuZXcgY29udGVudGVcclxuICAgICAgICAgICAgLy8gKG9wdGlvbnMgJiZcclxuICAgICAgICAgICAgLy8gICBPYmplY3Qua2V5cyhvcHRpb25zKS5maWx0ZXIoa2V5ID0+IGtleSAhPT0gJ21vZGVsJykubGVuZ3RoICYmXHJcbiAgICAgICAgICAgIC8vICAgSlNPTi5zdHJpbmdpZnkoeyBtb2RlbDogbW9kZWxOYW1lLCAuLi5vcHRpb25zLCBpbml0aWFsQ29udGVudDogdW5kZWZpbmVkIH0pKSB8fFxyXG4gICAgICAgICAgICBtb2RlbE5hbWU7XHJcbiAgICAgICAgdmFyIGlzRWRpdGluZ1RoaXNNb2RlbCA9IHRoaXMuZWRpdGluZ01vZGVsID09PSBtb2RlbE5hbWU7XHJcbiAgICAgICAgLy8gVE9ETzogaW5jbHVkZSBwYXJhbXMgaW4gdGhpcyBrZXkuLi4uLi4uLlxyXG4gICAgICAgIHZhciBjdXJyZW50T2JzZXJ2YWJsZSA9IHRoaXMub2JzZXJ2ZXJzQnlLZXlba2V5XTtcclxuICAgICAgICAvLyBpZiAob3B0aW9ucy5xdWVyeSAmJiBvcHRpb25zLnF1ZXJ5Ll9pZCkge1xyXG4gICAgICAgIC8vICAgdGhpcy5mbHVzaEdldENvbnRlbnRRdWV1ZShbb3B0aW9uc10pXHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIGlmICh0aGlzLmFwaUtleSA9PT0gJ0RFTU8nICYmICF0aGlzLm92ZXJyaWRlc1trZXldICYmICFvcHRpb25zLmluaXRpYWxDb250ZW50KSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuaW5pdGlhbENvbnRlbnQgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGluaXRpYWxDb250ZW50ID0gb3B0aW9ucy5pbml0aWFsQ29udGVudDtcclxuICAgICAgICAvLyBUT0RPOiByZWZyZXNoIG9wdGlvbiBpbiBvcHRpb25zXHJcbiAgICAgICAgaWYgKGN1cnJlbnRPYnNlcnZhYmxlICYmICghY3VycmVudE9ic2VydmFibGUudmFsdWUgfHwgb3B0aW9ucy5jYWNoZSkpIHtcclxuICAgICAgICAgICAgLy8gVE9ETzogdGVzdCBpZiB0aGlzIHJhbiwgb3RoZXJ3aXNlIG9uIDQwNCBzb21lIG9ic2VydmVycyBtYXkgbmV2ZXIgYmUgY2FsbGVkLi4uXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50T2JzZXJ2YWJsZS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgbmV4dFRpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHJldHVybiBhIG5ldyBvYnNlcnZhYmxlIGFuZCBvbmx5IHRoYXQgb25lIGZpcmVzIHN1YnNjcmliZXJzLCBkb24ndCByZWZpcmUgZm9yIGV4aXN0aW5nIG9uZXNcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T2JzZXJ2YWJsZS5uZXh0KGN1cnJlbnRPYnNlcnZhYmxlLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50T2JzZXJ2YWJsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzRWRpdGluZ1RoaXNNb2RlbCkge1xyXG4gICAgICAgICAgICBpZiAoQnVpbGRlci5pc0Jyb3dzZXIpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IHR5cGU6ICdidWlsZGVyLnVwZGF0ZUNvbnRlbnQnLCBkYXRhOiB7IG9wdGlvbnM6IG9wdGlvbnMgfSB9LCAnKicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaW5pdGlhbENvbnRlbnQgLyogfHwgaXNFZGl0aW5nVGhpc01vZGVsICovKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5nZXRDb250ZW50UXVldWUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudFF1ZXVlID0gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5nZXRDb250ZW50UXVldWUucHVzaChfX2Fzc2lnbihfX2Fzc2lnbih7fSwgb3B0aW9ucyksIHsgbW9kZWw6IG1vZGVsTmFtZSwga2V5OiBrZXkgfSkpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nZXRDb250ZW50UXVldWUgJiYgdGhpcy5nZXRDb250ZW50UXVldWUubGVuZ3RoID49IHRoaXMuY29udGVudFBlclJlcXVlc3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBxdWV1ZV8xID0gdGhpcy5nZXRDb250ZW50UXVldWUuc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q29udGVudFF1ZXVlID0gW107XHJcbiAgICAgICAgICAgICAgICBuZXh0VGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hHZXRDb250ZW50UXVldWUoZmFsc2UsIHF1ZXVlXzEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0VGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmx1c2hHZXRDb250ZW50UXVldWUoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvYnNlcnZhYmxlID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyc0J5S2V5W2tleV0gPSBvYnNlcnZhYmxlO1xyXG4gICAgICAgIGlmIChvcHRpb25zLm5vRWRpdG9yVXBkYXRlcykge1xyXG4gICAgICAgICAgICB0aGlzLm5vRWRpdG9yVXBkYXRlc1trZXldID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluaXRpYWxDb250ZW50KSB7XHJcbiAgICAgICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IG5lZWQgdG8gdGVzdE1vZGlmeSB0aGlzIEkgdGhpbmsuLi4/XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLm5leHQoaW5pdGlhbENvbnRlbnQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmFibGU7XHJcbiAgICB9O1xyXG4gICAgLy8gdGhpcyBpcyBuZWVkZWQgdG8gc2F0aXNmeSB0aGUgQW5ndWxhciBTREssIHdoaWNoIHVzZWQgdG8gcmVseSBvbiB0aGUgbW9yZSBjb21wbGV4IHZlcnNpb24gb2YgYHJlcXVlc3RVcmxgLlxyXG4gICAgLy8gZXZlbiB0aG91Z2ggd2Ugb25seSB1c2UgYGZldGNoKClgIG5vdywgd2UgcHJlZmVyIHRvIGtlZXAgdGhlIG9sZCBiZWhhdmlvciBhbmQgdXNlIHRoZSBgZmV0Y2hgIHRoYXQgY29tZXMgZnJvbVxyXG4gICAgLy8gdGhlIGNvcmUgU0RLIGZvciBjb25zaXN0ZW5jeVxyXG4gICAgQnVpbGRlci5wcm90b3R5cGUucmVxdWVzdFVybCA9IGZ1bmN0aW9uICh1cmwsIG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gZ2V0RmV0Y2goKSh1cmwsIF9fYXNzaWduKHsgbmV4dDogX19hc3NpZ24oeyByZXZhbGlkYXRlOiAxIH0sIG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5uZXh0KSB9LCBvcHRpb25zKSkudGhlbihmdW5jdGlvbiAocmVzKSB7IHJldHVybiByZXMuanNvbigpOyB9KTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnVpbGRlci5wcm90b3R5cGUsIFwiaG9zdFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5lbnYpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3FhJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2h0dHBzOi8vcWEuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0ZXN0JzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2h0dHBzOi8vYnVpbGRlci1pby10ZXN0LndlYi5hcHAnO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZmFzdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2Zhc3QuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbG91ZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2Nsb3VkLmJ1aWxkZXIuaW8nO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2RuMic6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2NkbjIuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjZG4tcWEnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnaHR0cHM6Ly9jZG4tcWEuYnVpbGRlci5pbyc7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZXZlbG9wbWVudCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZXYnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnaHR0cDovL2xvY2FsaG9zdDo1MDAwJztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2Nkbi1wcm9kJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2h0dHBzOi8vY2RuLmJ1aWxkZXIuaW8nO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQnVpbGRlci5vdmVycmlkZUhvc3QgfHwgJ2h0dHBzOi8vY2RuLmJ1aWxkZXIuaW8nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZmx1c2hHZXRDb250ZW50UXVldWUgPSBmdW5jdGlvbiAodXNlUGFzdFF1ZXVlLCB1c2VRdWV1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHVzZVBhc3RRdWV1ZSA9PT0gdm9pZCAwKSB7IHVzZVBhc3RRdWV1ZSA9IGZhbHNlOyB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmFwaUtleSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGZXRjaGluZyBjb250ZW50IGZhaWxlZCwgZXhwZWN0ZWQgYXBpS2V5IHRvIGJlIGRlZmluZWQgaW5zdGVhZCBnb3Q6IFwiLmNvbmNhdCh0aGlzLmFwaUtleSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hcGlWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIGlmICghWyd2MScsICd2MyddLmluY2x1ZGVzKHRoaXMuYXBpVmVyc2lvbikpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYXBpVmVyc2lvbjogZXhwZWN0ZWQgJ3YxJyBvciAndjMnLCByZWNlaXZlZCAnXCIuY29uY2F0KHRoaXMuYXBpVmVyc2lvbiwgXCInXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hcGlWZXJzaW9uID0gREVGQVVMVF9BUElfVkVSU0lPTjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF1c2VQYXN0UXVldWUgJiYgIXRoaXMuZ2V0Q29udGVudFF1ZXVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHF1ZXVlID0gdXNlUXVldWUgfHwgKHVzZVBhc3RRdWV1ZSA/IHRoaXMucHJpb3JDb250ZW50UXVldWUgOiB0aGlzLmdldENvbnRlbnRRdWV1ZSkgfHwgW107XHJcbiAgICAgICAgLy8gVE9ETzogZG8gdGhpcyBvbiBldmVyeSByZXF1ZXN0IHNlbmQ/XHJcbiAgICAgICAgdGhpcy5nZXRPdmVycmlkZXNGcm9tUXVlcnlTdHJpbmcoKTtcclxuICAgICAgICB2YXIgcXVlcnlQYXJhbXMgPSBfX2Fzc2lnbihfX2Fzc2lnbih7IFxyXG4gICAgICAgICAgICAvLyBUT0RPOiB3YXkgdG8gZm9yY2UgYSByZXF1ZXN0IHRvIGJlIGluIGEgc2VwYXJhdGUgcXVldWUuIG9yIGp1c3QgbG93ZXIgcXVldWUgbGltaXQgdG8gYmUgMSBieSBkZWZhdWx0XHJcbiAgICAgICAgICAgIG9taXQ6IHF1ZXVlWzBdLm9taXQgfHwgJ21ldGEuY29tcG9uZW50c1VzZWQnLCBhcGlLZXk6IHRoaXMuYXBpS2V5IH0sIHF1ZXVlWzBdLm9wdGlvbnMpLCB0aGlzLnF1ZXJ5T3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHF1ZXVlWzBdLmxvY2FsZSkge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtcy5sb2NhbGUgPSBxdWV1ZVswXS5sb2NhbGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChxdWV1ZVswXS5maWVsZHMpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMuZmllbGRzID0gcXVldWVbMF0uZmllbGRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocXVldWVbMF0uZm9ybWF0KSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmZvcm1hdCA9IHF1ZXVlWzBdLmZvcm1hdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCdub1RyYXZlcnNlJyBpbiBxdWV1ZVswXSkge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtcy5ub1RyYXZlcnNlID0gcXVldWVbMF0ubm9UcmF2ZXJzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCdpbmNsdWRlVW5wdWJsaXNoZWQnIGluIHF1ZXVlWzBdKSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmluY2x1ZGVVbnB1Ymxpc2hlZCA9IHF1ZXVlWzBdLmluY2x1ZGVVbnB1Ymxpc2hlZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHF1ZXVlWzBdLnNvcnQpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMuc29ydCA9IHF1ZXVlWzBdLnNvcnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYWdlUXVlcnlQYXJhbXMgPSB0eXBlb2YgbG9jYXRpb24gIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgID8gUXVlcnlTdHJpbmcucGFyc2VEZWVwKGxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkpXHJcbiAgICAgICAgICAgIDoge307IC8vIFRPRE86IFdIQVQgYWJvdXQgU1NSICh0aGlzLnJlcXVlc3QpID9cclxuICAgICAgICB2YXIgdXNlckF0dHJpYnV0ZXMgPSBcclxuICAgICAgICAvLyBGSVhNRTogSEFDSzogb25seSBjaGVja3MgZmlyc3QgaW4gcXVldWUgZm9yIHVzZXIgYXR0cmlidXRlcyBvdmVycmlkZXMsIHNob3VsZCBjaGVjayBhbGxcclxuICAgICAgICAvLyBUT0RPOiBtZXJnZSB1c2VyIGF0dHJpYnV0ZXMgcHJvdmlkZWQgaGVyZSB3aXRoIGRlZmF1bHRzIGFuZCBjdXJyZW50IHVzZXIgYXR0aXJpYnV0ZXMgKD8pXHJcbiAgICAgICAgcXVldWUgJiYgcXVldWVbMF0udXNlckF0dHJpYnV0ZXNcclxuICAgICAgICAgICAgPyBxdWV1ZVswXS51c2VyQXR0cmlidXRlc1xyXG4gICAgICAgICAgICA6IHRoaXMudGFyZ2V0Q29udGVudFxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLmdldFVzZXJBdHRyaWJ1dGVzKClcclxuICAgICAgICAgICAgICAgIDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybFBhdGg6IHRoaXMuZ2V0TG9jYXRpb24oKS5wYXRobmFtZSxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgdmFyIGZ1bGxVcmxRdWV1ZUl0ZW0gPSBxdWV1ZS5maW5kKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiAhIWl0ZW0uaW5jbHVkZVVybDsgfSk7XHJcbiAgICAgICAgaWYgKGZ1bGxVcmxRdWV1ZUl0ZW0pIHtcclxuICAgICAgICAgICAgdmFyIGxvY2F0aW9uXzEgPSB0aGlzLmdldExvY2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmIChsb2NhdGlvbl8xLm9yaWdpbikge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMudXJsID0gXCJcIi5jb25jYXQobG9jYXRpb25fMS5vcmlnaW4pLmNvbmNhdChsb2NhdGlvbl8xLnBhdGhuYW1lKS5jb25jYXQobG9jYXRpb25fMS5zZWFyY2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB1cmxRdWV1ZUl0ZW0gPSB1c2VRdWV1ZSA9PT0gbnVsbCB8fCB1c2VRdWV1ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlUXVldWUuZmluZChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gaXRlbS51cmw7IH0pO1xyXG4gICAgICAgIGlmICh1cmxRdWV1ZUl0ZW0gPT09IG51bGwgfHwgdXJsUXVldWVJdGVtID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1cmxRdWV1ZUl0ZW0udXJsKSB7XHJcbiAgICAgICAgICAgIHVzZXJBdHRyaWJ1dGVzLnVybFBhdGggPSB1cmxRdWV1ZUl0ZW0udXJsLnNwbGl0KCc/JylbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRPRE86IG1lcmdlIGluIHRoZSBhdHRyaWJ1dGUgZnJvbSBxdWVyeSBzdHJpbmcgb25lc1xyXG4gICAgICAgIC8vIFRPRE86IG1ha2UgdGhpcyBhbiBvcHRpb24gcGVyIGNvbXBvbmVudC9yZXF1ZXN0XHJcbiAgICAgICAgcXVlcnlQYXJhbXMudXNlckF0dHJpYnV0ZXMgPSB1c2VyQXR0cmlidXRlcztcclxuICAgICAgICBpZiAoIXVzZVBhc3RRdWV1ZSAmJiAhdXNlUXVldWUpIHtcclxuICAgICAgICAgICAgdGhpcy5wcmlvckNvbnRlbnRRdWV1ZSA9IHF1ZXVlO1xyXG4gICAgICAgICAgICB0aGlzLmdldENvbnRlbnRRdWV1ZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjYWNoZWJ1c3QgPSB0aGlzLmNhY2hlYnVzdCB8fFxyXG4gICAgICAgICAgICBpc0lmcmFtZSB8fFxyXG4gICAgICAgICAgICBwYWdlUXVlcnlQYXJhbXMuY2FjaGVidXN0IHx8XHJcbiAgICAgICAgICAgIHBhZ2VRdWVyeVBhcmFtc1snYnVpbGRlci5jYWNoZWJ1c3QnXTtcclxuICAgICAgICBpZiAoY2FjaGVidXN0IHx8IHRoaXMuZW52ICE9PSAncHJvZHVjdGlvbicpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMuY2FjaGVidXN0ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKEJ1aWxkZXIuaXNFZGl0aW5nKSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmlzRWRpdGluZyA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm5vQ2FjaGUgfHwgdGhpcy5lbnYgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgICAgICBxdWVyeVBhcmFtcy5ub0NhY2hlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNpemUodGhpcy5vdmVycmlkZXMpKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLm92ZXJyaWRlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3ZlcnJpZGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1tcIm92ZXJyaWRlcy5cIi5jb25jYXQoa2V5KV0gPSB0aGlzLm92ZXJyaWRlc1trZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcXVldWVfMiA9IHF1ZXVlOyBfaSA8IHF1ZXVlXzIubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gcXVldWVfMltfaV07XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMuZm9ybWF0ID0gb3B0aW9ucy5mb3JtYXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlIG1lIGFuZCBtYWtlIHBlcm1vZGVsXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnN0YXRpYykge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMuc3RhdGljID0gb3B0aW9ucy5zdGF0aWM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuY2FjaGVidXN0KSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5jYWNoZWJ1c3QgPSBvcHRpb25zLmNhY2hlYnVzdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXNQb3NpdGl2ZU51bWJlcihvcHRpb25zLmNhY2hlU2Vjb25kcykpIHtcclxuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zLmNhY2hlU2Vjb25kcyA9IG9wdGlvbnMuY2FjaGVTZWNvbmRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpc1Bvc2l0aXZlTnVtYmVyKG9wdGlvbnMuc3RhbGVDYWNoZVNlY29uZHMpKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5zdGFsZUNhY2hlU2Vjb25kcyA9IG9wdGlvbnMuc3RhbGVDYWNoZVNlY29uZHM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBbXHJcbiAgICAgICAgICAgICAgICAncHJlcmVuZGVyJyxcclxuICAgICAgICAgICAgICAgICdleHRyYWN0Q3NzJyxcclxuICAgICAgICAgICAgICAgICdsaW1pdCcsXHJcbiAgICAgICAgICAgICAgICAnb2Zmc2V0JyxcclxuICAgICAgICAgICAgICAgICdxdWVyeScsXHJcbiAgICAgICAgICAgICAgICAncHJldmlldycsXHJcbiAgICAgICAgICAgICAgICAnbW9kZWwnLFxyXG4gICAgICAgICAgICAgICAgJ2VudHJ5JyxcclxuICAgICAgICAgICAgICAgICdyZXYnLFxyXG4gICAgICAgICAgICAgICAgJ3N0YXRpYycsXHJcbiAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgcHJvcGVydGllc18xID0gcHJvcGVydGllczsgX2EgPCBwcm9wZXJ0aWVzXzEubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gcHJvcGVydGllc18xW19hXTtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9wdGlvbnNba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMub3B0aW9ucyA9IHF1ZXJ5UGFyYW1zLm9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMub3B0aW9uc1tvcHRpb25zLmtleV0gPSBxdWVyeVBhcmFtcy5vcHRpb25zW29wdGlvbnMua2V5XSB8fCB7fTtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5vcHRpb25zW29wdGlvbnMua2V5XVtrZXldID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnByZXZpZXcpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbXMucHJldmlldyA9ICd0cnVlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGhhc1BhcmFtcyA9IE9iamVjdC5rZXlzKHF1ZXJ5UGFyYW1zKS5sZW5ndGggPiAwO1xyXG4gICAgICAgIC8vIFRPRE86IG9wdGlvbiB0byBmb3JjZSBkZXYgb3IgcWEgYXBpIGhlcmVcclxuICAgICAgICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcclxuICAgICAgICB2YXIga2V5TmFtZXMgPSBxdWV1ZS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChpdGVtLmtleSk7IH0pLmpvaW4oJywnKTtcclxuICAgICAgICBpZiAodGhpcy5vdmVycmlkZVBhcmFtcykge1xyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gb21pdChRdWVyeVN0cmluZy5wYXJzZSh0aGlzLm92ZXJyaWRlUGFyYW1zKSwgJ2FwaUtleScpO1xyXG4gICAgICAgICAgICBhc3NpZ24ocXVlcnlQYXJhbXMsIHBhcmFtcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBxdWVyeVN0ciA9IFF1ZXJ5U3RyaW5nLnN0cmluZ2lmeURlZXAocXVlcnlQYXJhbXMpO1xyXG4gICAgICAgIHZhciBmb3JtYXQgPSBxdWVyeVBhcmFtcy5mb3JtYXQ7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RPcHRpb25zID0geyBoZWFkZXJzOiB7fSwgbmV4dDogeyByZXZhbGlkYXRlOiAxIH0gfTtcclxuICAgICAgICBpZiAodGhpcy5hdXRoVG9rZW4pIHtcclxuICAgICAgICAgICAgcmVxdWVzdE9wdGlvbnMuaGVhZGVycyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzKSwgeyBBdXRob3JpemF0aW9uOiBcIkJlYXJlciBcIi5jb25jYXQodGhpcy5hdXRoVG9rZW4pIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZm4gPSBmb3JtYXQgPT09ICdzb2xpZCcgfHwgZm9ybWF0ID09PSAncmVhY3QnID8gJ2NvZGVnZW4nIDogJ3F1ZXJ5JztcclxuICAgICAgICAvLyBOT1RFOiB0aGlzIGlzIGEgaGFjayB0byBnZXQgYXJvdW5kIHRoZSBmYWN0IHRoYXQgdGhlIGNvZGVnZW4gZW5kcG9pbnQgaXMgbm90IHlldCBhdmFpbGFibGUgaW4gdjNcclxuICAgICAgICB2YXIgYXBpVmVyc2lvbkJhc2VkT25GbiA9IGZuID09PSAncXVlcnknID8gdGhpcy5hcGlWZXJzaW9uIDogJ3YxJztcclxuICAgICAgICB2YXIgdXJsID0gXCJcIi5jb25jYXQoaG9zdCwgXCIvYXBpL1wiKS5jb25jYXQoYXBpVmVyc2lvbkJhc2VkT25GbiwgXCIvXCIpLmNvbmNhdChmbiwgXCIvXCIpLmNvbmNhdCh0aGlzLmFwaUtleSwgXCIvXCIpLmNvbmNhdChrZXlOYW1lcykgK1xyXG4gICAgICAgICAgICAocXVlcnlQYXJhbXMgJiYgaGFzUGFyYW1zID8gXCI/XCIuY29uY2F0KHF1ZXJ5U3RyKSA6ICcnKTtcclxuICAgICAgICB2YXIgcHJvbWlzZSA9IGdldEZldGNoKCkodXJsLCByZXF1ZXN0T3B0aW9ucylcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykgeyByZXR1cm4gcmVzLmpzb24oKTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHF1ZXVlXzMgPSBxdWV1ZTsgX2kgPCBxdWV1ZV8zLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBxdWV1ZV8zW19pXTtcclxuICAgICAgICAgICAgICAgIHZhciBrZXlOYW1lID0gb3B0aW9ucy5rZXk7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5tb2RlbCA9PT0gX3RoaXMuYmxvY2tDb250ZW50TG9hZGluZyAmJiAhb3B0aW9ucy5ub0VkaXRvclVwZGF0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBpc0VkaXRpbmdUaGlzTW9kZWwgPSBfdGhpcy5lZGl0aW5nTW9kZWwgPT09IG9wdGlvbnMubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNFZGl0aW5nVGhpc01vZGVsICYmIEJ1aWxkZXIuaXNFZGl0aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgdHlwZTogJ2J1aWxkZXIudXBkYXRlQ29udGVudCcsIGRhdGE6IHsgb3B0aW9uczogb3B0aW9ucyB9IH0sICcqJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIG9ic2VydmVyID0gX3RoaXMub2JzZXJ2ZXJzQnlLZXlba2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIW9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByZXN1bHRba2V5TmFtZV07XHJcbiAgICAgICAgICAgICAgICB2YXIgc29ydGVkID0gZGF0YTsgLy8gc29ydEJ5KGRhdGEsIGl0ZW0gPT4gaXRlbS5wcmlvcml0eSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXN0TW9kaWZpZWRSZXN1bHRzID0gQnVpbGRlci5pc1NlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNvcnRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA6IF90aGlzLnByb2Nlc3NSZXN1bHRzRm9yVGVzdHMoc29ydGVkKTtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHRlc3RNb2RpZmllZFJlc3VsdHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaCA9IF90aGlzLmdldExvY2F0aW9uKCkuc2VhcmNoO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgoc2VhcmNoIHx8ICcnKS5pbmNsdWRlcygnYnVpbGRlci5wcmV2aWV3PScgKyBvcHRpb25zLm1vZGVsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJldmlld0RhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ3ByZXZpZXcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1ByZXZpZXcnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToge30sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoW3ByZXZpZXdEYXRhXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoW10pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHF1ZXVlXzQgPSBxdWV1ZTsgX2kgPCBxdWV1ZV80Lmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBxdWV1ZV80W19pXTtcclxuICAgICAgICAgICAgICAgIHZhciBvYnNlcnZlciA9IF90aGlzLm9ic2VydmVyc0J5S2V5W29wdGlvbnMua2V5XTtcclxuICAgICAgICAgICAgICAgIGlmICghb2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUucHJvY2Vzc1Jlc3VsdHNGb3JUZXN0cyA9IGZ1bmN0aW9uIChyZXN1bHRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIG1hcHBlZFJlc3VsdHMgPSByZXN1bHRzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoIWl0ZW0udmFyaWF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGNvb2tpZVZhbHVlID0gX3RoaXMuZ2V0VGVzdENvb2tpZShpdGVtLmlkKTtcclxuICAgICAgICAgICAgdmFyIGNvb2tpZVZhcmlhdGlvbiA9IGNvb2tpZVZhbHVlID09PSBpdGVtLmlkID8gaXRlbSA6IGl0ZW0udmFyaWF0aW9uc1tjb29raWVWYWx1ZV07XHJcbiAgICAgICAgICAgIGlmIChjb29raWVWYXJpYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgaXRlbSksIHsgZGF0YTogY29va2llVmFyaWF0aW9uLmRhdGEsIHZhcmlhdGlvbklkOiBjb29raWVWYWx1ZSwgdGVzdFZhcmlhdGlvbklkOiBjb29raWVWYWx1ZSwgdGVzdFZhcmlhdGlvbk5hbWU6IGNvb2tpZVZhcmlhdGlvbi5uYW1lIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5jYW5UcmFjayAmJiBpdGVtLnZhcmlhdGlvbnMgJiYgc2l6ZShpdGVtLnZhcmlhdGlvbnMpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmFuZG9tID0gTWF0aC5yYW5kb20oKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGlkIGluIGl0ZW0udmFyaWF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYXRpb24gPSBpdGVtLnZhcmlhdGlvbnNbaWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZXN0UmF0aW8gPSB2YXJpYXRpb24udGVzdFJhdGlvO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gKz0gdGVzdFJhdGlvO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyYW5kb20gPCBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFRlc3RDb29raWUoaXRlbS5pZCwgdmFyaWF0aW9uLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhcmlhdGlvbk5hbWUgPSB2YXJpYXRpb24ubmFtZSB8fCAodmFyaWF0aW9uLmlkID09PSBpdGVtLmlkID8gJ0RlZmF1bHQgdmFyaWF0aW9uJyA6ICcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKHt9LCBpdGVtKSwgeyBkYXRhOiB2YXJpYXRpb24uZGF0YSwgdmFyaWF0aW9uSWQ6IHZhcmlhdGlvbi5pZCwgdGVzdFZhcmlhdGlvbklkOiB2YXJpYXRpb24uaWQsIHZhcmlhdGlvbk5hbWU6IHZhcmlhdGlvbk5hbWUsIHRlc3RWYXJpYXRpb25OYW1lOiB2YXJpYXRpb25OYW1lIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF90aGlzLnNldFRlc3RDb29raWUoaXRlbS5pZCwgaXRlbS5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKHt9LCBpdGVtKSwgeyB2YXJpYXRpb25JZDogaXRlbS5pZCB9KSwgKGl0ZW0udmFyaWF0aW9ucyAmJlxyXG4gICAgICAgICAgICAgICAgc2l6ZShpdGVtLnZhcmlhdGlvbnMpICYmIHtcclxuICAgICAgICAgICAgICAgIHRlc3RWYXJpYXRpb25JZDogaXRlbS5pZCxcclxuICAgICAgICAgICAgICAgIHRlc3RWYXJpYXRpb25OYW1lOiAnRGVmYXVsdCB2YXJpYXRpb24nLFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKGlzSWZyYW1lKSB7XHJcbiAgICAgICAgICAgIChfYSA9IHdpbmRvdy5wYXJlbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3N0TWVzc2FnZSh7IHR5cGU6ICdidWlsZGVyLmNvbnRlbnRSZXN1bHRzJywgZGF0YTogeyByZXN1bHRzOiBtYXBwZWRSZXN1bHRzIH0gfSwgJyonKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1hcHBlZFJlc3VsdHM7XHJcbiAgICB9O1xyXG4gICAgQnVpbGRlci5wcm90b3R5cGUuZ2V0VGVzdENvb2tpZSA9IGZ1bmN0aW9uIChjb250ZW50SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRDb29raWUoXCJcIi5jb25jYXQodGhpcy50ZXN0Q29va2llUHJlZml4LCBcIi5cIikuY29uY2F0KGNvbnRlbnRJZCkpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLnNldFRlc3RDb29raWUgPSBmdW5jdGlvbiAoY29udGVudElkLCB2YXJpYXRpb25JZCkge1xyXG4gICAgICAgIGlmICghdGhpcy5jYW5UcmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmNvb2tpZVF1ZXVlLnB1c2goW2NvbnRlbnRJZCwgdmFyaWF0aW9uSWRdKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAzMCBkYXlzIGZyb20gbm93XHJcbiAgICAgICAgdmFyIGZ1dHVyZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgZnV0dXJlLnNldERhdGUoZnV0dXJlLmdldERhdGUoKSArIDMwKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRDb29raWUoXCJcIi5jb25jYXQodGhpcy50ZXN0Q29va2llUHJlZml4LCBcIi5cIikuY29uY2F0KGNvbnRlbnRJZCksIHZhcmlhdGlvbklkLCBmdXR1cmUpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldENvb2tpZSA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29va2llcykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb29raWVzLmdldChuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEJ1aWxkZXIuaXNCcm93c2VyICYmIGdldENvb2tpZShuYW1lKTtcclxuICAgIH07XHJcbiAgICBCdWlsZGVyLnByb3RvdHlwZS5zZXRDb29raWUgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIGV4cGlyZXMpIHtcclxuICAgICAgICBpZiAodGhpcy5jb29raWVzICYmICEoQnVpbGRlci5pc1NlcnZlciAmJiBCdWlsZGVyLmlzU3RhdGljKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb29raWVzLnNldChuYW1lLCB2YWx1ZSwge1xyXG4gICAgICAgICAgICAgICAgZXhwaXJlczogZXhwaXJlcyxcclxuICAgICAgICAgICAgICAgIHNlY3VyZTogdGhpcy5nZXRMb2NhdGlvbigpLnByb3RvY29sID09PSAnaHR0cHM6JyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBCdWlsZGVyLmlzQnJvd3NlciAmJiBzZXRDb29raWUobmFtZSwgdmFsdWUsIGV4cGlyZXMpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldENvbnRlbnQgPSBmdW5jdGlvbiAobW9kZWxOYW1lLCBvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cclxuICAgICAgICBpZiAoIXRoaXMuYXBpS2V5KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZldGNoaW5nIGNvbnRlbnQgZnJvbSBtb2RlbCBcIi5jb25jYXQobW9kZWxOYW1lLCBcIiBmYWlsZWQsIGV4cGVjdGVkIGFwaUtleSB0byBiZSBkZWZpbmVkIGluc3RlYWQgZ290OiBcIikuY29uY2F0KHRoaXMuYXBpS2V5KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXVlR2V0Q29udGVudChtb2RlbE5hbWUsIG9wdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIEJ1aWxkZXIucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxyXG4gICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCFCdWlsZGVyLmlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICBpbnN0YW5jZSA9IG5ldyBCdWlsZGVyKG9wdGlvbnMuYXBpS2V5IHx8IHRoaXMuYXBpS2V5LCBvcHRpb25zLnJlcSwgb3B0aW9ucy5yZXMsIGZhbHNlLCBvcHRpb25zLmF1dGhUb2tlbiB8fCB0aGlzLmF1dGhUb2tlbiwgb3B0aW9ucy5hcGlWZXJzaW9uIHx8IHRoaXMuYXBpVmVyc2lvbik7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnNldFVzZXJBdHRyaWJ1dGVzKHRoaXMuZ2V0VXNlckF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBOT1RFOiBBbGwgdGhlc2UgYXJlIHdoZW4gLmluaXQgaXMgbm90IGNhbGxlZCBhbmQgdGhlIGN1c3RvbWVyXHJcbiAgICAgICAgICAgIC8vIGRpcmVjdGx5IGNhbGxzIC5nZXQgb24gdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiBCdWlsZGVyXHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmFwaUtleSAmJiAhdGhpcy5hcGlLZXkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpS2V5ID0gb3B0aW9ucy5hcGlLZXk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYXV0aFRva2VuICYmICF0aGlzLmF1dGhUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSBvcHRpb25zLmF1dGhUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5hcGlWZXJzaW9uICYmICF0aGlzLmFwaVZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBpVmVyc2lvbiA9IG9wdGlvbnMuYXBpVmVyc2lvbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTZXQgbm9UcmF2ZXJzZT10cnVlIGlmIE5PVCBhbHJlYWR5IHBhc3NlZCBieSB1c2VyLCBmb3IgcXVlcnkgcGVyZm9ybWFuY2VcclxuICAgICAgICBpZiAoISgnbm9UcmF2ZXJzZScgaW4gb3B0aW9ucykpIHtcclxuICAgICAgICAgICAgb3B0aW9ucy5ub1RyYXZlcnNlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlXHJcbiAgICAgICAgICAgIC5nZXRDb250ZW50KG1vZGVsTmFtZSwgX19hc3NpZ24oX19hc3NpZ24oeyBsaW1pdDogMzAgfSwgb3B0aW9ucyksIHsga2V5OiBvcHRpb25zLmtleSB8fFxyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSB0aGUga2V5IGluY2x1ZGUgYWxsIG9wdGlvbnMsIHNvIHdlIGRvbid0IHJldXNlIGNhY2hlIGZvciB0aGUgc2FtZSBjb250ZW50IGZldGNoZWRcclxuICAgICAgICAgICAgICAgIC8vIHdpdGggZGlmZmVyZW50IG9wdGlvbnNcclxuICAgICAgICAgICAgICAgIEJ1aWxkZXIuaXNCcm93c2VyXHJcbiAgICAgICAgICAgICAgICA/IFwiXCIuY29uY2F0KG1vZGVsTmFtZSwgXCI6XCIpLmNvbmNhdChoYXNoKG9taXQob3B0aW9ucywgJ2luaXRpYWxDb250ZW50JywgJ3JlcScsICdyZXMnKSkpXHJcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCB9KSlcclxuICAgICAgICAgICAgLnByb21pc2UoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIEBkZXByZWNhdGVkLiBUaGlzIGlzIGJ1Z2d5LCBhbmQgYWx3YXlzIGJlaGluZCBieSBhIHZlcnNpb24uXHJcbiAgICAgKi9cclxuICAgIEJ1aWxkZXIuVkVSU0lPTiA9IHZlcnNpb247XHJcbiAgICBCdWlsZGVyLmNvbXBvbmVudHMgPSBbXTtcclxuICAgIC8qKlxyXG4gICAgICogTWFrZXMgaXQgc28gdGhhdCBhL2IgdGVzdHMgZ2VuZXJhdGUgY29kZSBsaWtlIHtAbGlua1xyXG4gICAgICogaHR0cHM6Ly93d3cuYnVpbGRlci5pby9ibG9nL2hpZ2gtcGVyZm9ybWFuY2Utbm8tY29kZSNfX25leHQ6fjp0ZXh0PVN0YXRpYyUyMGdlbmVyYXRlZCUyMEElMkZCJTIwdGVzdGluZ31cclxuICAgICAqIGluc3RlYWQgb2YgdGhlIG9sZCB3YXkgd2hlcmUgd2UgcmVuZGVyIG9ubHkgb25lIHRlc3QgZ3JvdXAgYXQgYSB0aW1lIG9uIHRoZVxyXG4gICAgICogc2VydmVyLiBUaGlzIGlzIHRoZSBwcmVmZXJyZWQvYmV0dGVyIHdheSBub3QgYW5kIHdlIHNob3VsZCB1bHRpbWF0ZWx5IG1ha2UgaXRcclxuICAgICAqIHRoZSBkZWZhdWx0XHJcbiAgICAgKi9cclxuICAgIEJ1aWxkZXIuaXNTdGF0aWMgPSB0cnVlO1xyXG4gICAgQnVpbGRlci5hbmltYXRvciA9IG5ldyBBbmltYXRvcigpO1xyXG4gICAgQnVpbGRlci5uZXh0VGljayA9IG5leHRUaWNrO1xyXG4gICAgQnVpbGRlci50aHJvdHRsZSA9IHRocm90dGxlO1xyXG4gICAgQnVpbGRlci5lZGl0b3JzID0gW107XHJcbiAgICBCdWlsZGVyLnRydXN0ZWRIb3N0cyA9IFtcclxuICAgICAgICAnKi5iZXRhLmJ1aWxkZXIuaW8nLFxyXG4gICAgICAgICdiZXRhLmJ1aWxkZXIuaW8nLFxyXG4gICAgICAgICdidWlsZGVyLmlvJyxcclxuICAgICAgICAnbG9jYWxob3N0JyxcclxuICAgICAgICAncWEuYnVpbGRlci5pbycsXHJcbiAgICBdO1xyXG4gICAgQnVpbGRlci5wbHVnaW5zID0gW107XHJcbiAgICBCdWlsZGVyLmFjdGlvbnMgPSBbXTtcclxuICAgIEJ1aWxkZXIucmVnaXN0cnkgPSB7fTtcclxuICAgIEJ1aWxkZXIucmVnaXN0cnlDaGFuZ2UgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KHt9KTtcclxuICAgIEJ1aWxkZXIuX2VkaXRpbmdQYWdlID0gZmFsc2U7XHJcbiAgICBCdWlsZGVyLmlzSWZyYW1lID0gaXNJZnJhbWU7XHJcbiAgICBCdWlsZGVyLmlzQnJvd3NlciA9IGlzQnJvd3NlcjtcclxuICAgIEJ1aWxkZXIuaXNSZWFjdE5hdGl2ZSA9IGlzUmVhY3ROYXRpdmU7XHJcbiAgICBCdWlsZGVyLmlzU2VydmVyID0gIWlzQnJvd3NlciAmJiAhaXNSZWFjdE5hdGl2ZTtcclxuICAgIEJ1aWxkZXIucHJldmlld2luZ01vZGVsID0gQnVpbGRlci5pc0Jyb3dzZXIgJiYgZ2V0UXVlcnlQYXJhbShsb2NhdGlvbi5ocmVmLCAnYnVpbGRlci5wcmV2aWV3Jyk7XHJcbiAgICBCdWlsZGVyLnNldHRpbmdzID0ge307XHJcbiAgICBCdWlsZGVyLnNldHRpbmdzQ2hhbmdlID0gbmV3IEJlaGF2aW9yU3ViamVjdCh7fSk7XHJcbiAgICAvLyBUT0RPOiB0aGlzIGlzIHF1aWNrIGFuZCBkaXJ0eSwgZG8gYmV0dGVyIGltcGxlbWVudGF0aW9uIGxhdGVyLiBBbHNvIGNhbiBiZSB1bnJlbGlhYmxlXHJcbiAgICAvLyBpZiBwYWdlIDMwMXMgZXRjLiBVc2UgYSBxdWVyeSBwYXJhbSBpbnN0ZWFkPyBhbHNvIGNvdWxkIGhhdmUgaXNzdWVzIHdpdGggcmVkaXJlY3RzLiBJbmplY3RpbmcgdmFyIGNvdWxkXHJcbiAgICAvLyB3b3JrIGJ1dCBpcyBhc3luYy4uLlxyXG4gICAgQnVpbGRlci5pc0VkaXRpbmcgPSBCb29sZWFuKGlzSWZyYW1lICYmXHJcbiAgICAgICAgKChkb2N1bWVudC5yZWZlcnJlciAmJiBkb2N1bWVudC5yZWZlcnJlci5tYXRjaCgvYnVpbGRlclxcLmlvfGxvY2FsaG9zdDoxMjM0LykpIHx8XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKCdidWlsZGVyLmZyYW1lRWRpdGluZz0nKSAhPT0gLTEpKTtcclxuICAgIEJ1aWxkZXIuaXNQcmV2aWV3aW5nID0gQm9vbGVhbihpc0Jyb3dzZXIgJiZcclxuICAgICAgICAobG9jYXRpb24uc2VhcmNoLmluZGV4T2YoJ2J1aWxkZXIucHJldmlldz0nKSAhPT0gLTEgfHxcclxuICAgICAgICAgICAgbG9jYXRpb24uc2VhcmNoLmluZGV4T2YoJ2J1aWxkZXIuZnJhbWVFZGl0aW5nPScpICE9PSAtMSkpO1xyXG4gICAgQnVpbGRlci5pc1JlYWN0ID0gZmFsc2U7XHJcbiAgICBCdWlsZGVyLm92ZXJyaWRlVXNlckF0dHJpYnV0ZXMgPSB7fTtcclxuICAgIHJldHVybiBCdWlsZGVyO1xyXG59KCkpO1xuXG52YXIgYnVpbGRlciA9IG5ldyBCdWlsZGVyKG51bGwsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0cnVlKTtcclxuQnVpbGRlci5zaW5nbGV0b25JbnN0YW5jZSA9IGJ1aWxkZXI7XG5cbmV4cG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgQnVpbGRlciwgQnVpbGRlckNvbXBvbmVudCwgU3Vic2NyaXB0aW9uLCBidWlsZGVyLCBpc0Jyb3dzZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@builder.io/sdk/dist/index.esm.js\n");

/***/ })

};
;